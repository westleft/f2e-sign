var Nc=Object.defineProperty;var Dc=(Ie,r,Me)=>r in Ie?Nc(Ie,r,{enumerable:!0,configurable:!0,writable:!0,value:Me}):Ie[r]=Me;var qn=(Ie,r,Me)=>(Dc(Ie,typeof r!="symbol"?r+"":r,Me),Me),Pl=(Ie,r,Me)=>{if(!r.has(Ie))throw TypeError("Cannot "+Me)};var Mi=(Ie,r,Me)=>(Pl(Ie,r,"read from private field"),Me?Me.call(Ie):r.get(Ie)),rn=(Ie,r,Me)=>{if(r.has(Ie))throw TypeError("Cannot add the same private member more than once");r instanceof WeakSet?r.add(Ie):r.set(Ie,Me)},yn=(Ie,r,Me,Oe)=>(Pl(Ie,r,"write to private field"),Oe?Oe.call(Ie,Me):r.set(Ie,Me),Me),El=(Ie,r,Me,Oe)=>({set _(Be){yn(Ie,r,Be,Me)},get _(){return Mi(Ie,r,Oe)}}),fn=(Ie,r,Me)=>(Pl(Ie,r,"access private method"),Me);import{f as defineComponent,o as openBlock,c as createElementBlock,a as createBaseVNode,s as normalizeClass,h as unref,d as createTextVNode,m as createStaticVNode,u as useStore,i as inject,p as pushScopeId,e as popScopeId,_ as _export_sfc,n as ref,t as onMounted,F as Fragment,v as renderList,x as __vitePreload,b as createVNode,w as withCtx,y as TransitionGroup,z as useRouter,l as createBlock,k as createCommentVNode,q as provide}from"./index.bef12da5.js";const _imports_0$2="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAATCAYAAACKsM07AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAG7SURBVHgBtVRNTsJAFH7TDuw0GMXEHd4AboA3kBvQEzDsRFFKAsYd4wnwBuUGcgO5geyMApGYuIHScWZqOy2U0hr8kmZm3rz53uv7A/gHkOuPqvjEHsGeQZqzFgAz5cFxDA32iPrdrOaT/2Jvf8BDUgRNewmIBrRzUsHk6q0AmeyzFC0XF/ThbAwpITl03QLGXAFDY/j+MsRWA4yr/KIgPz1rEfKZS0VOXnPSQfHeI19xR+n53DVg2098lQdArAgHTgvS4OCw5ZNLA6tKMAqaPDDWVgqMkMb0Mgm3rBiuH3hbp/eno6AOUspTiy8e8RzsZSkuH6JimMOokrA27eTNdT1Vplg3ZPxc5ABn+rDNc55U5oAZEA2jyEMGqHk0B+QYgbsyuZmQKHK36phbDMIpe2nAFoQajXsxFHH0BQj1SHNSDr3AWWujYmJCudHJtJsXcR0qI1rfK11yO+tx1qK6c4xdfRPZyTIMOCO60uuJAVcdhcdAdFITGZBGmrJUrS3Xj3wMEEiA2FnEjYhw1UJChka0e1yChIifplg33dD45CKpFUiBndNU5YOr2ovSX4bhToh+II33RONjHT/yVr7tZ3N+qwAAAABJRU5ErkJggg==",_imports_1$1="/f2e-sign/assets/download.66e20f8f.png",_imports_0$1="/f2e-sign/assets/sign-logo.66817c29.png",_imports_1="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACQAAAAkCAYAAADhAJiYAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAD8SURBVHgB7ZdtDYMwEIbfJROABCQgoRImAQk4oBJwsMzBHDAHzEElMAfbXUaTGwH+UK5d0id5E/rx40muOVogk9nHCTpUFEMpKE/KHRFpKe9ZHKVEBKTMSOnFeIAyUsaKeSPmDZRYk/EMG2vqMoyb1hskICP3lEhIxuJA/lqmR0IyPi0SkOE9nRgXiCzjGae5CxKQKRG4S++R4RL5Du2QkEyQcu2RwUymRmSZKiUZT40Ah9gEkgnGFdutXlWGcVivu7qMwfqdRV2GmZeL+0iD30u6hSJOCEmJKDJmQYDDP8UOB78Uzgtzlfh+UW74vjQfiASfFwvFN1MmE5IPKw+wLrCmAHIAAAAASUVORK5CYII=",_imports_2="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACQAAAAkCAYAAADhAJiYAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAHwSURBVHgB7ZfxVcIwEMY/eP4vGxA3wAmsE+gGlglwA2ECdQLrBjoBOAE6AXEC2EDvXi42jQmm0IK8x++977VcU3K5XC4pcOTA6ETsPVJO6st9k6xIH6Qi9YUBaUH6alkL6atCKELcUJEmdUZRA454RronadI5TNSC5DDe36J9xqG+ul4jG8IZ2qeQq3KNvkM2gZfYHafujy7+GScRe4H2CZaTmEMZ9kRsyhRMSWhTZ3Uc2hsHk9QxMhEv1U/SC0y1jcF1jZOXK/E7NqCAqZ59z65Ic4T3pLvA/3D7qdNmGmnDz55cY+qU8b7Do+WRPsLsc1qejVFdlSNxPkMDFPgdoR7KkeaefSn2sWO3bR9QnhqSI5SSQxwVu0S1Z0fAzvdDmP3wCjVJTWotV46KTdSRXDlZC6ft2uNEUw5ZrlEN8Ruq04htnGHq1iGOBic0J7YmXcAk8AAtUSC87GPYpT2PPK+d1CkRyuQllr9D2+lpLEKpOZSjdMBOV4ay1mxUhUOkRGhGepZ7Pv+602AjNkFDpCZ1jmp1tsxIlzB7Wggt2njlcXX9K6k5Kgrbf0AOUFb0H/wIabkOEWeFLUct2CpeyT//Q5FHzUtYwexPrw10HOJG/l8jcnJ0Udjdp7TyO++scSwPvdAQGmYhtBH9I7vlGyZqpoHAeLirAAAAAElFTkSuQmCC",_imports_3="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACQAAAAkCAYAAADhAJiYAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAH9SURBVHgB7ZjRUcMwDIZ/uL7TDQgTABOQDegGuBO0TECYoN2gYQJggoYJWiZoRigTgHSRiWOcNFFzXB/y3f3ni2sZVZGMXGCgmbPAXEy6J93I8wspRT/MSXekMSknPctYy4z0HdBGNtEylj1Ce8/rjCJn0Y60RBEZO7eCnpWzzyspkb9h52K7cOQYPcmYk25Je3nekhYkQ/qADiPjI4ovChk5ahFpQsp8o7V4m3jzY4RDrZHPUubXdsKNkI3IdcAhSw4dkYxcKFtn/qLJiJPLTzTewCbjDnpsvthXxF/SLSBTZ1hXCawJ9MQN+26aDNnz1DPYwamCI5igWlm2clsdJwbHv6Y6rFMm9OEI3TEoTts28DGRogMah2LSQ4f1aYe1KocyVM8UzgGb8G8ojw9Ge5D+waB9DkUok/SyxfrGHDrHiTE4dIjBoUMMDh3i5BzSnNQhMhm/0DP8b4BbAr/9OKYXssRQtB9NDVoMPRMoGjSDagvLnkfov4W1F9BQy1y5ua5RRCElTZ1521czOXREMl55e/AdjaP3LmMwqf3E3AY21rL3nj/Fkd/bx8j7MEZxr08c45mzZgodKxkNyosip4Rt9PKQUYxqZSUoQupWhJbU22eBasVFdYZuovmV8C8/NoR+jolQROcSxWvjNnSJfjAoXxOnCLe8GQY68ANlA874dkA5qgAAAABJRU5ErkJggg==",_imports_4="/f2e-sign/assets/sign-illustration.247df215.png",_withScopeId$2=Ie=>(pushScopeId("data-v-8b06b5a2"),Ie=Ie(),popScopeId(),Ie),_hoisted_1$3={class:"main-list"},_hoisted_2$3=_withScopeId$2(()=>createBaseVNode("img",{class:"re-logo",src:_imports_0$1,alt:"logo\u5716"},null,-1)),_hoisted_3$3={class:"list"},_hoisted_4$3={class:"list-item"},_hoisted_5$3=_withScopeId$2(()=>createBaseVNode("img",{class:"list-img",src:_imports_1,alt:"\u7C3D\u540D\u6A94\u5716\u793A"},null,-1)),_hoisted_6$2=createStaticVNode('<li class="list-item" data-v-8b06b5a2><button class="list-btn disabled" data-v-8b06b5a2><img class="list-img" src="'+_imports_2+'" alt="\u52A0\u5165\u65E5\u671F\u5716\u793A" data-v-8b06b5a2> \u52A0\u5165\u65E5\u671F </button></li><li class="list-item" data-v-8b06b5a2><button class="list-btn disabled" data-v-8b06b5a2><img class="list-img" src="'+_imports_3+'" alt="\u6587\u5B57\u7DE8\u8F2F\u5716\u793A" data-v-8b06b5a2> \u6587\u5B57\u7DE8\u8F2F </button></li>',2),_hoisted_8$1=_withScopeId$2(()=>createBaseVNode("img",{class:"ill-icon",src:_imports_4,alt:""},null,-1)),_sfc_main$3=defineComponent({__name:"SignList",setup(Ie){const r=useStore(),Me=inject("popUnit"),Oe=()=>{r.getters["Files/getSigns"].length===0?Me.changePop("sign"):Me.changePop("choose")};return(Be,Ue)=>(openBlock(),createElementBlock("div",_hoisted_1$3,[_hoisted_2$3,createBaseVNode("ul",_hoisted_3$3,[createBaseVNode("li",_hoisted_4$3,[createBaseVNode("button",{class:normalizeClass(["list-btn",{current:unref(Me).current.value==="sign"}]),onClick:Oe},[_hoisted_5$3,createTextVNode(" \u7C3D\u540D\u6A94 ")],2)]),_hoisted_6$2]),_hoisted_8$1]))}}),SignList_vue_vue_type_style_index_0_scoped_8b06b5a2_lang="",SignList=_export_sfc(_sfc_main$3,[["__scopeId","data-v-8b06b5a2"]]),_imports_0="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAYAAACM/rhtAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAASvSURBVHgBvVk9TBxHFH6zd0cgMccZxVKIm0N2kyiWoUiKNIAb6pRxY0JKijukRIrkKAElllIQcQ3ugqCxuyRVJBpzTmPJLoxlS26wucayJf8tYHPY9zN+b5aFmdnZm7nl8CedbvVmdubbt++9ee8tg4Qo/vx0FMAbAeBDwNkQMMjhdS4YZT5wqADjFZTdQUG59PuJMiQAa2dy8afHecikC8C9iQMyrjuxCt5ThlpttvTHQMX5NpdJAbHMr6iVCegEGCy5ErUSnP7leYE3YaZtjdmBZsBnS5dOlFpNiiVYLG7k4KPsPNrRhGm8p9uDL4e74ORAGk4PZqA/5ynjjx434IXfgLv338KDjbq4jmGwBNup6VLpuG8ejiN3LLsqHEDDqXwGRr7uhjOfdUE7uHn7Daxcq5qJcrYGr70xE0nmSo40Nj7WjeR64DAgov/+twPV3Sa4kPQiK/T2zuvk+nMp+GGq79DkCF8NfyDWojUVMNyztzGvz1c0GDgEV4yWbGxqMosabCsiWVHd5bCwuIW2WlcHOJ+WHWd/VxFK0l23ZW+lp5z6PhtxgE6SnFvY1O3Sh3ptOAxBBztTnJPIkc0dJblgDyb2oL0k5AIuAcSI0J4WhMkhjpJcCNpjfEyzbeQiOIUEZcbBTamOOIQrKGxRLFWQTk/Q356K2Kg8Nn6uNbn1jRr89udLmLvso/00Y+fR2NzlTTEv4gwaIloEVhAERVbCeT4Uk/YoFLTC1b9fic3ptFj4a9NIkmQ0RsRo3tV/XrVckzSo2yJxI8moLD01mAYbenq8CBGZpEnmkpfQ0amBCLIRWXLmc/sRNnm+Vwm0MiETOZpL99hwckAL3hyGiKCSpfT3pWzrCM8LQlCUpImca7g6Pagpx/PO4l0H9md8ijZJJiUXrqmAcyFJnOeZSCYlF4NORWLuKGsfRNCHhDB7q32sDfge5mG+vnBScvRa47zbBRQvFXBW8cDja8qkJ3XrQnHkyObivNuFZCTbZpw0KOrWfaw/rNnWgcUr27HeGufddPrYcA/rFxX8OtlgWRbdwpTchmq1dSgxkaTczwY64zWUvb2K35cXWt9o/Zonz2fh00/SooCKCyUhSZp3HK+//eZYyzWpVlHMAO2PuIUH7zL+CuHYyuoORvVs7GIUzH/EusIGIukyT+x5bUeTYBcCwnSrXlPqEFL19Ru78L4Q0R6hUZulP0FQ5P+8uSyP0xMdMoY5gfaIaI/DUrQmaTRmQLPFxStbTsadFKKyi6Zlfqg9hWCgRT4rLyAS0sXNIyEZlJ2G+MibSlMp2lm4+GwJpRdkWeCRfR0roogUvZ3oyYGv9tLH38mi6I6ZVBF5r+kL0qu46RAjbfgfnW9uwTcda9j62J7W55ubRzMvc1BvGptHokw896G1btFBkWFltWoKxnvktrAvM2hvHqkkheMUTONElAqdL7DLRdfUIpERFFV1bL3VhOZj7ZhjDH69XTSRa0lwn+jFp0Vs31LdbE1sw/6Nm1NRH7uZvIGpkKQqP5WaAeZdgE4AnYFCSUdawDL2iUJqBFOhPLQFyjsby2g2pY430U0IPkNQTc3O4i+P13ntM4SPD7F22M8Q7wByXXoJoIPorAAAAABJRU5ErkJggg==";function useCanvas(){const Ie=ref();class r{constructor(Oe){qn(this,"isPainting");qn(this,"canvas");qn(this,"ctx");qn(this,"getPaintPosition",Oe=>{const Be=this.canvas.getBoundingClientRect();return Oe instanceof MouseEvent?{x:Oe.clientX-Be.left,y:Oe.clientY-Be.top}:{x:Oe.touches[0].clientX-Be.left,y:Oe.touches[0].clientY-Be.top}});qn(this,"startPosition",Oe=>{Oe.preventDefault(),this.isPainting=!0});qn(this,"finishedPosition",()=>{this.isPainting=!1,this.ctx.beginPath()});qn(this,"draw",Oe=>{if(Oe.preventDefault(),!this.isPainting)return;const Be=this.getPaintPosition(Oe);this.ctx.lineTo(Be.x,Be.y),this.ctx.stroke()});qn(this,"changeStrokeColor",Oe=>{this.ctx.strokeStyle=Oe});qn(this,"reset",()=>{this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height)});qn(this,"saveImage",()=>this.canvas.toDataURL("image/png"));this.isPainting=!1,this.canvas=Oe,this.ctx=Oe.getContext("2d"),this.ctx.lineWidth=4,this.ctx.strokeStyle="#000000",this.ctx.lineCap="round",this.addEvent()}addEvent(){this.canvas.addEventListener("mousedown",this.startPosition),this.canvas.addEventListener("mouseup",this.finishedPosition),this.canvas.addEventListener("mouseleave",this.finishedPosition),this.canvas.addEventListener("mousemove",this.draw),this.canvas.addEventListener("touchstart",this.startPosition),this.canvas.addEventListener("touchend",this.finishedPosition),this.canvas.addEventListener("touchcancel",this.finishedPosition),this.canvas.addEventListener("touchmove",this.draw)}}return{CanvasUnit:r,cannvasDOM:Ie}}const _withScopeId$1=Ie=>(pushScopeId("data-v-ca5c5222"),Ie=Ie(),popScopeId(),Ie),_hoisted_1$2={id:"write-sign"},_hoisted_2$2={class:"inner"},_hoisted_3$2=_withScopeId$1(()=>createBaseVNode("h2",{class:"write-title"},"\u624B\u5BEB\u7C3D\u540D\u6A94",-1)),_hoisted_4$2={class:"text-box"},_hoisted_5$2={class:"color-list"},_hoisted_6$1=["onClick"],_sfc_main$2=defineComponent({__name:"WriteSign",setup(Ie){const r=inject("popUnit"),Me=useStore(),{CanvasUnit:Oe,cannvasDOM:Be}=useCanvas();let Ue;onMounted(()=>{Ue=new Oe(Be.value)});const He=()=>{Ue.reset()},Ee=()=>{const _e=Ue.saveImage();Me.dispatch("Files/setSign",{date:Date.now(),img:_e}),r.changePop("choose"),console.log(Me.getters["Files/getSigns"])},e=ref("#000000"),xe=[{name:"blue",color:"#68c2f7"},{name:"red",color:"#eb4d3e"},{name:"black",color:"#000000"}],Te=_e=>{e.value=_e,Ue.changeStrokeColor(_e)};return(_e,Se)=>(openBlock(),createElementBlock("div",_hoisted_1$2,[createBaseVNode("div",_hoisted_2$2,[createBaseVNode("img",{class:"file-close",src:_imports_0,alt:"\u95DC\u9589\u8996\u7A97\u6309\u9215",onClick:Se[0]||(Se[0]=t=>unref(r).changePop(""))}),_hoisted_3$2,createBaseVNode("canvas",{ref_key:"cannvasDOM",ref:Be,id:"canvas",width:"500",height:"250"},null,512),createBaseVNode("div",_hoisted_4$2,[createBaseVNode("p",{class:"clear-text",onClick:He},"\u6E05\u9664\u91CD\u5BEB"),createBaseVNode("ul",_hoisted_5$2,[(openBlock(),createElementBlock(Fragment,null,renderList(xe,t=>createBaseVNode("li",{key:t.name,class:normalizeClass(["list-item",t.name,{current:e.value===t.color}]),onClick:Ae=>Te(t.color)},null,10,_hoisted_6$1)),64))]),createBaseVNode("button",{class:"submit-btn",onClick:Ee},"\u5132\u5B58")])])]))}}),WriteSign_vue_vue_type_style_index_0_scoped_ca5c5222_lang="",WriteSign=_export_sfc(_sfc_main$2,[["__scopeId","data-v-ca5c5222"]]),_withScopeId=Ie=>(pushScopeId("data-v-ab9b6236"),Ie=Ie(),popScopeId(),Ie),_hoisted_1$1={id:"select-sign"},_hoisted_2$1={class:"inner"},_hoisted_3$1=_withScopeId(()=>createBaseVNode("h2",{class:"select-title"},"\u9078\u64C7\u7C3D\u540D\u6A94",-1)),_hoisted_4$1={class:"select-box"},_hoisted_5$1={class:"select-record"},_hoisted_6=_withScopeId(()=>createBaseVNode("h3",{class:"box-title"},"\u624B\u5BEB\u7D00\u9304",-1)),_hoisted_7=["onClick"],_hoisted_8=["src"],_hoisted_9=_withScopeId(()=>createBaseVNode("p",{class:"sign-box-text"},"\u518D\u4F86\u5275\u5EFA\u4E00\u500B\u5427",-1)),_hoisted_10=[_hoisted_9],_hoisted_11={class:"select-create"},_hoisted_12=_withScopeId(()=>createBaseVNode("h3",{class:"box-title"},"\u5275\u5EFA\u7C3D\u540D",-1)),_hoisted_13=_withScopeId(()=>createBaseVNode("button",{class:"update"},"\u4E0A\u50B3\u5716\u6A94",-1)),_hoisted_14={class:"btn-box"},_sfc_main$1=defineComponent({__name:"ChooseSign",setup(Ie){const r=useStore(),Me=inject("addToPDF"),Oe=inject("popUnit"),Be=inject("signUnit"),Ue=r.getters["Files/getSigns"],He=Ee=>{Be.selectSign(Ee)};return(Ee,e)=>(openBlock(),createElementBlock("div",_hoisted_1$1,[createBaseVNode("div",_hoisted_2$1,[createBaseVNode("img",{class:"file-close",src:_imports_0,alt:"\u95DC\u9589\u8996\u7A97\u6309\u9215",onClick:e[0]||(e[0]=xe=>unref(Oe).changePop(""))}),_hoisted_3$1,createBaseVNode("div",_hoisted_4$1,[createBaseVNode("div",_hoisted_5$1,[_hoisted_6,(openBlock(!0),createElementBlock(Fragment,null,renderList(unref(Ue),xe=>(openBlock(),createElementBlock("div",{class:normalizeClass(["sign-box",{current:unref(Be).sign.value===xe.img}]),key:xe.date,onClick:Te=>He(xe.img)},[createBaseVNode("img",{src:xe.img,alt:"\u7C3D\u540D\u5716"},null,8,_hoisted_8)],10,_hoisted_7))),128)),(openBlock(!0),createElementBlock(Fragment,null,renderList(3-unref(Ue).length,xe=>(openBlock(),createElementBlock("div",{class:"sign-box",key:xe},_hoisted_10))),128))]),createBaseVNode("div",_hoisted_11,[_hoisted_12,createBaseVNode("button",{class:"write",onClick:e[1]||(e[1]=xe=>unref(Oe).changePop("sign"))}," \u624B\u5BEB\u7C3D\u540D\u6A94 "),_hoisted_13])]),createBaseVNode("div",_hoisted_14,[createBaseVNode("button",{class:"submit-btn",onClick:e[2]||(e[2]=(...xe)=>unref(Me)&&unref(Me)(...xe))},"\u78BA\u8A8D")])])]))}}),ChooseSign_vue_vue_type_style_index_0_scoped_ab9b6236_lang="",ChooseSign=_export_sfc(_sfc_main$1,[["__scopeId","data-v-ab9b6236"]]);var commonjsGlobal=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function getAugmentedNamespace(Ie){var r=Ie.default;if(typeof r=="function"){var Me=function(){return r.apply(this,arguments)};Me.prototype=r.prototype}else Me={};return Object.defineProperty(Me,"__esModule",{value:!0}),Object.keys(Ie).forEach(function(Oe){var Be=Object.getOwnPropertyDescriptor(Ie,Oe);Object.defineProperty(Me,Oe,Be.get?Be:{enumerable:!0,get:function(){return Ie[Oe]}})}),Me}var fabric={};const __viteBrowserExternal={},__viteBrowserExternal$1=Object.freeze(Object.defineProperty({__proto__:null,default:__viteBrowserExternal},Symbol.toStringTag,{value:"Module"})),require$$5=getAugmentedNamespace(__viteBrowserExternal$1);(function(Ie){/*! Fabric.js Copyright 2008-2015, Printio (Juriy Zaytsev, Maxim Chernyak) */var r=r||{version:"5.2.4"};if(Ie.fabric=r,typeof document<"u"&&typeof window<"u")document instanceof(typeof HTMLDocument<"u"?HTMLDocument:Document)?r.document=document:r.document=document.implementation.createHTMLDocument(""),r.window=window;else{var Me=require$$5,Oe=new Me.JSDOM(decodeURIComponent("%3C!DOCTYPE%20html%3E%3Chtml%3E%3Chead%3E%3C%2Fhead%3E%3Cbody%3E%3C%2Fbody%3E%3C%2Fhtml%3E"),{features:{FetchExternalResources:["img"]},resources:"usable"}).window;r.document=Oe.document,r.jsdomImplForWrapper=require$$5.implForWrapper,r.nodeCanvas=require$$5.Canvas,r.window=Oe,DOMParser=r.window.DOMParser}r.isTouchSupported="ontouchstart"in r.window||"ontouchstart"in r.document||r.window&&r.window.navigator&&r.window.navigator.maxTouchPoints>0,r.isLikelyNode=typeof Buffer<"u"&&typeof window>"u",r.SHARED_ATTRIBUTES=["display","transform","fill","fill-opacity","fill-rule","opacity","stroke","stroke-dasharray","stroke-linecap","stroke-dashoffset","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","id","paint-order","vector-effect","instantiated_by_use","clip-path"],r.DPI=96,r.reNum="(?:[-+]?(?:\\d+|\\d*\\.\\d+)(?:[eE][-+]?\\d+)?)",r.commaWsp="(?:\\s+,?\\s*|,\\s*)",r.rePathCommand=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:[eE][-+]?\d+)?)/ig,r.reNonWord=/[ \n\.,;!\?\-]/,r.fontPaths={},r.iMatrix=[1,0,0,1,0,0],r.svgNS="http://www.w3.org/2000/svg",r.perfLimitSizeTotal=2097152,r.maxCacheSideLimit=4096,r.minCacheSideLimit=256,r.charWidthsCache={},r.textureSize=2048,r.disableStyleCopyPaste=!1,r.enableGLFiltering=!0,r.devicePixelRatio=r.window.devicePixelRatio||r.window.webkitDevicePixelRatio||r.window.mozDevicePixelRatio||1,r.browserShadowBlurConstant=1,r.arcToSegmentsCache={},r.boundsOfCurveCache={},r.cachesBoundsOfCurve=!0,r.forceGLPutImageData=!1,r.initFilterBackend=function(){if(r.enableGLFiltering&&r.isWebglSupported&&r.isWebglSupported(r.textureSize))return console.log("max texture size: "+r.maxTextureSize),new r.WebglFilterBackend({tileSize:r.textureSize});if(r.Canvas2dFilterBackend)return new r.Canvas2dFilterBackend},typeof document<"u"&&typeof window<"u"&&(window.fabric=r),function(){function Ee(t,Ae){if(!!this.__eventListeners[t]){var Pe=this.__eventListeners[t];Ae?Pe[Pe.indexOf(Ae)]=!1:r.util.array.fill(Pe,!1)}}function e(t,Ae){if(this.__eventListeners||(this.__eventListeners={}),arguments.length===1)for(var Pe in t)this.on(Pe,t[Pe]);else this.__eventListeners[t]||(this.__eventListeners[t]=[]),this.__eventListeners[t].push(Ae);return this}function xe(t,Ae){var Pe=function(){Ae.apply(this,arguments),this.off(t,Pe)}.bind(this);this.on(t,Pe)}function Te(t,Ae){if(arguments.length===1)for(var Pe in t)xe.call(this,Pe,t[Pe]);else xe.call(this,t,Ae);return this}function _e(t,Ae){if(!this.__eventListeners)return this;if(arguments.length===0)for(t in this.__eventListeners)Ee.call(this,t);else if(arguments.length===1&&typeof arguments[0]=="object")for(var Pe in t)Ee.call(this,Pe,t[Pe]);else Ee.call(this,t,Ae);return this}function Se(t,Ae){if(!this.__eventListeners)return this;var Pe=this.__eventListeners[t];if(!Pe)return this;for(var St=0,Ce=Pe.length;St<Ce;St++)Pe[St]&&Pe[St].call(this,Ae||{});return this.__eventListeners[t]=Pe.filter(function(ke){return ke!==!1}),this}r.Observable={fire:Se,on:e,once:Te,off:_e}}(),r.Collection={_objects:[],add:function(){if(this._objects.push.apply(this._objects,arguments),this._onObjectAdded)for(var Ee=0,e=arguments.length;Ee<e;Ee++)this._onObjectAdded(arguments[Ee]);return this.renderOnAddRemove&&this.requestRenderAll(),this},insertAt:function(Ee,e,xe){var Te=this._objects;return xe?Te[e]=Ee:Te.splice(e,0,Ee),this._onObjectAdded&&this._onObjectAdded(Ee),this.renderOnAddRemove&&this.requestRenderAll(),this},remove:function(){for(var Ee=this._objects,e,xe=!1,Te=0,_e=arguments.length;Te<_e;Te++)e=Ee.indexOf(arguments[Te]),e!==-1&&(xe=!0,Ee.splice(e,1),this._onObjectRemoved&&this._onObjectRemoved(arguments[Te]));return this.renderOnAddRemove&&xe&&this.requestRenderAll(),this},forEachObject:function(Ee,e){for(var xe=this.getObjects(),Te=0,_e=xe.length;Te<_e;Te++)Ee.call(e,xe[Te],Te,xe);return this},getObjects:function(Ee){return typeof Ee>"u"?this._objects.concat():this._objects.filter(function(e){return e.type===Ee})},item:function(Ee){return this._objects[Ee]},isEmpty:function(){return this._objects.length===0},size:function(){return this._objects.length},contains:function(Ee,e){return this._objects.indexOf(Ee)>-1?!0:e?this._objects.some(function(xe){return typeof xe.contains=="function"&&xe.contains(Ee,!0)}):!1},complexity:function(){return this._objects.reduce(function(Ee,e){return Ee+=e.complexity?e.complexity():0,Ee},0)}},r.CommonMethods={_setOptions:function(Ee){for(var e in Ee)this.set(e,Ee[e])},_initGradient:function(Ee,e){Ee&&Ee.colorStops&&!(Ee instanceof r.Gradient)&&this.set(e,new r.Gradient(Ee))},_initPattern:function(Ee,e,xe){Ee&&Ee.source&&!(Ee instanceof r.Pattern)?this.set(e,new r.Pattern(Ee,xe)):xe&&xe()},_setObject:function(Ee){for(var e in Ee)this._set(e,Ee[e])},set:function(Ee,e){return typeof Ee=="object"?this._setObject(Ee):this._set(Ee,e),this},_set:function(Ee,e){this[Ee]=e},toggle:function(Ee){var e=this.get(Ee);return typeof e=="boolean"&&this.set(Ee,!e),this},get:function(Ee){return this[Ee]}},function(Ee){var e=Math.sqrt,xe=Math.atan2,Te=Math.pow,_e=Math.PI/180,Se=Math.PI/2;r.util={cos:function(t){if(t===0)return 1;t<0&&(t=-t);var Ae=t/Se;switch(Ae){case 1:case 3:return 0;case 2:return-1}return Math.cos(t)},sin:function(t){if(t===0)return 0;var Ae=t/Se,Pe=1;switch(t<0&&(Pe=-1),Ae){case 1:return Pe;case 2:return 0;case 3:return-Pe}return Math.sin(t)},removeFromArray:function(t,Ae){var Pe=t.indexOf(Ae);return Pe!==-1&&t.splice(Pe,1),t},getRandomInt:function(t,Ae){return Math.floor(Math.random()*(Ae-t+1))+t},degreesToRadians:function(t){return t*_e},radiansToDegrees:function(t){return t/_e},rotatePoint:function(t,Ae,Pe){var St=new r.Point(t.x-Ae.x,t.y-Ae.y),Ce=r.util.rotateVector(St,Pe);return new r.Point(Ce.x,Ce.y).addEquals(Ae)},rotateVector:function(t,Ae){var Pe=r.util.sin(Ae),St=r.util.cos(Ae),Ce=t.x*St-t.y*Pe,ke=t.x*Pe+t.y*St;return{x:Ce,y:ke}},createVector:function(t,Ae){return new r.Point(Ae.x-t.x,Ae.y-t.y)},calcAngleBetweenVectors:function(t,Ae){return Math.acos((t.x*Ae.x+t.y*Ae.y)/(Math.hypot(t.x,t.y)*Math.hypot(Ae.x,Ae.y)))},getHatVector:function(t){return new r.Point(t.x,t.y).multiply(1/Math.hypot(t.x,t.y))},getBisector:function(t,Ae,Pe){var St=r.util.createVector(t,Ae),Ce=r.util.createVector(t,Pe),ke=r.util.calcAngleBetweenVectors(St,Ce),De=r.util.calcAngleBetweenVectors(r.util.rotateVector(St,ke),Ce),Re=ke*(De===0?1:-1)/2;return{vector:r.util.getHatVector(r.util.rotateVector(St,Re)),angle:ke}},projectStrokeOnPoints:function(t,Ae,Pe){var St=[],Ce=Ae.strokeWidth/2,ke=Ae.strokeUniform?new r.Point(1/Ae.scaleX,1/Ae.scaleY):new r.Point(1,1),De=function(Re){var je=Ce/Math.hypot(Re.x,Re.y);return new r.Point(Re.x*je*ke.x,Re.y*je*ke.y)};return t.length<=1||t.forEach(function(Re,je){var We=new r.Point(Re.x,Re.y),Ke,Je;je===0?(Je=t[je+1],Ke=Pe?De(r.util.createVector(Je,We)).addEquals(We):t[t.length-1]):je===t.length-1?(Ke=t[je-1],Je=Pe?De(r.util.createVector(Ke,We)).addEquals(We):t[0]):(Ke=t[je-1],Je=t[je+1]);var hi=r.util.getBisector(We,Ke,Je),oi=hi.vector,ti=hi.angle,ai,yi;if(Ae.strokeLineJoin==="miter"&&(ai=-Ce/Math.sin(ti/2),yi=new r.Point(oi.x*ai*ke.x,oi.y*ai*ke.y),Math.hypot(yi.x,yi.y)/Ce<=Ae.strokeMiterLimit)){St.push(We.add(yi)),St.push(We.subtract(yi));return}ai=-Ce*Math.SQRT2,yi=new r.Point(oi.x*ai*ke.x,oi.y*ai*ke.y),St.push(We.add(yi)),St.push(We.subtract(yi))}),St},transformPoint:function(t,Ae,Pe){return Pe?new r.Point(Ae[0]*t.x+Ae[2]*t.y,Ae[1]*t.x+Ae[3]*t.y):new r.Point(Ae[0]*t.x+Ae[2]*t.y+Ae[4],Ae[1]*t.x+Ae[3]*t.y+Ae[5])},makeBoundingBoxFromPoints:function(t,Ae){if(Ae)for(var Pe=0;Pe<t.length;Pe++)t[Pe]=r.util.transformPoint(t[Pe],Ae);var St=[t[0].x,t[1].x,t[2].x,t[3].x],Ce=r.util.array.min(St),ke=r.util.array.max(St),De=ke-Ce,Re=[t[0].y,t[1].y,t[2].y,t[3].y],je=r.util.array.min(Re),We=r.util.array.max(Re),Ke=We-je;return{left:Ce,top:je,width:De,height:Ke}},invertTransform:function(t){var Ae=1/(t[0]*t[3]-t[1]*t[2]),Pe=[Ae*t[3],-Ae*t[1],-Ae*t[2],Ae*t[0]],St=r.util.transformPoint({x:t[4],y:t[5]},Pe,!0);return Pe[4]=-St.x,Pe[5]=-St.y,Pe},toFixed:function(t,Ae){return parseFloat(Number(t).toFixed(Ae))},parseUnit:function(t,Ae){var Pe=/\D{0,2}$/.exec(t),St=parseFloat(t);switch(Ae||(Ae=r.Text.DEFAULT_SVG_FONT_SIZE),Pe[0]){case"mm":return St*r.DPI/25.4;case"cm":return St*r.DPI/2.54;case"in":return St*r.DPI;case"pt":return St*r.DPI/72;case"pc":return St*r.DPI/72*12;case"em":return St*Ae;default:return St}},falseFunction:function(){return!1},getKlass:function(t,Ae){return t=r.util.string.camelize(t.charAt(0).toUpperCase()+t.slice(1)),r.util.resolveNamespace(Ae)[t]},getSvgAttributes:function(t){var Ae=["instantiated_by_use","style","id","class"];switch(t){case"linearGradient":Ae=Ae.concat(["x1","y1","x2","y2","gradientUnits","gradientTransform"]);break;case"radialGradient":Ae=Ae.concat(["gradientUnits","gradientTransform","cx","cy","r","fx","fy","fr"]);break;case"stop":Ae=Ae.concat(["offset","stop-color","stop-opacity"]);break}return Ae},resolveNamespace:function(t){if(!t)return r;var Ae=t.split("."),Pe=Ae.length,St,Ce=Ee||r.window;for(St=0;St<Pe;++St)Ce=Ce[Ae[St]];return Ce},loadImage:function(t,Ae,Pe,St){if(!t){Ae&&Ae.call(Pe,t);return}var Ce=r.util.createImage(),ke=function(){Ae&&Ae.call(Pe,Ce,!1),Ce=Ce.onload=Ce.onerror=null};Ce.onload=ke,Ce.onerror=function(){r.log("Error loading "+Ce.src),Ae&&Ae.call(Pe,null,!0),Ce=Ce.onload=Ce.onerror=null},t.indexOf("data")!==0&&St!==void 0&&St!==null&&(Ce.crossOrigin=St),t.substring(0,14)==="data:image/svg"&&(Ce.onload=null,r.util.loadImageInDom(Ce,ke)),Ce.src=t},loadImageInDom:function(t,Ae){var Pe=r.document.createElement("div");Pe.style.width=Pe.style.height="1px",Pe.style.left=Pe.style.top="-100%",Pe.style.position="absolute",Pe.appendChild(t),r.document.querySelector("body").appendChild(Pe),t.onload=function(){Ae(),Pe.parentNode.removeChild(Pe),Pe=null}},enlivenObjects:function(t,Ae,Pe,St){t=t||[];var Ce=[],ke=0,De=t.length;function Re(){++ke===De&&Ae&&Ae(Ce.filter(function(je){return je}))}if(!De){Ae&&Ae(Ce);return}t.forEach(function(je,We){if(!je||!je.type){Re();return}var Ke=r.util.getKlass(je.type,Pe);Ke.fromObject(je,function(Je,hi){hi||(Ce[We]=Je),St&&St(je,Je,hi),Re()})})},enlivenObjectEnlivables:function(t,Ae,Pe){var St=r.Object.ENLIVEN_PROPS.filter(function(Ce){return!!t[Ce]});r.util.enlivenObjects(St.map(function(Ce){return t[Ce]}),function(Ce){var ke={};St.forEach(function(De,Re){ke[De]=Ce[Re],Ae&&(Ae[De]=Ce[Re])}),Pe&&Pe(ke)})},enlivenPatterns:function(t,Ae){t=t||[];function Pe(){++Ce===ke&&Ae&&Ae(St)}var St=[],Ce=0,ke=t.length;if(!ke){Ae&&Ae(St);return}t.forEach(function(De,Re){De&&De.source?new r.Pattern(De,function(je){St[Re]=je,Pe()}):(St[Re]=De,Pe())})},groupSVGElements:function(t,Ae,Pe){var St;return t&&t.length===1?(typeof Pe<"u"&&(t[0].sourcePath=Pe),t[0]):(Ae&&(Ae.width&&Ae.height?Ae.centerPoint={x:Ae.width/2,y:Ae.height/2}:(delete Ae.width,delete Ae.height)),St=new r.Group(t,Ae),typeof Pe<"u"&&(St.sourcePath=Pe),St)},populateWithProperties:function(t,Ae,Pe){if(Pe&&Array.isArray(Pe))for(var St=0,Ce=Pe.length;St<Ce;St++)Pe[St]in t&&(Ae[Pe[St]]=t[Pe[St]])},createCanvasElement:function(){return r.document.createElement("canvas")},copyCanvasElement:function(t){var Ae=r.util.createCanvasElement();return Ae.width=t.width,Ae.height=t.height,Ae.getContext("2d").drawImage(t,0,0),Ae},toDataURL:function(t,Ae,Pe){return t.toDataURL("image/"+Ae,Pe)},createImage:function(){return r.document.createElement("img")},multiplyTransformMatrices:function(t,Ae,Pe){return[t[0]*Ae[0]+t[2]*Ae[1],t[1]*Ae[0]+t[3]*Ae[1],t[0]*Ae[2]+t[2]*Ae[3],t[1]*Ae[2]+t[3]*Ae[3],Pe?0:t[0]*Ae[4]+t[2]*Ae[5]+t[4],Pe?0:t[1]*Ae[4]+t[3]*Ae[5]+t[5]]},qrDecompose:function(t){var Ae=xe(t[1],t[0]),Pe=Te(t[0],2)+Te(t[1],2),St=e(Pe),Ce=(t[0]*t[3]-t[2]*t[1])/St,ke=xe(t[0]*t[2]+t[1]*t[3],Pe);return{angle:Ae/_e,scaleX:St,scaleY:Ce,skewX:ke/_e,skewY:0,translateX:t[4],translateY:t[5]}},calcRotateMatrix:function(t){if(!t.angle)return r.iMatrix.concat();var Ae=r.util.degreesToRadians(t.angle),Pe=r.util.cos(Ae),St=r.util.sin(Ae);return[Pe,St,-St,Pe,0,0]},calcDimensionsMatrix:function(t){var Ae=typeof t.scaleX>"u"?1:t.scaleX,Pe=typeof t.scaleY>"u"?1:t.scaleY,St=[t.flipX?-Ae:Ae,0,0,t.flipY?-Pe:Pe,0,0],Ce=r.util.multiplyTransformMatrices,ke=r.util.degreesToRadians;return t.skewX&&(St=Ce(St,[1,0,Math.tan(ke(t.skewX)),1],!0)),t.skewY&&(St=Ce(St,[1,Math.tan(ke(t.skewY)),0,1],!0)),St},composeMatrix:function(t){var Ae=[1,0,0,1,t.translateX||0,t.translateY||0],Pe=r.util.multiplyTransformMatrices;return t.angle&&(Ae=Pe(Ae,r.util.calcRotateMatrix(t))),(t.scaleX!==1||t.scaleY!==1||t.skewX||t.skewY||t.flipX||t.flipY)&&(Ae=Pe(Ae,r.util.calcDimensionsMatrix(t))),Ae},resetObjectTransform:function(t){t.scaleX=1,t.scaleY=1,t.skewX=0,t.skewY=0,t.flipX=!1,t.flipY=!1,t.rotate(0)},saveObjectTransform:function(t){return{scaleX:t.scaleX,scaleY:t.scaleY,skewX:t.skewX,skewY:t.skewY,angle:t.angle,left:t.left,flipX:t.flipX,flipY:t.flipY,top:t.top}},isTransparent:function(t,Ae,Pe,St){St>0&&(Ae>St?Ae-=St:Ae=0,Pe>St?Pe-=St:Pe=0);var Ce=!0,ke,De,Re=t.getImageData(Ae,Pe,St*2||1,St*2||1),je=Re.data.length;for(ke=3;ke<je&&(De=Re.data[ke],Ce=De<=0,Ce!==!1);ke+=4);return Re=null,Ce},parsePreserveAspectRatioAttribute:function(t){var Ae="meet",Pe="Mid",St="Mid",Ce=t.split(" "),ke;return Ce&&Ce.length&&(Ae=Ce.pop(),Ae!=="meet"&&Ae!=="slice"?(ke=Ae,Ae="meet"):Ce.length&&(ke=Ce.pop())),Pe=ke!=="none"?ke.slice(1,4):"none",St=ke!=="none"?ke.slice(5,8):"none",{meetOrSlice:Ae,alignX:Pe,alignY:St}},clearFabricFontCache:function(t){t=(t||"").toLowerCase(),t?r.charWidthsCache[t]&&delete r.charWidthsCache[t]:r.charWidthsCache={}},limitDimsByArea:function(t,Ae){var Pe=Math.sqrt(Ae*t),St=Math.floor(Ae/Pe);return{x:Math.floor(Pe),y:St}},capValue:function(t,Ae,Pe){return Math.max(t,Math.min(Ae,Pe))},findScaleToFit:function(t,Ae){return Math.min(Ae.width/t.width,Ae.height/t.height)},findScaleToCover:function(t,Ae){return Math.max(Ae.width/t.width,Ae.height/t.height)},matrixToSVG:function(t){return"matrix("+t.map(function(Ae){return r.util.toFixed(Ae,r.Object.NUM_FRACTION_DIGITS)}).join(" ")+")"},removeTransformFromObject:function(t,Ae){var Pe=r.util.invertTransform(Ae),St=r.util.multiplyTransformMatrices(Pe,t.calcOwnMatrix());r.util.applyTransformToObject(t,St)},addTransformToObject:function(t,Ae){r.util.applyTransformToObject(t,r.util.multiplyTransformMatrices(Ae,t.calcOwnMatrix()))},applyTransformToObject:function(t,Ae){var Pe=r.util.qrDecompose(Ae),St=new r.Point(Pe.translateX,Pe.translateY);t.flipX=!1,t.flipY=!1,t.set("scaleX",Pe.scaleX),t.set("scaleY",Pe.scaleY),t.skewX=Pe.skewX,t.skewY=Pe.skewY,t.angle=Pe.angle,t.setPositionByOrigin(St,"center","center")},sizeAfterTransform:function(t,Ae,Pe){var St=t/2,Ce=Ae/2,ke=[{x:-St,y:-Ce},{x:St,y:-Ce},{x:-St,y:Ce},{x:St,y:Ce}],De=r.util.calcDimensionsMatrix(Pe),Re=r.util.makeBoundingBoxFromPoints(ke,De);return{x:Re.width,y:Re.height}},mergeClipPaths:function(t,Ae){var Pe=t,St=Ae;Pe.inverted&&!St.inverted&&(Pe=Ae,St=t),r.util.applyTransformToObject(St,r.util.multiplyTransformMatrices(r.util.invertTransform(Pe.calcTransformMatrix()),St.calcTransformMatrix()));var Ce=Pe.inverted&&St.inverted;return Ce&&(Pe.inverted=St.inverted=!1),new r.Group([Pe],{clipPath:St,inverted:Ce})},hasStyleChanged:function(t,Ae,Pe){return Pe=Pe||!1,t.fill!==Ae.fill||t.stroke!==Ae.stroke||t.strokeWidth!==Ae.strokeWidth||t.fontSize!==Ae.fontSize||t.fontFamily!==Ae.fontFamily||t.fontWeight!==Ae.fontWeight||t.fontStyle!==Ae.fontStyle||t.deltaY!==Ae.deltaY||Pe&&(t.overline!==Ae.overline||t.underline!==Ae.underline||t.linethrough!==Ae.linethrough)},stylesToArray:function(Pe,Ae){for(var Pe=r.util.object.clone(Pe,!0),St=Ae.split(`
`),Ce=-1,ke={},De=[],Re=0;Re<St.length;Re++){if(!Pe[Re]){Ce+=St[Re].length;continue}for(var je=0;je<St[Re].length;je++){Ce++;var We=Pe[Re][je];if(We){var Ke=r.util.hasStyleChanged(ke,We,!0);Ke?De.push({start:Ce,end:Ce+1,style:We}):De[De.length-1].end++}ke=We||{}}}return De},stylesFromArray:function(t,Ae){if(!Array.isArray(t))return t;for(var Pe=Ae.split(`
`),St=-1,Ce=0,ke={},De=0;De<Pe.length;De++)for(var Re=0;Re<Pe[De].length;Re++)St++,t[Ce]&&t[Ce].start<=St&&St<t[Ce].end&&(ke[De]=ke[De]||{},ke[De][Re]=Object.assign({},t[Ce].style),St===t[Ce].end-1&&Ce++);return ke}}}(Ie),function(){var Ee=Array.prototype.join,e={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7},xe={m:"l",M:"L"};function Te(ni,fi,Si,Xe,Ge,ze,Ve,ei,si,li,ci){var Ci=r.util.cos(ni),Fi=r.util.sin(ni),Oi=r.util.cos(fi),Ti=r.util.sin(fi),Ze=Si*Ge*Oi-Xe*ze*Ti+Ve,ii=Xe*Ge*Oi+Si*ze*Ti+ei,Qe=li+si*(-Si*Ge*Fi-Xe*ze*Ci),ui=ci+si*(-Xe*Ge*Fi+Si*ze*Ci),gi=Ze+si*(Si*Ge*Ti+Xe*ze*Oi),_i=ii+si*(Xe*Ge*Ti-Si*ze*Oi);return["C",Qe,ui,gi,_i,Ze,ii]}function _e(ni,fi,Si,Xe,Ge,ze,Ve){var ei=Math.PI,si=Ve*ei/180,li=r.util.sin(si),ci=r.util.cos(si),Ci=0,Fi=0;Si=Math.abs(Si),Xe=Math.abs(Xe);var Oi=-ci*ni*.5-li*fi*.5,Ti=-ci*fi*.5+li*ni*.5,Ze=Si*Si,ii=Xe*Xe,Qe=Ti*Ti,ui=Oi*Oi,gi=Ze*ii-Ze*Qe-ii*ui,_i=0;if(gi<0){var Ri=Math.sqrt(1-gi/(Ze*ii));Si*=Ri,Xe*=Ri}else _i=(Ge===ze?-1:1)*Math.sqrt(gi/(Ze*Qe+ii*ui));var Ui=_i*Si*Ti/Xe,ki=-_i*Xe*Oi/Si,Vi=ci*Ui-li*ki+ni*.5,Ii=li*Ui+ci*ki+fi*.5,$i=Se(1,0,(Oi-Ui)/Si,(Ti-ki)/Xe),tn=Se((Oi-Ui)/Si,(Ti-ki)/Xe,(-Oi-Ui)/Si,(-Ti-ki)/Xe);ze===0&&tn>0?tn-=2*ei:ze===1&&tn<0&&(tn+=2*ei);for(var en=Math.ceil(Math.abs(tn/ei*2)),zi=[],Ji=tn/en,pn=8/3*Math.sin(Ji/4)*Math.sin(Ji/4)/Math.sin(Ji/2),an=$i+Ji,kn=0;kn<en;kn++)zi[kn]=Te($i,an,ci,li,Si,Xe,Vi,Ii,pn,Ci,Fi),Ci=zi[kn][5],Fi=zi[kn][6],$i=an,an+=Ji;return zi}function Se(ni,fi,Si,Xe){var Ge=Math.atan2(fi,ni),ze=Math.atan2(Xe,Si);return ze>=Ge?ze-Ge:2*Math.PI-(Ge-ze)}function t(ni,fi,Si,Xe,Ge,ze,Ve,ei){var si;if(r.cachesBoundsOfCurve&&(si=Ee.call(arguments),r.boundsOfCurveCache[si]))return r.boundsOfCurveCache[si];var li=Math.sqrt,ci=Math.min,Ci=Math.max,Fi=Math.abs,Oi=[],Ti=[[],[]],Ze,ii,Qe,ui,gi,_i,Ri,Ui;ii=6*ni-12*Si+6*Ge,Ze=-3*ni+9*Si-9*Ge+3*Ve,Qe=3*Si-3*ni;for(var ki=0;ki<2;++ki){if(ki>0&&(ii=6*fi-12*Xe+6*ze,Ze=-3*fi+9*Xe-9*ze+3*ei,Qe=3*Xe-3*fi),Fi(Ze)<1e-12){if(Fi(ii)<1e-12)continue;ui=-Qe/ii,0<ui&&ui<1&&Oi.push(ui);continue}Ri=ii*ii-4*Qe*Ze,!(Ri<0)&&(Ui=li(Ri),gi=(-ii+Ui)/(2*Ze),0<gi&&gi<1&&Oi.push(gi),_i=(-ii-Ui)/(2*Ze),0<_i&&_i<1&&Oi.push(_i))}for(var Vi,Ii,$i=Oi.length,tn=$i,en;$i--;)ui=Oi[$i],en=1-ui,Vi=en*en*en*ni+3*en*en*ui*Si+3*en*ui*ui*Ge+ui*ui*ui*Ve,Ti[0][$i]=Vi,Ii=en*en*en*fi+3*en*en*ui*Xe+3*en*ui*ui*ze+ui*ui*ui*ei,Ti[1][$i]=Ii;Ti[0][tn]=ni,Ti[1][tn]=fi,Ti[0][tn+1]=Ve,Ti[1][tn+1]=ei;var zi=[{x:ci.apply(null,Ti[0]),y:ci.apply(null,Ti[1])},{x:Ci.apply(null,Ti[0]),y:Ci.apply(null,Ti[1])}];return r.cachesBoundsOfCurve&&(r.boundsOfCurveCache[si]=zi),zi}function Ae(ni,fi,Si){for(var Xe=Si[1],Ge=Si[2],ze=Si[3],Ve=Si[4],ei=Si[5],si=Si[6],li=Si[7],ci=_e(si-ni,li-fi,Xe,Ge,Ve,ei,ze),Ci=0,Fi=ci.length;Ci<Fi;Ci++)ci[Ci][1]+=ni,ci[Ci][2]+=fi,ci[Ci][3]+=ni,ci[Ci][4]+=fi,ci[Ci][5]+=ni,ci[Ci][6]+=fi;return ci}function Pe(ni){var fi=0,Si=0,Xe=ni.length,Ge=0,ze=0,Ve,ei,si,li=[],ci,Ci,Fi;for(ei=0;ei<Xe;++ei){switch(si=!1,Ve=ni[ei].slice(0),Ve[0]){case"l":Ve[0]="L",Ve[1]+=fi,Ve[2]+=Si;case"L":fi=Ve[1],Si=Ve[2];break;case"h":Ve[1]+=fi;case"H":Ve[0]="L",Ve[2]=Si,fi=Ve[1];break;case"v":Ve[1]+=Si;case"V":Ve[0]="L",Si=Ve[1],Ve[1]=fi,Ve[2]=Si;break;case"m":Ve[0]="M",Ve[1]+=fi,Ve[2]+=Si;case"M":fi=Ve[1],Si=Ve[2],Ge=Ve[1],ze=Ve[2];break;case"c":Ve[0]="C",Ve[1]+=fi,Ve[2]+=Si,Ve[3]+=fi,Ve[4]+=Si,Ve[5]+=fi,Ve[6]+=Si;case"C":Ci=Ve[3],Fi=Ve[4],fi=Ve[5],Si=Ve[6];break;case"s":Ve[0]="S",Ve[1]+=fi,Ve[2]+=Si,Ve[3]+=fi,Ve[4]+=Si;case"S":ci==="C"?(Ci=2*fi-Ci,Fi=2*Si-Fi):(Ci=fi,Fi=Si),fi=Ve[3],Si=Ve[4],Ve[0]="C",Ve[5]=Ve[3],Ve[6]=Ve[4],Ve[3]=Ve[1],Ve[4]=Ve[2],Ve[1]=Ci,Ve[2]=Fi,Ci=Ve[3],Fi=Ve[4];break;case"q":Ve[0]="Q",Ve[1]+=fi,Ve[2]+=Si,Ve[3]+=fi,Ve[4]+=Si;case"Q":Ci=Ve[1],Fi=Ve[2],fi=Ve[3],Si=Ve[4];break;case"t":Ve[0]="T",Ve[1]+=fi,Ve[2]+=Si;case"T":ci==="Q"?(Ci=2*fi-Ci,Fi=2*Si-Fi):(Ci=fi,Fi=Si),Ve[0]="Q",fi=Ve[1],Si=Ve[2],Ve[1]=Ci,Ve[2]=Fi,Ve[3]=fi,Ve[4]=Si;break;case"a":Ve[0]="A",Ve[6]+=fi,Ve[7]+=Si;case"A":si=!0,li=li.concat(Ae(fi,Si,Ve)),fi=Ve[6],Si=Ve[7];break;case"z":case"Z":fi=Ge,Si=ze;break}si||li.push(Ve),ci=Ve[0]}return li}function St(ni,fi,Si,Xe){return Math.sqrt((Si-ni)*(Si-ni)+(Xe-fi)*(Xe-fi))}function Ce(ni){return ni*ni*ni}function ke(ni){return 3*ni*ni*(1-ni)}function De(ni){return 3*ni*(1-ni)*(1-ni)}function Re(ni){return(1-ni)*(1-ni)*(1-ni)}function je(ni,fi,Si,Xe,Ge,ze,Ve,ei){return function(si){var li=Ce(si),ci=ke(si),Ci=De(si),Fi=Re(si);return{x:Ve*li+Ge*ci+Si*Ci+ni*Fi,y:ei*li+ze*ci+Xe*Ci+fi*Fi}}}function We(ni,fi,Si,Xe,Ge,ze,Ve,ei){return function(si){var li=1-si,ci=3*li*li*(Si-ni)+6*li*si*(Ge-Si)+3*si*si*(Ve-Ge),Ci=3*li*li*(Xe-fi)+6*li*si*(ze-Xe)+3*si*si*(ei-ze);return Math.atan2(Ci,ci)}}function Ke(ni){return ni*ni}function Je(ni){return 2*ni*(1-ni)}function hi(ni){return(1-ni)*(1-ni)}function oi(ni,fi,Si,Xe,Ge,ze){return function(Ve){var ei=Ke(Ve),si=Je(Ve),li=hi(Ve);return{x:Ge*ei+Si*si+ni*li,y:ze*ei+Xe*si+fi*li}}}function ti(ni,fi,Si,Xe,Ge,ze){return function(Ve){var ei=1-Ve,si=2*ei*(Si-ni)+2*Ve*(Ge-Si),li=2*ei*(Xe-fi)+2*Ve*(ze-Xe);return Math.atan2(li,si)}}function ai(ni,fi,Si){var Xe={x:fi,y:Si},Ge,ze=0,Ve;for(Ve=1;Ve<=100;Ve+=1)Ge=ni(Ve/100),ze+=St(Xe.x,Xe.y,Ge.x,Ge.y),Xe=Ge;return ze}function yi(ni,fi){for(var Si=0,Xe=0,Ge=ni.iterator,ze={x:ni.x,y:ni.y},Ve,ei,si=.01,li=ni.angleFinder,ci;Xe<fi&&si>1e-4;)Ve=Ge(Si),ci=Si,ei=St(ze.x,ze.y,Ve.x,Ve.y),ei+Xe>fi?(Si-=si,si/=2):(ze=Ve,Si+=si,Xe+=ei);return Ve.angle=li(ci),Ve}function di(ni){for(var fi=0,Si=ni.length,Xe,Ge=0,ze=0,Ve=0,ei=0,si=[],li,ci,Ci,Fi=0;Fi<Si;Fi++){switch(Xe=ni[Fi],ci={x:Ge,y:ze,command:Xe[0]},Xe[0]){case"M":ci.length=0,Ve=Ge=Xe[1],ei=ze=Xe[2];break;case"L":ci.length=St(Ge,ze,Xe[1],Xe[2]),Ge=Xe[1],ze=Xe[2];break;case"C":li=je(Ge,ze,Xe[1],Xe[2],Xe[3],Xe[4],Xe[5],Xe[6]),Ci=We(Ge,ze,Xe[1],Xe[2],Xe[3],Xe[4],Xe[5],Xe[6]),ci.iterator=li,ci.angleFinder=Ci,ci.length=ai(li,Ge,ze),Ge=Xe[5],ze=Xe[6];break;case"Q":li=oi(Ge,ze,Xe[1],Xe[2],Xe[3],Xe[4]),Ci=ti(Ge,ze,Xe[1],Xe[2],Xe[3],Xe[4]),ci.iterator=li,ci.angleFinder=Ci,ci.length=ai(li,Ge,ze),Ge=Xe[3],ze=Xe[4];break;case"Z":case"z":ci.destX=Ve,ci.destY=ei,ci.length=St(Ge,ze,Ve,ei),Ge=Ve,ze=ei;break}fi+=ci.length,si.push(ci)}return si.push({length:fi,x:Ge,y:ze}),si}function bi(ni,fi,Si){Si||(Si=di(ni));for(var Xe=0;fi-Si[Xe].length>0&&Xe<Si.length-2;)fi-=Si[Xe].length,Xe++;var Ge=Si[Xe],ze=fi/Ge.length,Ve=Ge.command,ei=ni[Xe],si;switch(Ve){case"M":return{x:Ge.x,y:Ge.y,angle:0};case"Z":case"z":return si=new r.Point(Ge.x,Ge.y).lerp(new r.Point(Ge.destX,Ge.destY),ze),si.angle=Math.atan2(Ge.destY-Ge.y,Ge.destX-Ge.x),si;case"L":return si=new r.Point(Ge.x,Ge.y).lerp(new r.Point(ei[1],ei[2]),ze),si.angle=Math.atan2(ei[2]-Ge.y,ei[1]-Ge.x),si;case"C":return yi(Ge,fi);case"Q":return yi(Ge,fi)}}function vi(ni){var fi=[],Si=[],Xe,Ge,ze=r.rePathCommand,Ve="[-+]?(?:\\d*\\.\\d+|\\d+\\.?)(?:[eE][-+]?\\d+)?\\s*",ei="("+Ve+")"+r.commaWsp,si="([01])"+r.commaWsp+"?",li=ei+"?"+ei+"?"+ei+si+si+ei+"?("+Ve+")",ci=new RegExp(li,"g"),Ci,Fi,Oi;if(!ni||!ni.match)return fi;Oi=ni.match(/[mzlhvcsqta][^mzlhvcsqta]*/gi);for(var Ti=0,Ze,ii=Oi.length;Ti<ii;Ti++){Xe=Oi[Ti],Fi=Xe.slice(1).trim(),Si.length=0;var Qe=Xe.charAt(0);if(Ze=[Qe],Qe.toLowerCase()==="a")for(var ui;ui=ci.exec(Fi);)for(var gi=1;gi<ui.length;gi++)Si.push(ui[gi]);else for(;Ci=ze.exec(Fi);)Si.push(Ci[0]);for(var gi=0,_i=Si.length;gi<_i;gi++)Ge=parseFloat(Si[gi]),isNaN(Ge)||Ze.push(Ge);var Ri=e[Qe.toLowerCase()],Ui=xe[Qe]||Qe;if(Ze.length-1>Ri)for(var ki=1,Vi=Ze.length;ki<Vi;ki+=Ri)fi.push([Qe].concat(Ze.slice(ki,ki+Ri))),Qe=Ui;else fi.push(Ze)}return fi}function Pi(ni,fi){var Si=[],Xe,Ge=new r.Point(ni[0].x,ni[0].y),ze=new r.Point(ni[1].x,ni[1].y),Ve=ni.length,ei=1,si=0,li=Ve>2;for(fi=fi||0,li&&(ei=ni[2].x<ze.x?-1:ni[2].x===ze.x?0:1,si=ni[2].y<ze.y?-1:ni[2].y===ze.y?0:1),Si.push(["M",Ge.x-ei*fi,Ge.y-si*fi]),Xe=1;Xe<Ve;Xe++){if(!Ge.eq(ze)){var ci=Ge.midPointFrom(ze);Si.push(["Q",Ge.x,Ge.y,ci.x,ci.y])}Ge=ni[Xe],Xe+1<ni.length&&(ze=ni[Xe+1])}return li&&(ei=Ge.x>ni[Xe-2].x?1:Ge.x===ni[Xe-2].x?0:-1,si=Ge.y>ni[Xe-2].y?1:Ge.y===ni[Xe-2].y?0:-1),Si.push(["L",Ge.x+ei*fi,Ge.y+si*fi]),Si}function xi(ni,fi,Si){return Si&&(fi=r.util.multiplyTransformMatrices(fi,[1,0,0,1,-Si.x,-Si.y])),ni.map(function(Xe){for(var Ge=Xe.slice(0),ze={},Ve=1;Ve<Xe.length-1;Ve+=2)ze.x=Xe[Ve],ze.y=Xe[Ve+1],ze=r.util.transformPoint(ze,fi),Ge[Ve]=ze.x,Ge[Ve+1]=ze.y;return Ge})}r.util.joinPath=function(ni){return ni.map(function(fi){return fi.join(" ")}).join(" ")},r.util.parsePath=vi,r.util.makePathSimpler=Pe,r.util.getSmoothPathFromPoints=Pi,r.util.getPathSegmentsInfo=di,r.util.getBoundsOfCurve=t,r.util.getPointOnPath=bi,r.util.transformPath=xi}(),function(){var Ee=Array.prototype.slice;function e(t,Ae){for(var Pe=Ee.call(arguments,2),St=[],Ce=0,ke=t.length;Ce<ke;Ce++)St[Ce]=Pe.length?t[Ce][Ae].apply(t[Ce],Pe):t[Ce][Ae].call(t[Ce]);return St}function xe(t,Ae){return Se(t,Ae,function(Pe,St){return Pe>=St})}function Te(t,Ae){return Se(t,Ae,function(Pe,St){return Pe<St})}function _e(t,Ae){for(var Pe=t.length;Pe--;)t[Pe]=Ae;return t}function Se(t,Ae,Pe){if(!(!t||t.length===0)){var St=t.length-1,Ce=Ae?t[St][Ae]:t[St];if(Ae)for(;St--;)Pe(t[St][Ae],Ce)&&(Ce=t[St][Ae]);else for(;St--;)Pe(t[St],Ce)&&(Ce=t[St]);return Ce}}r.util.array={fill:_e,invoke:e,min:Te,max:xe}}(),function(){function Ee(xe,Te,_e){if(_e)if(!r.isLikelyNode&&Te instanceof Element)xe=Te;else if(Te instanceof Array){xe=[];for(var Se=0,t=Te.length;Se<t;Se++)xe[Se]=Ee({},Te[Se],_e)}else if(Te&&typeof Te=="object")for(var Ae in Te)Ae==="canvas"||Ae==="group"?xe[Ae]=null:Te.hasOwnProperty(Ae)&&(xe[Ae]=Ee({},Te[Ae],_e));else xe=Te;else for(var Ae in Te)xe[Ae]=Te[Ae];return xe}function e(xe,Te){return Ee({},xe,Te)}r.util.object={extend:Ee,clone:e},r.util.object.extend(r.util,r.Observable)}(),function(){function Ee(Se){return Se.replace(/-+(.)?/g,function(t,Ae){return Ae?Ae.toUpperCase():""})}function e(Se,t){return Se.charAt(0).toUpperCase()+(t?Se.slice(1):Se.slice(1).toLowerCase())}function xe(Se){return Se.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&apos;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function Te(Se){var t=0,Ae,Pe=[];for(t=0,Ae;t<Se.length;t++)(Ae=_e(Se,t))!==!1&&Pe.push(Ae);return Pe}function _e(Se,t){var Ae=Se.charCodeAt(t);if(isNaN(Ae))return"";if(Ae<55296||Ae>57343)return Se.charAt(t);if(55296<=Ae&&Ae<=56319){if(Se.length<=t+1)throw"High surrogate without following low surrogate";var Pe=Se.charCodeAt(t+1);if(56320>Pe||Pe>57343)throw"High surrogate without following low surrogate";return Se.charAt(t)+Se.charAt(t+1)}if(t===0)throw"Low surrogate without preceding high surrogate";var St=Se.charCodeAt(t-1);if(55296>St||St>56319)throw"Low surrogate without preceding high surrogate";return!1}r.util.string={camelize:Ee,capitalize:e,escapeXml:xe,graphemeSplit:Te}}(),function(){var Ee=Array.prototype.slice,e=function(){},xe=function(){for(var Ae in{toString:1})if(Ae==="toString")return!1;return!0}(),Te=function(Ae,Pe,St){for(var Ce in Pe)Ce in Ae.prototype&&typeof Ae.prototype[Ce]=="function"&&(Pe[Ce]+"").indexOf("callSuper")>-1?Ae.prototype[Ce]=function(ke){return function(){var De=this.constructor.superclass;this.constructor.superclass=St;var Re=Pe[ke].apply(this,arguments);if(this.constructor.superclass=De,ke!=="initialize")return Re}}(Ce):Ae.prototype[Ce]=Pe[Ce],xe&&(Pe.toString!==Object.prototype.toString&&(Ae.prototype.toString=Pe.toString),Pe.valueOf!==Object.prototype.valueOf&&(Ae.prototype.valueOf=Pe.valueOf))};function _e(){}function Se(Ae){for(var Pe=null,St=this;St.constructor.superclass;){var Ce=St.constructor.superclass.prototype[Ae];if(St[Ae]!==Ce){Pe=Ce;break}St=St.constructor.superclass.prototype}return Pe?arguments.length>1?Pe.apply(this,Ee.call(arguments,1)):Pe.call(this):console.log("tried to callSuper "+Ae+", method not found in prototype chain",this)}function t(){var Ae=null,Pe=Ee.call(arguments,0);typeof Pe[0]=="function"&&(Ae=Pe.shift());function St(){this.initialize.apply(this,arguments)}St.superclass=Ae,St.subclasses=[],Ae&&(_e.prototype=Ae.prototype,St.prototype=new _e,Ae.subclasses.push(St));for(var Ce=0,ke=Pe.length;Ce<ke;Ce++)Te(St,Pe[Ce],Ae);return St.prototype.initialize||(St.prototype.initialize=e),St.prototype.constructor=St,St.prototype.callSuper=Se,St}r.util.createClass=t}(),function(){var Ee=!!r.document.createElement("div").attachEvent,e=["touchstart","touchmove","touchend"];r.util.addListener=function(Te,_e,Se,t){Te&&Te.addEventListener(_e,Se,Ee?!1:t)},r.util.removeListener=function(Te,_e,Se,t){Te&&Te.removeEventListener(_e,Se,Ee?!1:t)};function xe(Te){var _e=Te.changedTouches;return _e&&_e[0]?_e[0]:Te}r.util.getPointer=function(Te){var _e=Te.target,Se=r.util.getScrollLeftTop(_e),t=xe(Te);return{x:t.clientX+Se.left,y:t.clientY+Se.top}},r.util.isTouchEvent=function(Te){return e.indexOf(Te.type)>-1||Te.pointerType==="touch"}}(),function(){function Ee(t,Ae){var Pe=t.style;if(!Pe)return t;if(typeof Ae=="string")return t.style.cssText+=";"+Ae,Ae.indexOf("opacity")>-1?Se(t,Ae.match(/opacity:\s*(\d?\.?\d*)/)[1]):t;for(var St in Ae)if(St==="opacity")Se(t,Ae[St]);else{var Ce=St==="float"||St==="cssFloat"?typeof Pe.styleFloat>"u"?"cssFloat":"styleFloat":St;Pe.setProperty(Ce,Ae[St])}return t}var e=r.document.createElement("div"),xe=typeof e.style.opacity=="string",Te=typeof e.style.filter=="string",_e=/alpha\s*\(\s*opacity\s*=\s*([^\)]+)\)/,Se=function(t){return t};xe?Se=function(t,Ae){return t.style.opacity=Ae,t}:Te&&(Se=function(t,Ae){var Pe=t.style;return t.currentStyle&&!t.currentStyle.hasLayout&&(Pe.zoom=1),_e.test(Pe.filter)?(Ae=Ae>=.9999?"":"alpha(opacity="+Ae*100+")",Pe.filter=Pe.filter.replace(_e,Ae)):Pe.filter+=" alpha(opacity="+Ae*100+")",t}),r.util.setStyle=Ee}(),function(){var Ee=Array.prototype.slice;function e(Re){return typeof Re=="string"?r.document.getElementById(Re):Re}var xe,Te=function(Re){return Ee.call(Re,0)};try{xe=Te(r.document.childNodes)instanceof Array}catch{}xe||(Te=function(Re){for(var je=new Array(Re.length),We=Re.length;We--;)je[We]=Re[We];return je});function _e(Re,je){var We=r.document.createElement(Re);for(var Ke in je)Ke==="class"?We.className=je[Ke]:Ke==="for"?We.htmlFor=je[Ke]:We.setAttribute(Ke,je[Ke]);return We}function Se(Re,je){Re&&(" "+Re.className+" ").indexOf(" "+je+" ")===-1&&(Re.className+=(Re.className?" ":"")+je)}function t(Re,je,We){return typeof je=="string"&&(je=_e(je,We)),Re.parentNode&&Re.parentNode.replaceChild(je,Re),je.appendChild(Re),je}function Ae(Re){for(var je=0,We=0,Ke=r.document.documentElement,Je=r.document.body||{scrollLeft:0,scrollTop:0};Re&&(Re.parentNode||Re.host)&&(Re=Re.parentNode||Re.host,Re===r.document?(je=Je.scrollLeft||Ke.scrollLeft||0,We=Je.scrollTop||Ke.scrollTop||0):(je+=Re.scrollLeft||0,We+=Re.scrollTop||0),!(Re.nodeType===1&&Re.style.position==="fixed")););return{left:je,top:We}}function Pe(Re){var je,We=Re&&Re.ownerDocument,Ke={left:0,top:0},Je={left:0,top:0},hi,oi={borderLeftWidth:"left",borderTopWidth:"top",paddingLeft:"left",paddingTop:"top"};if(!We)return Je;for(var ti in oi)Je[oi[ti]]+=parseInt(St(Re,ti),10)||0;return je=We.documentElement,typeof Re.getBoundingClientRect<"u"&&(Ke=Re.getBoundingClientRect()),hi=Ae(Re),{left:Ke.left+hi.left-(je.clientLeft||0)+Je.left,top:Ke.top+hi.top-(je.clientTop||0)+Je.top}}var St;r.document.defaultView&&r.document.defaultView.getComputedStyle?St=function(Re,je){var We=r.document.defaultView.getComputedStyle(Re,null);return We?We[je]:void 0}:St=function(Re,je){var We=Re.style[je];return!We&&Re.currentStyle&&(We=Re.currentStyle[je]),We},function(){var Re=r.document.documentElement.style,je="userSelect"in Re?"userSelect":"MozUserSelect"in Re?"MozUserSelect":"WebkitUserSelect"in Re?"WebkitUserSelect":"KhtmlUserSelect"in Re?"KhtmlUserSelect":"";function We(Je){return typeof Je.onselectstart<"u"&&(Je.onselectstart=r.util.falseFunction),je?Je.style[je]="none":typeof Je.unselectable=="string"&&(Je.unselectable="on"),Je}function Ke(Je){return typeof Je.onselectstart<"u"&&(Je.onselectstart=null),je?Je.style[je]="":typeof Je.unselectable=="string"&&(Je.unselectable=""),Je}r.util.makeElementUnselectable=We,r.util.makeElementSelectable=Ke}();function Ce(Re){var je=r.jsdomImplForWrapper(Re);return je._canvas||je._image}function ke(Re){if(!!r.isLikelyNode){var je=r.jsdomImplForWrapper(Re);je&&(je._image=null,je._canvas=null,je._currentSrc=null,je._attributes=null,je._classList=null)}}function De(Re,je){Re.imageSmoothingEnabled=Re.imageSmoothingEnabled||Re.webkitImageSmoothingEnabled||Re.mozImageSmoothingEnabled||Re.msImageSmoothingEnabled||Re.oImageSmoothingEnabled,Re.imageSmoothingEnabled=je}r.util.setImageSmoothing=De,r.util.getById=e,r.util.toArray=Te,r.util.addClass=Se,r.util.makeElement=_e,r.util.wrapElement=t,r.util.getScrollLeftTop=Ae,r.util.getElementOffset=Pe,r.util.getNodeCanvas=Ce,r.util.cleanUpJsdomNode=ke}(),function(){function Ee(Te,_e){return Te+(/\?/.test(Te)?"&":"?")+_e}function e(){}function xe(Te,_e){_e||(_e={});var Se=_e.method?_e.method.toUpperCase():"GET",t=_e.onComplete||function(){},Ae=new r.window.XMLHttpRequest,Pe=_e.body||_e.parameters;return Ae.onreadystatechange=function(){Ae.readyState===4&&(t(Ae),Ae.onreadystatechange=e)},Se==="GET"&&(Pe=null,typeof _e.parameters=="string"&&(Te=Ee(Te,_e.parameters))),Ae.open(Se,Te,!0),(Se==="POST"||Se==="PUT")&&Ae.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),Ae.send(Pe),Ae}r.util.request=xe}(),r.log=console.log,r.warn=console.warn,function(){var Ee=r.util.object.extend,e=r.util.object.clone,xe=[];r.util.object.extend(xe,{cancelAll:function(){var Ce=this.splice(0);return Ce.forEach(function(ke){ke.cancel()}),Ce},cancelByCanvas:function(Ce){if(!Ce)return[];var ke=this.filter(function(De){return typeof De.target=="object"&&De.target.canvas===Ce});return ke.forEach(function(De){De.cancel()}),ke},cancelByTarget:function(Ce){var ke=this.findAnimationsByTarget(Ce);return ke.forEach(function(De){De.cancel()}),ke},findAnimationIndex:function(Ce){return this.indexOf(this.findAnimation(Ce))},findAnimation:function(Ce){return this.find(function(ke){return ke.cancel===Ce})},findAnimationsByTarget:function(Ce){return Ce?this.filter(function(ke){return ke.target===Ce}):[]}});function Te(){return!1}function _e(Ce,ke,De,Re){return-De*Math.cos(Ce/Re*(Math.PI/2))+De+ke}function Se(Ce){Ce||(Ce={});var ke=!1,De,Re=function(){var je=r.runningAnimations.indexOf(De);return je>-1&&r.runningAnimations.splice(je,1)[0]};return De=Ee(e(Ce),{cancel:function(){return ke=!0,Re()},currentValue:"startValue"in Ce?Ce.startValue:0,completionRate:0,durationRate:0}),r.runningAnimations.push(De),Pe(function(je){var We=je||+new Date,Ke=Ce.duration||500,Je=We+Ke,hi,oi=Ce.onChange||Te,ti=Ce.abort||Te,ai=Ce.onComplete||Te,yi=Ce.easing||_e,di="startValue"in Ce?Ce.startValue.length>0:!1,bi="startValue"in Ce?Ce.startValue:0,vi="endValue"in Ce?Ce.endValue:100,Pi=Ce.byValue||(di?bi.map(function(xi,ni){return vi[ni]-bi[ni]}):vi-bi);Ce.onStart&&Ce.onStart(),function xi(ni){hi=ni||+new Date;var fi=hi>Je?Ke:hi-We,Si=fi/Ke,Xe=di?bi.map(function(ze,Ve){return yi(fi,bi[Ve],Pi[Ve],Ke)}):yi(fi,bi,Pi,Ke),Ge=Math.abs(di?(Xe[0]-bi[0])/Pi[0]:(Xe-bi)/Pi);if(De.currentValue=di?Xe.slice():Xe,De.completionRate=Ge,De.durationRate=Si,!ke){if(ti(Xe,Ge,Si)){Re();return}if(hi>Je){De.currentValue=di?vi.slice():vi,De.completionRate=1,De.durationRate=1,oi(di?vi.slice():vi,1,1),ai(vi,1,1),Re();return}else oi(Xe,Ge,Si),Pe(xi)}}(We)}),De.cancel}var t=r.window.requestAnimationFrame||r.window.webkitRequestAnimationFrame||r.window.mozRequestAnimationFrame||r.window.oRequestAnimationFrame||r.window.msRequestAnimationFrame||function(Ce){return r.window.setTimeout(Ce,1e3/60)},Ae=r.window.cancelAnimationFrame||r.window.clearTimeout;function Pe(){return t.apply(r.window,arguments)}function St(){return Ae.apply(r.window,arguments)}r.util.animate=Se,r.util.requestAnimFrame=Pe,r.util.cancelAnimFrame=St,r.runningAnimations=xe}(),function(){function Ee(xe,Te,_e){var Se="rgba("+parseInt(xe[0]+_e*(Te[0]-xe[0]),10)+","+parseInt(xe[1]+_e*(Te[1]-xe[1]),10)+","+parseInt(xe[2]+_e*(Te[2]-xe[2]),10);return Se+=","+(xe&&Te?parseFloat(xe[3]+_e*(Te[3]-xe[3])):1),Se+=")",Se}function e(xe,Te,_e,Se){var t=new r.Color(xe).getSource(),Ae=new r.Color(Te).getSource(),Pe=Se.onComplete,St=Se.onChange;return Se=Se||{},r.util.animate(r.util.object.extend(Se,{duration:_e||500,startValue:t,endValue:Ae,byValue:Ae,easing:function(Ce,ke,De,Re){var je=Se.colorEasing?Se.colorEasing(Ce,Re):1-Math.cos(Ce/Re*(Math.PI/2));return Ee(ke,De,je)},onComplete:function(Ce,ke,De){if(Pe)return Pe(Ee(Ae,Ae,0),ke,De)},onChange:function(Ce,ke,De){if(St){if(Array.isArray(Ce))return St(Ee(Ce,Ce,0),ke,De);St(Ce,ke,De)}}}))}r.util.animateColor=e}(),function(){function Ee(ni,fi,Si,Xe){return ni<Math.abs(fi)?(ni=fi,Xe=Si/4):fi===0&&ni===0?Xe=Si/(2*Math.PI)*Math.asin(1):Xe=Si/(2*Math.PI)*Math.asin(fi/ni),{a:ni,c:fi,p:Si,s:Xe}}function e(ni,fi,Si){return ni.a*Math.pow(2,10*(fi-=1))*Math.sin((fi*Si-ni.s)*(2*Math.PI)/ni.p)}function xe(ni,fi,Si,Xe){return Si*((ni=ni/Xe-1)*ni*ni+1)+fi}function Te(ni,fi,Si,Xe){return ni/=Xe/2,ni<1?Si/2*ni*ni*ni+fi:Si/2*((ni-=2)*ni*ni+2)+fi}function _e(ni,fi,Si,Xe){return Si*(ni/=Xe)*ni*ni*ni+fi}function Se(ni,fi,Si,Xe){return-Si*((ni=ni/Xe-1)*ni*ni*ni-1)+fi}function t(ni,fi,Si,Xe){return ni/=Xe/2,ni<1?Si/2*ni*ni*ni*ni+fi:-Si/2*((ni-=2)*ni*ni*ni-2)+fi}function Ae(ni,fi,Si,Xe){return Si*(ni/=Xe)*ni*ni*ni*ni+fi}function Pe(ni,fi,Si,Xe){return Si*((ni=ni/Xe-1)*ni*ni*ni*ni+1)+fi}function St(ni,fi,Si,Xe){return ni/=Xe/2,ni<1?Si/2*ni*ni*ni*ni*ni+fi:Si/2*((ni-=2)*ni*ni*ni*ni+2)+fi}function Ce(ni,fi,Si,Xe){return-Si*Math.cos(ni/Xe*(Math.PI/2))+Si+fi}function ke(ni,fi,Si,Xe){return Si*Math.sin(ni/Xe*(Math.PI/2))+fi}function De(ni,fi,Si,Xe){return-Si/2*(Math.cos(Math.PI*ni/Xe)-1)+fi}function Re(ni,fi,Si,Xe){return ni===0?fi:Si*Math.pow(2,10*(ni/Xe-1))+fi}function je(ni,fi,Si,Xe){return ni===Xe?fi+Si:Si*(-Math.pow(2,-10*ni/Xe)+1)+fi}function We(ni,fi,Si,Xe){return ni===0?fi:ni===Xe?fi+Si:(ni/=Xe/2,ni<1?Si/2*Math.pow(2,10*(ni-1))+fi:Si/2*(-Math.pow(2,-10*--ni)+2)+fi)}function Ke(ni,fi,Si,Xe){return-Si*(Math.sqrt(1-(ni/=Xe)*ni)-1)+fi}function Je(ni,fi,Si,Xe){return Si*Math.sqrt(1-(ni=ni/Xe-1)*ni)+fi}function hi(ni,fi,Si,Xe){return ni/=Xe/2,ni<1?-Si/2*(Math.sqrt(1-ni*ni)-1)+fi:Si/2*(Math.sqrt(1-(ni-=2)*ni)+1)+fi}function oi(ni,fi,Si,Xe){var Ge=1.70158,ze=0,Ve=Si;if(ni===0)return fi;if(ni/=Xe,ni===1)return fi+Si;ze||(ze=Xe*.3);var ei=Ee(Ve,Si,ze,Ge);return-e(ei,ni,Xe)+fi}function ti(ni,fi,Si,Xe){var Ge=1.70158,ze=0,Ve=Si;if(ni===0)return fi;if(ni/=Xe,ni===1)return fi+Si;ze||(ze=Xe*.3);var ei=Ee(Ve,Si,ze,Ge);return ei.a*Math.pow(2,-10*ni)*Math.sin((ni*Xe-ei.s)*(2*Math.PI)/ei.p)+ei.c+fi}function ai(ni,fi,Si,Xe){var Ge=1.70158,ze=0,Ve=Si;if(ni===0)return fi;if(ni/=Xe/2,ni===2)return fi+Si;ze||(ze=Xe*(.3*1.5));var ei=Ee(Ve,Si,ze,Ge);return ni<1?-.5*e(ei,ni,Xe)+fi:ei.a*Math.pow(2,-10*(ni-=1))*Math.sin((ni*Xe-ei.s)*(2*Math.PI)/ei.p)*.5+ei.c+fi}function yi(ni,fi,Si,Xe,Ge){return Ge===void 0&&(Ge=1.70158),Si*(ni/=Xe)*ni*((Ge+1)*ni-Ge)+fi}function di(ni,fi,Si,Xe,Ge){return Ge===void 0&&(Ge=1.70158),Si*((ni=ni/Xe-1)*ni*((Ge+1)*ni+Ge)+1)+fi}function bi(ni,fi,Si,Xe,Ge){return Ge===void 0&&(Ge=1.70158),ni/=Xe/2,ni<1?Si/2*(ni*ni*(((Ge*=1.525)+1)*ni-Ge))+fi:Si/2*((ni-=2)*ni*(((Ge*=1.525)+1)*ni+Ge)+2)+fi}function vi(ni,fi,Si,Xe){return Si-Pi(Xe-ni,0,Si,Xe)+fi}function Pi(ni,fi,Si,Xe){return(ni/=Xe)<1/2.75?Si*(7.5625*ni*ni)+fi:ni<2/2.75?Si*(7.5625*(ni-=1.5/2.75)*ni+.75)+fi:ni<2.5/2.75?Si*(7.5625*(ni-=2.25/2.75)*ni+.9375)+fi:Si*(7.5625*(ni-=2.625/2.75)*ni+.984375)+fi}function xi(ni,fi,Si,Xe){return ni<Xe/2?vi(ni*2,0,Si,Xe)*.5+fi:Pi(ni*2-Xe,0,Si,Xe)*.5+Si*.5+fi}r.util.ease={easeInQuad:function(ni,fi,Si,Xe){return Si*(ni/=Xe)*ni+fi},easeOutQuad:function(ni,fi,Si,Xe){return-Si*(ni/=Xe)*(ni-2)+fi},easeInOutQuad:function(ni,fi,Si,Xe){return ni/=Xe/2,ni<1?Si/2*ni*ni+fi:-Si/2*(--ni*(ni-2)-1)+fi},easeInCubic:function(ni,fi,Si,Xe){return Si*(ni/=Xe)*ni*ni+fi},easeOutCubic:xe,easeInOutCubic:Te,easeInQuart:_e,easeOutQuart:Se,easeInOutQuart:t,easeInQuint:Ae,easeOutQuint:Pe,easeInOutQuint:St,easeInSine:Ce,easeOutSine:ke,easeInOutSine:De,easeInExpo:Re,easeOutExpo:je,easeInOutExpo:We,easeInCirc:Ke,easeOutCirc:Je,easeInOutCirc:hi,easeInElastic:oi,easeOutElastic:ti,easeInOutElastic:ai,easeInBack:yi,easeOutBack:di,easeInOutBack:bi,easeInBounce:vi,easeOutBounce:Pi,easeInOutBounce:xi}}(),function(Ee){var e=Ee.fabric||(Ee.fabric={}),xe=e.util.object.extend,Te=e.util.object.clone,_e=e.util.toFixed,Se=e.util.parseUnit,t=e.util.multiplyTransformMatrices,Ae=["path","circle","polygon","polyline","ellipse","rect","line","image","text"],Pe=["symbol","image","marker","pattern","view","svg"],St=["pattern","defs","symbol","metadata","clipPath","mask","desc"],Ce=["symbol","g","a","svg","clipPath","defs"],ke={cx:"left",x:"left",r:"radius",cy:"top",y:"top",display:"visible",visibility:"visible",transform:"transformMatrix","fill-opacity":"fillOpacity","fill-rule":"fillRule","font-family":"fontFamily","font-size":"fontSize","font-style":"fontStyle","font-weight":"fontWeight","letter-spacing":"charSpacing","paint-order":"paintFirst","stroke-dasharray":"strokeDashArray","stroke-dashoffset":"strokeDashOffset","stroke-linecap":"strokeLineCap","stroke-linejoin":"strokeLineJoin","stroke-miterlimit":"strokeMiterLimit","stroke-opacity":"strokeOpacity","stroke-width":"strokeWidth","text-decoration":"textDecoration","text-anchor":"textAnchor",opacity:"opacity","clip-path":"clipPath","clip-rule":"clipRule","vector-effect":"strokeUniform","image-rendering":"imageSmoothing"},De={stroke:"strokeOpacity",fill:"fillOpacity"},Re="font-size",je="clip-path";e.svgValidTagNamesRegEx=Je(Ae),e.svgViewBoxElementsRegEx=Je(Pe),e.svgInvalidAncestorsRegEx=Je(St),e.svgValidParentsRegEx=Je(Ce),e.cssRules={},e.gradientDefs={},e.clipPaths={};function We(ze){return ze in ke?ke[ze]:ze}function Ke(ze,Ve,ei,si){var li=Array.isArray(Ve),ci;if((ze==="fill"||ze==="stroke")&&Ve==="none")Ve="";else{if(ze==="strokeUniform")return Ve==="non-scaling-stroke";if(ze==="strokeDashArray")Ve==="none"?Ve=null:Ve=Ve.replace(/,/g," ").split(/\s+/).map(parseFloat);else if(ze==="transformMatrix")ei&&ei.transformMatrix?Ve=t(ei.transformMatrix,e.parseTransformAttribute(Ve)):Ve=e.parseTransformAttribute(Ve);else if(ze==="visible")Ve=Ve!=="none"&&Ve!=="hidden",ei&&ei.visible===!1&&(Ve=!1);else if(ze==="opacity")Ve=parseFloat(Ve),ei&&typeof ei.opacity<"u"&&(Ve*=ei.opacity);else if(ze==="textAnchor")Ve=Ve==="start"?"left":Ve==="end"?"right":"center";else if(ze==="charSpacing")ci=Se(Ve,si)/si*1e3;else if(ze==="paintFirst"){var Ci=Ve.indexOf("fill"),Fi=Ve.indexOf("stroke"),Ve="fill";(Ci>-1&&Fi>-1&&Fi<Ci||Ci===-1&&Fi>-1)&&(Ve="stroke")}else{if(ze==="href"||ze==="xlink:href"||ze==="font")return Ve;if(ze==="imageSmoothing")return Ve==="optimizeQuality";ci=li?Ve.map(Se):Se(Ve,si)}}return!li&&isNaN(ci)?Ve:ci}function Je(ze){return new RegExp("^("+ze.join("|")+")\\b","i")}function hi(ze){for(var Ve in De)if(!(typeof ze[De[Ve]]>"u"||ze[Ve]==="")){if(typeof ze[Ve]>"u"){if(!e.Object.prototype[Ve])continue;ze[Ve]=e.Object.prototype[Ve]}if(ze[Ve].indexOf("url(")!==0){var ei=new e.Color(ze[Ve]);ze[Ve]=ei.setAlpha(_e(ei.getAlpha()*ze[De[Ve]],2)).toRgba()}}return ze}function oi(ze,Ve){var ei,si=[],li,ci,Ci;for(ci=0,Ci=Ve.length;ci<Ci;ci++)ei=Ve[ci],li=ze.getElementsByTagName(ei),si=si.concat(Array.prototype.slice.call(li));return si}e.parseTransformAttribute=function(){function ze(ki,Vi){var Ii=e.util.cos(Vi[0]),$i=e.util.sin(Vi[0]),tn=0,en=0;Vi.length===3&&(tn=Vi[1],en=Vi[2]),ki[0]=Ii,ki[1]=$i,ki[2]=-$i,ki[3]=Ii,ki[4]=tn-(Ii*tn-$i*en),ki[5]=en-($i*tn+Ii*en)}function Ve(ki,Vi){var Ii=Vi[0],$i=Vi.length===2?Vi[1]:Vi[0];ki[0]=Ii,ki[3]=$i}function ei(ki,Vi,Ii){ki[Ii]=Math.tan(e.util.degreesToRadians(Vi[0]))}function si(ki,Vi){ki[4]=Vi[0],Vi.length===2&&(ki[5]=Vi[1])}var li=e.iMatrix,ci=e.reNum,Ci=e.commaWsp,Fi="(?:(skewX)\\s*\\(\\s*("+ci+")\\s*\\))",Oi="(?:(skewY)\\s*\\(\\s*("+ci+")\\s*\\))",Ti="(?:(rotate)\\s*\\(\\s*("+ci+")(?:"+Ci+"("+ci+")"+Ci+"("+ci+"))?\\s*\\))",Ze="(?:(scale)\\s*\\(\\s*("+ci+")(?:"+Ci+"("+ci+"))?\\s*\\))",ii="(?:(translate)\\s*\\(\\s*("+ci+")(?:"+Ci+"("+ci+"))?\\s*\\))",Qe="(?:(matrix)\\s*\\(\\s*("+ci+")"+Ci+"("+ci+")"+Ci+"("+ci+")"+Ci+"("+ci+")"+Ci+"("+ci+")"+Ci+"("+ci+")\\s*\\))",ui="(?:"+Qe+"|"+ii+"|"+Ze+"|"+Ti+"|"+Fi+"|"+Oi+")",gi="(?:"+ui+"(?:"+Ci+"*"+ui+")*)",_i="^\\s*(?:"+gi+"?)\\s*$",Ri=new RegExp(_i),Ui=new RegExp(ui,"g");return function(ki){var Vi=li.concat(),Ii=[];if(!ki||ki&&!Ri.test(ki))return Vi;ki.replace(Ui,function(tn){var en=new RegExp(ui).exec(tn).filter(function(pn){return!!pn}),zi=en[1],Ji=en.slice(2).map(parseFloat);switch(zi){case"translate":si(Vi,Ji);break;case"rotate":Ji[0]=e.util.degreesToRadians(Ji[0]),ze(Vi,Ji);break;case"scale":Ve(Vi,Ji);break;case"skewX":ei(Vi,Ji,2);break;case"skewY":ei(Vi,Ji,1);break;case"matrix":Vi=Ji;break}Ii.push(Vi.concat()),Vi=li.concat()});for(var $i=Ii[0];Ii.length>1;)Ii.shift(),$i=e.util.multiplyTransformMatrices($i,Ii[0]);return $i}}();function ti(ze,Ve){var ei,si;ze.replace(/;\s*$/,"").split(";").forEach(function(li){var ci=li.split(":");ei=ci[0].trim().toLowerCase(),si=ci[1].trim(),Ve[ei]=si})}function ai(ze,Ve){var ei,si;for(var li in ze)typeof ze[li]>"u"||(ei=li.toLowerCase(),si=ze[li],Ve[ei]=si)}function yi(ze,Ve){var ei={};for(var si in e.cssRules[Ve])if(di(ze,si.split(" ")))for(var li in e.cssRules[Ve][si])ei[li]=e.cssRules[Ve][si][li];return ei}function di(ze,Ve){var ei,si=!0;return ei=vi(ze,Ve.pop()),ei&&Ve.length&&(si=bi(ze,Ve)),ei&&si&&Ve.length===0}function bi(ze,Ve){for(var ei,si=!0;ze.parentNode&&ze.parentNode.nodeType===1&&Ve.length;)si&&(ei=Ve.pop()),ze=ze.parentNode,si=vi(ze,ei);return Ve.length===0}function vi(ze,Ve){var ei=ze.nodeName,si=ze.getAttribute("class"),li=ze.getAttribute("id"),ci,Ci;if(ci=new RegExp("^"+ei,"i"),Ve=Ve.replace(ci,""),li&&Ve.length&&(ci=new RegExp("#"+li+"(?![a-zA-Z\\-]+)","i"),Ve=Ve.replace(ci,"")),si&&Ve.length)for(si=si.split(" "),Ci=si.length;Ci--;)ci=new RegExp("\\."+si[Ci]+"(?![a-zA-Z\\-]+)","i"),Ve=Ve.replace(ci,"");return Ve.length===0}function Pi(ze,Ve){var ei;if(ze.getElementById&&(ei=ze.getElementById(Ve)),ei)return ei;var si,li,ci,Ci=ze.getElementsByTagName("*");for(li=0,ci=Ci.length;li<ci;li++)if(si=Ci[li],Ve===si.getAttribute("id"))return si}function xi(ze){for(var Ve=oi(ze,["use","svg:use"]),ei=0;Ve.length&&ei<Ve.length;){var si=Ve[ei],li=si.getAttribute("xlink:href")||si.getAttribute("href");if(li===null)return;var ci=li.slice(1),Ci=si.getAttribute("x")||0,Fi=si.getAttribute("y")||0,Oi=Pi(ze,ci).cloneNode(!0),Ti=(Oi.getAttribute("transform")||"")+" translate("+Ci+", "+Fi+")",Ze,ii=Ve.length,Qe,ui,gi,_i,Ri=e.svgNS;if(fi(Oi),/^svg$/i.test(Oi.nodeName)){var Ui=Oi.ownerDocument.createElementNS(Ri,"g");for(ui=0,gi=Oi.attributes,_i=gi.length;ui<_i;ui++)Qe=gi.item(ui),Ui.setAttributeNS(Ri,Qe.nodeName,Qe.nodeValue);for(;Oi.firstChild;)Ui.appendChild(Oi.firstChild);Oi=Ui}for(ui=0,gi=si.attributes,_i=gi.length;ui<_i;ui++)Qe=gi.item(ui),!(Qe.nodeName==="x"||Qe.nodeName==="y"||Qe.nodeName==="xlink:href"||Qe.nodeName==="href")&&(Qe.nodeName==="transform"?Ti=Qe.nodeValue+" "+Ti:Oi.setAttribute(Qe.nodeName,Qe.nodeValue));Oi.setAttribute("transform",Ti),Oi.setAttribute("instantiated_by_use","1"),Oi.removeAttribute("id"),Ze=si.parentNode,Ze.replaceChild(Oi,si),Ve.length===ii&&ei++}}var ni=new RegExp("^\\s*("+e.reNum+"+)\\s*,?\\s*("+e.reNum+"+)\\s*,?\\s*("+e.reNum+"+)\\s*,?\\s*("+e.reNum+"+)\\s*$");function fi(ze){if(!e.svgViewBoxElementsRegEx.test(ze.nodeName))return{};var Ve=ze.getAttribute("viewBox"),ei=1,si=1,li=0,ci=0,Ci,Fi,Oi,Ti,Ze=ze.getAttribute("width"),ii=ze.getAttribute("height"),Qe=ze.getAttribute("x")||0,ui=ze.getAttribute("y")||0,gi=ze.getAttribute("preserveAspectRatio")||"",_i=!Ve||!(Ve=Ve.match(ni)),Ri=!Ze||!ii||Ze==="100%"||ii==="100%",Ui=_i&&Ri,ki={},Vi="",Ii=0,$i=0;if(ki.width=0,ki.height=0,ki.toBeParsed=Ui,_i&&(Qe||ui)&&ze.parentNode&&ze.parentNode.nodeName!=="#document"&&(Vi=" translate("+Se(Qe)+" "+Se(ui)+") ",Oi=(ze.getAttribute("transform")||"")+Vi,ze.setAttribute("transform",Oi),ze.removeAttribute("x"),ze.removeAttribute("y")),Ui)return ki;if(_i)return ki.width=Se(Ze),ki.height=Se(ii),ki;if(li=-parseFloat(Ve[1]),ci=-parseFloat(Ve[2]),Ci=parseFloat(Ve[3]),Fi=parseFloat(Ve[4]),ki.minX=li,ki.minY=ci,ki.viewBoxWidth=Ci,ki.viewBoxHeight=Fi,Ri?(ki.width=Ci,ki.height=Fi):(ki.width=Se(Ze),ki.height=Se(ii),ei=ki.width/Ci,si=ki.height/Fi),gi=e.util.parsePreserveAspectRatioAttribute(gi),gi.alignX!=="none"&&(gi.meetOrSlice==="meet"&&(si=ei=ei>si?si:ei),gi.meetOrSlice==="slice"&&(si=ei=ei>si?ei:si),Ii=ki.width-Ci*ei,$i=ki.height-Fi*ei,gi.alignX==="Mid"&&(Ii/=2),gi.alignY==="Mid"&&($i/=2),gi.alignX==="Min"&&(Ii=0),gi.alignY==="Min"&&($i=0)),ei===1&&si===1&&li===0&&ci===0&&Qe===0&&ui===0)return ki;if((Qe||ui)&&ze.parentNode.nodeName!=="#document"&&(Vi=" translate("+Se(Qe)+" "+Se(ui)+") "),Oi=Vi+" matrix("+ei+" 0 0 "+si+" "+(li*ei+Ii)+" "+(ci*si+$i)+") ",ze.nodeName==="svg"){for(Ti=ze.ownerDocument.createElementNS(e.svgNS,"g");ze.firstChild;)Ti.appendChild(ze.firstChild);ze.appendChild(Ti)}else Ti=ze,Ti.removeAttribute("x"),Ti.removeAttribute("y"),Oi=Ti.getAttribute("transform")+Oi;return Ti.setAttribute("transform",Oi),ki}function Si(ze,Ve){for(;ze&&(ze=ze.parentNode);)if(ze.nodeName&&Ve.test(ze.nodeName.replace("svg:",""))&&!ze.getAttribute("instantiated_by_use"))return!0;return!1}e.parseSVGDocument=function(ze,Ve,ei,si){if(!!ze){xi(ze);var li=e.Object.__uid++,ci,Ci,Fi=fi(ze),Oi=e.util.toArray(ze.getElementsByTagName("*"));if(Fi.crossOrigin=si&&si.crossOrigin,Fi.svgUid=li,Oi.length===0&&e.isLikelyNode){Oi=ze.selectNodes('//*[name(.)!="svg"]');var Ti=[];for(ci=0,Ci=Oi.length;ci<Ci;ci++)Ti[ci]=Oi[ci];Oi=Ti}var Ze=Oi.filter(function(Qe){return fi(Qe),e.svgValidTagNamesRegEx.test(Qe.nodeName.replace("svg:",""))&&!Si(Qe,e.svgInvalidAncestorsRegEx)});if(!Ze||Ze&&!Ze.length){Ve&&Ve([],{});return}var ii={};Oi.filter(function(Qe){return Qe.nodeName.replace("svg:","")==="clipPath"}).forEach(function(Qe){var ui=Qe.getAttribute("id");ii[ui]=e.util.toArray(Qe.getElementsByTagName("*")).filter(function(gi){return e.svgValidTagNamesRegEx.test(gi.nodeName.replace("svg:",""))})}),e.gradientDefs[li]=e.getGradientDefs(ze),e.cssRules[li]=e.getCSSRules(ze),e.clipPaths[li]=ii,e.parseElements(Ze,function(Qe,ui){Ve&&(Ve(Qe,Fi,ui,Oi),delete e.gradientDefs[li],delete e.cssRules[li],delete e.clipPaths[li])},Te(Fi),ei,si)}};function Xe(ze,Ve){var ei=["gradientTransform","x1","x2","y1","y2","gradientUnits","cx","cy","r","fx","fy"],si="xlink:href",li=Ve.getAttribute(si).slice(1),ci=Pi(ze,li);if(ci&&ci.getAttribute(si)&&Xe(ze,ci),ei.forEach(function(Fi){ci&&!Ve.hasAttribute(Fi)&&ci.hasAttribute(Fi)&&Ve.setAttribute(Fi,ci.getAttribute(Fi))}),!Ve.children.length)for(var Ci=ci.cloneNode(!0);Ci.firstChild;)Ve.appendChild(Ci.firstChild);Ve.removeAttribute(si)}var Ge=new RegExp("(normal|italic)?\\s*(normal|small-caps)?\\s*(normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900)?\\s*("+e.reNum+"(?:px|cm|mm|em|pt|pc|in)*)(?:\\/(normal|"+e.reNum+"))?\\s+(.*)");xe(e,{parseFontDeclaration:function(ze,Ve){var ei=ze.match(Ge);if(!!ei){var si=ei[1],li=ei[3],ci=ei[4],Ci=ei[5],Fi=ei[6];si&&(Ve.fontStyle=si),li&&(Ve.fontWeight=isNaN(parseFloat(li))?li:parseFloat(li)),ci&&(Ve.fontSize=Se(ci)),Fi&&(Ve.fontFamily=Fi),Ci&&(Ve.lineHeight=Ci==="normal"?1:Ci)}},getGradientDefs:function(ze){var Ve=["linearGradient","radialGradient","svg:linearGradient","svg:radialGradient"],ei=oi(ze,Ve),si,li=0,ci={};for(li=ei.length;li--;)si=ei[li],si.getAttribute("xlink:href")&&Xe(ze,si),ci[si.getAttribute("id")]=si;return ci},parseAttributes:function(ze,Ve,ei){if(!!ze){var si,li={},ci,Ci;typeof ei>"u"&&(ei=ze.getAttribute("svgUid")),ze.parentNode&&e.svgValidParentsRegEx.test(ze.parentNode.nodeName)&&(li=e.parseAttributes(ze.parentNode,Ve,ei));var Fi=Ve.reduce(function(gi,_i){return si=ze.getAttribute(_i),si&&(gi[_i]=si),gi},{}),Oi=xe(yi(ze,ei),e.parseStyleAttribute(ze));Fi=xe(Fi,Oi),Oi[je]&&ze.setAttribute(je,Oi[je]),ci=Ci=li.fontSize||e.Text.DEFAULT_SVG_FONT_SIZE,Fi[Re]&&(Fi[Re]=ci=Se(Fi[Re],Ci));var Ti,Ze,ii={};for(var Qe in Fi)Ti=We(Qe),Ze=Ke(Ti,Fi[Qe],li,ci),ii[Ti]=Ze;ii&&ii.font&&e.parseFontDeclaration(ii.font,ii);var ui=xe(li,ii);return e.svgValidParentsRegEx.test(ze.nodeName)?ui:hi(ui)}},parseElements:function(ze,Ve,ei,si,li){new e.ElementsParser(ze,Ve,ei,si,li).parse()},parseStyleAttribute:function(ze){var Ve={},ei=ze.getAttribute("style");return ei&&(typeof ei=="string"?ti(ei,Ve):ai(ei,Ve)),Ve},parsePointsAttribute:function(ze){if(!ze)return null;ze=ze.replace(/,/g," ").trim(),ze=ze.split(/\s+/);var Ve=[],ei,si;for(ei=0,si=ze.length;ei<si;ei+=2)Ve.push({x:parseFloat(ze[ei]),y:parseFloat(ze[ei+1])});return Ve},getCSSRules:function(ze){var Ve=ze.getElementsByTagName("style"),ei,si,li={},ci;for(ei=0,si=Ve.length;ei<si;ei++){var Ci=Ve[ei].textContent;Ci=Ci.replace(/\/\*[\s\S]*?\*\//g,""),Ci.trim()!==""&&(ci=Ci.split("}"),ci=ci.filter(function(Fi){return Fi.trim()}),ci.forEach(function(Fi){var Oi=Fi.split("{"),Ti={},Ze=Oi[1].trim(),ii=Ze.split(";").filter(function(_i){return _i.trim()});for(ei=0,si=ii.length;ei<si;ei++){var Qe=ii[ei].split(":"),ui=Qe[0].trim(),gi=Qe[1].trim();Ti[ui]=gi}Fi=Oi[0].trim(),Fi.split(",").forEach(function(_i){_i=_i.replace(/^svg/i,"").trim(),_i!==""&&(li[_i]?e.util.object.extend(li[_i],Ti):li[_i]=e.util.object.clone(Ti))})}))}return li},loadSVGFromURL:function(ze,Ve,ei,si){ze=ze.replace(/^\n\s*/,"").trim(),new e.util.request(ze,{method:"get",onComplete:li});function li(ci){var Ci=ci.responseXML;if(!Ci||!Ci.documentElement)return Ve&&Ve(null),!1;e.parseSVGDocument(Ci.documentElement,function(Fi,Oi,Ti,Ze){Ve&&Ve(Fi,Oi,Ti,Ze)},ei,si)}},loadSVGFromString:function(ze,Ve,ei,si){var li=new e.window.DOMParser,ci=li.parseFromString(ze.trim(),"text/xml");e.parseSVGDocument(ci.documentElement,function(Ci,Fi,Oi,Ti){Ve(Ci,Fi,Oi,Ti)},ei,si)}})}(Ie),r.ElementsParser=function(Ee,e,xe,Te,_e,Se){this.elements=Ee,this.callback=e,this.options=xe,this.reviver=Te,this.svgUid=xe&&xe.svgUid||0,this.parsingOptions=_e,this.regexUrl=/^url\(['"]?#([^'"]+)['"]?\)/g,this.doc=Se},function(Ee){Ee.parse=function(){this.instances=new Array(this.elements.length),this.numElements=this.elements.length,this.createObjects()},Ee.createObjects=function(){var e=this;this.elements.forEach(function(xe,Te){xe.setAttribute("svgUid",e.svgUid),e.createObject(xe,Te)})},Ee.findTag=function(e){return r[r.util.string.capitalize(e.tagName.replace("svg:",""))]},Ee.createObject=function(e,xe){var Te=this.findTag(e);if(Te&&Te.fromElement)try{Te.fromElement(e,this.createCallback(xe,e),this.options)}catch(_e){r.log(_e)}else this.checkIfDone()},Ee.createCallback=function(e,xe){var Te=this;return function(_e){var Se;Te.resolveGradient(_e,xe,"fill"),Te.resolveGradient(_e,xe,"stroke"),_e instanceof r.Image&&_e._originalElement&&(Se=_e.parsePreserveAspectRatioAttribute(xe)),_e._removeTransformMatrix(Se),Te.resolveClipPath(_e,xe),Te.reviver&&Te.reviver(xe,_e),Te.instances[e]=_e,Te.checkIfDone()}},Ee.extractPropertyDefinition=function(e,xe,Te){var _e=e[xe],Se=this.regexUrl;if(!!Se.test(_e)){Se.lastIndex=0;var t=Se.exec(_e)[1];return Se.lastIndex=0,r[Te][this.svgUid][t]}},Ee.resolveGradient=function(e,xe,Te){var _e=this.extractPropertyDefinition(e,Te,"gradientDefs");if(_e){var Se=xe.getAttribute(Te+"-opacity"),t=r.Gradient.fromElement(_e,e,Se,this.options);e.set(Te,t)}},Ee.createClipPathCallback=function(e,xe){return function(Te){Te._removeTransformMatrix(),Te.fillRule=Te.clipRule,xe.push(Te)}},Ee.resolveClipPath=function(e,xe){var Te=this.extractPropertyDefinition(e,"clipPath","clipPaths"),_e,Se,t,Ae,Pe,St;if(Te){Ae=[],t=r.util.invertTransform(e.calcTransformMatrix());for(var Ce=Te[0].parentNode,ke=xe;ke.parentNode&&ke.getAttribute("clip-path")!==e.clipPath;)ke=ke.parentNode;ke.parentNode.appendChild(Ce);for(var De=0;De<Te.length;De++)_e=Te[De],Se=this.findTag(_e),Se.fromElement(_e,this.createClipPathCallback(e,Ae),this.options);Ae.length===1?Te=Ae[0]:Te=new r.Group(Ae),Pe=r.util.multiplyTransformMatrices(t,Te.calcTransformMatrix()),Te.clipPath&&this.resolveClipPath(Te,ke);var St=r.util.qrDecompose(Pe);Te.flipX=!1,Te.flipY=!1,Te.set("scaleX",St.scaleX),Te.set("scaleY",St.scaleY),Te.angle=St.angle,Te.skewX=St.skewX,Te.skewY=0,Te.setPositionByOrigin({x:St.translateX,y:St.translateY},"center","center"),e.clipPath=Te}else delete e.clipPath},Ee.checkIfDone=function(){--this.numElements===0&&(this.instances=this.instances.filter(function(e){return e!=null}),this.callback(this.instances,this.elements))}}(r.ElementsParser.prototype),function(Ee){var e=Ee.fabric||(Ee.fabric={});if(e.Point){e.warn("fabric.Point is already defined");return}e.Point=xe;function xe(Te,_e){this.x=Te,this.y=_e}xe.prototype={type:"point",constructor:xe,add:function(Te){return new xe(this.x+Te.x,this.y+Te.y)},addEquals:function(Te){return this.x+=Te.x,this.y+=Te.y,this},scalarAdd:function(Te){return new xe(this.x+Te,this.y+Te)},scalarAddEquals:function(Te){return this.x+=Te,this.y+=Te,this},subtract:function(Te){return new xe(this.x-Te.x,this.y-Te.y)},subtractEquals:function(Te){return this.x-=Te.x,this.y-=Te.y,this},scalarSubtract:function(Te){return new xe(this.x-Te,this.y-Te)},scalarSubtractEquals:function(Te){return this.x-=Te,this.y-=Te,this},multiply:function(Te){return new xe(this.x*Te,this.y*Te)},multiplyEquals:function(Te){return this.x*=Te,this.y*=Te,this},divide:function(Te){return new xe(this.x/Te,this.y/Te)},divideEquals:function(Te){return this.x/=Te,this.y/=Te,this},eq:function(Te){return this.x===Te.x&&this.y===Te.y},lt:function(Te){return this.x<Te.x&&this.y<Te.y},lte:function(Te){return this.x<=Te.x&&this.y<=Te.y},gt:function(Te){return this.x>Te.x&&this.y>Te.y},gte:function(Te){return this.x>=Te.x&&this.y>=Te.y},lerp:function(Te,_e){return typeof _e>"u"&&(_e=.5),_e=Math.max(Math.min(1,_e),0),new xe(this.x+(Te.x-this.x)*_e,this.y+(Te.y-this.y)*_e)},distanceFrom:function(Te){var _e=this.x-Te.x,Se=this.y-Te.y;return Math.sqrt(_e*_e+Se*Se)},midPointFrom:function(Te){return this.lerp(Te)},min:function(Te){return new xe(Math.min(this.x,Te.x),Math.min(this.y,Te.y))},max:function(Te){return new xe(Math.max(this.x,Te.x),Math.max(this.y,Te.y))},toString:function(){return this.x+","+this.y},setXY:function(Te,_e){return this.x=Te,this.y=_e,this},setX:function(Te){return this.x=Te,this},setY:function(Te){return this.y=Te,this},setFromPoint:function(Te){return this.x=Te.x,this.y=Te.y,this},swap:function(Te){var _e=this.x,Se=this.y;this.x=Te.x,this.y=Te.y,Te.x=_e,Te.y=Se},clone:function(){return new xe(this.x,this.y)}}}(Ie),function(Ee){var e=Ee.fabric||(Ee.fabric={});if(e.Intersection){e.warn("fabric.Intersection is already defined");return}function xe(Te){this.status=Te,this.points=[]}e.Intersection=xe,e.Intersection.prototype={constructor:xe,appendPoint:function(Te){return this.points.push(Te),this},appendPoints:function(Te){return this.points=this.points.concat(Te),this}},e.Intersection.intersectLineLine=function(Te,_e,Se,t){var Ae,Pe=(t.x-Se.x)*(Te.y-Se.y)-(t.y-Se.y)*(Te.x-Se.x),St=(_e.x-Te.x)*(Te.y-Se.y)-(_e.y-Te.y)*(Te.x-Se.x),Ce=(t.y-Se.y)*(_e.x-Te.x)-(t.x-Se.x)*(_e.y-Te.y);if(Ce!==0){var ke=Pe/Ce,De=St/Ce;0<=ke&&ke<=1&&0<=De&&De<=1?(Ae=new xe("Intersection"),Ae.appendPoint(new e.Point(Te.x+ke*(_e.x-Te.x),Te.y+ke*(_e.y-Te.y)))):Ae=new xe}else Pe===0||St===0?Ae=new xe("Coincident"):Ae=new xe("Parallel");return Ae},e.Intersection.intersectLinePolygon=function(Te,_e,Se){var t=new xe,Ae=Se.length,Pe,St,Ce,ke;for(ke=0;ke<Ae;ke++)Pe=Se[ke],St=Se[(ke+1)%Ae],Ce=xe.intersectLineLine(Te,_e,Pe,St),t.appendPoints(Ce.points);return t.points.length>0&&(t.status="Intersection"),t},e.Intersection.intersectPolygonPolygon=function(Te,_e){var Se=new xe,t=Te.length,Ae;for(Ae=0;Ae<t;Ae++){var Pe=Te[Ae],St=Te[(Ae+1)%t],Ce=xe.intersectLinePolygon(Pe,St,_e);Se.appendPoints(Ce.points)}return Se.points.length>0&&(Se.status="Intersection"),Se},e.Intersection.intersectPolygonRectangle=function(Te,_e,Se){var t=_e.min(Se),Ae=_e.max(Se),Pe=new e.Point(Ae.x,t.y),St=new e.Point(t.x,Ae.y),Ce=xe.intersectLinePolygon(t,Pe,Te),ke=xe.intersectLinePolygon(Pe,Ae,Te),De=xe.intersectLinePolygon(Ae,St,Te),Re=xe.intersectLinePolygon(St,t,Te),je=new xe;return je.appendPoints(Ce.points),je.appendPoints(ke.points),je.appendPoints(De.points),je.appendPoints(Re.points),je.points.length>0&&(je.status="Intersection"),je}}(Ie),function(Ee){var e=Ee.fabric||(Ee.fabric={});if(e.Color){e.warn("fabric.Color is already defined.");return}function xe(_e){_e?this._tryParsingColor(_e):this.setSource([0,0,0,1])}e.Color=xe,e.Color.prototype={_tryParsingColor:function(_e){var Se;_e in xe.colorNameMap&&(_e=xe.colorNameMap[_e]),_e==="transparent"&&(Se=[255,255,255,0]),Se||(Se=xe.sourceFromHex(_e)),Se||(Se=xe.sourceFromRgb(_e)),Se||(Se=xe.sourceFromHsl(_e)),Se||(Se=[0,0,0,1]),Se&&this.setSource(Se)},_rgbToHsl:function(_e,Se,t){_e/=255,Se/=255,t/=255;var Ae,Pe,St,Ce=e.util.array.max([_e,Se,t]),ke=e.util.array.min([_e,Se,t]);if(St=(Ce+ke)/2,Ce===ke)Ae=Pe=0;else{var De=Ce-ke;switch(Pe=St>.5?De/(2-Ce-ke):De/(Ce+ke),Ce){case _e:Ae=(Se-t)/De+(Se<t?6:0);break;case Se:Ae=(t-_e)/De+2;break;case t:Ae=(_e-Se)/De+4;break}Ae/=6}return[Math.round(Ae*360),Math.round(Pe*100),Math.round(St*100)]},getSource:function(){return this._source},setSource:function(_e){this._source=_e},toRgb:function(){var _e=this.getSource();return"rgb("+_e[0]+","+_e[1]+","+_e[2]+")"},toRgba:function(){var _e=this.getSource();return"rgba("+_e[0]+","+_e[1]+","+_e[2]+","+_e[3]+")"},toHsl:function(){var _e=this.getSource(),Se=this._rgbToHsl(_e[0],_e[1],_e[2]);return"hsl("+Se[0]+","+Se[1]+"%,"+Se[2]+"%)"},toHsla:function(){var _e=this.getSource(),Se=this._rgbToHsl(_e[0],_e[1],_e[2]);return"hsla("+Se[0]+","+Se[1]+"%,"+Se[2]+"%,"+_e[3]+")"},toHex:function(){var _e=this.getSource(),Se,t,Ae;return Se=_e[0].toString(16),Se=Se.length===1?"0"+Se:Se,t=_e[1].toString(16),t=t.length===1?"0"+t:t,Ae=_e[2].toString(16),Ae=Ae.length===1?"0"+Ae:Ae,Se.toUpperCase()+t.toUpperCase()+Ae.toUpperCase()},toHexa:function(){var _e=this.getSource(),Se;return Se=Math.round(_e[3]*255),Se=Se.toString(16),Se=Se.length===1?"0"+Se:Se,this.toHex()+Se.toUpperCase()},getAlpha:function(){return this.getSource()[3]},setAlpha:function(_e){var Se=this.getSource();return Se[3]=_e,this.setSource(Se),this},toGrayscale:function(){var _e=this.getSource(),Se=parseInt((_e[0]*.3+_e[1]*.59+_e[2]*.11).toFixed(0),10),t=_e[3];return this.setSource([Se,Se,Se,t]),this},toBlackWhite:function(_e){var Se=this.getSource(),t=(Se[0]*.3+Se[1]*.59+Se[2]*.11).toFixed(0),Ae=Se[3];return _e=_e||127,t=Number(t)<Number(_e)?0:255,this.setSource([t,t,t,Ae]),this},overlayWith:function(_e){_e instanceof xe||(_e=new xe(_e));var Se=[],t=this.getAlpha(),Ae=.5,Pe=this.getSource(),St=_e.getSource(),Ce;for(Ce=0;Ce<3;Ce++)Se.push(Math.round(Pe[Ce]*(1-Ae)+St[Ce]*Ae));return Se[3]=t,this.setSource(Se),this}},e.Color.reRGBa=/^rgba?\(\s*(\d{1,3}(?:\.\d+)?\%?)\s*,\s*(\d{1,3}(?:\.\d+)?\%?)\s*,\s*(\d{1,3}(?:\.\d+)?\%?)\s*(?:\s*,\s*((?:\d*\.?\d+)?)\s*)?\)$/i,e.Color.reHSLa=/^hsla?\(\s*(\d{1,3})\s*,\s*(\d{1,3}\%)\s*,\s*(\d{1,3}\%)\s*(?:\s*,\s*(\d+(?:\.\d+)?)\s*)?\)$/i,e.Color.reHex=/^#?([0-9a-f]{8}|[0-9a-f]{6}|[0-9a-f]{4}|[0-9a-f]{3})$/i,e.Color.colorNameMap={aliceblue:"#F0F8FF",antiquewhite:"#FAEBD7",aqua:"#00FFFF",aquamarine:"#7FFFD4",azure:"#F0FFFF",beige:"#F5F5DC",bisque:"#FFE4C4",black:"#000000",blanchedalmond:"#FFEBCD",blue:"#0000FF",blueviolet:"#8A2BE2",brown:"#A52A2A",burlywood:"#DEB887",cadetblue:"#5F9EA0",chartreuse:"#7FFF00",chocolate:"#D2691E",coral:"#FF7F50",cornflowerblue:"#6495ED",cornsilk:"#FFF8DC",crimson:"#DC143C",cyan:"#00FFFF",darkblue:"#00008B",darkcyan:"#008B8B",darkgoldenrod:"#B8860B",darkgray:"#A9A9A9",darkgrey:"#A9A9A9",darkgreen:"#006400",darkkhaki:"#BDB76B",darkmagenta:"#8B008B",darkolivegreen:"#556B2F",darkorange:"#FF8C00",darkorchid:"#9932CC",darkred:"#8B0000",darksalmon:"#E9967A",darkseagreen:"#8FBC8F",darkslateblue:"#483D8B",darkslategray:"#2F4F4F",darkslategrey:"#2F4F4F",darkturquoise:"#00CED1",darkviolet:"#9400D3",deeppink:"#FF1493",deepskyblue:"#00BFFF",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1E90FF",firebrick:"#B22222",floralwhite:"#FFFAF0",forestgreen:"#228B22",fuchsia:"#FF00FF",gainsboro:"#DCDCDC",ghostwhite:"#F8F8FF",gold:"#FFD700",goldenrod:"#DAA520",gray:"#808080",grey:"#808080",green:"#008000",greenyellow:"#ADFF2F",honeydew:"#F0FFF0",hotpink:"#FF69B4",indianred:"#CD5C5C",indigo:"#4B0082",ivory:"#FFFFF0",khaki:"#F0E68C",lavender:"#E6E6FA",lavenderblush:"#FFF0F5",lawngreen:"#7CFC00",lemonchiffon:"#FFFACD",lightblue:"#ADD8E6",lightcoral:"#F08080",lightcyan:"#E0FFFF",lightgoldenrodyellow:"#FAFAD2",lightgray:"#D3D3D3",lightgrey:"#D3D3D3",lightgreen:"#90EE90",lightpink:"#FFB6C1",lightsalmon:"#FFA07A",lightseagreen:"#20B2AA",lightskyblue:"#87CEFA",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#B0C4DE",lightyellow:"#FFFFE0",lime:"#00FF00",limegreen:"#32CD32",linen:"#FAF0E6",magenta:"#FF00FF",maroon:"#800000",mediumaquamarine:"#66CDAA",mediumblue:"#0000CD",mediumorchid:"#BA55D3",mediumpurple:"#9370DB",mediumseagreen:"#3CB371",mediumslateblue:"#7B68EE",mediumspringgreen:"#00FA9A",mediumturquoise:"#48D1CC",mediumvioletred:"#C71585",midnightblue:"#191970",mintcream:"#F5FFFA",mistyrose:"#FFE4E1",moccasin:"#FFE4B5",navajowhite:"#FFDEAD",navy:"#000080",oldlace:"#FDF5E6",olive:"#808000",olivedrab:"#6B8E23",orange:"#FFA500",orangered:"#FF4500",orchid:"#DA70D6",palegoldenrod:"#EEE8AA",palegreen:"#98FB98",paleturquoise:"#AFEEEE",palevioletred:"#DB7093",papayawhip:"#FFEFD5",peachpuff:"#FFDAB9",peru:"#CD853F",pink:"#FFC0CB",plum:"#DDA0DD",powderblue:"#B0E0E6",purple:"#800080",rebeccapurple:"#663399",red:"#FF0000",rosybrown:"#BC8F8F",royalblue:"#4169E1",saddlebrown:"#8B4513",salmon:"#FA8072",sandybrown:"#F4A460",seagreen:"#2E8B57",seashell:"#FFF5EE",sienna:"#A0522D",silver:"#C0C0C0",skyblue:"#87CEEB",slateblue:"#6A5ACD",slategray:"#708090",slategrey:"#708090",snow:"#FFFAFA",springgreen:"#00FF7F",steelblue:"#4682B4",tan:"#D2B48C",teal:"#008080",thistle:"#D8BFD8",tomato:"#FF6347",turquoise:"#40E0D0",violet:"#EE82EE",wheat:"#F5DEB3",white:"#FFFFFF",whitesmoke:"#F5F5F5",yellow:"#FFFF00",yellowgreen:"#9ACD32"};function Te(_e,Se,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?_e+(Se-_e)*6*t:t<1/2?Se:t<2/3?_e+(Se-_e)*(2/3-t)*6:_e}e.Color.fromRgb=function(_e){return xe.fromSource(xe.sourceFromRgb(_e))},e.Color.sourceFromRgb=function(_e){var Se=_e.match(xe.reRGBa);if(Se){var t=parseInt(Se[1],10)/(/%$/.test(Se[1])?100:1)*(/%$/.test(Se[1])?255:1),Ae=parseInt(Se[2],10)/(/%$/.test(Se[2])?100:1)*(/%$/.test(Se[2])?255:1),Pe=parseInt(Se[3],10)/(/%$/.test(Se[3])?100:1)*(/%$/.test(Se[3])?255:1);return[parseInt(t,10),parseInt(Ae,10),parseInt(Pe,10),Se[4]?parseFloat(Se[4]):1]}},e.Color.fromRgba=xe.fromRgb,e.Color.fromHsl=function(_e){return xe.fromSource(xe.sourceFromHsl(_e))},e.Color.sourceFromHsl=function(_e){var Se=_e.match(xe.reHSLa);if(!!Se){var t=(parseFloat(Se[1])%360+360)%360/360,Ae=parseFloat(Se[2])/(/%$/.test(Se[2])?100:1),Pe=parseFloat(Se[3])/(/%$/.test(Se[3])?100:1),St,Ce,ke;if(Ae===0)St=Ce=ke=Pe;else{var De=Pe<=.5?Pe*(Ae+1):Pe+Ae-Pe*Ae,Re=Pe*2-De;St=Te(Re,De,t+1/3),Ce=Te(Re,De,t),ke=Te(Re,De,t-1/3)}return[Math.round(St*255),Math.round(Ce*255),Math.round(ke*255),Se[4]?parseFloat(Se[4]):1]}},e.Color.fromHsla=xe.fromHsl,e.Color.fromHex=function(_e){return xe.fromSource(xe.sourceFromHex(_e))},e.Color.sourceFromHex=function(_e){if(_e.match(xe.reHex)){var Se=_e.slice(_e.indexOf("#")+1),t=Se.length===3||Se.length===4,Ae=Se.length===8||Se.length===4,Pe=t?Se.charAt(0)+Se.charAt(0):Se.substring(0,2),St=t?Se.charAt(1)+Se.charAt(1):Se.substring(2,4),Ce=t?Se.charAt(2)+Se.charAt(2):Se.substring(4,6),ke=Ae?t?Se.charAt(3)+Se.charAt(3):Se.substring(6,8):"FF";return[parseInt(Pe,16),parseInt(St,16),parseInt(Ce,16),parseFloat((parseInt(ke,16)/255).toFixed(2))]}},e.Color.fromSource=function(_e){var Se=new xe;return Se.setSource(_e),Se}}(Ie),function(Ee){var e=Ee.fabric||(Ee.fabric={}),xe=["e","se","s","sw","w","nw","n","ne","e"],Te=["ns","nesw","ew","nwse"],_e={},Se="left",t="top",Ae="right",Pe="bottom",St="center",Ce={top:Pe,bottom:t,left:Ae,right:Se,center:St},ke=e.util.radiansToDegrees,De=Math.sign||function(Ti){return(Ti>0)-(Ti<0)||+Ti};function Re(Ti,Ze){var ii=Ti.angle+ke(Math.atan2(Ze.y,Ze.x))+360;return Math.round(ii%360/45)}function je(Ti,Ze){var ii=Ze.transform.target,Qe=ii.canvas,ui=e.util.object.clone(Ze);ui.target=ii,Qe&&Qe.fire("object:"+Ti,ui),ii.fire(Ti,Ze)}function We(Ti,Ze){var ii=Ze.canvas,Qe=ii.uniScaleKey,ui=Ti[Qe];return ii.uniformScaling&&!ui||!ii.uniformScaling&&ui}function Ke(Ti){return Ti.originX===St&&Ti.originY===St}function Je(Ti,Ze,ii){var Qe=Ti.lockScalingX,ui=Ti.lockScalingY;return!!(Qe&&ui||!Ze&&(Qe||ui)&&ii||Qe&&Ze==="x"||ui&&Ze==="y")}function hi(Ti,Ze,ii){var Qe="not-allowed",ui=We(Ti,ii),gi="";if(Ze.x!==0&&Ze.y===0?gi="x":Ze.x===0&&Ze.y!==0&&(gi="y"),Je(ii,gi,ui))return Qe;var _i=Re(ii,Ze);return xe[_i]+"-resize"}function oi(Ti,Ze,ii){var Qe="not-allowed";if(Ze.x!==0&&ii.lockSkewingY||Ze.y!==0&&ii.lockSkewingX)return Qe;var ui=Re(ii,Ze)%4;return Te[ui]+"-resize"}function ti(Ti,Ze,ii){return Ti[ii.canvas.altActionKey]?_e.skewCursorStyleHandler(Ti,Ze,ii):_e.scaleCursorStyleHandler(Ti,Ze,ii)}function ai(Ti,Ze,ii){var Qe=Ti[ii.canvas.altActionKey];if(Ze.x===0)return Qe?"skewX":"scaleY";if(Ze.y===0)return Qe?"skewY":"scaleX"}function yi(Ti,Ze,ii){return ii.lockRotation?"not-allowed":Ze.cursorStyle}function di(Ti,Ze,ii,Qe){return{e:Ti,transform:Ze,pointer:{x:ii,y:Qe}}}function bi(Ti){return function(Ze,ii,Qe,ui){var gi=ii.target,_i=gi.getCenterPoint(),Ri=gi.translateToOriginPoint(_i,ii.originX,ii.originY),Ui=Ti(Ze,ii,Qe,ui);return gi.setPositionByOrigin(Ri,ii.originX,ii.originY),Ui}}function vi(Ti,Ze){return function(ii,Qe,ui,gi){var _i=Ze(ii,Qe,ui,gi);return _i&&je(Ti,di(ii,Qe,ui,gi)),_i}}function Pi(Ti,Ze,ii,Qe,ui){var gi=Ti.target,_i=gi.controls[Ti.corner],Ri=gi.canvas.getZoom(),Ui=gi.padding/Ri,ki=gi.toLocalPoint(new e.Point(Qe,ui),Ze,ii);return ki.x>=Ui&&(ki.x-=Ui),ki.x<=-Ui&&(ki.x+=Ui),ki.y>=Ui&&(ki.y-=Ui),ki.y<=Ui&&(ki.y+=Ui),ki.x-=_i.offsetX,ki.y-=_i.offsetY,ki}function xi(Ti){return Ti.flipX!==Ti.flipY}function ni(Ti,Ze,ii,Qe,ui){if(Ti[Ze]!==0){var gi=Ti._getTransformedDimensions()[Qe],_i=ui/gi*Ti[ii];Ti.set(ii,_i)}}function fi(Ti,Ze,ii,Qe){var ui=Ze.target,gi=ui._getTransformedDimensions(0,ui.skewY),_i=Pi(Ze,Ze.originX,Ze.originY,ii,Qe),Ri=Math.abs(_i.x*2)-gi.x,Ui=ui.skewX,ki;Ri<2?ki=0:(ki=ke(Math.atan2(Ri/ui.scaleX,gi.y/ui.scaleY)),Ze.originX===Se&&Ze.originY===Pe&&(ki=-ki),Ze.originX===Ae&&Ze.originY===t&&(ki=-ki),xi(ui)&&(ki=-ki));var Vi=Ui!==ki;if(Vi){var Ii=ui._getTransformedDimensions().y;ui.set("skewX",ki),ni(ui,"skewY","scaleY","y",Ii)}return Vi}function Si(Ti,Ze,ii,Qe){var ui=Ze.target,gi=ui._getTransformedDimensions(ui.skewX,0),_i=Pi(Ze,Ze.originX,Ze.originY,ii,Qe),Ri=Math.abs(_i.y*2)-gi.y,Ui=ui.skewY,ki;Ri<2?ki=0:(ki=ke(Math.atan2(Ri/ui.scaleY,gi.x/ui.scaleX)),Ze.originX===Se&&Ze.originY===Pe&&(ki=-ki),Ze.originX===Ae&&Ze.originY===t&&(ki=-ki),xi(ui)&&(ki=-ki));var Vi=Ui!==ki;if(Vi){var Ii=ui._getTransformedDimensions().x;ui.set("skewY",ki),ni(ui,"skewX","scaleX","x",Ii)}return Vi}function Xe(Ti,Ze,ii,Qe){var ui=Ze.target,gi=ui.skewX,_i,Ri=Ze.originY;if(ui.lockSkewingX)return!1;if(gi===0){var Ui=Pi(Ze,St,St,ii,Qe);Ui.x>0?_i=Se:_i=Ae}else gi>0&&(_i=Ri===t?Se:Ae),gi<0&&(_i=Ri===t?Ae:Se),xi(ui)&&(_i=_i===Se?Ae:Se);Ze.originX=_i;var ki=vi("skewing",bi(fi));return ki(Ti,Ze,ii,Qe)}function Ge(Ti,Ze,ii,Qe){var ui=Ze.target,gi=ui.skewY,_i,Ri=Ze.originX;if(ui.lockSkewingY)return!1;if(gi===0){var Ui=Pi(Ze,St,St,ii,Qe);Ui.y>0?_i=t:_i=Pe}else gi>0&&(_i=Ri===Se?t:Pe),gi<0&&(_i=Ri===Se?Pe:t),xi(ui)&&(_i=_i===t?Pe:t);Ze.originY=_i;var ki=vi("skewing",bi(Si));return ki(Ti,Ze,ii,Qe)}function ze(Ti,Ze,ii,Qe){var ui=Ze,gi=ui.target,_i=gi.translateToOriginPoint(gi.getCenterPoint(),ui.originX,ui.originY);if(gi.lockRotation)return!1;var Ri=Math.atan2(ui.ey-_i.y,ui.ex-_i.x),Ui=Math.atan2(Qe-_i.y,ii-_i.x),ki=ke(Ui-Ri+ui.theta),Vi=!0;if(gi.snapAngle>0){var Ii=gi.snapAngle,$i=gi.snapThreshold||Ii,tn=Math.ceil(ki/Ii)*Ii,en=Math.floor(ki/Ii)*Ii;Math.abs(ki-en)<$i?ki=en:Math.abs(ki-tn)<$i&&(ki=tn)}return ki<0&&(ki=360+ki),ki%=360,Vi=gi.angle!==ki,gi.angle=ki,Vi}function Ve(Ti,Ze,ii,Qe,ui){ui=ui||{};var gi=Ze.target,_i=gi.lockScalingX,Ri=gi.lockScalingY,Ui=ui.by,ki,Vi,Ii,$i,tn=We(Ti,gi),en=Je(gi,Ui,tn),zi,Ji,pn=Ze.gestureScale;if(en)return!1;if(pn)Vi=Ze.scaleX*pn,Ii=Ze.scaleY*pn;else{if(ki=Pi(Ze,Ze.originX,Ze.originY,ii,Qe),zi=Ui!=="y"?De(ki.x):1,Ji=Ui!=="x"?De(ki.y):1,Ze.signX||(Ze.signX=zi),Ze.signY||(Ze.signY=Ji),gi.lockScalingFlip&&(Ze.signX!==zi||Ze.signY!==Ji))return!1;if($i=gi._getTransformedDimensions(),tn&&!Ui){var an=Math.abs(ki.x)+Math.abs(ki.y),kn=Ze.original,xn=Math.abs($i.x*kn.scaleX/gi.scaleX)+Math.abs($i.y*kn.scaleY/gi.scaleY),Tn=an/xn;Vi=kn.scaleX*Tn,Ii=kn.scaleY*Tn}else Vi=Math.abs(ki.x*gi.scaleX/$i.x),Ii=Math.abs(ki.y*gi.scaleY/$i.y);Ke(Ze)&&(Vi*=2,Ii*=2),Ze.signX!==zi&&Ui!=="y"&&(Ze.originX=Ce[Ze.originX],Vi*=-1,Ze.signX=zi),Ze.signY!==Ji&&Ui!=="x"&&(Ze.originY=Ce[Ze.originY],Ii*=-1,Ze.signY=Ji)}var Bn=gi.scaleX,$n=gi.scaleY;return Ui?(Ui==="x"&&gi.set("scaleX",Vi),Ui==="y"&&gi.set("scaleY",Ii)):(!_i&&gi.set("scaleX",Vi),!Ri&&gi.set("scaleY",Ii)),Bn!==gi.scaleX||$n!==gi.scaleY}function ei(Ti,Ze,ii,Qe){return Ve(Ti,Ze,ii,Qe)}function si(Ti,Ze,ii,Qe){return Ve(Ti,Ze,ii,Qe,{by:"x"})}function li(Ti,Ze,ii,Qe){return Ve(Ti,Ze,ii,Qe,{by:"y"})}function ci(Ti,Ze,ii,Qe){return Ti[Ze.target.canvas.altActionKey]?_e.skewHandlerX(Ti,Ze,ii,Qe):_e.scalingY(Ti,Ze,ii,Qe)}function Ci(Ti,Ze,ii,Qe){return Ti[Ze.target.canvas.altActionKey]?_e.skewHandlerY(Ti,Ze,ii,Qe):_e.scalingX(Ti,Ze,ii,Qe)}function Fi(Ti,Ze,ii,Qe){var ui=Ze.target,gi=Pi(Ze,Ze.originX,Ze.originY,ii,Qe),_i=ui.strokeWidth/(ui.strokeUniform?ui.scaleX:1),Ri=Ke(Ze)?2:1,Ui=ui.width,ki=Math.abs(gi.x*Ri/ui.scaleX)-_i;return ui.set("width",Math.max(ki,0)),Ui!==ki}function Oi(Ti,Ze,ii,Qe){var ui=Ze.target,gi=ii-Ze.offsetX,_i=Qe-Ze.offsetY,Ri=!ui.get("lockMovementX")&&ui.left!==gi,Ui=!ui.get("lockMovementY")&&ui.top!==_i;return Ri&&ui.set("left",gi),Ui&&ui.set("top",_i),(Ri||Ui)&&je("moving",di(Ti,Ze,ii,Qe)),Ri||Ui}_e.scaleCursorStyleHandler=hi,_e.skewCursorStyleHandler=oi,_e.scaleSkewCursorStyleHandler=ti,_e.rotationWithSnapping=vi("rotating",bi(ze)),_e.scalingEqually=vi("scaling",bi(ei)),_e.scalingX=vi("scaling",bi(si)),_e.scalingY=vi("scaling",bi(li)),_e.scalingYOrSkewingX=ci,_e.scalingXOrSkewingY=Ci,_e.changeWidth=vi("resizing",bi(Fi)),_e.skewHandlerX=Xe,_e.skewHandlerY=Ge,_e.dragHandler=Oi,_e.scaleOrSkewActionName=ai,_e.rotationStyleHandler=yi,_e.fireEvent=je,_e.wrapWithFixedAnchor=bi,_e.wrapWithFireEvent=vi,_e.getLocalPoint=Pi,e.controlsUtils=_e}(Ie),function(Ee){var e=Ee.fabric||(Ee.fabric={}),xe=e.util.degreesToRadians,Te=e.controlsUtils;function _e(t,Ae,Pe,St,Ce){St=St||{};var ke=this.sizeX||St.cornerSize||Ce.cornerSize,De=this.sizeY||St.cornerSize||Ce.cornerSize,Re=typeof St.transparentCorners<"u"?St.transparentCorners:Ce.transparentCorners,je=Re?"stroke":"fill",We=!Re&&(St.cornerStrokeColor||Ce.cornerStrokeColor),Ke=Ae,Je=Pe,hi;t.save(),t.fillStyle=St.cornerColor||Ce.cornerColor,t.strokeStyle=St.cornerStrokeColor||Ce.cornerStrokeColor,ke>De?(hi=ke,t.scale(1,De/ke),Je=Pe*ke/De):De>ke?(hi=De,t.scale(ke/De,1),Ke=Ae*De/ke):hi=ke,t.lineWidth=1,t.beginPath(),t.arc(Ke,Je,hi/2,0,2*Math.PI,!1),t[je](),We&&t.stroke(),t.restore()}function Se(t,Ae,Pe,St,Ce){St=St||{};var ke=this.sizeX||St.cornerSize||Ce.cornerSize,De=this.sizeY||St.cornerSize||Ce.cornerSize,Re=typeof St.transparentCorners<"u"?St.transparentCorners:Ce.transparentCorners,je=Re?"stroke":"fill",We=!Re&&(St.cornerStrokeColor||Ce.cornerStrokeColor),Ke=ke/2,Je=De/2;t.save(),t.fillStyle=St.cornerColor||Ce.cornerColor,t.strokeStyle=St.cornerStrokeColor||Ce.cornerStrokeColor,t.lineWidth=1,t.translate(Ae,Pe),t.rotate(xe(Ce.angle)),t[je+"Rect"](-Ke,-Je,ke,De),We&&t.strokeRect(-Ke,-Je,ke,De),t.restore()}Te.renderCircleControl=_e,Te.renderSquareControl=Se}(Ie),function(Ee){var e=Ee.fabric||(Ee.fabric={});function xe(Te){for(var _e in Te)this[_e]=Te[_e]}e.Control=xe,e.Control.prototype={visible:!0,actionName:"scale",angle:0,x:0,y:0,offsetX:0,offsetY:0,sizeX:null,sizeY:null,touchSizeX:null,touchSizeY:null,cursorStyle:"crosshair",withConnection:!1,actionHandler:function(){},mouseDownHandler:function(){},mouseUpHandler:function(){},getActionHandler:function(){return this.actionHandler},getMouseDownHandler:function(){return this.mouseDownHandler},getMouseUpHandler:function(){return this.mouseUpHandler},cursorStyleHandler:function(Te,_e){return _e.cursorStyle},getActionName:function(Te,_e){return _e.actionName},getVisibility:function(Te,_e){var Se=Te._controlsVisibility;return Se&&typeof Se[_e]<"u"?Se[_e]:this.visible},setVisibility:function(Te){this.visible=Te},positionHandler:function(Te,_e){var Se=e.util.transformPoint({x:this.x*Te.x+this.offsetX,y:this.y*Te.y+this.offsetY},_e);return Se},calcCornerCoords:function(Te,_e,Se,t,Ae){var Pe,St,Ce,ke,De=Ae?this.touchSizeX:this.sizeX,Re=Ae?this.touchSizeY:this.sizeY;if(De&&Re&&De!==Re){var je=Math.atan2(Re,De),We=Math.sqrt(De*De+Re*Re)/2,Ke=je-e.util.degreesToRadians(Te),Je=Math.PI/2-je-e.util.degreesToRadians(Te);Pe=We*e.util.cos(Ke),St=We*e.util.sin(Ke),Ce=We*e.util.cos(Je),ke=We*e.util.sin(Je)}else{var hi=De&&Re?De:_e;We=hi*.7071067812;var Ke=e.util.degreesToRadians(45-Te);Pe=Ce=We*e.util.cos(Ke),St=ke=We*e.util.sin(Ke)}return{tl:{x:Se-ke,y:t-Ce},tr:{x:Se+Pe,y:t-St},bl:{x:Se-Pe,y:t+St},br:{x:Se+ke,y:t+Ce}}},render:function(Te,_e,Se,t,Ae){switch(t=t||{},t.cornerStyle||Ae.cornerStyle){case"circle":e.controlsUtils.renderCircleControl.call(this,Te,_e,Se,t,Ae);break;default:e.controlsUtils.renderSquareControl.call(this,Te,_e,Se,t,Ae)}}}}(Ie),function(){function Ee(Se,t){var Ae=Se.getAttribute("style"),Pe=Se.getAttribute("offset")||0,St,Ce,ke,De;if(Pe=parseFloat(Pe)/(/%$/.test(Pe)?100:1),Pe=Pe<0?0:Pe>1?1:Pe,Ae){var Re=Ae.split(/\s*;\s*/);for(Re[Re.length-1]===""&&Re.pop(),De=Re.length;De--;){var je=Re[De].split(/\s*:\s*/),We=je[0].trim(),Ke=je[1].trim();We==="stop-color"?St=Ke:We==="stop-opacity"&&(ke=Ke)}}return St||(St=Se.getAttribute("stop-color")||"rgb(0,0,0)"),ke||(ke=Se.getAttribute("stop-opacity")),St=new r.Color(St),Ce=St.getAlpha(),ke=isNaN(parseFloat(ke))?1:parseFloat(ke),ke*=Ce*t,{offset:Pe,color:St.toRgb(),opacity:ke}}function e(Se){return{x1:Se.getAttribute("x1")||0,y1:Se.getAttribute("y1")||0,x2:Se.getAttribute("x2")||"100%",y2:Se.getAttribute("y2")||0}}function xe(Se){return{x1:Se.getAttribute("fx")||Se.getAttribute("cx")||"50%",y1:Se.getAttribute("fy")||Se.getAttribute("cy")||"50%",r1:0,x2:Se.getAttribute("cx")||"50%",y2:Se.getAttribute("cy")||"50%",r2:Se.getAttribute("r")||"50%"}}var Te=r.util.object.clone;r.Gradient=r.util.createClass({offsetX:0,offsetY:0,gradientTransform:null,gradientUnits:"pixels",type:"linear",initialize:function(Se){Se||(Se={}),Se.coords||(Se.coords={});var t,Ae=this;Object.keys(Se).forEach(function(Pe){Ae[Pe]=Se[Pe]}),this.id?this.id+="_"+r.Object.__uid++:this.id=r.Object.__uid++,t={x1:Se.coords.x1||0,y1:Se.coords.y1||0,x2:Se.coords.x2||0,y2:Se.coords.y2||0},this.type==="radial"&&(t.r1=Se.coords.r1||0,t.r2=Se.coords.r2||0),this.coords=t,this.colorStops=Se.colorStops.slice()},addColorStop:function(Se){for(var t in Se){var Ae=new r.Color(Se[t]);this.colorStops.push({offset:parseFloat(t),color:Ae.toRgb(),opacity:Ae.getAlpha()})}return this},toObject:function(Se){var t={type:this.type,coords:this.coords,colorStops:this.colorStops,offsetX:this.offsetX,offsetY:this.offsetY,gradientUnits:this.gradientUnits,gradientTransform:this.gradientTransform?this.gradientTransform.concat():this.gradientTransform};return r.util.populateWithProperties(this,t,Se),t},toSVG:function(Se,Ce){var Ae=Te(this.coords,!0),Pe,St,Ce=Ce||{},ke,De,Re=Te(this.colorStops,!0),je=Ae.r1>Ae.r2,We=this.gradientTransform?this.gradientTransform.concat():r.iMatrix.concat(),Ke=-this.offsetX,Je=-this.offsetY,hi=!!Ce.additionalTransform,oi=this.gradientUnits==="pixels"?"userSpaceOnUse":"objectBoundingBox";if(Re.sort(function(bi,vi){return bi.offset-vi.offset}),oi==="objectBoundingBox"?(Ke/=Se.width,Je/=Se.height):(Ke+=Se.width/2,Je+=Se.height/2),Se.type==="path"&&this.gradientUnits!=="percentage"&&(Ke-=Se.pathOffset.x,Je-=Se.pathOffset.y),We[4]-=Ke,We[5]-=Je,De='id="SVGID_'+this.id+'" gradientUnits="'+oi+'"',De+=' gradientTransform="'+(hi?Ce.additionalTransform+" ":"")+r.util.matrixToSVG(We)+'" ',this.type==="linear"?ke=["<linearGradient ",De,' x1="',Ae.x1,'" y1="',Ae.y1,'" x2="',Ae.x2,'" y2="',Ae.y2,`">
`]:this.type==="radial"&&(ke=["<radialGradient ",De,' cx="',je?Ae.x1:Ae.x2,'" cy="',je?Ae.y1:Ae.y2,'" r="',je?Ae.r1:Ae.r2,'" fx="',je?Ae.x2:Ae.x1,'" fy="',je?Ae.y2:Ae.y1,`">
`]),this.type==="radial"){if(je)for(Re=Re.concat(),Re.reverse(),Pe=0,St=Re.length;Pe<St;Pe++)Re[Pe].offset=1-Re[Pe].offset;var ti=Math.min(Ae.r1,Ae.r2);if(ti>0){var ai=Math.max(Ae.r1,Ae.r2),yi=ti/ai;for(Pe=0,St=Re.length;Pe<St;Pe++)Re[Pe].offset+=yi*(1-Re[Pe].offset)}}for(Pe=0,St=Re.length;Pe<St;Pe++){var di=Re[Pe];ke.push("<stop ",'offset="',di.offset*100+"%",'" style="stop-color:',di.color,typeof di.opacity<"u"?";stop-opacity: "+di.opacity:";",`"/>
`)}return ke.push(this.type==="linear"?`</linearGradient>
`:`</radialGradient>
`),ke.join("")},toLive:function(Se){var t,Ae=r.util.object.clone(this.coords),Pe,St;if(!!this.type){for(this.type==="linear"?t=Se.createLinearGradient(Ae.x1,Ae.y1,Ae.x2,Ae.y2):this.type==="radial"&&(t=Se.createRadialGradient(Ae.x1,Ae.y1,Ae.r1,Ae.x2,Ae.y2,Ae.r2)),Pe=0,St=this.colorStops.length;Pe<St;Pe++){var Ce=this.colorStops[Pe].color,ke=this.colorStops[Pe].opacity,De=this.colorStops[Pe].offset;typeof ke<"u"&&(Ce=new r.Color(Ce).setAlpha(ke).toRgba()),t.addColorStop(De,Ce)}return t}}}),r.util.object.extend(r.Gradient,{fromElement:function(Se,t,Ae,Pe){var St=parseFloat(Ae)/(/%$/.test(Ae)?100:1);St=St<0?0:St>1?1:St,isNaN(St)&&(St=1);var Ce=Se.getElementsByTagName("stop"),ke,De=Se.getAttribute("gradientUnits")==="userSpaceOnUse"?"pixels":"percentage",Re=Se.getAttribute("gradientTransform")||"",je=[],We,Ke,Je=0,hi=0,oi;for(Se.nodeName==="linearGradient"||Se.nodeName==="LINEARGRADIENT"?(ke="linear",We=e(Se)):(ke="radial",We=xe(Se)),Ke=Ce.length;Ke--;)je.push(Ee(Ce[Ke],St));oi=r.parseTransformAttribute(Re),_e(t,We,Pe,De),De==="pixels"&&(Je=-t.left,hi=-t.top);var ti=new r.Gradient({id:Se.getAttribute("id"),type:ke,coords:We,colorStops:je,gradientUnits:De,gradientTransform:oi,offsetX:Je,offsetY:hi});return ti}});function _e(Se,t,Ae,Pe){var St,Ce;Object.keys(t).forEach(function(ke){St=t[ke],St==="Infinity"?Ce=1:St==="-Infinity"?Ce=0:(Ce=parseFloat(t[ke],10),typeof St=="string"&&/^(\d+\.\d+)%|(\d+)%$/.test(St)&&(Ce*=.01,Pe==="pixels"&&((ke==="x1"||ke==="x2"||ke==="r2")&&(Ce*=Ae.viewBoxWidth||Ae.width),(ke==="y1"||ke==="y2")&&(Ce*=Ae.viewBoxHeight||Ae.height)))),t[ke]=Ce})}}(),function(){var Ee=r.util.toFixed;r.Pattern=r.util.createClass({repeat:"repeat",offsetX:0,offsetY:0,crossOrigin:"",patternTransform:null,initialize:function(e,xe){if(e||(e={}),this.id=r.Object.__uid++,this.setOptions(e),!e.source||e.source&&typeof e.source!="string"){xe&&xe(this);return}else{var Te=this;this.source=r.util.createImage(),r.util.loadImage(e.source,function(_e,Se){Te.source=_e,xe&&xe(Te,Se)},null,this.crossOrigin)}},toObject:function(e){var xe=r.Object.NUM_FRACTION_DIGITS,Te,_e;return typeof this.source.src=="string"?Te=this.source.src:typeof this.source=="object"&&this.source.toDataURL&&(Te=this.source.toDataURL()),_e={type:"pattern",source:Te,repeat:this.repeat,crossOrigin:this.crossOrigin,offsetX:Ee(this.offsetX,xe),offsetY:Ee(this.offsetY,xe),patternTransform:this.patternTransform?this.patternTransform.concat():null},r.util.populateWithProperties(this,_e,e),_e},toSVG:function(e){var xe=typeof this.source=="function"?this.source():this.source,Te=xe.width/e.width,_e=xe.height/e.height,Se=this.offsetX/e.width,t=this.offsetY/e.height,Ae="";return(this.repeat==="repeat-x"||this.repeat==="no-repeat")&&(_e=1,t&&(_e+=Math.abs(t))),(this.repeat==="repeat-y"||this.repeat==="no-repeat")&&(Te=1,Se&&(Te+=Math.abs(Se))),xe.src?Ae=xe.src:xe.toDataURL&&(Ae=xe.toDataURL()),'<pattern id="SVGID_'+this.id+'" x="'+Se+'" y="'+t+'" width="'+Te+'" height="'+_e+`">
<image x="0" y="0" width="`+xe.width+'" height="'+xe.height+'" xlink:href="'+Ae+`"></image>
</pattern>
`},setOptions:function(e){for(var xe in e)this[xe]=e[xe]},toLive:function(e){var xe=this.source;return!xe||typeof xe.src<"u"&&(!xe.complete||xe.naturalWidth===0||xe.naturalHeight===0)?"":e.createPattern(xe,this.repeat)}})}(),function(Ee){var e=Ee.fabric||(Ee.fabric={}),xe=e.util.toFixed;if(e.Shadow){e.warn("fabric.Shadow is already defined.");return}e.Shadow=e.util.createClass({color:"rgb(0,0,0)",blur:0,offsetX:0,offsetY:0,affectStroke:!1,includeDefaultValues:!0,nonScaling:!1,initialize:function(Te){typeof Te=="string"&&(Te=this._parseShadow(Te));for(var _e in Te)this[_e]=Te[_e];this.id=e.Object.__uid++},_parseShadow:function(Te){var _e=Te.trim(),Se=e.Shadow.reOffsetsAndBlur.exec(_e)||[],t=_e.replace(e.Shadow.reOffsetsAndBlur,"")||"rgb(0,0,0)";return{color:t.trim(),offsetX:parseFloat(Se[1],10)||0,offsetY:parseFloat(Se[2],10)||0,blur:parseFloat(Se[3],10)||0}},toString:function(){return[this.offsetX,this.offsetY,this.blur,this.color].join("px ")},toSVG:function(Te){var _e=40,Se=40,t=e.Object.NUM_FRACTION_DIGITS,Ae=e.util.rotateVector({x:this.offsetX,y:this.offsetY},e.util.degreesToRadians(-Te.angle)),Pe=20,St=new e.Color(this.color);return Te.width&&Te.height&&(_e=xe((Math.abs(Ae.x)+this.blur)/Te.width,t)*100+Pe,Se=xe((Math.abs(Ae.y)+this.blur)/Te.height,t)*100+Pe),Te.flipX&&(Ae.x*=-1),Te.flipY&&(Ae.y*=-1),'<filter id="SVGID_'+this.id+'" y="-'+Se+'%" height="'+(100+2*Se)+'%" x="-'+_e+'%" width="'+(100+2*_e)+`%" >
	<feGaussianBlur in="SourceAlpha" stdDeviation="`+xe(this.blur?this.blur/2:0,t)+`"></feGaussianBlur>
	<feOffset dx="`+xe(Ae.x,t)+'" dy="'+xe(Ae.y,t)+`" result="oBlur" ></feOffset>
	<feFlood flood-color="`+St.toRgb()+'" flood-opacity="'+St.getAlpha()+`"/>
	<feComposite in2="oBlur" operator="in" />
	<feMerge>
		<feMergeNode></feMergeNode>
		<feMergeNode in="SourceGraphic"></feMergeNode>
	</feMerge>
</filter>
`},toObject:function(){if(this.includeDefaultValues)return{color:this.color,blur:this.blur,offsetX:this.offsetX,offsetY:this.offsetY,affectStroke:this.affectStroke,nonScaling:this.nonScaling};var Te={},_e=e.Shadow.prototype;return["color","blur","offsetX","offsetY","affectStroke","nonScaling"].forEach(function(Se){this[Se]!==_e[Se]&&(Te[Se]=this[Se])},this),Te}}),e.Shadow.reOffsetsAndBlur=/(?:\s|^)(-?\d+(?:\.\d*)?(?:px)?(?:\s?|$))?(-?\d+(?:\.\d*)?(?:px)?(?:\s?|$))?(\d+(?:\.\d*)?(?:px)?)?(?:\s?|$)(?:$|\s)/}(Ie),function(){if(r.StaticCanvas){r.warn("fabric.StaticCanvas is already defined.");return}var Ee=r.util.object.extend,e=r.util.getElementOffset,xe=r.util.removeFromArray,Te=r.util.toFixed,_e=r.util.transformPoint,Se=r.util.invertTransform,t=r.util.getNodeCanvas,Ae=r.util.createCanvasElement,Pe=new Error("Could not initialize `canvas` element");r.StaticCanvas=r.util.createClass(r.CommonMethods,{initialize:function(St,Ce){Ce||(Ce={}),this.renderAndResetBound=this.renderAndReset.bind(this),this.requestRenderAllBound=this.requestRenderAll.bind(this),this._initStatic(St,Ce)},backgroundColor:"",backgroundImage:null,overlayColor:"",overlayImage:null,includeDefaultValues:!0,stateful:!1,renderOnAddRemove:!0,controlsAboveOverlay:!1,allowTouchScrolling:!1,imageSmoothingEnabled:!0,viewportTransform:r.iMatrix.concat(),backgroundVpt:!0,overlayVpt:!0,enableRetinaScaling:!0,vptCoords:{},skipOffscreen:!0,clipPath:void 0,_initStatic:function(St,Ce){var ke=this.requestRenderAllBound;this._objects=[],this._createLowerCanvas(St),this._initOptions(Ce),this.interactive||this._initRetinaScaling(),Ce.overlayImage&&this.setOverlayImage(Ce.overlayImage,ke),Ce.backgroundImage&&this.setBackgroundImage(Ce.backgroundImage,ke),Ce.backgroundColor&&this.setBackgroundColor(Ce.backgroundColor,ke),Ce.overlayColor&&this.setOverlayColor(Ce.overlayColor,ke),this.calcOffset()},_isRetinaScaling:function(){return r.devicePixelRatio>1&&this.enableRetinaScaling},getRetinaScaling:function(){return this._isRetinaScaling()?Math.max(1,r.devicePixelRatio):1},_initRetinaScaling:function(){if(!!this._isRetinaScaling()){var St=r.devicePixelRatio;this.__initRetinaScaling(St,this.lowerCanvasEl,this.contextContainer),this.upperCanvasEl&&this.__initRetinaScaling(St,this.upperCanvasEl,this.contextTop)}},__initRetinaScaling:function(St,Ce,ke){Ce.setAttribute("width",this.width*St),Ce.setAttribute("height",this.height*St),ke.scale(St,St)},calcOffset:function(){return this._offset=e(this.lowerCanvasEl),this},setOverlayImage:function(St,Ce,ke){return this.__setBgOverlayImage("overlayImage",St,Ce,ke)},setBackgroundImage:function(St,Ce,ke){return this.__setBgOverlayImage("backgroundImage",St,Ce,ke)},setOverlayColor:function(St,Ce){return this.__setBgOverlayColor("overlayColor",St,Ce)},setBackgroundColor:function(St,Ce){return this.__setBgOverlayColor("backgroundColor",St,Ce)},__setBgOverlayImage:function(St,Ce,ke,De){return typeof Ce=="string"?r.util.loadImage(Ce,function(Re,je){if(Re){var We=new r.Image(Re,De);this[St]=We,We.canvas=this}ke&&ke(Re,je)},this,De&&De.crossOrigin):(De&&Ce.setOptions(De),this[St]=Ce,Ce&&(Ce.canvas=this),ke&&ke(Ce,!1)),this},__setBgOverlayColor:function(St,Ce,ke){return this[St]=Ce,this._initGradient(Ce,St),this._initPattern(Ce,St,ke),this},_createCanvasElement:function(){var St=Ae();if(!St||(St.style||(St.style={}),typeof St.getContext>"u"))throw Pe;return St},_initOptions:function(St){var Ce=this.lowerCanvasEl;this._setOptions(St),this.width=this.width||parseInt(Ce.width,10)||0,this.height=this.height||parseInt(Ce.height,10)||0,this.lowerCanvasEl.style&&(Ce.width=this.width,Ce.height=this.height,Ce.style.width=this.width+"px",Ce.style.height=this.height+"px",this.viewportTransform=this.viewportTransform.slice())},_createLowerCanvas:function(St){St&&St.getContext?this.lowerCanvasEl=St:this.lowerCanvasEl=r.util.getById(St)||this._createCanvasElement(),r.util.addClass(this.lowerCanvasEl,"lower-canvas"),this._originalCanvasStyle=this.lowerCanvasEl.style,this.interactive&&this._applyCanvasStyle(this.lowerCanvasEl),this.contextContainer=this.lowerCanvasEl.getContext("2d")},getWidth:function(){return this.width},getHeight:function(){return this.height},setWidth:function(St,Ce){return this.setDimensions({width:St},Ce)},setHeight:function(St,Ce){return this.setDimensions({height:St},Ce)},setDimensions:function(St,Ce){var ke;Ce=Ce||{};for(var De in St)ke=St[De],Ce.cssOnly||(this._setBackstoreDimension(De,St[De]),ke+="px",this.hasLostContext=!0),Ce.backstoreOnly||this._setCssDimension(De,ke);return this._isCurrentlyDrawing&&this.freeDrawingBrush&&this.freeDrawingBrush._setBrushStyles(this.contextTop),this._initRetinaScaling(),this.calcOffset(),Ce.cssOnly||this.requestRenderAll(),this},_setBackstoreDimension:function(St,Ce){return this.lowerCanvasEl[St]=Ce,this.upperCanvasEl&&(this.upperCanvasEl[St]=Ce),this.cacheCanvasEl&&(this.cacheCanvasEl[St]=Ce),this[St]=Ce,this},_setCssDimension:function(St,Ce){return this.lowerCanvasEl.style[St]=Ce,this.upperCanvasEl&&(this.upperCanvasEl.style[St]=Ce),this.wrapperEl&&(this.wrapperEl.style[St]=Ce),this},getZoom:function(){return this.viewportTransform[0]},setViewportTransform:function(St){var Ce=this._activeObject,ke=this.backgroundImage,De=this.overlayImage,Re,je,We;for(this.viewportTransform=St,je=0,We=this._objects.length;je<We;je++)Re=this._objects[je],Re.group||Re.setCoords(!0);return Ce&&Ce.setCoords(),ke&&ke.setCoords(!0),De&&De.setCoords(!0),this.calcViewportBoundaries(),this.renderOnAddRemove&&this.requestRenderAll(),this},zoomToPoint:function(St,Ce){var ke=St,De=this.viewportTransform.slice(0);St=_e(St,Se(this.viewportTransform)),De[0]=Ce,De[3]=Ce;var Re=_e(St,De);return De[4]+=ke.x-Re.x,De[5]+=ke.y-Re.y,this.setViewportTransform(De)},setZoom:function(St){return this.zoomToPoint(new r.Point(0,0),St),this},absolutePan:function(St){var Ce=this.viewportTransform.slice(0);return Ce[4]=-St.x,Ce[5]=-St.y,this.setViewportTransform(Ce)},relativePan:function(St){return this.absolutePan(new r.Point(-St.x-this.viewportTransform[4],-St.y-this.viewportTransform[5]))},getElement:function(){return this.lowerCanvasEl},_onObjectAdded:function(St){this.stateful&&St.setupState(),St._set("canvas",this),St.setCoords(),this.fire("object:added",{target:St}),St.fire("added")},_onObjectRemoved:function(St){this.fire("object:removed",{target:St}),St.fire("removed"),delete St.canvas},clearContext:function(St){return St.clearRect(0,0,this.width,this.height),this},getContext:function(){return this.contextContainer},clear:function(){return this.remove.apply(this,this.getObjects()),this.backgroundImage=null,this.overlayImage=null,this.backgroundColor="",this.overlayColor="",this._hasITextHandlers&&(this.off("mouse:up",this._mouseUpITextHandler),this._iTextInstances=null,this._hasITextHandlers=!1),this.clearContext(this.contextContainer),this.fire("canvas:cleared"),this.renderOnAddRemove&&this.requestRenderAll(),this},renderAll:function(){var St=this.contextContainer;return this.renderCanvas(St,this._objects),this},renderAndReset:function(){this.isRendering=0,this.renderAll()},requestRenderAll:function(){return this.isRendering||(this.isRendering=r.util.requestAnimFrame(this.renderAndResetBound)),this},calcViewportBoundaries:function(){var St={},Ce=this.width,ke=this.height,De=Se(this.viewportTransform);return St.tl=_e({x:0,y:0},De),St.br=_e({x:Ce,y:ke},De),St.tr=new r.Point(St.br.x,St.tl.y),St.bl=new r.Point(St.tl.x,St.br.y),this.vptCoords=St,St},cancelRequestedRender:function(){this.isRendering&&(r.util.cancelAnimFrame(this.isRendering),this.isRendering=0)},renderCanvas:function(St,Ce){var ke=this.viewportTransform,De=this.clipPath;this.cancelRequestedRender(),this.calcViewportBoundaries(),this.clearContext(St),r.util.setImageSmoothing(St,this.imageSmoothingEnabled),this.fire("before:render",{ctx:St}),this._renderBackground(St),St.save(),St.transform(ke[0],ke[1],ke[2],ke[3],ke[4],ke[5]),this._renderObjects(St,Ce),St.restore(),!this.controlsAboveOverlay&&this.interactive&&this.drawControls(St),De&&(De.canvas=this,De.shouldCache(),De._transformDone=!0,De.renderCache({forClipping:!0}),this.drawClipPathOnCanvas(St)),this._renderOverlay(St),this.controlsAboveOverlay&&this.interactive&&this.drawControls(St),this.fire("after:render",{ctx:St})},drawClipPathOnCanvas:function(St){var Ce=this.viewportTransform,ke=this.clipPath;St.save(),St.transform(Ce[0],Ce[1],Ce[2],Ce[3],Ce[4],Ce[5]),St.globalCompositeOperation="destination-in",ke.transform(St),St.scale(1/ke.zoomX,1/ke.zoomY),St.drawImage(ke._cacheCanvas,-ke.cacheTranslationX,-ke.cacheTranslationY),St.restore()},_renderObjects:function(St,Ce){var ke,De;for(ke=0,De=Ce.length;ke<De;++ke)Ce[ke]&&Ce[ke].render(St)},_renderBackgroundOrOverlay:function(St,Ce){var ke=this[Ce+"Color"],De=this[Ce+"Image"],Re=this.viewportTransform,je=this[Ce+"Vpt"];if(!(!ke&&!De)){if(ke){St.save(),St.beginPath(),St.moveTo(0,0),St.lineTo(this.width,0),St.lineTo(this.width,this.height),St.lineTo(0,this.height),St.closePath(),St.fillStyle=ke.toLive?ke.toLive(St,this):ke,je&&St.transform(Re[0],Re[1],Re[2],Re[3],Re[4],Re[5]),St.transform(1,0,0,1,ke.offsetX||0,ke.offsetY||0);var We=ke.gradientTransform||ke.patternTransform;We&&St.transform(We[0],We[1],We[2],We[3],We[4],We[5]),St.fill(),St.restore()}De&&(St.save(),je&&St.transform(Re[0],Re[1],Re[2],Re[3],Re[4],Re[5]),De.render(St),St.restore())}},_renderBackground:function(St){this._renderBackgroundOrOverlay(St,"background")},_renderOverlay:function(St){this._renderBackgroundOrOverlay(St,"overlay")},getCenter:function(){return{top:this.height/2,left:this.width/2}},getCenterPoint:function(){return new r.Point(this.width/2,this.height/2)},centerObjectH:function(St){return this._centerObject(St,new r.Point(this.getCenterPoint().x,St.getCenterPoint().y))},centerObjectV:function(St){return this._centerObject(St,new r.Point(St.getCenterPoint().x,this.getCenterPoint().y))},centerObject:function(St){var Ce=this.getCenterPoint();return this._centerObject(St,Ce)},viewportCenterObject:function(St){var Ce=this.getVpCenter();return this._centerObject(St,Ce)},viewportCenterObjectH:function(St){var Ce=this.getVpCenter();return this._centerObject(St,new r.Point(Ce.x,St.getCenterPoint().y)),this},viewportCenterObjectV:function(St){var Ce=this.getVpCenter();return this._centerObject(St,new r.Point(St.getCenterPoint().x,Ce.y))},getVpCenter:function(){var St=this.getCenterPoint(),Ce=Se(this.viewportTransform);return _e(St,Ce)},_centerObject:function(St,Ce){return St.setPositionByOrigin(Ce,"center","center"),St.setCoords(),this.renderOnAddRemove&&this.requestRenderAll(),this},toDatalessJSON:function(St){return this.toDatalessObject(St)},toObject:function(St){return this._toObjectMethod("toObject",St)},toDatalessObject:function(St){return this._toObjectMethod("toDatalessObject",St)},_toObjectMethod:function(St,Ce){var ke=this.clipPath,De={version:r.version,objects:this._toObjects(St,Ce)};return ke&&!ke.excludeFromExport&&(De.clipPath=this._toObject(this.clipPath,St,Ce)),Ee(De,this.__serializeBgOverlay(St,Ce)),r.util.populateWithProperties(this,De,Ce),De},_toObjects:function(St,Ce){return this._objects.filter(function(ke){return!ke.excludeFromExport}).map(function(ke){return this._toObject(ke,St,Ce)},this)},_toObject:function(St,Ce,ke){var De;this.includeDefaultValues||(De=St.includeDefaultValues,St.includeDefaultValues=!1);var Re=St[Ce](ke);return this.includeDefaultValues||(St.includeDefaultValues=De),Re},__serializeBgOverlay:function(St,Ce){var ke={},De=this.backgroundImage,Re=this.overlayImage,je=this.backgroundColor,We=this.overlayColor;return je&&je.toObject?je.excludeFromExport||(ke.background=je.toObject(Ce)):je&&(ke.background=je),We&&We.toObject?We.excludeFromExport||(ke.overlay=We.toObject(Ce)):We&&(ke.overlay=We),De&&!De.excludeFromExport&&(ke.backgroundImage=this._toObject(De,St,Ce)),Re&&!Re.excludeFromExport&&(ke.overlayImage=this._toObject(Re,St,Ce)),ke},svgViewportTransformation:!0,toSVG:function(St,Ce){St||(St={}),St.reviver=Ce;var ke=[];return this._setSVGPreamble(ke,St),this._setSVGHeader(ke,St),this.clipPath&&ke.push('<g clip-path="url(#'+this.clipPath.clipPathId+`)" >
`),this._setSVGBgOverlayColor(ke,"background"),this._setSVGBgOverlayImage(ke,"backgroundImage",Ce),this._setSVGObjects(ke,Ce),this.clipPath&&ke.push(`</g>
`),this._setSVGBgOverlayColor(ke,"overlay"),this._setSVGBgOverlayImage(ke,"overlayImage",Ce),ke.push("</svg>"),ke.join("")},_setSVGPreamble:function(St,Ce){Ce.suppressPreamble||St.push('<?xml version="1.0" encoding="',Ce.encoding||"UTF-8",`" standalone="no" ?>
`,'<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" ',`"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
`)},_setSVGHeader:function(St,Ce){var ke=Ce.width||this.width,De=Ce.height||this.height,Re,je='viewBox="0 0 '+this.width+" "+this.height+'" ',We=r.Object.NUM_FRACTION_DIGITS;Ce.viewBox?je='viewBox="'+Ce.viewBox.x+" "+Ce.viewBox.y+" "+Ce.viewBox.width+" "+Ce.viewBox.height+'" ':this.svgViewportTransformation&&(Re=this.viewportTransform,je='viewBox="'+Te(-Re[4]/Re[0],We)+" "+Te(-Re[5]/Re[3],We)+" "+Te(this.width/Re[0],We)+" "+Te(this.height/Re[3],We)+'" '),St.push("<svg ",'xmlns="http://www.w3.org/2000/svg" ','xmlns:xlink="http://www.w3.org/1999/xlink" ','version="1.1" ','width="',ke,'" ','height="',De,'" ',je,`xml:space="preserve">
`,"<desc>Created with Fabric.js ",r.version,`</desc>
`,`<defs>
`,this.createSVGFontFacesMarkup(),this.createSVGRefElementsMarkup(),this.createSVGClipPathMarkup(Ce),`</defs>
`)},createSVGClipPathMarkup:function(St){var Ce=this.clipPath;return Ce?(Ce.clipPathId="CLIPPATH_"+r.Object.__uid++,'<clipPath id="'+Ce.clipPathId+`" >
`+this.clipPath.toClipPathSVG(St.reviver)+`</clipPath>
`):""},createSVGRefElementsMarkup:function(){var St=this,Ce=["background","overlay"].map(function(ke){var De=St[ke+"Color"];if(De&&De.toLive){var Re=St[ke+"Vpt"],je=St.viewportTransform,We={width:St.width/(Re?je[0]:1),height:St.height/(Re?je[3]:1)};return De.toSVG(We,{additionalTransform:Re?r.util.matrixToSVG(je):""})}});return Ce.join("")},createSVGFontFacesMarkup:function(){var St="",Ce={},ke,De,Re,je,We,Ke,Je,hi,oi,ti=r.fontPaths,ai=[];for(this._objects.forEach(function di(bi){ai.push(bi),bi._objects&&bi._objects.forEach(di)}),hi=0,oi=ai.length;hi<oi;hi++)if(ke=ai[hi],De=ke.fontFamily,!(ke.type.indexOf("text")===-1||Ce[De]||!ti[De])&&(Ce[De]=!0,!!ke.styles)){Re=ke.styles;for(We in Re){je=Re[We];for(Je in je)Ke=je[Je],De=Ke.fontFamily,!Ce[De]&&ti[De]&&(Ce[De]=!0)}}for(var yi in Ce)St+=[`		@font-face {
`,"			font-family: '",yi,`';
`,"			src: url('",ti[yi],`');
`,`		}
`].join("");return St&&(St=['	<style type="text/css">',`<![CDATA[
`,St,"]]>",`</style>
`].join("")),St},_setSVGObjects:function(St,Ce){var ke,De,Re,je=this._objects;for(De=0,Re=je.length;De<Re;De++)ke=je[De],!ke.excludeFromExport&&this._setSVGObject(St,ke,Ce)},_setSVGObject:function(St,Ce,ke){St.push(Ce.toSVG(ke))},_setSVGBgOverlayImage:function(St,Ce,ke){this[Ce]&&!this[Ce].excludeFromExport&&this[Ce].toSVG&&St.push(this[Ce].toSVG(ke))},_setSVGBgOverlayColor:function(St,Ce){var ke=this[Ce+"Color"],De=this.viewportTransform,Re=this.width,je=this.height;if(!!ke)if(ke.toLive){var We=ke.repeat,Ke=r.util.invertTransform(De),Je=this[Ce+"Vpt"],hi=Je?r.util.matrixToSVG(Ke):"";St.push('<rect transform="'+hi+" translate(",Re/2,",",je/2,')"',' x="',ke.offsetX-Re/2,'" y="',ke.offsetY-je/2,'" ','width="',We==="repeat-y"||We==="no-repeat"?ke.source.width:Re,'" height="',We==="repeat-x"||We==="no-repeat"?ke.source.height:je,'" fill="url(#SVGID_'+ke.id+')"',`></rect>
`)}else St.push('<rect x="0" y="0" width="100%" height="100%" ','fill="',ke,'"',`></rect>
`)},sendToBack:function(St){if(!St)return this;var Ce=this._activeObject,ke,De,Re;if(St===Ce&&St.type==="activeSelection")for(Re=Ce._objects,ke=Re.length;ke--;)De=Re[ke],xe(this._objects,De),this._objects.unshift(De);else xe(this._objects,St),this._objects.unshift(St);return this.renderOnAddRemove&&this.requestRenderAll(),this},bringToFront:function(St){if(!St)return this;var Ce=this._activeObject,ke,De,Re;if(St===Ce&&St.type==="activeSelection")for(Re=Ce._objects,ke=0;ke<Re.length;ke++)De=Re[ke],xe(this._objects,De),this._objects.push(De);else xe(this._objects,St),this._objects.push(St);return this.renderOnAddRemove&&this.requestRenderAll(),this},sendBackwards:function(St,Ce){if(!St)return this;var ke=this._activeObject,De,Re,je,We,Ke,Je=0;if(St===ke&&St.type==="activeSelection")for(Ke=ke._objects,De=0;De<Ke.length;De++)Re=Ke[De],je=this._objects.indexOf(Re),je>0+Je&&(We=je-1,xe(this._objects,Re),this._objects.splice(We,0,Re)),Je++;else je=this._objects.indexOf(St),je!==0&&(We=this._findNewLowerIndex(St,je,Ce),xe(this._objects,St),this._objects.splice(We,0,St));return this.renderOnAddRemove&&this.requestRenderAll(),this},_findNewLowerIndex:function(St,Ce,ke){var De,Re;if(ke)for(De=Ce,Re=Ce-1;Re>=0;--Re){var je=St.intersectsWithObject(this._objects[Re])||St.isContainedWithinObject(this._objects[Re])||this._objects[Re].isContainedWithinObject(St);if(je){De=Re;break}}else De=Ce-1;return De},bringForward:function(St,Ce){if(!St)return this;var ke=this._activeObject,De,Re,je,We,Ke,Je=0;if(St===ke&&St.type==="activeSelection")for(Ke=ke._objects,De=Ke.length;De--;)Re=Ke[De],je=this._objects.indexOf(Re),je<this._objects.length-1-Je&&(We=je+1,xe(this._objects,Re),this._objects.splice(We,0,Re)),Je++;else je=this._objects.indexOf(St),je!==this._objects.length-1&&(We=this._findNewUpperIndex(St,je,Ce),xe(this._objects,St),this._objects.splice(We,0,St));return this.renderOnAddRemove&&this.requestRenderAll(),this},_findNewUpperIndex:function(St,Ce,ke){var De,Re,je;if(ke)for(De=Ce,Re=Ce+1,je=this._objects.length;Re<je;++Re){var We=St.intersectsWithObject(this._objects[Re])||St.isContainedWithinObject(this._objects[Re])||this._objects[Re].isContainedWithinObject(St);if(We){De=Re;break}}else De=Ce+1;return De},moveTo:function(St,Ce){return xe(this._objects,St),this._objects.splice(Ce,0,St),this.renderOnAddRemove&&this.requestRenderAll()},dispose:function(){return this.isRendering&&(r.util.cancelAnimFrame(this.isRendering),this.isRendering=0),this.forEachObject(function(St){St.dispose&&St.dispose()}),this._objects=[],this.backgroundImage&&this.backgroundImage.dispose&&this.backgroundImage.dispose(),this.backgroundImage=null,this.overlayImage&&this.overlayImage.dispose&&this.overlayImage.dispose(),this.overlayImage=null,this._iTextInstances=null,this.contextContainer=null,this.lowerCanvasEl.classList.remove("lower-canvas"),r.util.setStyle(this.lowerCanvasEl,this._originalCanvasStyle),delete this._originalCanvasStyle,this.lowerCanvasEl.setAttribute("width",this.width),this.lowerCanvasEl.setAttribute("height",this.height),r.util.cleanUpJsdomNode(this.lowerCanvasEl),this.lowerCanvasEl=void 0,this},toString:function(){return"#<fabric.Canvas ("+this.complexity()+"): { objects: "+this._objects.length+" }>"}}),Ee(r.StaticCanvas.prototype,r.Observable),Ee(r.StaticCanvas.prototype,r.Collection),Ee(r.StaticCanvas.prototype,r.DataURLExporter),Ee(r.StaticCanvas,{EMPTY_JSON:'{"objects": [], "background": "white"}',supports:function(St){var Ce=Ae();if(!Ce||!Ce.getContext)return null;var ke=Ce.getContext("2d");if(!ke)return null;switch(St){case"setLineDash":return typeof ke.setLineDash<"u";default:return null}}}),r.StaticCanvas.prototype.toJSON=r.StaticCanvas.prototype.toObject,r.isLikelyNode&&(r.StaticCanvas.prototype.createPNGStream=function(){var St=t(this.lowerCanvasEl);return St&&St.createPNGStream()},r.StaticCanvas.prototype.createJPEGStream=function(St){var Ce=t(this.lowerCanvasEl);return Ce&&Ce.createJPEGStream(St)})}(),r.BaseBrush=r.util.createClass({color:"rgb(0, 0, 0)",width:1,shadow:null,strokeLineCap:"round",strokeLineJoin:"round",strokeMiterLimit:10,strokeDashArray:null,limitedToCanvasSize:!1,_setBrushStyles:function(Ee){Ee.strokeStyle=this.color,Ee.lineWidth=this.width,Ee.lineCap=this.strokeLineCap,Ee.miterLimit=this.strokeMiterLimit,Ee.lineJoin=this.strokeLineJoin,Ee.setLineDash(this.strokeDashArray||[])},_saveAndTransform:function(Ee){var e=this.canvas.viewportTransform;Ee.save(),Ee.transform(e[0],e[1],e[2],e[3],e[4],e[5])},_setShadow:function(){if(!!this.shadow){var Ee=this.canvas,e=this.shadow,xe=Ee.contextTop,Te=Ee.getZoom();Ee&&Ee._isRetinaScaling()&&(Te*=r.devicePixelRatio),xe.shadowColor=e.color,xe.shadowBlur=e.blur*Te,xe.shadowOffsetX=e.offsetX*Te,xe.shadowOffsetY=e.offsetY*Te}},needsFullRender:function(){var Ee=new r.Color(this.color);return Ee.getAlpha()<1||!!this.shadow},_resetShadow:function(){var Ee=this.canvas.contextTop;Ee.shadowColor="",Ee.shadowBlur=Ee.shadowOffsetX=Ee.shadowOffsetY=0},_isOutSideCanvas:function(Ee){return Ee.x<0||Ee.x>this.canvas.getWidth()||Ee.y<0||Ee.y>this.canvas.getHeight()}}),function(){r.PencilBrush=r.util.createClass(r.BaseBrush,{decimate:.4,drawStraightLine:!1,straightLineKey:"shiftKey",initialize:function(Ee){this.canvas=Ee,this._points=[]},needsFullRender:function(){return this.callSuper("needsFullRender")||this._hasStraightLine},_drawSegment:function(Ee,e,xe){var Te=e.midPointFrom(xe);return Ee.quadraticCurveTo(e.x,e.y,Te.x,Te.y),Te},onMouseDown:function(Ee,e){!this.canvas._isMainEvent(e.e)||(this.drawStraightLine=e.e[this.straightLineKey],this._prepareForDrawing(Ee),this._captureDrawingPath(Ee),this._render())},onMouseMove:function(Ee,e){if(!!this.canvas._isMainEvent(e.e)&&(this.drawStraightLine=e.e[this.straightLineKey],!(this.limitedToCanvasSize===!0&&this._isOutSideCanvas(Ee))&&this._captureDrawingPath(Ee)&&this._points.length>1))if(this.needsFullRender())this.canvas.clearContext(this.canvas.contextTop),this._render();else{var xe=this._points,Te=xe.length,_e=this.canvas.contextTop;this._saveAndTransform(_e),this.oldEnd&&(_e.beginPath(),_e.moveTo(this.oldEnd.x,this.oldEnd.y)),this.oldEnd=this._drawSegment(_e,xe[Te-2],xe[Te-1],!0),_e.stroke(),_e.restore()}},onMouseUp:function(Ee){return this.canvas._isMainEvent(Ee.e)?(this.drawStraightLine=!1,this.oldEnd=void 0,this._finalizeAndAddPath(),!1):!0},_prepareForDrawing:function(Ee){var e=new r.Point(Ee.x,Ee.y);this._reset(),this._addPoint(e),this.canvas.contextTop.moveTo(e.x,e.y)},_addPoint:function(Ee){return this._points.length>1&&Ee.eq(this._points[this._points.length-1])?!1:(this.drawStraightLine&&this._points.length>1&&(this._hasStraightLine=!0,this._points.pop()),this._points.push(Ee),!0)},_reset:function(){this._points=[],this._setBrushStyles(this.canvas.contextTop),this._setShadow(),this._hasStraightLine=!1},_captureDrawingPath:function(Ee){var e=new r.Point(Ee.x,Ee.y);return this._addPoint(e)},_render:function(Ee){var e,xe,Te=this._points[0],_e=this._points[1];if(Ee=Ee||this.canvas.contextTop,this._saveAndTransform(Ee),Ee.beginPath(),this._points.length===2&&Te.x===_e.x&&Te.y===_e.y){var Se=this.width/1e3;Te=new r.Point(Te.x,Te.y),_e=new r.Point(_e.x,_e.y),Te.x-=Se,_e.x+=Se}for(Ee.moveTo(Te.x,Te.y),e=1,xe=this._points.length;e<xe;e++)this._drawSegment(Ee,Te,_e),Te=this._points[e],_e=this._points[e+1];Ee.lineTo(Te.x,Te.y),Ee.stroke(),Ee.restore()},convertPointsToSVGPath:function(Ee){var e=this.width/1e3;return r.util.getSmoothPathFromPoints(Ee,e)},_isEmptySVGPath:function(Ee){var e=r.util.joinPath(Ee);return e==="M 0 0 Q 0 0 0 0 L 0 0"},createPath:function(Ee){var e=new r.Path(Ee,{fill:null,stroke:this.color,strokeWidth:this.width,strokeLineCap:this.strokeLineCap,strokeMiterLimit:this.strokeMiterLimit,strokeLineJoin:this.strokeLineJoin,strokeDashArray:this.strokeDashArray});return this.shadow&&(this.shadow.affectStroke=!0,e.shadow=new r.Shadow(this.shadow)),e},decimatePoints:function(Ee,e){if(Ee.length<=2)return Ee;var xe=this.canvas.getZoom(),Te=Math.pow(e/xe,2),_e,Se=Ee.length-1,t=Ee[0],Ae=[t],Pe;for(_e=1;_e<Se-1;_e++)Pe=Math.pow(t.x-Ee[_e].x,2)+Math.pow(t.y-Ee[_e].y,2),Pe>=Te&&(t=Ee[_e],Ae.push(t));return Ae.push(Ee[Se]),Ae},_finalizeAndAddPath:function(){var Ee=this.canvas.contextTop;Ee.closePath(),this.decimate&&(this._points=this.decimatePoints(this._points,this.decimate));var e=this.convertPointsToSVGPath(this._points);if(this._isEmptySVGPath(e)){this.canvas.requestRenderAll();return}var xe=this.createPath(e);this.canvas.clearContext(this.canvas.contextTop),this.canvas.fire("before:path:created",{path:xe}),this.canvas.add(xe),this.canvas.requestRenderAll(),xe.setCoords(),this._resetShadow(),this.canvas.fire("path:created",{path:xe})}})}(),r.CircleBrush=r.util.createClass(r.BaseBrush,{width:10,initialize:function(Ee){this.canvas=Ee,this.points=[]},drawDot:function(Ee){var e=this.addPoint(Ee),xe=this.canvas.contextTop;this._saveAndTransform(xe),this.dot(xe,e),xe.restore()},dot:function(Ee,e){Ee.fillStyle=e.fill,Ee.beginPath(),Ee.arc(e.x,e.y,e.radius,0,Math.PI*2,!1),Ee.closePath(),Ee.fill()},onMouseDown:function(Ee){this.points.length=0,this.canvas.clearContext(this.canvas.contextTop),this._setShadow(),this.drawDot(Ee)},_render:function(){var Ee=this.canvas.contextTop,e,xe,Te=this.points;for(this._saveAndTransform(Ee),e=0,xe=Te.length;e<xe;e++)this.dot(Ee,Te[e]);Ee.restore()},onMouseMove:function(Ee){this.limitedToCanvasSize===!0&&this._isOutSideCanvas(Ee)||(this.needsFullRender()?(this.canvas.clearContext(this.canvas.contextTop),this.addPoint(Ee),this._render()):this.drawDot(Ee))},onMouseUp:function(){var Ee=this.canvas.renderOnAddRemove,e,xe;this.canvas.renderOnAddRemove=!1;var Te=[];for(e=0,xe=this.points.length;e<xe;e++){var _e=this.points[e],Se=new r.Circle({radius:_e.radius,left:_e.x,top:_e.y,originX:"center",originY:"center",fill:_e.fill});this.shadow&&(Se.shadow=new r.Shadow(this.shadow)),Te.push(Se)}var t=new r.Group(Te);t.canvas=this.canvas,this.canvas.fire("before:path:created",{path:t}),this.canvas.add(t),this.canvas.fire("path:created",{path:t}),this.canvas.clearContext(this.canvas.contextTop),this._resetShadow(),this.canvas.renderOnAddRemove=Ee,this.canvas.requestRenderAll()},addPoint:function(Ee){var e=new r.Point(Ee.x,Ee.y),xe=r.util.getRandomInt(Math.max(0,this.width-20),this.width+20)/2,Te=new r.Color(this.color).setAlpha(r.util.getRandomInt(0,100)/100).toRgba();return e.radius=xe,e.fill=Te,this.points.push(e),e}}),r.SprayBrush=r.util.createClass(r.BaseBrush,{width:10,density:20,dotWidth:1,dotWidthVariance:1,randomOpacity:!1,optimizeOverlapping:!0,initialize:function(Ee){this.canvas=Ee,this.sprayChunks=[]},onMouseDown:function(Ee){this.sprayChunks.length=0,this.canvas.clearContext(this.canvas.contextTop),this._setShadow(),this.addSprayChunk(Ee),this.render(this.sprayChunkPoints)},onMouseMove:function(Ee){this.limitedToCanvasSize===!0&&this._isOutSideCanvas(Ee)||(this.addSprayChunk(Ee),this.render(this.sprayChunkPoints))},onMouseUp:function(){var Ee=this.canvas.renderOnAddRemove;this.canvas.renderOnAddRemove=!1;for(var e=[],xe=0,Te=this.sprayChunks.length;xe<Te;xe++)for(var _e=this.sprayChunks[xe],Se=0,t=_e.length;Se<t;Se++){var Ae=new r.Rect({width:_e[Se].width,height:_e[Se].width,left:_e[Se].x+1,top:_e[Se].y+1,originX:"center",originY:"center",fill:this.color});e.push(Ae)}this.optimizeOverlapping&&(e=this._getOptimizedRects(e));var Pe=new r.Group(e);this.shadow&&Pe.set("shadow",new r.Shadow(this.shadow)),this.canvas.fire("before:path:created",{path:Pe}),this.canvas.add(Pe),this.canvas.fire("path:created",{path:Pe}),this.canvas.clearContext(this.canvas.contextTop),this._resetShadow(),this.canvas.renderOnAddRemove=Ee,this.canvas.requestRenderAll()},_getOptimizedRects:function(Ee){var e={},xe,Te,_e;for(Te=0,_e=Ee.length;Te<_e;Te++)xe=Ee[Te].left+""+Ee[Te].top,e[xe]||(e[xe]=Ee[Te]);var Se=[];for(xe in e)Se.push(e[xe]);return Se},render:function(Ee){var e=this.canvas.contextTop,xe,Te;for(e.fillStyle=this.color,this._saveAndTransform(e),xe=0,Te=Ee.length;xe<Te;xe++){var _e=Ee[xe];typeof _e.opacity<"u"&&(e.globalAlpha=_e.opacity),e.fillRect(_e.x,_e.y,_e.width,_e.width)}e.restore()},_render:function(){var Ee=this.canvas.contextTop,e,xe;for(Ee.fillStyle=this.color,this._saveAndTransform(Ee),e=0,xe=this.sprayChunks.length;e<xe;e++)this.render(this.sprayChunks[e]);Ee.restore()},addSprayChunk:function(Ee){this.sprayChunkPoints=[];var e,xe,Te,_e=this.width/2,Se;for(Se=0;Se<this.density;Se++){e=r.util.getRandomInt(Ee.x-_e,Ee.x+_e),xe=r.util.getRandomInt(Ee.y-_e,Ee.y+_e),this.dotWidthVariance?Te=r.util.getRandomInt(Math.max(1,this.dotWidth-this.dotWidthVariance),this.dotWidth+this.dotWidthVariance):Te=this.dotWidth;var t=new r.Point(e,xe);t.width=Te,this.randomOpacity&&(t.opacity=r.util.getRandomInt(0,100)/100),this.sprayChunkPoints.push(t)}this.sprayChunks.push(this.sprayChunkPoints)}}),r.PatternBrush=r.util.createClass(r.PencilBrush,{getPatternSrc:function(){var Ee=20,e=5,xe=r.util.createCanvasElement(),Te=xe.getContext("2d");return xe.width=xe.height=Ee+e,Te.fillStyle=this.color,Te.beginPath(),Te.arc(Ee/2,Ee/2,Ee/2,0,Math.PI*2,!1),Te.closePath(),Te.fill(),xe},getPatternSrcFunction:function(){return String(this.getPatternSrc).replace("this.color",'"'+this.color+'"')},getPattern:function(Ee){return Ee.createPattern(this.source||this.getPatternSrc(),"repeat")},_setBrushStyles:function(Ee){this.callSuper("_setBrushStyles",Ee),Ee.strokeStyle=this.getPattern(Ee)},createPath:function(Ee){var e=this.callSuper("createPath",Ee),xe=e._getLeftTopCoords().scalarAdd(e.strokeWidth/2);return e.stroke=new r.Pattern({source:this.source||this.getPatternSrcFunction(),offsetX:-xe.x,offsetY:-xe.y}),e}}),function(){var Ee=r.util.getPointer,e=r.util.degreesToRadians,xe=r.util.isTouchEvent;r.Canvas=r.util.createClass(r.StaticCanvas,{initialize:function(_e,Se){Se||(Se={}),this.renderAndResetBound=this.renderAndReset.bind(this),this.requestRenderAllBound=this.requestRenderAll.bind(this),this._initStatic(_e,Se),this._initInteractive(),this._createCacheCanvas()},uniformScaling:!0,uniScaleKey:"shiftKey",centeredScaling:!1,centeredRotation:!1,centeredKey:"altKey",altActionKey:"shiftKey",interactive:!0,selection:!0,selectionKey:"shiftKey",altSelectionKey:null,selectionColor:"rgba(100, 100, 255, 0.3)",selectionDashArray:[],selectionBorderColor:"rgba(255, 255, 255, 0.3)",selectionLineWidth:1,selectionFullyContained:!1,hoverCursor:"move",moveCursor:"move",defaultCursor:"default",freeDrawingCursor:"crosshair",notAllowedCursor:"not-allowed",containerClass:"canvas-container",perPixelTargetFind:!1,targetFindTolerance:0,skipTargetFind:!1,isDrawingMode:!1,preserveObjectStacking:!1,snapAngle:0,snapThreshold:null,stopContextMenu:!1,fireRightClick:!1,fireMiddleClick:!1,targets:[],enablePointerEvents:!1,_hoveredTarget:null,_hoveredTargets:[],_initInteractive:function(){this._currentTransform=null,this._groupSelector=null,this._initWrapperElement(),this._createUpperCanvas(),this._initEventListeners(),this._initRetinaScaling(),this.freeDrawingBrush=r.PencilBrush&&new r.PencilBrush(this),this.calcOffset()},_chooseObjectsToRender:function(){var _e=this.getActiveObjects(),Se,t,Ae;if(_e.length>0&&!this.preserveObjectStacking){t=[],Ae=[];for(var Pe=0,St=this._objects.length;Pe<St;Pe++)Se=this._objects[Pe],_e.indexOf(Se)===-1?t.push(Se):Ae.push(Se);_e.length>1&&(this._activeObject._objects=Ae),t.push.apply(t,Ae)}else t=this._objects;return t},renderAll:function(){this.contextTopDirty&&!this._groupSelector&&!this.isDrawingMode&&(this.clearContext(this.contextTop),this.contextTopDirty=!1),this.hasLostContext&&(this.renderTopLayer(this.contextTop),this.hasLostContext=!1);var _e=this.contextContainer;return this.renderCanvas(_e,this._chooseObjectsToRender()),this},renderTopLayer:function(_e){_e.save(),this.isDrawingMode&&this._isCurrentlyDrawing&&(this.freeDrawingBrush&&this.freeDrawingBrush._render(),this.contextTopDirty=!0),this.selection&&this._groupSelector&&(this._drawSelection(_e),this.contextTopDirty=!0),_e.restore()},renderTop:function(){var _e=this.contextTop;return this.clearContext(_e),this.renderTopLayer(_e),this.fire("after:render"),this},_normalizePointer:function(_e,Se){var t=_e.calcTransformMatrix(),Ae=r.util.invertTransform(t),Pe=this.restorePointerVpt(Se);return r.util.transformPoint(Pe,Ae)},isTargetTransparent:function(_e,Se,t){if(_e.shouldCache()&&_e._cacheCanvas&&_e!==this._activeObject){var Ae=this._normalizePointer(_e,{x:Se,y:t}),Pe=Math.max(_e.cacheTranslationX+Ae.x*_e.zoomX,0),St=Math.max(_e.cacheTranslationY+Ae.y*_e.zoomY,0),Re=r.util.isTransparent(_e._cacheContext,Math.round(Pe),Math.round(St),this.targetFindTolerance);return Re}var Ce=this.contextCache,ke=_e.selectionBackgroundColor,De=this.viewportTransform;_e.selectionBackgroundColor="",this.clearContext(Ce),Ce.save(),Ce.transform(De[0],De[1],De[2],De[3],De[4],De[5]),_e.render(Ce),Ce.restore(),_e.selectionBackgroundColor=ke;var Re=r.util.isTransparent(Ce,Se,t,this.targetFindTolerance);return Re},_isSelectionKeyPressed:function(_e){var Se=!1;return Array.isArray(this.selectionKey)?Se=!!this.selectionKey.find(function(t){return _e[t]===!0}):Se=_e[this.selectionKey],Se},_shouldClearSelection:function(_e,Se){var t=this.getActiveObjects(),Ae=this._activeObject;return!Se||Se&&Ae&&t.length>1&&t.indexOf(Se)===-1&&Ae!==Se&&!this._isSelectionKeyPressed(_e)||Se&&!Se.evented||Se&&!Se.selectable&&Ae&&Ae!==Se},_shouldCenterTransform:function(_e,Se,t){if(!!_e){var Ae;return Se==="scale"||Se==="scaleX"||Se==="scaleY"||Se==="resizing"?Ae=this.centeredScaling||_e.centeredScaling:Se==="rotate"&&(Ae=this.centeredRotation||_e.centeredRotation),Ae?!t:t}},_getOriginFromCorner:function(_e,Se){var t={x:_e.originX,y:_e.originY};return Se==="ml"||Se==="tl"||Se==="bl"?t.x="right":(Se==="mr"||Se==="tr"||Se==="br")&&(t.x="left"),Se==="tl"||Se==="mt"||Se==="tr"?t.y="bottom":(Se==="bl"||Se==="mb"||Se==="br")&&(t.y="top"),t},_getActionFromCorner:function(_e,Se,t,Ae){if(!Se||!_e)return"drag";var Pe=Ae.controls[Se];return Pe.getActionName(t,Pe,Ae)},_setupCurrentTransform:function(_e,Se,t){if(!!Se){var Ae=this.getPointer(_e),Pe=Se.__corner,St=Se.controls[Pe],Ce=t&&Pe?St.getActionHandler(_e,Se,St):r.controlsUtils.dragHandler,ke=this._getActionFromCorner(t,Pe,_e,Se),De=this._getOriginFromCorner(Se,Pe),Re=_e[this.centeredKey],je={target:Se,action:ke,actionHandler:Ce,corner:Pe,scaleX:Se.scaleX,scaleY:Se.scaleY,skewX:Se.skewX,skewY:Se.skewY,offsetX:Ae.x-Se.left,offsetY:Ae.y-Se.top,originX:De.x,originY:De.y,ex:Ae.x,ey:Ae.y,lastX:Ae.x,lastY:Ae.y,theta:e(Se.angle),width:Se.width*Se.scaleX,shiftKey:_e.shiftKey,altKey:Re,original:r.util.saveObjectTransform(Se)};this._shouldCenterTransform(Se,ke,Re)&&(je.originX="center",je.originY="center"),je.original.originX=De.x,je.original.originY=De.y,this._currentTransform=je,this._beforeTransform(_e)}},setCursor:function(_e){this.upperCanvasEl.style.cursor=_e},_drawSelection:function(_e){var Se=this._groupSelector,t=new r.Point(Se.ex,Se.ey),Ae=r.util.transformPoint(t,this.viewportTransform),Pe=new r.Point(Se.ex+Se.left,Se.ey+Se.top),St=r.util.transformPoint(Pe,this.viewportTransform),Ce=Math.min(Ae.x,St.x),ke=Math.min(Ae.y,St.y),De=Math.max(Ae.x,St.x),Re=Math.max(Ae.y,St.y),je=this.selectionLineWidth/2;this.selectionColor&&(_e.fillStyle=this.selectionColor,_e.fillRect(Ce,ke,De-Ce,Re-ke)),!(!this.selectionLineWidth||!this.selectionBorderColor)&&(_e.lineWidth=this.selectionLineWidth,_e.strokeStyle=this.selectionBorderColor,Ce+=je,ke+=je,De-=je,Re-=je,r.Object.prototype._setLineDash.call(this,_e,this.selectionDashArray),_e.strokeRect(Ce,ke,De-Ce,Re-ke))},findTarget:function(_e,Se){if(!this.skipTargetFind){var t=!0,Ae=this.getPointer(_e,t),Pe=this._activeObject,St=this.getActiveObjects(),Ce,ke,De=xe(_e),Re=St.length>1&&!Se||St.length===1;if(this.targets=[],Re&&Pe._findTargetCorner(Ae,De)||St.length>1&&!Se&&Pe===this._searchPossibleTargets([Pe],Ae))return Pe;if(St.length===1&&Pe===this._searchPossibleTargets([Pe],Ae))if(this.preserveObjectStacking)Ce=Pe,ke=this.targets,this.targets=[];else return Pe;var je=this._searchPossibleTargets(this._objects,Ae);return _e[this.altSelectionKey]&&je&&Ce&&je!==Ce&&(je=Ce,this.targets=ke),je}},_checkTarget:function(_e,Se,t){if(Se&&Se.visible&&Se.evented&&Se.containsPoint(_e))if((this.perPixelTargetFind||Se.perPixelTargetFind)&&!Se.isEditing){var Ae=this.isTargetTransparent(Se,t.x,t.y);if(!Ae)return!0}else return!0},_searchPossibleTargets:function(_e,Se){for(var t,Ae=_e.length,Pe;Ae--;){var St=_e[Ae],Ce=St.group?this._normalizePointer(St.group,Se):Se;if(this._checkTarget(Ce,St,Se)){t=_e[Ae],t.subTargetCheck&&t instanceof r.Group&&(Pe=this._searchPossibleTargets(t._objects,Se),Pe&&this.targets.push(Pe));break}}return t},restorePointerVpt:function(_e){return r.util.transformPoint(_e,r.util.invertTransform(this.viewportTransform))},getPointer:function(_e,Se){if(this._absolutePointer&&!Se)return this._absolutePointer;if(this._pointer&&Se)return this._pointer;var t=Ee(_e),Ae=this.upperCanvasEl,Pe=Ae.getBoundingClientRect(),St=Pe.width||0,Ce=Pe.height||0,ke;(!St||!Ce)&&("top"in Pe&&"bottom"in Pe&&(Ce=Math.abs(Pe.top-Pe.bottom)),"right"in Pe&&"left"in Pe&&(St=Math.abs(Pe.right-Pe.left))),this.calcOffset(),t.x=t.x-this._offset.left,t.y=t.y-this._offset.top,Se||(t=this.restorePointerVpt(t));var De=this.getRetinaScaling();return De!==1&&(t.x/=De,t.y/=De),St===0||Ce===0?ke={width:1,height:1}:ke={width:Ae.width/St,height:Ae.height/Ce},{x:t.x*ke.width,y:t.y*ke.height}},_createUpperCanvas:function(){var _e=this.lowerCanvasEl.className.replace(/\s*lower-canvas\s*/,""),Se=this.lowerCanvasEl,t=this.upperCanvasEl;t?t.className="":(t=this._createCanvasElement(),this.upperCanvasEl=t),r.util.addClass(t,"upper-canvas "+_e),this.wrapperEl.appendChild(t),this._copyCanvasStyle(Se,t),this._applyCanvasStyle(t),this.contextTop=t.getContext("2d")},getTopContext:function(){return this.contextTop},_createCacheCanvas:function(){this.cacheCanvasEl=this._createCanvasElement(),this.cacheCanvasEl.setAttribute("width",this.width),this.cacheCanvasEl.setAttribute("height",this.height),this.contextCache=this.cacheCanvasEl.getContext("2d")},_initWrapperElement:function(){this.wrapperEl=r.util.wrapElement(this.lowerCanvasEl,"div",{class:this.containerClass}),r.util.setStyle(this.wrapperEl,{width:this.width+"px",height:this.height+"px",position:"relative"}),r.util.makeElementUnselectable(this.wrapperEl)},_applyCanvasStyle:function(_e){var Se=this.width||_e.width,t=this.height||_e.height;r.util.setStyle(_e,{position:"absolute",width:Se+"px",height:t+"px",left:0,top:0,"touch-action":this.allowTouchScrolling?"manipulation":"none","-ms-touch-action":this.allowTouchScrolling?"manipulation":"none"}),_e.width=Se,_e.height=t,r.util.makeElementUnselectable(_e)},_copyCanvasStyle:function(_e,Se){Se.style.cssText=_e.style.cssText},getSelectionContext:function(){return this.contextTop},getSelectionElement:function(){return this.upperCanvasEl},getActiveObject:function(){return this._activeObject},getActiveObjects:function(){var _e=this._activeObject;return _e?_e.type==="activeSelection"&&_e._objects?_e._objects.slice(0):[_e]:[]},_onObjectRemoved:function(_e){_e===this._activeObject&&(this.fire("before:selection:cleared",{target:_e}),this._discardActiveObject(),this.fire("selection:cleared",{target:_e}),_e.fire("deselected")),_e===this._hoveredTarget&&(this._hoveredTarget=null,this._hoveredTargets=[]),this.callSuper("_onObjectRemoved",_e)},_fireSelectionEvents:function(_e,Se){var t=!1,Ae=this.getActiveObjects(),Pe=[],St=[];_e.forEach(function(Ce){Ae.indexOf(Ce)===-1&&(t=!0,Ce.fire("deselected",{e:Se,target:Ce}),St.push(Ce))}),Ae.forEach(function(Ce){_e.indexOf(Ce)===-1&&(t=!0,Ce.fire("selected",{e:Se,target:Ce}),Pe.push(Ce))}),_e.length>0&&Ae.length>0?t&&this.fire("selection:updated",{e:Se,selected:Pe,deselected:St}):Ae.length>0?this.fire("selection:created",{e:Se,selected:Pe}):_e.length>0&&this.fire("selection:cleared",{e:Se,deselected:St})},setActiveObject:function(_e,Se){var t=this.getActiveObjects();return this._setActiveObject(_e,Se),this._fireSelectionEvents(t,Se),this},_setActiveObject:function(_e,Se){return this._activeObject===_e||!this._discardActiveObject(Se,_e)||_e.onSelect({e:Se})?!1:(this._activeObject=_e,!0)},_discardActiveObject:function(_e,Se){var t=this._activeObject;if(t){if(t.onDeselect({e:_e,object:Se}))return!1;this._activeObject=null}return!0},discardActiveObject:function(_e){var Se=this.getActiveObjects(),t=this.getActiveObject();return Se.length&&this.fire("before:selection:cleared",{target:t,e:_e}),this._discardActiveObject(_e),this._fireSelectionEvents(Se,_e),this},dispose:function(){var _e=this.wrapperEl;return this.removeListeners(),_e.removeChild(this.upperCanvasEl),_e.removeChild(this.lowerCanvasEl),this.contextCache=null,this.contextTop=null,["upperCanvasEl","cacheCanvasEl"].forEach(function(Se){r.util.cleanUpJsdomNode(this[Se]),this[Se]=void 0}.bind(this)),_e.parentNode&&_e.parentNode.replaceChild(this.lowerCanvasEl,this.wrapperEl),delete this.wrapperEl,r.StaticCanvas.prototype.dispose.call(this),this},clear:function(){return this.discardActiveObject(),this.clearContext(this.contextTop),this.callSuper("clear")},drawControls:function(_e){var Se=this._activeObject;Se&&Se._renderControls(_e)},_toObject:function(_e,Se,t){var Ae=this._realizeGroupTransformOnObject(_e),Pe=this.callSuper("_toObject",_e,Se,t);return this._unwindGroupTransformOnObject(_e,Ae),Pe},_realizeGroupTransformOnObject:function(_e){if(_e.group&&_e.group.type==="activeSelection"&&this._activeObject===_e.group){var Se=["angle","flipX","flipY","left","scaleX","scaleY","skewX","skewY","top"],t={};return Se.forEach(function(Ae){t[Ae]=_e[Ae]}),r.util.addTransformToObject(_e,this._activeObject.calcOwnMatrix()),t}else return null},_unwindGroupTransformOnObject:function(_e,Se){Se&&_e.set(Se)},_setSVGObject:function(_e,Se,t){var Ae=this._realizeGroupTransformOnObject(Se);this.callSuper("_setSVGObject",_e,Se,t),this._unwindGroupTransformOnObject(Se,Ae)},setViewportTransform:function(_e){this.renderOnAddRemove&&this._activeObject&&this._activeObject.isEditing&&this._activeObject.clearContextTop(),r.StaticCanvas.prototype.setViewportTransform.call(this,_e)}});for(var Te in r.StaticCanvas)Te!=="prototype"&&(r.Canvas[Te]=r.StaticCanvas[Te])}(),function(){var Ee=r.util.addListener,e=r.util.removeListener,xe=3,Te=2,_e=1,Se={passive:!1};function t(Ae,Pe){return Ae.button&&Ae.button===Pe-1}r.util.object.extend(r.Canvas.prototype,{mainTouchId:null,_initEventListeners:function(){this.removeListeners(),this._bindEvents(),this.addOrRemove(Ee,"add")},_getEventPrefix:function(){return this.enablePointerEvents?"pointer":"mouse"},addOrRemove:function(Ae,Pe){var St=this.upperCanvasEl,Ce=this._getEventPrefix();Ae(r.window,"resize",this._onResize),Ae(St,Ce+"down",this._onMouseDown),Ae(St,Ce+"move",this._onMouseMove,Se),Ae(St,Ce+"out",this._onMouseOut),Ae(St,Ce+"enter",this._onMouseEnter),Ae(St,"wheel",this._onMouseWheel),Ae(St,"contextmenu",this._onContextMenu),Ae(St,"dblclick",this._onDoubleClick),Ae(St,"dragover",this._onDragOver),Ae(St,"dragenter",this._onDragEnter),Ae(St,"dragleave",this._onDragLeave),Ae(St,"drop",this._onDrop),this.enablePointerEvents||Ae(St,"touchstart",this._onTouchStart,Se),typeof eventjs<"u"&&Pe in eventjs&&(eventjs[Pe](St,"gesture",this._onGesture),eventjs[Pe](St,"drag",this._onDrag),eventjs[Pe](St,"orientation",this._onOrientationChange),eventjs[Pe](St,"shake",this._onShake),eventjs[Pe](St,"longpress",this._onLongPress))},removeListeners:function(){this.addOrRemove(e,"remove");var Ae=this._getEventPrefix();e(r.document,Ae+"up",this._onMouseUp),e(r.document,"touchend",this._onTouchEnd,Se),e(r.document,Ae+"move",this._onMouseMove,Se),e(r.document,"touchmove",this._onMouseMove,Se)},_bindEvents:function(){this.eventsBound||(this._onMouseDown=this._onMouseDown.bind(this),this._onTouchStart=this._onTouchStart.bind(this),this._onMouseMove=this._onMouseMove.bind(this),this._onMouseUp=this._onMouseUp.bind(this),this._onTouchEnd=this._onTouchEnd.bind(this),this._onResize=this._onResize.bind(this),this._onGesture=this._onGesture.bind(this),this._onDrag=this._onDrag.bind(this),this._onShake=this._onShake.bind(this),this._onLongPress=this._onLongPress.bind(this),this._onOrientationChange=this._onOrientationChange.bind(this),this._onMouseWheel=this._onMouseWheel.bind(this),this._onMouseOut=this._onMouseOut.bind(this),this._onMouseEnter=this._onMouseEnter.bind(this),this._onContextMenu=this._onContextMenu.bind(this),this._onDoubleClick=this._onDoubleClick.bind(this),this._onDragOver=this._onDragOver.bind(this),this._onDragEnter=this._simpleEventHandler.bind(this,"dragenter"),this._onDragLeave=this._simpleEventHandler.bind(this,"dragleave"),this._onDrop=this._onDrop.bind(this),this.eventsBound=!0)},_onGesture:function(Ae,Pe){this.__onTransformGesture&&this.__onTransformGesture(Ae,Pe)},_onDrag:function(Ae,Pe){this.__onDrag&&this.__onDrag(Ae,Pe)},_onMouseWheel:function(Ae){this.__onMouseWheel(Ae)},_onMouseOut:function(Ae){var Pe=this._hoveredTarget;this.fire("mouse:out",{target:Pe,e:Ae}),this._hoveredTarget=null,Pe&&Pe.fire("mouseout",{e:Ae});var St=this;this._hoveredTargets.forEach(function(Ce){St.fire("mouse:out",{target:Pe,e:Ae}),Ce&&Pe.fire("mouseout",{e:Ae})}),this._hoveredTargets=[]},_onMouseEnter:function(Ae){!this._currentTransform&&!this.findTarget(Ae)&&(this.fire("mouse:over",{target:null,e:Ae}),this._hoveredTarget=null,this._hoveredTargets=[])},_onOrientationChange:function(Ae,Pe){this.__onOrientationChange&&this.__onOrientationChange(Ae,Pe)},_onShake:function(Ae,Pe){this.__onShake&&this.__onShake(Ae,Pe)},_onLongPress:function(Ae,Pe){this.__onLongPress&&this.__onLongPress(Ae,Pe)},_onDragOver:function(Ae){Ae.preventDefault();var Pe=this._simpleEventHandler("dragover",Ae);this._fireEnterLeaveEvents(Pe,Ae)},_onDrop:function(Ae){return this._simpleEventHandler("drop:before",Ae),this._simpleEventHandler("drop",Ae)},_onContextMenu:function(Ae){return this.stopContextMenu&&(Ae.stopPropagation(),Ae.preventDefault()),!1},_onDoubleClick:function(Ae){this._cacheTransformEventData(Ae),this._handleEvent(Ae,"dblclick"),this._resetTransformEventData(Ae)},getPointerId:function(Ae){var Pe=Ae.changedTouches;return Pe?Pe[0]&&Pe[0].identifier:this.enablePointerEvents?Ae.pointerId:-1},_isMainEvent:function(Ae){return Ae.isPrimary===!0?!0:Ae.isPrimary===!1?!1:Ae.type==="touchend"&&Ae.touches.length===0?!0:Ae.changedTouches?Ae.changedTouches[0].identifier===this.mainTouchId:!0},_onTouchStart:function(Ae){Ae.preventDefault(),this.mainTouchId===null&&(this.mainTouchId=this.getPointerId(Ae)),this.__onMouseDown(Ae),this._resetTransformEventData();var Pe=this.upperCanvasEl,St=this._getEventPrefix();Ee(r.document,"touchend",this._onTouchEnd,Se),Ee(r.document,"touchmove",this._onMouseMove,Se),e(Pe,St+"down",this._onMouseDown)},_onMouseDown:function(Ae){this.__onMouseDown(Ae),this._resetTransformEventData();var Pe=this.upperCanvasEl,St=this._getEventPrefix();e(Pe,St+"move",this._onMouseMove,Se),Ee(r.document,St+"up",this._onMouseUp),Ee(r.document,St+"move",this._onMouseMove,Se)},_onTouchEnd:function(Ae){if(!(Ae.touches.length>0)){this.__onMouseUp(Ae),this._resetTransformEventData(),this.mainTouchId=null;var Pe=this._getEventPrefix();e(r.document,"touchend",this._onTouchEnd,Se),e(r.document,"touchmove",this._onMouseMove,Se);var St=this;this._willAddMouseDown&&clearTimeout(this._willAddMouseDown),this._willAddMouseDown=setTimeout(function(){Ee(St.upperCanvasEl,Pe+"down",St._onMouseDown),St._willAddMouseDown=0},400)}},_onMouseUp:function(Ae){this.__onMouseUp(Ae),this._resetTransformEventData();var Pe=this.upperCanvasEl,St=this._getEventPrefix();this._isMainEvent(Ae)&&(e(r.document,St+"up",this._onMouseUp),e(r.document,St+"move",this._onMouseMove,Se),Ee(Pe,St+"move",this._onMouseMove,Se))},_onMouseMove:function(Ae){!this.allowTouchScrolling&&Ae.preventDefault&&Ae.preventDefault(),this.__onMouseMove(Ae)},_onResize:function(){this.calcOffset()},_shouldRender:function(Ae){var Pe=this._activeObject;return!!Pe!=!!Ae||Pe&&Ae&&Pe!==Ae?!0:(Pe&&Pe.isEditing,!1)},__onMouseUp:function(Ae){var Pe,St=this._currentTransform,Ce=this._groupSelector,ke=!1,De=!Ce||Ce.left===0&&Ce.top===0;if(this._cacheTransformEventData(Ae),Pe=this._target,this._handleEvent(Ae,"up:before"),t(Ae,xe)){this.fireRightClick&&this._handleEvent(Ae,"up",xe,De);return}if(t(Ae,Te)){this.fireMiddleClick&&this._handleEvent(Ae,"up",Te,De),this._resetTransformEventData();return}if(this.isDrawingMode&&this._isCurrentlyDrawing){this._onMouseUpInDrawingMode(Ae);return}if(!!this._isMainEvent(Ae)){if(St&&(this._finalizeCurrentTransform(Ae),ke=St.actionPerformed),!De){var Re=Pe===this._activeObject;this._maybeGroupObjects(Ae),ke||(ke=this._shouldRender(Pe)||!Re&&Pe===this._activeObject)}var je,We;if(Pe){if(je=Pe._findTargetCorner(this.getPointer(Ae,!0),r.util.isTouchEvent(Ae)),Pe.selectable&&Pe!==this._activeObject&&Pe.activeOn==="up")this.setActiveObject(Pe,Ae),ke=!0;else{var Ke=Pe.controls[je],Je=Ke&&Ke.getMouseUpHandler(Ae,Pe,Ke);Je&&(We=this.getPointer(Ae),Je(Ae,St,We.x,We.y))}Pe.isMoving=!1}if(St&&(St.target!==Pe||St.corner!==je)){var hi=St.target&&St.target.controls[St.corner],oi=hi&&hi.getMouseUpHandler(Ae,Pe,Ke);We=We||this.getPointer(Ae),oi&&oi(Ae,St,We.x,We.y)}this._setCursorFromEvent(Ae,Pe),this._handleEvent(Ae,"up",_e,De),this._groupSelector=null,this._currentTransform=null,Pe&&(Pe.__corner=0),ke?this.requestRenderAll():De||this.renderTop()}},_simpleEventHandler:function(Ae,Pe){var St=this.findTarget(Pe),Ce=this.targets,ke={e:Pe,target:St,subTargets:Ce};if(this.fire(Ae,ke),St&&St.fire(Ae,ke),!Ce)return St;for(var De=0;De<Ce.length;De++)Ce[De].fire(Ae,ke);return St},_handleEvent:function(Ae,Pe,St,Ce){var ke=this._target,De=this.targets||[],Re={e:Ae,target:ke,subTargets:De,button:St||_e,isClick:Ce||!1,pointer:this._pointer,absolutePointer:this._absolutePointer,transform:this._currentTransform};Pe==="up"&&(Re.currentTarget=this.findTarget(Ae),Re.currentSubTargets=this.targets),this.fire("mouse:"+Pe,Re),ke&&ke.fire("mouse"+Pe,Re);for(var je=0;je<De.length;je++)De[je].fire("mouse"+Pe,Re)},_finalizeCurrentTransform:function(Ae){var Pe=this._currentTransform,St=Pe.target,Ce={e:Ae,target:St,transform:Pe,action:Pe.action};St._scaling&&(St._scaling=!1),St.setCoords(),(Pe.actionPerformed||this.stateful&&St.hasStateChanged())&&this._fire("modified",Ce)},_onMouseDownInDrawingMode:function(Ae){this._isCurrentlyDrawing=!0,this.getActiveObject()&&this.discardActiveObject(Ae).requestRenderAll();var Pe=this.getPointer(Ae);this.freeDrawingBrush.onMouseDown(Pe,{e:Ae,pointer:Pe}),this._handleEvent(Ae,"down")},_onMouseMoveInDrawingMode:function(Ae){if(this._isCurrentlyDrawing){var Pe=this.getPointer(Ae);this.freeDrawingBrush.onMouseMove(Pe,{e:Ae,pointer:Pe})}this.setCursor(this.freeDrawingCursor),this._handleEvent(Ae,"move")},_onMouseUpInDrawingMode:function(Ae){var Pe=this.getPointer(Ae);this._isCurrentlyDrawing=this.freeDrawingBrush.onMouseUp({e:Ae,pointer:Pe}),this._handleEvent(Ae,"up")},__onMouseDown:function(Ae){this._cacheTransformEventData(Ae),this._handleEvent(Ae,"down:before");var Pe=this._target;if(t(Ae,xe)){this.fireRightClick&&this._handleEvent(Ae,"down",xe);return}if(t(Ae,Te)){this.fireMiddleClick&&this._handleEvent(Ae,"down",Te);return}if(this.isDrawingMode){this._onMouseDownInDrawingMode(Ae);return}if(!!this._isMainEvent(Ae)&&!this._currentTransform){var St=this._pointer;this._previousPointer=St;var Ce=this._shouldRender(Pe),ke=this._shouldGroup(Ae,Pe);if(this._shouldClearSelection(Ae,Pe)?this.discardActiveObject(Ae):ke&&(this._handleGrouping(Ae,Pe),Pe=this._activeObject),this.selection&&(!Pe||!Pe.selectable&&!Pe.isEditing&&Pe!==this._activeObject)&&(this._groupSelector={ex:this._absolutePointer.x,ey:this._absolutePointer.y,top:0,left:0}),Pe){var De=Pe===this._activeObject;Pe.selectable&&Pe.activeOn==="down"&&this.setActiveObject(Pe,Ae);var Re=Pe._findTargetCorner(this.getPointer(Ae,!0),r.util.isTouchEvent(Ae));if(Pe.__corner=Re,Pe===this._activeObject&&(Re||!ke)){this._setupCurrentTransform(Ae,Pe,De);var je=Pe.controls[Re],St=this.getPointer(Ae),We=je&&je.getMouseDownHandler(Ae,Pe,je);We&&We(Ae,this._currentTransform,St.x,St.y)}}this._handleEvent(Ae,"down"),(Ce||ke)&&this.requestRenderAll()}},_resetTransformEventData:function(){this._target=null,this._pointer=null,this._absolutePointer=null},_cacheTransformEventData:function(Ae){this._resetTransformEventData(),this._pointer=this.getPointer(Ae,!0),this._absolutePointer=this.restorePointerVpt(this._pointer),this._target=this._currentTransform?this._currentTransform.target:this.findTarget(Ae)||null},_beforeTransform:function(Ae){var Pe=this._currentTransform;this.stateful&&Pe.target.saveState(),this.fire("before:transform",{e:Ae,transform:Pe})},__onMouseMove:function(Ae){this._handleEvent(Ae,"move:before"),this._cacheTransformEventData(Ae);var Pe,St;if(this.isDrawingMode){this._onMouseMoveInDrawingMode(Ae);return}if(!!this._isMainEvent(Ae)){var Ce=this._groupSelector;Ce?(St=this._absolutePointer,Ce.left=St.x-Ce.ex,Ce.top=St.y-Ce.ey,this.renderTop()):this._currentTransform?this._transformObject(Ae):(Pe=this.findTarget(Ae)||null,this._setCursorFromEvent(Ae,Pe),this._fireOverOutEvents(Pe,Ae)),this._handleEvent(Ae,"move"),this._resetTransformEventData()}},_fireOverOutEvents:function(Ae,Pe){var St=this._hoveredTarget,Ce=this._hoveredTargets,ke=this.targets,De=Math.max(Ce.length,ke.length);this.fireSyntheticInOutEvents(Ae,Pe,{oldTarget:St,evtOut:"mouseout",canvasEvtOut:"mouse:out",evtIn:"mouseover",canvasEvtIn:"mouse:over"});for(var Re=0;Re<De;Re++)this.fireSyntheticInOutEvents(ke[Re],Pe,{oldTarget:Ce[Re],evtOut:"mouseout",evtIn:"mouseover"});this._hoveredTarget=Ae,this._hoveredTargets=this.targets.concat()},_fireEnterLeaveEvents:function(Ae,Pe){var St=this._draggedoverTarget,Ce=this._hoveredTargets,ke=this.targets,De=Math.max(Ce.length,ke.length);this.fireSyntheticInOutEvents(Ae,Pe,{oldTarget:St,evtOut:"dragleave",evtIn:"dragenter"});for(var Re=0;Re<De;Re++)this.fireSyntheticInOutEvents(ke[Re],Pe,{oldTarget:Ce[Re],evtOut:"dragleave",evtIn:"dragenter"});this._draggedoverTarget=Ae},fireSyntheticInOutEvents:function(Ae,Pe,St){var Ce,ke,De=St.oldTarget,Re,je,We=De!==Ae,Ke=St.canvasEvtIn,Je=St.canvasEvtOut;We&&(Ce={e:Pe,target:Ae,previousTarget:De},ke={e:Pe,target:De,nextTarget:Ae}),je=Ae&&We,Re=De&&We,Re&&(Je&&this.fire(Je,ke),De.fire(St.evtOut,ke)),je&&(Ke&&this.fire(Ke,Ce),Ae.fire(St.evtIn,Ce))},__onMouseWheel:function(Ae){this._cacheTransformEventData(Ae),this._handleEvent(Ae,"wheel"),this._resetTransformEventData()},_transformObject:function(Ae){var Pe=this.getPointer(Ae),St=this._currentTransform;St.reset=!1,St.shiftKey=Ae.shiftKey,St.altKey=Ae[this.centeredKey],this._performTransformAction(Ae,St,Pe),St.actionPerformed&&this.requestRenderAll()},_performTransformAction:function(Ae,Pe,St){var Ce=St.x,ke=St.y,De=Pe.action,Re=!1,je=Pe.actionHandler;je&&(Re=je(Ae,Pe,Ce,ke)),De==="drag"&&Re&&(Pe.target.isMoving=!0,this.setCursor(Pe.target.moveCursor||this.moveCursor)),Pe.actionPerformed=Pe.actionPerformed||Re},_fire:r.controlsUtils.fireEvent,_setCursorFromEvent:function(Ae,Pe){if(!Pe)return this.setCursor(this.defaultCursor),!1;var St=Pe.hoverCursor||this.hoverCursor,Ce=this._activeObject&&this._activeObject.type==="activeSelection"?this._activeObject:null,ke=(!Ce||!Ce.contains(Pe))&&Pe._findTargetCorner(this.getPointer(Ae,!0));ke?this.setCursor(this.getCornerCursor(ke,Pe,Ae)):(Pe.subTargetCheck&&this.targets.concat().reverse().map(function(De){St=De.hoverCursor||St}),this.setCursor(St))},getCornerCursor:function(Ae,Pe,St){var Ce=Pe.controls[Ae];return Ce.cursorStyleHandler(St,Ce,Pe)}})}(),function(){var Ee=Math.min,e=Math.max;r.util.object.extend(r.Canvas.prototype,{_shouldGroup:function(xe,Te){var _e=this._activeObject;return _e&&this._isSelectionKeyPressed(xe)&&Te&&Te.selectable&&this.selection&&(_e!==Te||_e.type==="activeSelection")&&!Te.onSelect({e:xe})},_handleGrouping:function(xe,Te){var _e=this._activeObject;_e.__corner||Te===_e&&(Te=this.findTarget(xe,!0),!Te||!Te.selectable)||(_e&&_e.type==="activeSelection"?this._updateActiveSelection(Te,xe):this._createActiveSelection(Te,xe))},_updateActiveSelection:function(xe,Te){var _e=this._activeObject,Se=_e._objects.slice(0);_e.contains(xe)?(_e.removeWithUpdate(xe),this._hoveredTarget=xe,this._hoveredTargets=this.targets.concat(),_e.size()===1&&this._setActiveObject(_e.item(0),Te)):(_e.addWithUpdate(xe),this._hoveredTarget=_e,this._hoveredTargets=this.targets.concat()),this._fireSelectionEvents(Se,Te)},_createActiveSelection:function(xe,Te){var _e=this.getActiveObjects(),Se=this._createGroup(xe);this._hoveredTarget=Se,this._setActiveObject(Se,Te),this._fireSelectionEvents(_e,Te)},_createGroup:function(xe){var Te=this._objects,_e=Te.indexOf(this._activeObject)<Te.indexOf(xe),Se=_e?[this._activeObject,xe]:[xe,this._activeObject];return this._activeObject.isEditing&&this._activeObject.exitEditing(),new r.ActiveSelection(Se,{canvas:this})},_groupSelectedObjects:function(xe){var Te=this._collectObjects(xe),_e;Te.length===1?this.setActiveObject(Te[0],xe):Te.length>1&&(_e=new r.ActiveSelection(Te.reverse(),{canvas:this}),this.setActiveObject(_e,xe))},_collectObjects:function(xe){for(var Te=[],_e,Se=this._groupSelector.ex,t=this._groupSelector.ey,Ae=Se+this._groupSelector.left,Pe=t+this._groupSelector.top,St=new r.Point(Ee(Se,Ae),Ee(t,Pe)),Ce=new r.Point(e(Se,Ae),e(t,Pe)),ke=!this.selectionFullyContained,De=Se===Ae&&t===Pe,Re=this._objects.length;Re--&&(_e=this._objects[Re],!(!(!_e||!_e.selectable||!_e.visible)&&(ke&&_e.intersectsWithRect(St,Ce,!0)||_e.isContainedWithinRect(St,Ce,!0)||ke&&_e.containsPoint(St,null,!0)||ke&&_e.containsPoint(Ce,null,!0))&&(Te.push(_e),De))););return Te.length>1&&(Te=Te.filter(function(je){return!je.onSelect({e:xe})})),Te},_maybeGroupObjects:function(xe){this.selection&&this._groupSelector&&this._groupSelectedObjects(xe),this.setCursor(this.defaultCursor),this._groupSelector=null}})}(),function(){r.util.object.extend(r.StaticCanvas.prototype,{toDataURL:function(Ee){Ee||(Ee={});var e=Ee.format||"png",xe=Ee.quality||1,Te=(Ee.multiplier||1)*(Ee.enableRetinaScaling?this.getRetinaScaling():1),_e=this.toCanvasElement(Te,Ee);return r.util.toDataURL(_e,e,xe)},toCanvasElement:function(Ee,e){Ee=Ee||1,e=e||{};var xe=(e.width||this.width)*Ee,Te=(e.height||this.height)*Ee,_e=this.getZoom(),Se=this.width,t=this.height,Ae=_e*Ee,Pe=this.viewportTransform,St=(Pe[4]-(e.left||0))*Ee,Ce=(Pe[5]-(e.top||0))*Ee,ke=this.interactive,De=[Ae,0,0,Ae,St,Ce],Re=this.enableRetinaScaling,je=r.util.createCanvasElement(),We=this.contextTop;return je.width=xe,je.height=Te,this.contextTop=null,this.enableRetinaScaling=!1,this.interactive=!1,this.viewportTransform=De,this.width=xe,this.height=Te,this.calcViewportBoundaries(),this.renderCanvas(je.getContext("2d"),this._objects),this.viewportTransform=Pe,this.width=Se,this.height=t,this.calcViewportBoundaries(),this.interactive=ke,this.enableRetinaScaling=Re,this.contextTop=We,je}})}(),r.util.object.extend(r.StaticCanvas.prototype,{loadFromJSON:function(Ee,e,xe){if(!!Ee){var Te=typeof Ee=="string"?JSON.parse(Ee):r.util.object.clone(Ee),_e=this,Se=Te.clipPath,t=this.renderOnAddRemove;return this.renderOnAddRemove=!1,delete Te.clipPath,this._enlivenObjects(Te.objects,function(Ae){_e.clear(),_e._setBgOverlay(Te,function(){Se?_e._enlivenObjects([Se],function(Pe){_e.clipPath=Pe[0],_e.__setupCanvas.call(_e,Te,Ae,t,e)}):_e.__setupCanvas.call(_e,Te,Ae,t,e)})},xe),this}},__setupCanvas:function(Ee,e,xe,Te){var _e=this;e.forEach(function(Se,t){_e.insertAt(Se,t)}),this.renderOnAddRemove=xe,delete Ee.objects,delete Ee.backgroundImage,delete Ee.overlayImage,delete Ee.background,delete Ee.overlay,this._setOptions(Ee),this.renderAll(),Te&&Te()},_setBgOverlay:function(Ee,e){var xe={backgroundColor:!1,overlayColor:!1,backgroundImage:!1,overlayImage:!1};if(!Ee.backgroundImage&&!Ee.overlayImage&&!Ee.background&&!Ee.overlay){e&&e();return}var Te=function(){xe.backgroundImage&&xe.overlayImage&&xe.backgroundColor&&xe.overlayColor&&e&&e()};this.__setBgOverlay("backgroundImage",Ee.backgroundImage,xe,Te),this.__setBgOverlay("overlayImage",Ee.overlayImage,xe,Te),this.__setBgOverlay("backgroundColor",Ee.background,xe,Te),this.__setBgOverlay("overlayColor",Ee.overlay,xe,Te)},__setBgOverlay:function(Ee,e,xe,Te){var _e=this;if(!e){xe[Ee]=!0,Te&&Te();return}Ee==="backgroundImage"||Ee==="overlayImage"?r.util.enlivenObjects([e],function(Se){_e[Ee]=Se[0],xe[Ee]=!0,Te&&Te()}):this["set"+r.util.string.capitalize(Ee,!0)](e,function(){xe[Ee]=!0,Te&&Te()})},_enlivenObjects:function(Ee,e,xe){if(!Ee||Ee.length===0){e&&e([]);return}r.util.enlivenObjects(Ee,function(Te){e&&e(Te)},null,xe)},_toDataURL:function(Ee,e){this.clone(function(xe){e(xe.toDataURL(Ee))})},_toDataURLWithMultiplier:function(Ee,e,xe){this.clone(function(Te){xe(Te.toDataURLWithMultiplier(Ee,e))})},clone:function(Ee,e){var xe=JSON.stringify(this.toJSON(e));this.cloneWithoutData(function(Te){Te.loadFromJSON(xe,function(){Ee&&Ee(Te)})})},cloneWithoutData:function(Ee){var e=r.util.createCanvasElement();e.width=this.width,e.height=this.height;var xe=new r.Canvas(e);this.backgroundImage?(xe.setBackgroundImage(this.backgroundImage.src,function(){xe.renderAll(),Ee&&Ee(xe)}),xe.backgroundImageOpacity=this.backgroundImageOpacity,xe.backgroundImageStretch=this.backgroundImageStretch):Ee&&Ee(xe)}}),function(Ee){var e=Ee.fabric||(Ee.fabric={}),xe=e.util.object.extend,Te=e.util.object.clone,_e=e.util.toFixed,Se=e.util.string.capitalize,t=e.util.degreesToRadians,Ae=!e.isLikelyNode,Pe=2;e.Object||(e.Object=e.util.createClass(e.CommonMethods,{type:"object",originX:"left",originY:"top",top:0,left:0,width:0,height:0,scaleX:1,scaleY:1,flipX:!1,flipY:!1,opacity:1,angle:0,skewX:0,skewY:0,cornerSize:13,touchCornerSize:24,transparentCorners:!0,hoverCursor:null,moveCursor:null,padding:0,borderColor:"rgb(178,204,255)",borderDashArray:null,cornerColor:"rgb(178,204,255)",cornerStrokeColor:null,cornerStyle:"rect",cornerDashArray:null,centeredScaling:!1,centeredRotation:!0,fill:"rgb(0,0,0)",fillRule:"nonzero",globalCompositeOperation:"source-over",backgroundColor:"",selectionBackgroundColor:"",stroke:null,strokeWidth:1,strokeDashArray:null,strokeDashOffset:0,strokeLineCap:"butt",strokeLineJoin:"miter",strokeMiterLimit:4,shadow:null,borderOpacityWhenMoving:.4,borderScaleFactor:1,minScaleLimit:0,selectable:!0,evented:!0,visible:!0,hasControls:!0,hasBorders:!0,perPixelTargetFind:!1,includeDefaultValues:!0,lockMovementX:!1,lockMovementY:!1,lockRotation:!1,lockScalingX:!1,lockScalingY:!1,lockSkewingX:!1,lockSkewingY:!1,lockScalingFlip:!1,excludeFromExport:!1,objectCaching:Ae,statefullCache:!1,noScaleCache:!0,strokeUniform:!1,dirty:!0,__corner:0,paintFirst:"fill",activeOn:"down",stateProperties:"top left width height scaleX scaleY flipX flipY originX originY transformMatrix stroke strokeWidth strokeDashArray strokeLineCap strokeDashOffset strokeLineJoin strokeMiterLimit angle opacity fill globalCompositeOperation shadow visible backgroundColor skewX skewY fillRule paintFirst clipPath strokeUniform".split(" "),cacheProperties:"fill stroke strokeWidth strokeDashArray width height paintFirst strokeUniform strokeLineCap strokeDashOffset strokeLineJoin strokeMiterLimit backgroundColor clipPath".split(" "),colorProperties:"fill stroke backgroundColor".split(" "),clipPath:void 0,inverted:!1,absolutePositioned:!1,initialize:function(St){St&&this.setOptions(St)},_createCacheCanvas:function(){this._cacheProperties={},this._cacheCanvas=e.util.createCanvasElement(),this._cacheContext=this._cacheCanvas.getContext("2d"),this._updateCacheCanvas(),this.dirty=!0},_limitCacheSize:function(St){var Ce=e.perfLimitSizeTotal,ke=St.width,De=St.height,Re=e.maxCacheSideLimit,je=e.minCacheSideLimit;if(ke<=Re&&De<=Re&&ke*De<=Ce)return ke<je&&(St.width=je),De<je&&(St.height=je),St;var We=ke/De,Ke=e.util.limitDimsByArea(We,Ce),Je=e.util.capValue,hi=Je(je,Ke.x,Re),oi=Je(je,Ke.y,Re);return ke>hi&&(St.zoomX/=ke/hi,St.width=hi,St.capped=!0),De>oi&&(St.zoomY/=De/oi,St.height=oi,St.capped=!0),St},_getCacheCanvasDimensions:function(){var St=this.getTotalObjectScaling(),Ce=this._getTransformedDimensions(0,0),ke=Ce.x*St.scaleX/this.scaleX,De=Ce.y*St.scaleY/this.scaleY;return{width:ke+Pe,height:De+Pe,zoomX:St.scaleX,zoomY:St.scaleY,x:ke,y:De}},_updateCacheCanvas:function(){var St=this.canvas;if(this.noScaleCache&&St&&St._currentTransform){var Ce=St._currentTransform.target,ke=St._currentTransform.action;if(this===Ce&&ke.slice&&ke.slice(0,5)==="scale")return!1}var De=this._cacheCanvas,Re=this._limitCacheSize(this._getCacheCanvasDimensions()),je=e.minCacheSideLimit,We=Re.width,Ke=Re.height,Je,hi,oi=Re.zoomX,ti=Re.zoomY,ai=We!==this.cacheWidth||Ke!==this.cacheHeight,yi=this.zoomX!==oi||this.zoomY!==ti,di=ai||yi,bi=0,vi=0,Pi=!1;if(ai){var xi=this._cacheCanvas.width,ni=this._cacheCanvas.height,fi=We>xi||Ke>ni,Si=(We<xi*.9||Ke<ni*.9)&&xi>je&&ni>je;Pi=fi||Si,fi&&!Re.capped&&(We>je||Ke>je)&&(bi=We*.1,vi=Ke*.1)}return this instanceof e.Text&&this.path&&(di=!0,Pi=!0,bi+=this.getHeightOfLine(0)*this.zoomX,vi+=this.getHeightOfLine(0)*this.zoomY),di?(Pi?(De.width=Math.ceil(We+bi),De.height=Math.ceil(Ke+vi)):(this._cacheContext.setTransform(1,0,0,1,0,0),this._cacheContext.clearRect(0,0,De.width,De.height)),Je=Re.x/2,hi=Re.y/2,this.cacheTranslationX=Math.round(De.width/2-Je)+Je,this.cacheTranslationY=Math.round(De.height/2-hi)+hi,this.cacheWidth=We,this.cacheHeight=Ke,this._cacheContext.translate(this.cacheTranslationX,this.cacheTranslationY),this._cacheContext.scale(oi,ti),this.zoomX=oi,this.zoomY=ti,!0):!1},setOptions:function(St){this._setOptions(St),this._initGradient(St.fill,"fill"),this._initGradient(St.stroke,"stroke"),this._initPattern(St.fill,"fill"),this._initPattern(St.stroke,"stroke")},transform:function(St){var Ce=this.group&&!this.group._transformDone||this.group&&this.canvas&&St===this.canvas.contextTop,ke=this.calcTransformMatrix(!Ce);St.transform(ke[0],ke[1],ke[2],ke[3],ke[4],ke[5])},toObject:function(St){var Ce=e.Object.NUM_FRACTION_DIGITS,ke={type:this.type,version:e.version,originX:this.originX,originY:this.originY,left:_e(this.left,Ce),top:_e(this.top,Ce),width:_e(this.width,Ce),height:_e(this.height,Ce),fill:this.fill&&this.fill.toObject?this.fill.toObject():this.fill,stroke:this.stroke&&this.stroke.toObject?this.stroke.toObject():this.stroke,strokeWidth:_e(this.strokeWidth,Ce),strokeDashArray:this.strokeDashArray?this.strokeDashArray.concat():this.strokeDashArray,strokeLineCap:this.strokeLineCap,strokeDashOffset:this.strokeDashOffset,strokeLineJoin:this.strokeLineJoin,strokeUniform:this.strokeUniform,strokeMiterLimit:_e(this.strokeMiterLimit,Ce),scaleX:_e(this.scaleX,Ce),scaleY:_e(this.scaleY,Ce),angle:_e(this.angle,Ce),flipX:this.flipX,flipY:this.flipY,opacity:_e(this.opacity,Ce),shadow:this.shadow&&this.shadow.toObject?this.shadow.toObject():this.shadow,visible:this.visible,backgroundColor:this.backgroundColor,fillRule:this.fillRule,paintFirst:this.paintFirst,globalCompositeOperation:this.globalCompositeOperation,skewX:_e(this.skewX,Ce),skewY:_e(this.skewY,Ce)};return this.clipPath&&!this.clipPath.excludeFromExport&&(ke.clipPath=this.clipPath.toObject(St),ke.clipPath.inverted=this.clipPath.inverted,ke.clipPath.absolutePositioned=this.clipPath.absolutePositioned),e.util.populateWithProperties(this,ke,St),this.includeDefaultValues||(ke=this._removeDefaultValues(ke)),ke},toDatalessObject:function(St){return this.toObject(St)},_removeDefaultValues:function(St){var Ce=e.util.getKlass(St.type).prototype,ke=Ce.stateProperties;return ke.forEach(function(De){De==="left"||De==="top"||(St[De]===Ce[De]&&delete St[De],Array.isArray(St[De])&&Array.isArray(Ce[De])&&St[De].length===0&&Ce[De].length===0&&delete St[De])}),St},toString:function(){return"#<fabric."+Se(this.type)+">"},getObjectScaling:function(){if(!this.group)return{scaleX:this.scaleX,scaleY:this.scaleY};var St=e.util.qrDecompose(this.calcTransformMatrix());return{scaleX:Math.abs(St.scaleX),scaleY:Math.abs(St.scaleY)}},getTotalObjectScaling:function(){var St=this.getObjectScaling(),Ce=St.scaleX,ke=St.scaleY;if(this.canvas){var De=this.canvas.getZoom(),Re=this.canvas.getRetinaScaling();Ce*=De*Re,ke*=De*Re}return{scaleX:Ce,scaleY:ke}},getObjectOpacity:function(){var St=this.opacity;return this.group&&(St*=this.group.getObjectOpacity()),St},_set:function(St,Ce){var ke=St==="scaleX"||St==="scaleY",De=this[St]!==Ce,Re=!1;return ke&&(Ce=this._constrainScale(Ce)),St==="scaleX"&&Ce<0?(this.flipX=!this.flipX,Ce*=-1):St==="scaleY"&&Ce<0?(this.flipY=!this.flipY,Ce*=-1):St==="shadow"&&Ce&&!(Ce instanceof e.Shadow)?Ce=new e.Shadow(Ce):St==="dirty"&&this.group&&this.group.set("dirty",Ce),this[St]=Ce,De&&(Re=this.group&&this.group.isOnACache(),this.cacheProperties.indexOf(St)>-1?(this.dirty=!0,Re&&this.group.set("dirty",!0)):Re&&this.stateProperties.indexOf(St)>-1&&this.group.set("dirty",!0)),this},setOnGroup:function(){},getViewportTransform:function(){return this.canvas&&this.canvas.viewportTransform?this.canvas.viewportTransform:e.iMatrix.concat()},isNotVisible:function(){return this.opacity===0||!this.width&&!this.height&&this.strokeWidth===0||!this.visible},render:function(St){this.isNotVisible()||this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(St.save(),this._setupCompositeOperation(St),this.drawSelectionBackground(St),this.transform(St),this._setOpacity(St),this._setShadow(St,this),this.shouldCache()?(this.renderCache(),this.drawCacheOnCanvas(St)):(this._removeCacheCanvas(),this.dirty=!1,this.drawObject(St),this.objectCaching&&this.statefullCache&&this.saveState({propertySet:"cacheProperties"})),St.restore())},renderCache:function(St){St=St||{},(!this._cacheCanvas||!this._cacheContext)&&this._createCacheCanvas(),this.isCacheDirty()&&(this.statefullCache&&this.saveState({propertySet:"cacheProperties"}),this.drawObject(this._cacheContext,St.forClipping),this.dirty=!1)},_removeCacheCanvas:function(){this._cacheCanvas=null,this._cacheContext=null,this.cacheWidth=0,this.cacheHeight=0},hasStroke:function(){return this.stroke&&this.stroke!=="transparent"&&this.strokeWidth!==0},hasFill:function(){return this.fill&&this.fill!=="transparent"},needsItsOwnCache:function(){return!!(this.paintFirst==="stroke"&&this.hasFill()&&this.hasStroke()&&typeof this.shadow=="object"||this.clipPath)},shouldCache:function(){return this.ownCaching=this.needsItsOwnCache()||this.objectCaching&&(!this.group||!this.group.isOnACache()),this.ownCaching},willDrawShadow:function(){return!!this.shadow&&(this.shadow.offsetX!==0||this.shadow.offsetY!==0)},drawClipPathOnCache:function(St,Ce){if(St.save(),Ce.inverted?St.globalCompositeOperation="destination-out":St.globalCompositeOperation="destination-in",Ce.absolutePositioned){var ke=e.util.invertTransform(this.calcTransformMatrix());St.transform(ke[0],ke[1],ke[2],ke[3],ke[4],ke[5])}Ce.transform(St),St.scale(1/Ce.zoomX,1/Ce.zoomY),St.drawImage(Ce._cacheCanvas,-Ce.cacheTranslationX,-Ce.cacheTranslationY),St.restore()},drawObject:function(St,Ce){var ke=this.fill,De=this.stroke;Ce?(this.fill="black",this.stroke="",this._setClippingProperties(St)):this._renderBackground(St),this._render(St),this._drawClipPath(St,this.clipPath),this.fill=ke,this.stroke=De},_drawClipPath:function(St,Ce){!Ce||(Ce.canvas=this.canvas,Ce.shouldCache(),Ce._transformDone=!0,Ce.renderCache({forClipping:!0}),this.drawClipPathOnCache(St,Ce))},drawCacheOnCanvas:function(St){St.scale(1/this.zoomX,1/this.zoomY),St.drawImage(this._cacheCanvas,-this.cacheTranslationX,-this.cacheTranslationY)},isCacheDirty:function(St){if(this.isNotVisible())return!1;if(this._cacheCanvas&&this._cacheContext&&!St&&this._updateCacheCanvas())return!0;if(this.dirty||this.clipPath&&this.clipPath.absolutePositioned||this.statefullCache&&this.hasStateChanged("cacheProperties")){if(this._cacheCanvas&&this._cacheContext&&!St){var Ce=this.cacheWidth/this.zoomX,ke=this.cacheHeight/this.zoomY;this._cacheContext.clearRect(-Ce/2,-ke/2,Ce,ke)}return!0}return!1},_renderBackground:function(St){if(!!this.backgroundColor){var Ce=this._getNonTransformedDimensions();St.fillStyle=this.backgroundColor,St.fillRect(-Ce.x/2,-Ce.y/2,Ce.x,Ce.y),this._removeShadow(St)}},_setOpacity:function(St){this.group&&!this.group._transformDone?St.globalAlpha=this.getObjectOpacity():St.globalAlpha*=this.opacity},_setStrokeStyles:function(St,Ce){var ke=Ce.stroke;ke&&(St.lineWidth=Ce.strokeWidth,St.lineCap=Ce.strokeLineCap,St.lineDashOffset=Ce.strokeDashOffset,St.lineJoin=Ce.strokeLineJoin,St.miterLimit=Ce.strokeMiterLimit,ke.toLive?ke.gradientUnits==="percentage"||ke.gradientTransform||ke.patternTransform?this._applyPatternForTransformedGradient(St,ke):(St.strokeStyle=ke.toLive(St,this),this._applyPatternGradientTransform(St,ke)):St.strokeStyle=Ce.stroke)},_setFillStyles:function(St,Ce){var ke=Ce.fill;ke&&(ke.toLive?(St.fillStyle=ke.toLive(St,this),this._applyPatternGradientTransform(St,Ce.fill)):St.fillStyle=ke)},_setClippingProperties:function(St){St.globalAlpha=1,St.strokeStyle="transparent",St.fillStyle="#000000"},_setLineDash:function(St,Ce){!Ce||Ce.length===0||(1&Ce.length&&Ce.push.apply(Ce,Ce),St.setLineDash(Ce))},_renderControls:function(St,Ce){var ke=this.getViewportTransform(),De=this.calcTransformMatrix(),Re,je,We;Ce=Ce||{},je=typeof Ce.hasBorders<"u"?Ce.hasBorders:this.hasBorders,We=typeof Ce.hasControls<"u"?Ce.hasControls:this.hasControls,De=e.util.multiplyTransformMatrices(ke,De),Re=e.util.qrDecompose(De),St.save(),St.translate(Re.translateX,Re.translateY),St.lineWidth=1*this.borderScaleFactor,this.group||(St.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1),this.flipX&&(Re.angle-=180),St.rotate(t(this.group?Re.angle:this.angle)),Ce.forActiveSelection||this.group?je&&this.drawBordersInGroup(St,Re,Ce):je&&this.drawBorders(St,Ce),We&&this.drawControls(St,Ce),St.restore()},_setShadow:function(St){if(!!this.shadow){var Ce=this.shadow,ke=this.canvas,De,Re=ke&&ke.viewportTransform[0]||1,je=ke&&ke.viewportTransform[3]||1;Ce.nonScaling?De={scaleX:1,scaleY:1}:De=this.getObjectScaling(),ke&&ke._isRetinaScaling()&&(Re*=e.devicePixelRatio,je*=e.devicePixelRatio),St.shadowColor=Ce.color,St.shadowBlur=Ce.blur*e.browserShadowBlurConstant*(Re+je)*(De.scaleX+De.scaleY)/4,St.shadowOffsetX=Ce.offsetX*Re*De.scaleX,St.shadowOffsetY=Ce.offsetY*je*De.scaleY}},_removeShadow:function(St){!this.shadow||(St.shadowColor="",St.shadowBlur=St.shadowOffsetX=St.shadowOffsetY=0)},_applyPatternGradientTransform:function(St,Ce){if(!Ce||!Ce.toLive)return{offsetX:0,offsetY:0};var ke=Ce.gradientTransform||Ce.patternTransform,De=-this.width/2+Ce.offsetX||0,Re=-this.height/2+Ce.offsetY||0;return Ce.gradientUnits==="percentage"?St.transform(this.width,0,0,this.height,De,Re):St.transform(1,0,0,1,De,Re),ke&&St.transform(ke[0],ke[1],ke[2],ke[3],ke[4],ke[5]),{offsetX:De,offsetY:Re}},_renderPaintInOrder:function(St){this.paintFirst==="stroke"?(this._renderStroke(St),this._renderFill(St)):(this._renderFill(St),this._renderStroke(St))},_render:function(){},_renderFill:function(St){!this.fill||(St.save(),this._setFillStyles(St,this),this.fillRule==="evenodd"?St.fill("evenodd"):St.fill(),St.restore())},_renderStroke:function(St){if(!(!this.stroke||this.strokeWidth===0)){if(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(St),St.save(),this.strokeUniform&&this.group){var Ce=this.getObjectScaling();St.scale(1/Ce.scaleX,1/Ce.scaleY)}else this.strokeUniform&&St.scale(1/this.scaleX,1/this.scaleY);this._setLineDash(St,this.strokeDashArray),this._setStrokeStyles(St,this),St.stroke(),St.restore()}},_applyPatternForTransformedGradient:function(St,Ce){var ke=this._limitCacheSize(this._getCacheCanvasDimensions()),De=e.util.createCanvasElement(),Re,je=this.canvas.getRetinaScaling(),We=ke.x/this.scaleX/je,Ke=ke.y/this.scaleY/je;De.width=We,De.height=Ke,Re=De.getContext("2d"),Re.beginPath(),Re.moveTo(0,0),Re.lineTo(We,0),Re.lineTo(We,Ke),Re.lineTo(0,Ke),Re.closePath(),Re.translate(We/2,Ke/2),Re.scale(ke.zoomX/this.scaleX/je,ke.zoomY/this.scaleY/je),this._applyPatternGradientTransform(Re,Ce),Re.fillStyle=Ce.toLive(St),Re.fill(),St.translate(-this.width/2-this.strokeWidth/2,-this.height/2-this.strokeWidth/2),St.scale(je*this.scaleX/ke.zoomX,je*this.scaleY/ke.zoomY),St.strokeStyle=Re.createPattern(De,"no-repeat")},_findCenterFromElement:function(){return{x:this.left+this.width/2,y:this.top+this.height/2}},_assignTransformMatrixProps:function(){if(this.transformMatrix){var St=e.util.qrDecompose(this.transformMatrix);this.flipX=!1,this.flipY=!1,this.set("scaleX",St.scaleX),this.set("scaleY",St.scaleY),this.angle=St.angle,this.skewX=St.skewX,this.skewY=0}},_removeTransformMatrix:function(St){var Ce=this._findCenterFromElement();this.transformMatrix&&(this._assignTransformMatrixProps(),Ce=e.util.transformPoint(Ce,this.transformMatrix)),this.transformMatrix=null,St&&(this.scaleX*=St.scaleX,this.scaleY*=St.scaleY,this.cropX=St.cropX,this.cropY=St.cropY,Ce.x+=St.offsetLeft,Ce.y+=St.offsetTop,this.width=St.width,this.height=St.height),this.setPositionByOrigin(Ce,"center","center")},clone:function(St,Ce){var ke=this.toObject(Ce);this.constructor.fromObject?this.constructor.fromObject(ke,St):e.Object._fromObject("Object",ke,St)},cloneAsImage:function(St,Ce){var ke=this.toCanvasElement(Ce);return St&&St(new e.Image(ke)),this},toCanvasElement:function(St){St||(St={});var Ce=e.util,ke=Ce.saveObjectTransform(this),De=this.group,Re=this.shadow,je=Math.abs,We=(St.multiplier||1)*(St.enableRetinaScaling?e.devicePixelRatio:1);delete this.group,St.withoutTransform&&Ce.resetObjectTransform(this),St.withoutShadow&&(this.shadow=null);var Ke=e.util.createCanvasElement(),Je=this.getBoundingRect(!0,!0),hi=this.shadow,oi,ti={x:0,y:0},ai,yi,di;hi&&(ai=hi.blur,hi.nonScaling?oi={scaleX:1,scaleY:1}:oi=this.getObjectScaling(),ti.x=2*Math.round(je(hi.offsetX)+ai)*je(oi.scaleX),ti.y=2*Math.round(je(hi.offsetY)+ai)*je(oi.scaleY)),yi=Je.width+ti.x,di=Je.height+ti.y,Ke.width=Math.ceil(yi),Ke.height=Math.ceil(di);var bi=new e.StaticCanvas(Ke,{enableRetinaScaling:!1,renderOnAddRemove:!1,skipOffscreen:!1});St.format==="jpeg"&&(bi.backgroundColor="#fff"),this.setPositionByOrigin(new e.Point(bi.width/2,bi.height/2),"center","center");var vi=this.canvas;bi.add(this);var Pi=bi.toCanvasElement(We||1,St);return this.shadow=Re,this.set("canvas",vi),De&&(this.group=De),this.set(ke).setCoords(),bi._objects=[],bi.dispose(),bi=null,Pi},toDataURL:function(St){return St||(St={}),e.util.toDataURL(this.toCanvasElement(St),St.format||"png",St.quality||1)},isType:function(St){return arguments.length>1?Array.from(arguments).includes(this.type):this.type===St},complexity:function(){return 1},toJSON:function(St){return this.toObject(St)},rotate:function(St){var Ce=(this.originX!=="center"||this.originY!=="center")&&this.centeredRotation;return Ce&&this._setOriginToCenter(),this.set("angle",St),Ce&&this._resetOrigin(),this},centerH:function(){return this.canvas&&this.canvas.centerObjectH(this),this},viewportCenterH:function(){return this.canvas&&this.canvas.viewportCenterObjectH(this),this},centerV:function(){return this.canvas&&this.canvas.centerObjectV(this),this},viewportCenterV:function(){return this.canvas&&this.canvas.viewportCenterObjectV(this),this},center:function(){return this.canvas&&this.canvas.centerObject(this),this},viewportCenter:function(){return this.canvas&&this.canvas.viewportCenterObject(this),this},getLocalPointer:function(St,Ce){Ce=Ce||this.canvas.getPointer(St);var ke=new e.Point(Ce.x,Ce.y),De=this._getLeftTopCoords();return this.angle&&(ke=e.util.rotatePoint(ke,De,t(-this.angle))),{x:ke.x-De.x,y:ke.y-De.y}},_setupCompositeOperation:function(St){this.globalCompositeOperation&&(St.globalCompositeOperation=this.globalCompositeOperation)},dispose:function(){e.runningAnimations&&e.runningAnimations.cancelByTarget(this)}}),e.util.createAccessors&&e.util.createAccessors(e.Object),xe(e.Object.prototype,e.Observable),e.Object.NUM_FRACTION_DIGITS=2,e.Object.ENLIVEN_PROPS=["clipPath"],e.Object._fromObject=function(St,Ce,ke,De){var Re=e[St];Ce=Te(Ce,!0),e.util.enlivenPatterns([Ce.fill,Ce.stroke],function(je){typeof je[0]<"u"&&(Ce.fill=je[0]),typeof je[1]<"u"&&(Ce.stroke=je[1]),e.util.enlivenObjectEnlivables(Ce,Ce,function(){var We=De?new Re(Ce[De],Ce):new Re(Ce);ke&&ke(We)})})},e.Object.__uid=0)}(Ie),function(){var Ee=r.util.degreesToRadians,e={left:-.5,center:0,right:.5},xe={top:-.5,center:0,bottom:.5};r.util.object.extend(r.Object.prototype,{translateToGivenOrigin:function(Te,_e,Se,t,Ae){var Pe=Te.x,St=Te.y,Ce,ke,De;return typeof _e=="string"?_e=e[_e]:_e-=.5,typeof t=="string"?t=e[t]:t-=.5,Ce=t-_e,typeof Se=="string"?Se=xe[Se]:Se-=.5,typeof Ae=="string"?Ae=xe[Ae]:Ae-=.5,ke=Ae-Se,(Ce||ke)&&(De=this._getTransformedDimensions(),Pe=Te.x+Ce*De.x,St=Te.y+ke*De.y),new r.Point(Pe,St)},translateToCenterPoint:function(Te,_e,Se){var t=this.translateToGivenOrigin(Te,_e,Se,"center","center");return this.angle?r.util.rotatePoint(t,Te,Ee(this.angle)):t},translateToOriginPoint:function(Te,_e,Se){var t=this.translateToGivenOrigin(Te,"center","center",_e,Se);return this.angle?r.util.rotatePoint(t,Te,Ee(this.angle)):t},getCenterPoint:function(){var Te=new r.Point(this.left,this.top);return this.translateToCenterPoint(Te,this.originX,this.originY)},getPointByOrigin:function(Te,_e){var Se=this.getCenterPoint();return this.translateToOriginPoint(Se,Te,_e)},toLocalPoint:function(Te,_e,Se){var t=this.getCenterPoint(),Ae,Pe;return typeof _e<"u"&&typeof Se<"u"?Ae=this.translateToGivenOrigin(t,"center","center",_e,Se):Ae=new r.Point(this.left,this.top),Pe=new r.Point(Te.x,Te.y),this.angle&&(Pe=r.util.rotatePoint(Pe,t,-Ee(this.angle))),Pe.subtractEquals(Ae)},setPositionByOrigin:function(Te,_e,Se){var t=this.translateToCenterPoint(Te,_e,Se),Ae=this.translateToOriginPoint(t,this.originX,this.originY);this.set("left",Ae.x),this.set("top",Ae.y)},adjustPosition:function(Te){var _e=Ee(this.angle),Se=this.getScaledWidth(),t=r.util.cos(_e)*Se,Ae=r.util.sin(_e)*Se,Pe,St;typeof this.originX=="string"?Pe=e[this.originX]:Pe=this.originX-.5,typeof Te=="string"?St=e[Te]:St=Te-.5,this.left+=t*(St-Pe),this.top+=Ae*(St-Pe),this.setCoords(),this.originX=Te},_setOriginToCenter:function(){this._originalOriginX=this.originX,this._originalOriginY=this.originY;var Te=this.getCenterPoint();this.originX="center",this.originY="center",this.left=Te.x,this.top=Te.y},_resetOrigin:function(){var Te=this.translateToOriginPoint(this.getCenterPoint(),this._originalOriginX,this._originalOriginY);this.originX=this._originalOriginX,this.originY=this._originalOriginY,this.left=Te.x,this.top=Te.y,this._originalOriginX=null,this._originalOriginY=null},_getLeftTopCoords:function(){return this.translateToOriginPoint(this.getCenterPoint(),"left","top")}})}(),function(){function Ee(Se){return[new r.Point(Se.tl.x,Se.tl.y),new r.Point(Se.tr.x,Se.tr.y),new r.Point(Se.br.x,Se.br.y),new r.Point(Se.bl.x,Se.bl.y)]}var e=r.util,xe=e.degreesToRadians,Te=e.multiplyTransformMatrices,_e=e.transformPoint;e.object.extend(r.Object.prototype,{oCoords:null,aCoords:null,lineCoords:null,ownMatrixCache:null,matrixCache:null,controls:{},_getCoords:function(Se,t){return t?Se?this.calcACoords():this.calcLineCoords():((!this.aCoords||!this.lineCoords)&&this.setCoords(!0),Se?this.aCoords:this.lineCoords)},getCoords:function(Se,t){return Ee(this._getCoords(Se,t))},intersectsWithRect:function(Se,t,Ae,Pe){var St=this.getCoords(Ae,Pe),Ce=r.Intersection.intersectPolygonRectangle(St,Se,t);return Ce.status==="Intersection"},intersectsWithObject:function(Se,t,Ae){var Pe=r.Intersection.intersectPolygonPolygon(this.getCoords(t,Ae),Se.getCoords(t,Ae));return Pe.status==="Intersection"||Se.isContainedWithinObject(this,t,Ae)||this.isContainedWithinObject(Se,t,Ae)},isContainedWithinObject:function(Se,t,Ae){for(var Pe=this.getCoords(t,Ae),St=t?Se.aCoords:Se.lineCoords,Ce=0,ke=Se._getImageLines(St);Ce<4;Ce++)if(!Se.containsPoint(Pe[Ce],ke))return!1;return!0},isContainedWithinRect:function(Se,t,Ae,Pe){var St=this.getBoundingRect(Ae,Pe);return St.left>=Se.x&&St.left+St.width<=t.x&&St.top>=Se.y&&St.top+St.height<=t.y},containsPoint:function(Se,Ce,Ae,Pe){var St=this._getCoords(Ae,Pe),Ce=Ce||this._getImageLines(St),ke=this._findCrossPoints(Se,Ce);return ke!==0&&ke%2===1},isOnScreen:function(Se){if(!this.canvas)return!1;var t=this.canvas.vptCoords.tl,Ae=this.canvas.vptCoords.br,Pe=this.getCoords(!0,Se);return Pe.some(function(St){return St.x<=Ae.x&&St.x>=t.x&&St.y<=Ae.y&&St.y>=t.y})||this.intersectsWithRect(t,Ae,!0,Se)?!0:this._containsCenterOfCanvas(t,Ae,Se)},_containsCenterOfCanvas:function(Se,t,Ae){var Pe={x:(Se.x+t.x)/2,y:(Se.y+t.y)/2};return!!this.containsPoint(Pe,null,!0,Ae)},isPartiallyOnScreen:function(Se){if(!this.canvas)return!1;var t=this.canvas.vptCoords.tl,Ae=this.canvas.vptCoords.br;if(this.intersectsWithRect(t,Ae,!0,Se))return!0;var Pe=this.getCoords(!0,Se).every(function(St){return(St.x>=Ae.x||St.x<=t.x)&&(St.y>=Ae.y||St.y<=t.y)});return Pe&&this._containsCenterOfCanvas(t,Ae,Se)},_getImageLines:function(Se){var t={topline:{o:Se.tl,d:Se.tr},rightline:{o:Se.tr,d:Se.br},bottomline:{o:Se.br,d:Se.bl},leftline:{o:Se.bl,d:Se.tl}};return t},_findCrossPoints:function(Se,t){var Ae,Pe,St,Ce,ke,De=0,Re;for(var je in t)if(Re=t[je],!(Re.o.y<Se.y&&Re.d.y<Se.y)&&!(Re.o.y>=Se.y&&Re.d.y>=Se.y)&&(Re.o.x===Re.d.x&&Re.o.x>=Se.x?ke=Re.o.x:(Ae=0,Pe=(Re.d.y-Re.o.y)/(Re.d.x-Re.o.x),St=Se.y-Ae*Se.x,Ce=Re.o.y-Pe*Re.o.x,ke=-(St-Ce)/(Ae-Pe)),ke>=Se.x&&(De+=1),De===2))break;return De},getBoundingRect:function(Se,t){var Ae=this.getCoords(Se,t);return e.makeBoundingBoxFromPoints(Ae)},getScaledWidth:function(){return this._getTransformedDimensions().x},getScaledHeight:function(){return this._getTransformedDimensions().y},_constrainScale:function(Se){return Math.abs(Se)<this.minScaleLimit?Se<0?-this.minScaleLimit:this.minScaleLimit:Se===0?1e-4:Se},scale:function(Se){return this._set("scaleX",Se),this._set("scaleY",Se),this.setCoords()},scaleToWidth:function(Se,t){var Ae=this.getBoundingRect(t).width/this.getScaledWidth();return this.scale(Se/this.width/Ae)},scaleToHeight:function(Se,t){var Ae=this.getBoundingRect(t).height/this.getScaledHeight();return this.scale(Se/this.height/Ae)},calcLineCoords:function(){var Se=this.getViewportTransform(),t=this.padding,Ae=xe(this.angle),Pe=e.cos(Ae),St=e.sin(Ae),Ce=Pe*t,ke=St*t,De=Ce+ke,Re=Ce-ke,je=this.calcACoords(),We={tl:_e(je.tl,Se),tr:_e(je.tr,Se),bl:_e(je.bl,Se),br:_e(je.br,Se)};return t&&(We.tl.x-=Re,We.tl.y-=De,We.tr.x+=De,We.tr.y-=Re,We.bl.x-=De,We.bl.y+=Re,We.br.x+=Re,We.br.y+=De),We},calcOCoords:function(){var Se=this._calcRotateMatrix(),t=this._calcTranslateMatrix(),Ae=this.getViewportTransform(),Pe=Te(Ae,t),St=Te(Pe,Se),St=Te(St,[1/Ae[0],0,0,1/Ae[3],0,0]),Ce=this._calculateCurrentDimensions(),ke={};return this.forEachControl(function(De,Re,je){ke[Re]=De.positionHandler(Ce,St,je)}),ke},calcACoords:function(){var Se=this._calcRotateMatrix(),t=this._calcTranslateMatrix(),Ae=Te(t,Se),Pe=this._getTransformedDimensions(),St=Pe.x/2,Ce=Pe.y/2;return{tl:_e({x:-St,y:-Ce},Ae),tr:_e({x:St,y:-Ce},Ae),bl:_e({x:-St,y:Ce},Ae),br:_e({x:St,y:Ce},Ae)}},setCoords:function(Se){return this.aCoords=this.calcACoords(),this.lineCoords=this.group?this.aCoords:this.calcLineCoords(),Se?this:(this.oCoords=this.calcOCoords(),this._setCornerCoords&&this._setCornerCoords(),this)},_calcRotateMatrix:function(){return e.calcRotateMatrix(this)},_calcTranslateMatrix:function(){var Se=this.getCenterPoint();return[1,0,0,1,Se.x,Se.y]},transformMatrixKey:function(Se){var t="_",Ae="";return!Se&&this.group&&(Ae=this.group.transformMatrixKey(Se)+t),Ae+this.top+t+this.left+t+this.scaleX+t+this.scaleY+t+this.skewX+t+this.skewY+t+this.angle+t+this.originX+t+this.originY+t+this.width+t+this.height+t+this.strokeWidth+this.flipX+this.flipY},calcTransformMatrix:function(Se){var t=this.calcOwnMatrix();if(Se||!this.group)return t;var Ae=this.transformMatrixKey(Se),Pe=this.matrixCache||(this.matrixCache={});return Pe.key===Ae?Pe.value:(this.group&&(t=Te(this.group.calcTransformMatrix(!1),t)),Pe.key=Ae,Pe.value=t,t)},calcOwnMatrix:function(){var Se=this.transformMatrixKey(!0),t=this.ownMatrixCache||(this.ownMatrixCache={});if(t.key===Se)return t.value;var Ae=this._calcTranslateMatrix(),Pe={angle:this.angle,translateX:Ae[4],translateY:Ae[5],scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY,flipX:this.flipX,flipY:this.flipY};return t.key=Se,t.value=e.composeMatrix(Pe),t.value},_getNonTransformedDimensions:function(){var Se=this.strokeWidth,t=this.width+Se,Ae=this.height+Se;return{x:t,y:Ae}},_getTransformedDimensions:function(Se,t){typeof Se>"u"&&(Se=this.skewX),typeof t>"u"&&(t=this.skewY);var Ae,Pe,St,Ce=Se===0&&t===0;if(this.strokeUniform?(Pe=this.width,St=this.height):(Ae=this._getNonTransformedDimensions(),Pe=Ae.x,St=Ae.y),Ce)return this._finalizeDimensions(Pe*this.scaleX,St*this.scaleY);var ke=e.sizeAfterTransform(Pe,St,{scaleX:this.scaleX,scaleY:this.scaleY,skewX:Se,skewY:t});return this._finalizeDimensions(ke.x,ke.y)},_finalizeDimensions:function(Se,t){return this.strokeUniform?{x:Se+this.strokeWidth,y:t+this.strokeWidth}:{x:Se,y:t}},_calculateCurrentDimensions:function(){var Se=this.getViewportTransform(),t=this._getTransformedDimensions(),Ae=_e(t,Se,!0);return Ae.scalarAdd(2*this.padding)}})}(),r.util.object.extend(r.Object.prototype,{sendToBack:function(){return this.group?r.StaticCanvas.prototype.sendToBack.call(this.group,this):this.canvas&&this.canvas.sendToBack(this),this},bringToFront:function(){return this.group?r.StaticCanvas.prototype.bringToFront.call(this.group,this):this.canvas&&this.canvas.bringToFront(this),this},sendBackwards:function(Ee){return this.group?r.StaticCanvas.prototype.sendBackwards.call(this.group,this,Ee):this.canvas&&this.canvas.sendBackwards(this,Ee),this},bringForward:function(Ee){return this.group?r.StaticCanvas.prototype.bringForward.call(this.group,this,Ee):this.canvas&&this.canvas.bringForward(this,Ee),this},moveTo:function(Ee){return this.group&&this.group.type!=="activeSelection"?r.StaticCanvas.prototype.moveTo.call(this.group,this,Ee):this.canvas&&this.canvas.moveTo(this,Ee),this}}),function(){function Ee(xe,Te){if(Te){if(Te.toLive)return xe+": url(#SVGID_"+Te.id+"); ";var _e=new r.Color(Te),Se=xe+": "+_e.toRgb()+"; ",t=_e.getAlpha();return t!==1&&(Se+=xe+"-opacity: "+t.toString()+"; "),Se}else return xe+": none; "}var e=r.util.toFixed;r.util.object.extend(r.Object.prototype,{getSvgStyles:function(xe){var Te=this.fillRule?this.fillRule:"nonzero",_e=this.strokeWidth?this.strokeWidth:"0",Se=this.strokeDashArray?this.strokeDashArray.join(" "):"none",t=this.strokeDashOffset?this.strokeDashOffset:"0",Ae=this.strokeLineCap?this.strokeLineCap:"butt",Pe=this.strokeLineJoin?this.strokeLineJoin:"miter",St=this.strokeMiterLimit?this.strokeMiterLimit:"4",Ce=typeof this.opacity<"u"?this.opacity:"1",ke=this.visible?"":" visibility: hidden;",De=xe?"":this.getSvgFilter(),Re=Ee("fill",this.fill),je=Ee("stroke",this.stroke);return[je,"stroke-width: ",_e,"; ","stroke-dasharray: ",Se,"; ","stroke-linecap: ",Ae,"; ","stroke-dashoffset: ",t,"; ","stroke-linejoin: ",Pe,"; ","stroke-miterlimit: ",St,"; ",Re,"fill-rule: ",Te,"; ","opacity: ",Ce,";",De,ke].join("")},getSvgSpanStyles:function(xe,Te){var _e="; ",t=xe.fontFamily?"font-family: "+(xe.fontFamily.indexOf("'")===-1&&xe.fontFamily.indexOf('"')===-1?"'"+xe.fontFamily+"'":xe.fontFamily)+_e:"",Se=xe.strokeWidth?"stroke-width: "+xe.strokeWidth+_e:"",t=t,Ae=xe.fontSize?"font-size: "+xe.fontSize+"px"+_e:"",Pe=xe.fontStyle?"font-style: "+xe.fontStyle+_e:"",St=xe.fontWeight?"font-weight: "+xe.fontWeight+_e:"",Ce=xe.fill?Ee("fill",xe.fill):"",ke=xe.stroke?Ee("stroke",xe.stroke):"",De=this.getSvgTextDecoration(xe),Re=xe.deltaY?"baseline-shift: "+-xe.deltaY+"; ":"";return De&&(De="text-decoration: "+De+_e),[ke,Se,t,Ae,Pe,St,De,Ce,Re,Te?"white-space: pre; ":""].join("")},getSvgTextDecoration:function(xe){return["overline","underline","line-through"].filter(function(Te){return xe[Te.replace("-","")]}).join(" ")},getSvgFilter:function(){return this.shadow?"filter: url(#SVGID_"+this.shadow.id+");":""},getSvgCommons:function(){return[this.id?'id="'+this.id+'" ':"",this.clipPath?'clip-path="url(#'+this.clipPath.clipPathId+')" ':""].join("")},getSvgTransform:function(xe,Te){var _e=xe?this.calcTransformMatrix():this.calcOwnMatrix(),Se='transform="'+r.util.matrixToSVG(_e);return Se+(Te||"")+'" '},_setSVGBg:function(xe){if(this.backgroundColor){var Te=r.Object.NUM_FRACTION_DIGITS;xe.push("		<rect ",this._getFillAttributes(this.backgroundColor),' x="',e(-this.width/2,Te),'" y="',e(-this.height/2,Te),'" width="',e(this.width,Te),'" height="',e(this.height,Te),`"></rect>
`)}},toSVG:function(xe){return this._createBaseSVGMarkup(this._toSVG(xe),{reviver:xe})},toClipPathSVG:function(xe){return"	"+this._createBaseClipPathSVGMarkup(this._toSVG(xe),{reviver:xe})},_createBaseClipPathSVGMarkup:function(xe,Te){Te=Te||{};var _e=Te.reviver,Se=Te.additionalTransform||"",t=[this.getSvgTransform(!0,Se),this.getSvgCommons()].join(""),Ae=xe.indexOf("COMMON_PARTS");return xe[Ae]=t,_e?_e(xe.join("")):xe.join("")},_createBaseSVGMarkup:function(xe,Te){Te=Te||{};var _e=Te.noStyle,Se=Te.reviver,t=_e?"":'style="'+this.getSvgStyles()+'" ',Ae=Te.withShadow?'style="'+this.getSvgFilter()+'" ':"",Pe=this.clipPath,St=this.strokeUniform?'vector-effect="non-scaling-stroke" ':"",Ce=Pe&&Pe.absolutePositioned,ke=this.stroke,De=this.fill,Re=this.shadow,je,We=[],Ke,Je=xe.indexOf("COMMON_PARTS"),hi=Te.additionalTransform;return Pe&&(Pe.clipPathId="CLIPPATH_"+r.Object.__uid++,Ke='<clipPath id="'+Pe.clipPathId+`" >
`+Pe.toClipPathSVG(Se)+`</clipPath>
`),Ce&&We.push("<g ",Ae,this.getSvgCommons(),` >
`),We.push("<g ",this.getSvgTransform(!1),Ce?"":Ae+this.getSvgCommons(),` >
`),je=[t,St,_e?"":this.addPaintOrder()," ",hi?'transform="'+hi+'" ':""].join(""),xe[Je]=je,De&&De.toLive&&We.push(De.toSVG(this)),ke&&ke.toLive&&We.push(ke.toSVG(this)),Re&&We.push(Re.toSVG(this)),Pe&&We.push(Ke),We.push(xe.join("")),We.push(`</g>
`),Ce&&We.push(`</g>
`),Se?Se(We.join("")):We.join("")},addPaintOrder:function(){return this.paintFirst!=="fill"?' paint-order="'+this.paintFirst+'" ':""}})}(),function(){var Ee=r.util.object.extend,e="stateProperties";function xe(_e,Se,t){var Ae={},Pe=!0;t.forEach(function(St){Ae[St]=_e[St]}),Ee(_e[Se],Ae,Pe)}function Te(_e,Se,t){if(_e===Se)return!0;if(Array.isArray(_e)){if(!Array.isArray(Se)||_e.length!==Se.length)return!1;for(var Ae=0,Pe=_e.length;Ae<Pe;Ae++)if(!Te(_e[Ae],Se[Ae]))return!1;return!0}else if(_e&&typeof _e=="object"){var St=Object.keys(_e),Ce;if(!Se||typeof Se!="object"||!t&&St.length!==Object.keys(Se).length)return!1;for(var Ae=0,Pe=St.length;Ae<Pe;Ae++)if(Ce=St[Ae],!(Ce==="canvas"||Ce==="group")&&!Te(_e[Ce],Se[Ce]))return!1;return!0}}r.util.object.extend(r.Object.prototype,{hasStateChanged:function(_e){_e=_e||e;var Se="_"+_e;return Object.keys(this[Se]).length<this[_e].length?!0:!Te(this[Se],this,!0)},saveState:function(_e){var Se=_e&&_e.propertySet||e,t="_"+Se;return this[t]?(xe(this,t,this[Se]),_e&&_e.stateProperties&&xe(this,t,_e.stateProperties),this):this.setupState(_e)},setupState:function(_e){_e=_e||{};var Se=_e.propertySet||e;return _e.propertySet=Se,this["_"+Se]={},this.saveState(_e),this}})}(),function(){var Ee=r.util.degreesToRadians;r.util.object.extend(r.Object.prototype,{_findTargetCorner:function(e,xe){if(!this.hasControls||this.group||!this.canvas||this.canvas._activeObject!==this)return!1;var Te=e.x,_e=e.y,Se,t,Ae=Object.keys(this.oCoords),Pe=Ae.length-1,St;for(this.__corner=0;Pe>=0;Pe--)if(St=Ae[Pe],!!this.isControlVisible(St)&&(t=this._getImageLines(xe?this.oCoords[St].touchCorner:this.oCoords[St].corner),Se=this._findCrossPoints({x:Te,y:_e},t),Se!==0&&Se%2===1))return this.__corner=St,St;return!1},forEachControl:function(e){for(var xe in this.controls)e(this.controls[xe],xe,this)},_setCornerCoords:function(){var e=this.oCoords;for(var xe in e){var Te=this.controls[xe];e[xe].corner=Te.calcCornerCoords(this.angle,this.cornerSize,e[xe].x,e[xe].y,!1),e[xe].touchCorner=Te.calcCornerCoords(this.angle,this.touchCornerSize,e[xe].x,e[xe].y,!0)}},drawSelectionBackground:function(e){if(!this.selectionBackgroundColor||this.canvas&&!this.canvas.interactive||this.canvas&&this.canvas._activeObject!==this)return this;e.save();var xe=this.getCenterPoint(),Te=this._calculateCurrentDimensions(),_e=this.canvas.viewportTransform;return e.translate(xe.x,xe.y),e.scale(1/_e[0],1/_e[3]),e.rotate(Ee(this.angle)),e.fillStyle=this.selectionBackgroundColor,e.fillRect(-Te.x/2,-Te.y/2,Te.x,Te.y),e.restore(),this},drawBorders:function(e,xe){xe=xe||{};var Te=this._calculateCurrentDimensions(),_e=this.borderScaleFactor,Se=Te.x+_e,t=Te.y+_e,Ae=typeof xe.hasControls<"u"?xe.hasControls:this.hasControls,Pe=!1;return e.save(),e.strokeStyle=xe.borderColor||this.borderColor,this._setLineDash(e,xe.borderDashArray||this.borderDashArray),e.strokeRect(-Se/2,-t/2,Se,t),Ae&&(e.beginPath(),this.forEachControl(function(St,Ce,ke){St.withConnection&&St.getVisibility(ke,Ce)&&(Pe=!0,e.moveTo(St.x*Se,St.y*t),e.lineTo(St.x*Se+St.offsetX,St.y*t+St.offsetY))}),Pe&&e.stroke()),e.restore(),this},drawBordersInGroup:function(e,xe,Te){Te=Te||{};var _e=r.util.sizeAfterTransform(this.width,this.height,xe),Se=this.strokeWidth,t=this.strokeUniform,Ae=this.borderScaleFactor,Pe=_e.x+Se*(t?this.canvas.getZoom():xe.scaleX)+Ae,St=_e.y+Se*(t?this.canvas.getZoom():xe.scaleY)+Ae;return e.save(),this._setLineDash(e,Te.borderDashArray||this.borderDashArray),e.strokeStyle=Te.borderColor||this.borderColor,e.strokeRect(-Pe/2,-St/2,Pe,St),e.restore(),this},drawControls:function(e,xe){xe=xe||{},e.save();var Te=this.canvas.getRetinaScaling(),_e,Se;return e.setTransform(Te,0,0,Te,0,0),e.strokeStyle=e.fillStyle=xe.cornerColor||this.cornerColor,this.transparentCorners||(e.strokeStyle=xe.cornerStrokeColor||this.cornerStrokeColor),this._setLineDash(e,xe.cornerDashArray||this.cornerDashArray),this.setCoords(),this.group&&(_e=this.group.calcTransformMatrix()),this.forEachControl(function(t,Ae,Pe){Se=Pe.oCoords[Ae],t.getVisibility(Pe,Ae)&&(_e&&(Se=r.util.transformPoint(Se,_e)),t.render(e,Se.x,Se.y,xe,Pe))}),e.restore(),this},isControlVisible:function(e){return this.controls[e]&&this.controls[e].getVisibility(this,e)},setControlVisible:function(e,xe){return this._controlsVisibility||(this._controlsVisibility={}),this._controlsVisibility[e]=xe,this},setControlsVisibility:function(e){e||(e={});for(var xe in e)this.setControlVisible(xe,e[xe]);return this},onDeselect:function(){},onSelect:function(){}})}(),r.util.object.extend(r.StaticCanvas.prototype,{FX_DURATION:500,fxCenterObjectH:function(Ee,e){e=e||{};var xe=function(){},Te=e.onComplete||xe,_e=e.onChange||xe,Se=this;return r.util.animate({target:this,startValue:Ee.left,endValue:this.getCenterPoint().x,duration:this.FX_DURATION,onChange:function(t){Ee.set("left",t),Se.requestRenderAll(),_e()},onComplete:function(){Ee.setCoords(),Te()}})},fxCenterObjectV:function(Ee,e){e=e||{};var xe=function(){},Te=e.onComplete||xe,_e=e.onChange||xe,Se=this;return r.util.animate({target:this,startValue:Ee.top,endValue:this.getCenterPoint().y,duration:this.FX_DURATION,onChange:function(t){Ee.set("top",t),Se.requestRenderAll(),_e()},onComplete:function(){Ee.setCoords(),Te()}})},fxRemove:function(Ee,e){e=e||{};var xe=function(){},Te=e.onComplete||xe,_e=e.onChange||xe,Se=this;return r.util.animate({target:this,startValue:Ee.opacity,endValue:0,duration:this.FX_DURATION,onChange:function(t){Ee.set("opacity",t),Se.requestRenderAll(),_e()},onComplete:function(){Se.remove(Ee),Te()}})}}),r.util.object.extend(r.Object.prototype,{animate:function(){if(arguments[0]&&typeof arguments[0]=="object"){var Ee=[],e,xe,Te=[];for(e in arguments[0])Ee.push(e);for(var _e=0,Se=Ee.length;_e<Se;_e++)e=Ee[_e],xe=_e!==Se-1,Te.push(this._animate(e,arguments[0][e],arguments[1],xe));return Te}else return this._animate.apply(this,arguments)},_animate:function(Ee,e,xe,Te){var _e=this,Se;e=e.toString(),xe?xe=r.util.object.clone(xe):xe={},~Ee.indexOf(".")&&(Se=Ee.split("."));var t=_e.colorProperties.indexOf(Ee)>-1||Se&&_e.colorProperties.indexOf(Se[1])>-1,Ae=Se?this.get(Se[0])[Se[1]]:this.get(Ee);"from"in xe||(xe.from=Ae),t||(~e.indexOf("=")?e=Ae+parseFloat(e.replace("=","")):e=parseFloat(e));var Pe={target:this,startValue:xe.from,endValue:e,byValue:xe.by,easing:xe.easing,duration:xe.duration,abort:xe.abort&&function(St,Ce,ke){return xe.abort.call(_e,St,Ce,ke)},onChange:function(St,Ce,ke){Se?_e[Se[0]][Se[1]]=St:_e.set(Ee,St),!Te&&xe.onChange&&xe.onChange(St,Ce,ke)},onComplete:function(St,Ce,ke){Te||(_e.setCoords(),xe.onComplete&&xe.onComplete(St,Ce,ke))}};return t?r.util.animateColor(Pe.startValue,Pe.endValue,Pe.duration,Pe):r.util.animate(Pe)}}),function(Ee){var e=Ee.fabric||(Ee.fabric={}),xe=e.util.object.extend,Te=e.util.object.clone,_e={x1:1,x2:1,y1:1,y2:1};if(e.Line){e.warn("fabric.Line is already defined");return}e.Line=e.util.createClass(e.Object,{type:"line",x1:0,y1:0,x2:0,y2:0,cacheProperties:e.Object.prototype.cacheProperties.concat("x1","x2","y1","y2"),initialize:function(t,Ae){t||(t=[0,0,0,0]),this.callSuper("initialize",Ae),this.set("x1",t[0]),this.set("y1",t[1]),this.set("x2",t[2]),this.set("y2",t[3]),this._setWidthHeight(Ae)},_setWidthHeight:function(t){t||(t={}),this.width=Math.abs(this.x2-this.x1),this.height=Math.abs(this.y2-this.y1),this.left="left"in t?t.left:this._getLeftToOriginX(),this.top="top"in t?t.top:this._getTopToOriginY()},_set:function(t,Ae){return this.callSuper("_set",t,Ae),typeof _e[t]<"u"&&this._setWidthHeight(),this},_getLeftToOriginX:Se({origin:"originX",axis1:"x1",axis2:"x2",dimension:"width"},{nearest:"left",center:"center",farthest:"right"}),_getTopToOriginY:Se({origin:"originY",axis1:"y1",axis2:"y2",dimension:"height"},{nearest:"top",center:"center",farthest:"bottom"}),_render:function(t){t.beginPath();var Ae=this.calcLinePoints();t.moveTo(Ae.x1,Ae.y1),t.lineTo(Ae.x2,Ae.y2),t.lineWidth=this.strokeWidth;var Pe=t.strokeStyle;t.strokeStyle=this.stroke||t.fillStyle,this.stroke&&this._renderStroke(t),t.strokeStyle=Pe},_findCenterFromElement:function(){return{x:(this.x1+this.x2)/2,y:(this.y1+this.y2)/2}},toObject:function(t){return xe(this.callSuper("toObject",t),this.calcLinePoints())},_getNonTransformedDimensions:function(){var t=this.callSuper("_getNonTransformedDimensions");return this.strokeLineCap==="butt"&&(this.width===0&&(t.y-=this.strokeWidth),this.height===0&&(t.x-=this.strokeWidth)),t},calcLinePoints:function(){var t=this.x1<=this.x2?-1:1,Ae=this.y1<=this.y2?-1:1,Pe=t*this.width*.5,St=Ae*this.height*.5,Ce=t*this.width*-.5,ke=Ae*this.height*-.5;return{x1:Pe,x2:Ce,y1:St,y2:ke}},_toSVG:function(){var t=this.calcLinePoints();return["<line ","COMMON_PARTS",'x1="',t.x1,'" y1="',t.y1,'" x2="',t.x2,'" y2="',t.y2,`" />
`]}}),e.Line.ATTRIBUTE_NAMES=e.SHARED_ATTRIBUTES.concat("x1 y1 x2 y2".split(" ")),e.Line.fromElement=function(t,Ae,Pe){Pe=Pe||{};var St=e.parseAttributes(t,e.Line.ATTRIBUTE_NAMES),Ce=[St.x1||0,St.y1||0,St.x2||0,St.y2||0];Ae(new e.Line(Ce,xe(St,Pe)))},e.Line.fromObject=function(t,Ae){function Pe(Ce){delete Ce.points,Ae&&Ae(Ce)}var St=Te(t,!0);St.points=[t.x1,t.y1,t.x2,t.y2],e.Object._fromObject("Line",St,Pe,"points")};function Se(t,Ae){var Pe=t.origin,St=t.axis1,Ce=t.axis2,ke=t.dimension,De=Ae.nearest,Re=Ae.center,je=Ae.farthest;return function(){switch(this.get(Pe)){case De:return Math.min(this.get(St),this.get(Ce));case Re:return Math.min(this.get(St),this.get(Ce))+.5*this.get(ke);case je:return Math.max(this.get(St),this.get(Ce))}}}}(Ie),function(Ee){var e=Ee.fabric||(Ee.fabric={}),xe=e.util.degreesToRadians;if(e.Circle){e.warn("fabric.Circle is already defined.");return}e.Circle=e.util.createClass(e.Object,{type:"circle",radius:0,startAngle:0,endAngle:360,cacheProperties:e.Object.prototype.cacheProperties.concat("radius","startAngle","endAngle"),_set:function(_e,Se){return this.callSuper("_set",_e,Se),_e==="radius"&&this.setRadius(Se),this},toObject:function(_e){return this.callSuper("toObject",["radius","startAngle","endAngle"].concat(_e))},_toSVG:function(){var _e,Se=0,t=0,Ae=(this.endAngle-this.startAngle)%360;if(Ae===0)_e=["<circle ","COMMON_PARTS",'cx="'+Se+'" cy="'+t+'" ','r="',this.radius,`" />
`];else{var Pe=xe(this.startAngle),St=xe(this.endAngle),Ce=this.radius,ke=e.util.cos(Pe)*Ce,De=e.util.sin(Pe)*Ce,Re=e.util.cos(St)*Ce,je=e.util.sin(St)*Ce,We=Ae>180?"1":"0";_e=['<path d="M '+ke+" "+De," A "+Ce+" "+Ce," 0 ",+We+" 1"," "+Re+" "+je,'" ',"COMMON_PARTS",` />
`]}return _e},_render:function(_e){_e.beginPath(),_e.arc(0,0,this.radius,xe(this.startAngle),xe(this.endAngle),!1),this._renderPaintInOrder(_e)},getRadiusX:function(){return this.get("radius")*this.get("scaleX")},getRadiusY:function(){return this.get("radius")*this.get("scaleY")},setRadius:function(_e){return this.radius=_e,this.set("width",_e*2).set("height",_e*2)}}),e.Circle.ATTRIBUTE_NAMES=e.SHARED_ATTRIBUTES.concat("cx cy r".split(" ")),e.Circle.fromElement=function(_e,Se){var t=e.parseAttributes(_e,e.Circle.ATTRIBUTE_NAMES);if(!Te(t))throw new Error("value of `r` attribute is required and can not be negative");t.left=(t.left||0)-t.radius,t.top=(t.top||0)-t.radius,Se(new e.Circle(t))};function Te(_e){return"radius"in _e&&_e.radius>=0}e.Circle.fromObject=function(_e,Se){e.Object._fromObject("Circle",_e,Se)}}(Ie),function(Ee){var e=Ee.fabric||(Ee.fabric={});if(e.Triangle){e.warn("fabric.Triangle is already defined");return}e.Triangle=e.util.createClass(e.Object,{type:"triangle",width:100,height:100,_render:function(xe){var Te=this.width/2,_e=this.height/2;xe.beginPath(),xe.moveTo(-Te,_e),xe.lineTo(0,-_e),xe.lineTo(Te,_e),xe.closePath(),this._renderPaintInOrder(xe)},_toSVG:function(){var xe=this.width/2,Te=this.height/2,_e=[-xe+" "+Te,"0 "+-Te,xe+" "+Te].join(",");return["<polygon ","COMMON_PARTS",'points="',_e,'" />']}}),e.Triangle.fromObject=function(xe,Te){return e.Object._fromObject("Triangle",xe,Te)}}(Ie),function(Ee){var e=Ee.fabric||(Ee.fabric={}),xe=Math.PI*2;if(e.Ellipse){e.warn("fabric.Ellipse is already defined.");return}e.Ellipse=e.util.createClass(e.Object,{type:"ellipse",rx:0,ry:0,cacheProperties:e.Object.prototype.cacheProperties.concat("rx","ry"),initialize:function(Te){this.callSuper("initialize",Te),this.set("rx",Te&&Te.rx||0),this.set("ry",Te&&Te.ry||0)},_set:function(Te,_e){switch(this.callSuper("_set",Te,_e),Te){case"rx":this.rx=_e,this.set("width",_e*2);break;case"ry":this.ry=_e,this.set("height",_e*2);break}return this},getRx:function(){return this.get("rx")*this.get("scaleX")},getRy:function(){return this.get("ry")*this.get("scaleY")},toObject:function(Te){return this.callSuper("toObject",["rx","ry"].concat(Te))},_toSVG:function(){return["<ellipse ","COMMON_PARTS",'cx="0" cy="0" ','rx="',this.rx,'" ry="',this.ry,`" />
`]},_render:function(Te){Te.beginPath(),Te.save(),Te.transform(1,0,0,this.ry/this.rx,0,0),Te.arc(0,0,this.rx,0,xe,!1),Te.restore(),this._renderPaintInOrder(Te)}}),e.Ellipse.ATTRIBUTE_NAMES=e.SHARED_ATTRIBUTES.concat("cx cy rx ry".split(" ")),e.Ellipse.fromElement=function(Te,_e){var Se=e.parseAttributes(Te,e.Ellipse.ATTRIBUTE_NAMES);Se.left=(Se.left||0)-Se.rx,Se.top=(Se.top||0)-Se.ry,_e(new e.Ellipse(Se))},e.Ellipse.fromObject=function(Te,_e){e.Object._fromObject("Ellipse",Te,_e)}}(Ie),function(Ee){var e=Ee.fabric||(Ee.fabric={}),xe=e.util.object.extend;if(e.Rect){e.warn("fabric.Rect is already defined");return}e.Rect=e.util.createClass(e.Object,{stateProperties:e.Object.prototype.stateProperties.concat("rx","ry"),type:"rect",rx:0,ry:0,cacheProperties:e.Object.prototype.cacheProperties.concat("rx","ry"),initialize:function(Te){this.callSuper("initialize",Te),this._initRxRy()},_initRxRy:function(){this.rx&&!this.ry?this.ry=this.rx:this.ry&&!this.rx&&(this.rx=this.ry)},_render:function(Te){var _e=this.rx?Math.min(this.rx,this.width/2):0,Se=this.ry?Math.min(this.ry,this.height/2):0,t=this.width,Ae=this.height,Pe=-this.width/2,St=-this.height/2,Ce=_e!==0||Se!==0,ke=1-.5522847498;Te.beginPath(),Te.moveTo(Pe+_e,St),Te.lineTo(Pe+t-_e,St),Ce&&Te.bezierCurveTo(Pe+t-ke*_e,St,Pe+t,St+ke*Se,Pe+t,St+Se),Te.lineTo(Pe+t,St+Ae-Se),Ce&&Te.bezierCurveTo(Pe+t,St+Ae-ke*Se,Pe+t-ke*_e,St+Ae,Pe+t-_e,St+Ae),Te.lineTo(Pe+_e,St+Ae),Ce&&Te.bezierCurveTo(Pe+ke*_e,St+Ae,Pe,St+Ae-ke*Se,Pe,St+Ae-Se),Te.lineTo(Pe,St+Se),Ce&&Te.bezierCurveTo(Pe,St+ke*Se,Pe+ke*_e,St,Pe+_e,St),Te.closePath(),this._renderPaintInOrder(Te)},toObject:function(Te){return this.callSuper("toObject",["rx","ry"].concat(Te))},_toSVG:function(){var Te=-this.width/2,_e=-this.height/2;return["<rect ","COMMON_PARTS",'x="',Te,'" y="',_e,'" rx="',this.rx,'" ry="',this.ry,'" width="',this.width,'" height="',this.height,`" />
`]}}),e.Rect.ATTRIBUTE_NAMES=e.SHARED_ATTRIBUTES.concat("x y rx ry width height".split(" ")),e.Rect.fromElement=function(Te,_e,Se){if(!Te)return _e(null);Se=Se||{};var t=e.parseAttributes(Te,e.Rect.ATTRIBUTE_NAMES);t.left=t.left||0,t.top=t.top||0,t.height=t.height||0,t.width=t.width||0;var Ae=new e.Rect(xe(Se?e.util.object.clone(Se):{},t));Ae.visible=Ae.visible&&Ae.width>0&&Ae.height>0,_e(Ae)},e.Rect.fromObject=function(Te,_e){return e.Object._fromObject("Rect",Te,_e)}}(Ie),function(Ee){var e=Ee.fabric||(Ee.fabric={}),xe=e.util.object.extend,Te=e.util.array.min,_e=e.util.array.max,Se=e.util.toFixed,t=e.util.projectStrokeOnPoints;if(e.Polyline){e.warn("fabric.Polyline is already defined");return}e.Polyline=e.util.createClass(e.Object,{type:"polyline",points:null,exactBoundingBox:!1,cacheProperties:e.Object.prototype.cacheProperties.concat("points"),initialize:function(Ae,Pe){Pe=Pe||{},this.points=Ae||[],this.callSuper("initialize",Pe),this._setPositionDimensions(Pe)},_projectStrokeOnPoints:function(){return t(this.points,this,!0)},_setPositionDimensions:function(Ae){var Pe=this._calcDimensions(Ae),St,Ce=this.exactBoundingBox?this.strokeWidth:0;this.width=Pe.width-Ce,this.height=Pe.height-Ce,Ae.fromSVG||(St=this.translateToGivenOrigin({x:Pe.left-this.strokeWidth/2+Ce/2,y:Pe.top-this.strokeWidth/2+Ce/2},"left","top",this.originX,this.originY)),typeof Ae.left>"u"&&(this.left=Ae.fromSVG?Pe.left:St.x),typeof Ae.top>"u"&&(this.top=Ae.fromSVG?Pe.top:St.y),this.pathOffset={x:Pe.left+this.width/2+Ce/2,y:Pe.top+this.height/2+Ce/2}},_calcDimensions:function(){var Ae=this.exactBoundingBox?this._projectStrokeOnPoints():this.points,Pe=Te(Ae,"x")||0,St=Te(Ae,"y")||0,Ce=_e(Ae,"x")||0,ke=_e(Ae,"y")||0,De=Ce-Pe,Re=ke-St;return{left:Pe,top:St,width:De,height:Re}},toObject:function(Ae){return xe(this.callSuper("toObject",Ae),{points:this.points.concat()})},_toSVG:function(){for(var Ae=[],Pe=this.pathOffset.x,St=this.pathOffset.y,Ce=e.Object.NUM_FRACTION_DIGITS,ke=0,De=this.points.length;ke<De;ke++)Ae.push(Se(this.points[ke].x-Pe,Ce),",",Se(this.points[ke].y-St,Ce)," ");return["<"+this.type+" ","COMMON_PARTS",'points="',Ae.join(""),`" />
`]},commonRender:function(Ae){var Pe,St=this.points.length,Ce=this.pathOffset.x,ke=this.pathOffset.y;if(!St||isNaN(this.points[St-1].y))return!1;Ae.beginPath(),Ae.moveTo(this.points[0].x-Ce,this.points[0].y-ke);for(var De=0;De<St;De++)Pe=this.points[De],Ae.lineTo(Pe.x-Ce,Pe.y-ke);return!0},_render:function(Ae){!this.commonRender(Ae)||this._renderPaintInOrder(Ae)},complexity:function(){return this.get("points").length}}),e.Polyline.ATTRIBUTE_NAMES=e.SHARED_ATTRIBUTES.concat(),e.Polyline.fromElementGenerator=function(Ae){return function(Pe,St,Ce){if(!Pe)return St(null);Ce||(Ce={});var ke=e.parsePointsAttribute(Pe.getAttribute("points")),De=e.parseAttributes(Pe,e[Ae].ATTRIBUTE_NAMES);De.fromSVG=!0,St(new e[Ae](ke,xe(De,Ce)))}},e.Polyline.fromElement=e.Polyline.fromElementGenerator("Polyline"),e.Polyline.fromObject=function(Ae,Pe){return e.Object._fromObject("Polyline",Ae,Pe,"points")}}(Ie),function(Ee){var e=Ee.fabric||(Ee.fabric={}),xe=e.util.projectStrokeOnPoints;if(e.Polygon){e.warn("fabric.Polygon is already defined");return}e.Polygon=e.util.createClass(e.Polyline,{type:"polygon",_projectStrokeOnPoints:function(){return xe(this.points,this)},_render:function(Te){!this.commonRender(Te)||(Te.closePath(),this._renderPaintInOrder(Te))}}),e.Polygon.ATTRIBUTE_NAMES=e.SHARED_ATTRIBUTES.concat(),e.Polygon.fromElement=e.Polyline.fromElementGenerator("Polygon"),e.Polygon.fromObject=function(Te,_e){e.Object._fromObject("Polygon",Te,_e,"points")}}(Ie),function(Ee){var e=Ee.fabric||(Ee.fabric={}),xe=e.util.array.min,Te=e.util.array.max,_e=e.util.object.extend,Se=e.util.object.clone,t=e.util.toFixed;if(e.Path){e.warn("fabric.Path is already defined");return}e.Path=e.util.createClass(e.Object,{type:"path",path:null,cacheProperties:e.Object.prototype.cacheProperties.concat("path","fillRule"),stateProperties:e.Object.prototype.stateProperties.concat("path"),initialize:function(Ae,Pe){Pe=Se(Pe||{}),delete Pe.path,this.callSuper("initialize",Pe),this._setPath(Ae||[],Pe)},_setPath:function(Ae,Pe){this.path=e.util.makePathSimpler(Array.isArray(Ae)?Ae:e.util.parsePath(Ae)),e.Polyline.prototype._setPositionDimensions.call(this,Pe||{})},_renderPathCommands:function(Ae){var Pe,St=0,Ce=0,ke=0,De=0,Re=0,je=0,We=-this.pathOffset.x,Ke=-this.pathOffset.y;Ae.beginPath();for(var Je=0,hi=this.path.length;Je<hi;++Je)switch(Pe=this.path[Je],Pe[0]){case"L":ke=Pe[1],De=Pe[2],Ae.lineTo(ke+We,De+Ke);break;case"M":ke=Pe[1],De=Pe[2],St=ke,Ce=De,Ae.moveTo(ke+We,De+Ke);break;case"C":ke=Pe[5],De=Pe[6],Re=Pe[3],je=Pe[4],Ae.bezierCurveTo(Pe[1]+We,Pe[2]+Ke,Re+We,je+Ke,ke+We,De+Ke);break;case"Q":Ae.quadraticCurveTo(Pe[1]+We,Pe[2]+Ke,Pe[3]+We,Pe[4]+Ke),ke=Pe[3],De=Pe[4],Re=Pe[1],je=Pe[2];break;case"z":case"Z":ke=St,De=Ce,Ae.closePath();break}},_render:function(Ae){this._renderPathCommands(Ae),this._renderPaintInOrder(Ae)},toString:function(){return"#<fabric.Path ("+this.complexity()+'): { "top": '+this.top+', "left": '+this.left+" }>"},toObject:function(Ae){return _e(this.callSuper("toObject",Ae),{path:this.path.map(function(Pe){return Pe.slice()})})},toDatalessObject:function(Ae){var Pe=this.toObject(["sourcePath"].concat(Ae));return Pe.sourcePath&&delete Pe.path,Pe},_toSVG:function(){var Ae=e.util.joinPath(this.path);return["<path ","COMMON_PARTS",'d="',Ae,'" stroke-linecap="round" ',`/>
`]},_getOffsetTransform:function(){var Ae=e.Object.NUM_FRACTION_DIGITS;return" translate("+t(-this.pathOffset.x,Ae)+", "+t(-this.pathOffset.y,Ae)+")"},toClipPathSVG:function(Ae){var Pe=this._getOffsetTransform();return"	"+this._createBaseClipPathSVGMarkup(this._toSVG(),{reviver:Ae,additionalTransform:Pe})},toSVG:function(Ae){var Pe=this._getOffsetTransform();return this._createBaseSVGMarkup(this._toSVG(),{reviver:Ae,additionalTransform:Pe})},complexity:function(){return this.path.length},_calcDimensions:function(){for(var Ae=[],Pe=[],St,Ce=0,ke=0,De=0,Re=0,je,We=0,Ke=this.path.length;We<Ke;++We){switch(St=this.path[We],St[0]){case"L":De=St[1],Re=St[2],je=[];break;case"M":De=St[1],Re=St[2],Ce=De,ke=Re,je=[];break;case"C":je=e.util.getBoundsOfCurve(De,Re,St[1],St[2],St[3],St[4],St[5],St[6]),De=St[5],Re=St[6];break;case"Q":je=e.util.getBoundsOfCurve(De,Re,St[1],St[2],St[1],St[2],St[3],St[4]),De=St[3],Re=St[4];break;case"z":case"Z":De=Ce,Re=ke;break}je.forEach(function(di){Ae.push(di.x),Pe.push(di.y)}),Ae.push(De),Pe.push(Re)}var Je=xe(Ae)||0,hi=xe(Pe)||0,oi=Te(Ae)||0,ti=Te(Pe)||0,ai=oi-Je,yi=ti-hi;return{left:Je,top:hi,width:ai,height:yi}}}),e.Path.fromObject=function(Ae,Pe){if(typeof Ae.sourcePath=="string"){var St=Ae.sourcePath;e.loadSVGFromURL(St,function(Ce){var ke=Ce[0];ke.setOptions(Ae),Ae.clipPath?e.util.enlivenObjects([Ae.clipPath],function(De){ke.clipPath=De[0],Pe&&Pe(ke)}):Pe&&Pe(ke)})}else e.Object._fromObject("Path",Ae,Pe,"path")},e.Path.ATTRIBUTE_NAMES=e.SHARED_ATTRIBUTES.concat(["d"]),e.Path.fromElement=function(Ae,Pe,St){var Ce=e.parseAttributes(Ae,e.Path.ATTRIBUTE_NAMES);Ce.fromSVG=!0,Pe(new e.Path(Ce.d,_e(Ce,St)))}}(Ie),function(Ee){var e=Ee.fabric||(Ee.fabric={}),xe=e.util.array.min,Te=e.util.array.max;e.Group||(e.Group=e.util.createClass(e.Object,e.Collection,{type:"group",strokeWidth:0,subTargetCheck:!1,cacheProperties:[],useSetOnGroup:!1,initialize:function(_e,Se,t){Se=Se||{},this._objects=[],t&&this.callSuper("initialize",Se),this._objects=_e||[];for(var Ae=this._objects.length;Ae--;)this._objects[Ae].group=this;if(t)this._updateObjectsACoords();else{var Pe=Se&&Se.centerPoint;Se.originX!==void 0&&(this.originX=Se.originX),Se.originY!==void 0&&(this.originY=Se.originY),Pe||this._calcBounds(),this._updateObjectsCoords(Pe),delete Se.centerPoint,this.callSuper("initialize",Se)}this.setCoords()},_updateObjectsACoords:function(){for(var _e=!0,Se=this._objects.length;Se--;)this._objects[Se].setCoords(_e)},_updateObjectsCoords:function(Se){for(var Se=Se||this.getCenterPoint(),t=this._objects.length;t--;)this._updateObjectCoords(this._objects[t],Se)},_updateObjectCoords:function(_e,Se){var t=_e.left,Ae=_e.top,Pe=!0;_e.set({left:t-Se.x,top:Ae-Se.y}),_e.group=this,_e.setCoords(Pe)},toString:function(){return"#<fabric.Group: ("+this.complexity()+")>"},addWithUpdate:function(_e){var Se=!!this.group;return this._restoreObjectsState(),e.util.resetObjectTransform(this),_e&&(Se&&e.util.removeTransformFromObject(_e,this.group.calcTransformMatrix()),this._objects.push(_e),_e.group=this,_e._set("canvas",this.canvas)),this._calcBounds(),this._updateObjectsCoords(),this.dirty=!0,Se?this.group.addWithUpdate():this.setCoords(),this},removeWithUpdate:function(_e){return this._restoreObjectsState(),e.util.resetObjectTransform(this),this.remove(_e),this._calcBounds(),this._updateObjectsCoords(),this.setCoords(),this.dirty=!0,this},_onObjectAdded:function(_e){this.dirty=!0,_e.group=this,_e._set("canvas",this.canvas)},_onObjectRemoved:function(_e){this.dirty=!0,delete _e.group},_set:function(_e,Se){var t=this._objects.length;if(this.useSetOnGroup)for(;t--;)this._objects[t].setOnGroup(_e,Se);if(_e==="canvas")for(;t--;)this._objects[t]._set(_e,Se);e.Object.prototype._set.call(this,_e,Se)},toObject:function(_e){var Se=this.includeDefaultValues,t=this._objects.filter(function(Pe){return!Pe.excludeFromExport}).map(function(Pe){var St=Pe.includeDefaultValues;Pe.includeDefaultValues=Se;var Ce=Pe.toObject(_e);return Pe.includeDefaultValues=St,Ce}),Ae=e.Object.prototype.toObject.call(this,_e);return Ae.objects=t,Ae},toDatalessObject:function(_e){var Se,t=this.sourcePath;if(t)Se=t;else{var Ae=this.includeDefaultValues;Se=this._objects.map(function(St){var Ce=St.includeDefaultValues;St.includeDefaultValues=Ae;var ke=St.toDatalessObject(_e);return St.includeDefaultValues=Ce,ke})}var Pe=e.Object.prototype.toDatalessObject.call(this,_e);return Pe.objects=Se,Pe},render:function(_e){this._transformDone=!0,this.callSuper("render",_e),this._transformDone=!1},shouldCache:function(){var _e=e.Object.prototype.shouldCache.call(this);if(_e){for(var Se=0,t=this._objects.length;Se<t;Se++)if(this._objects[Se].willDrawShadow())return this.ownCaching=!1,!1}return _e},willDrawShadow:function(){if(e.Object.prototype.willDrawShadow.call(this))return!0;for(var _e=0,Se=this._objects.length;_e<Se;_e++)if(this._objects[_e].willDrawShadow())return!0;return!1},isOnACache:function(){return this.ownCaching||this.group&&this.group.isOnACache()},drawObject:function(_e){for(var Se=0,t=this._objects.length;Se<t;Se++)this._objects[Se].render(_e);this._drawClipPath(_e,this.clipPath)},isCacheDirty:function(_e){if(this.callSuper("isCacheDirty",_e))return!0;if(!this.statefullCache)return!1;for(var Se=0,t=this._objects.length;Se<t;Se++)if(this._objects[Se].isCacheDirty(!0)){if(this._cacheCanvas){var Ae=this.cacheWidth/this.zoomX,Pe=this.cacheHeight/this.zoomY;this._cacheContext.clearRect(-Ae/2,-Pe/2,Ae,Pe)}return!0}return!1},_restoreObjectsState:function(){var _e=this.calcOwnMatrix();return this._objects.forEach(function(Se){e.util.addTransformToObject(Se,_e),delete Se.group,Se.setCoords()}),this},destroy:function(){return this._objects.forEach(function(_e){_e.set("dirty",!0)}),this._restoreObjectsState()},dispose:function(){this.callSuper("dispose"),this.forEachObject(function(_e){_e.dispose&&_e.dispose()}),this._objects=[]},toActiveSelection:function(){if(!!this.canvas){var _e=this._objects,Se=this.canvas;this._objects=[];var t=this.toObject();delete t.objects;var Ae=new e.ActiveSelection([]);return Ae.set(t),Ae.type="activeSelection",Se.remove(this),_e.forEach(function(Pe){Pe.group=Ae,Pe.dirty=!0,Se.add(Pe)}),Ae.canvas=Se,Ae._objects=_e,Se._activeObject=Ae,Ae.setCoords(),Ae}},ungroupOnCanvas:function(){return this._restoreObjectsState()},setObjectsCoords:function(){var _e=!0;return this.forEachObject(function(Se){Se.setCoords(_e)}),this},_calcBounds:function(_e){for(var Se=[],t=[],Ae,Pe,St,Ce=["tr","br","bl","tl"],ke=0,De=this._objects.length,Re,je=Ce.length;ke<De;++ke){for(Ae=this._objects[ke],St=Ae.calcACoords(),Re=0;Re<je;Re++)Pe=Ce[Re],Se.push(St[Pe].x),t.push(St[Pe].y);Ae.aCoords=St}this._getBounds(Se,t,_e)},_getBounds:function(_e,Se,t){var Ae=new e.Point(xe(_e),xe(Se)),Pe=new e.Point(Te(_e),Te(Se)),St=Ae.y||0,Ce=Ae.x||0,ke=Pe.x-Ae.x||0,De=Pe.y-Ae.y||0;this.width=ke,this.height=De,t||this.setPositionByOrigin({x:Ce,y:St},"left","top")},_toSVG:function(_e){for(var Se=["<g ","COMMON_PARTS",` >
`],t=0,Ae=this._objects.length;t<Ae;t++)Se.push("		",this._objects[t].toSVG(_e));return Se.push(`</g>
`),Se},getSvgStyles:function(){var _e=typeof this.opacity<"u"&&this.opacity!==1?"opacity: "+this.opacity+";":"",Se=this.visible?"":" visibility: hidden;";return[_e,this.getSvgFilter(),Se].join("")},toClipPathSVG:function(_e){for(var Se=[],t=0,Ae=this._objects.length;t<Ae;t++)Se.push("	",this._objects[t].toClipPathSVG(_e));return this._createBaseClipPathSVGMarkup(Se,{reviver:_e})}}),e.Group.fromObject=function(_e,Se){var t=_e.objects,Ae=e.util.object.clone(_e,!0);if(delete Ae.objects,typeof t=="string"){e.loadSVGFromURL(t,function(Pe){var St=e.util.groupSVGElements(Pe,_e,t),Ce=Ae.clipPath;delete Ae.clipPath,St.set(Ae),Ce?e.util.enlivenObjects([Ce],function(ke){St.clipPath=ke[0],Se&&Se(St)}):Se&&Se(St)});return}e.util.enlivenObjects(t,function(Pe){e.util.enlivenObjectEnlivables(_e,Ae,function(){Se&&Se(new e.Group(Pe,Ae,!0))})})})}(Ie),function(Ee){var e=Ee.fabric||(Ee.fabric={});e.ActiveSelection||(e.ActiveSelection=e.util.createClass(e.Group,{type:"activeSelection",initialize:function(xe,Te){Te=Te||{},this._objects=xe||[];for(var _e=this._objects.length;_e--;)this._objects[_e].group=this;Te.originX&&(this.originX=Te.originX),Te.originY&&(this.originY=Te.originY),this._calcBounds(),this._updateObjectsCoords(),e.Object.prototype.initialize.call(this,Te),this.setCoords()},toGroup:function(){var xe=this._objects.concat();this._objects=[];var Te=e.Object.prototype.toObject.call(this),_e=new e.Group([]);if(delete Te.type,_e.set(Te),xe.forEach(function(t){t.canvas.remove(t),t.group=_e}),_e._objects=xe,!this.canvas)return _e;var Se=this.canvas;return Se.add(_e),Se._activeObject=_e,_e.setCoords(),_e},onDeselect:function(){return this.destroy(),!1},toString:function(){return"#<fabric.ActiveSelection: ("+this.complexity()+")>"},shouldCache:function(){return!1},isOnACache:function(){return!1},_renderControls:function(xe,Te,_e){xe.save(),xe.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1,this.callSuper("_renderControls",xe,Te),_e=_e||{},typeof _e.hasControls>"u"&&(_e.hasControls=!1),_e.forActiveSelection=!0;for(var Se=0,t=this._objects.length;Se<t;Se++)this._objects[Se]._renderControls(xe,_e);xe.restore()}}),e.ActiveSelection.fromObject=function(xe,Te){e.util.enlivenObjects(xe.objects,function(_e){delete xe.objects,Te&&Te(new e.ActiveSelection(_e,xe,!0))})})}(Ie),function(Ee){var e=r.util.object.extend;if(Ee.fabric||(Ee.fabric={}),Ee.fabric.Image){r.warn("fabric.Image is already defined.");return}r.Image=r.util.createClass(r.Object,{type:"image",strokeWidth:0,srcFromAttribute:!1,_lastScaleX:1,_lastScaleY:1,_filterScalingX:1,_filterScalingY:1,minimumScaleTrigger:.5,stateProperties:r.Object.prototype.stateProperties.concat("cropX","cropY"),cacheProperties:r.Object.prototype.cacheProperties.concat("cropX","cropY"),cacheKey:"",cropX:0,cropY:0,imageSmoothing:!0,initialize:function(xe,Te){Te||(Te={}),this.filters=[],this.cacheKey="texture"+r.Object.__uid++,this.callSuper("initialize",Te),this._initElement(xe,Te)},getElement:function(){return this._element||{}},setElement:function(xe,Te){return this.removeTexture(this.cacheKey),this.removeTexture(this.cacheKey+"_filtered"),this._element=xe,this._originalElement=xe,this._initConfig(Te),this.filters.length!==0&&this.applyFilters(),this.resizeFilter&&this.applyResizeFilters(),this},removeTexture:function(xe){var Te=r.filterBackend;Te&&Te.evictCachesForKey&&Te.evictCachesForKey(xe)},dispose:function(){this.callSuper("dispose"),this.removeTexture(this.cacheKey),this.removeTexture(this.cacheKey+"_filtered"),this._cacheContext=void 0,["_originalElement","_element","_filteredEl","_cacheCanvas"].forEach(function(xe){r.util.cleanUpJsdomNode(this[xe]),this[xe]=void 0}.bind(this))},getCrossOrigin:function(){return this._originalElement&&(this._originalElement.crossOrigin||null)},getOriginalSize:function(){var xe=this.getElement();return{width:xe.naturalWidth||xe.width,height:xe.naturalHeight||xe.height}},_stroke:function(xe){if(!(!this.stroke||this.strokeWidth===0)){var Te=this.width/2,_e=this.height/2;xe.beginPath(),xe.moveTo(-Te,-_e),xe.lineTo(Te,-_e),xe.lineTo(Te,_e),xe.lineTo(-Te,_e),xe.lineTo(-Te,-_e),xe.closePath()}},toObject:function(xe){var Te=[];this.filters.forEach(function(Se){Se&&Te.push(Se.toObject())});var _e=e(this.callSuper("toObject",["cropX","cropY"].concat(xe)),{src:this.getSrc(),crossOrigin:this.getCrossOrigin(),filters:Te});return this.resizeFilter&&(_e.resizeFilter=this.resizeFilter.toObject()),_e},hasCrop:function(){return this.cropX||this.cropY||this.width<this._element.width||this.height<this._element.height},_toSVG:function(){var xe=[],Te=[],_e,Se=this._element,t=-this.width/2,Ae=-this.height/2,Pe="",St="";if(!Se)return[];if(this.hasCrop()){var Ce=r.Object.__uid++;xe.push('<clipPath id="imageCrop_'+Ce+`">
`,'	<rect x="'+t+'" y="'+Ae+'" width="'+this.width+'" height="'+this.height+`" />
`,`</clipPath>
`),Pe=' clip-path="url(#imageCrop_'+Ce+')" '}if(this.imageSmoothing||(St='" image-rendering="optimizeSpeed'),Te.push("	<image ","COMMON_PARTS",'xlink:href="',this.getSvgSrc(!0),'" x="',t-this.cropX,'" y="',Ae-this.cropY,'" width="',Se.width||Se.naturalWidth,'" height="',Se.height||Se.height,St,'"',Pe,`></image>
`),this.stroke||this.strokeDashArray){var ke=this.fill;this.fill=null,_e=["	<rect ",'x="',t,'" y="',Ae,'" width="',this.width,'" height="',this.height,'" style="',this.getSvgStyles(),`"/>
`],this.fill=ke}return this.paintFirst!=="fill"?xe=xe.concat(_e,Te):xe=xe.concat(Te,_e),xe},getSrc:function(xe){var Te=xe?this._element:this._originalElement;return Te?Te.toDataURL?Te.toDataURL():this.srcFromAttribute?Te.getAttribute("src"):Te.src:this.src||""},setSrc:function(xe,Te,_e){return r.util.loadImage(xe,function(Se,t){this.setElement(Se,_e),this._setWidthHeight(),Te&&Te(this,t)},this,_e&&_e.crossOrigin),this},toString:function(){return'#<fabric.Image: { src: "'+this.getSrc()+'" }>'},applyResizeFilters:function(){var xe=this.resizeFilter,Te=this.minimumScaleTrigger,_e=this.getTotalObjectScaling(),Se=_e.scaleX,t=_e.scaleY,Ae=this._filteredEl||this._originalElement;if(this.group&&this.set("dirty",!0),!xe||Se>Te&&t>Te){this._element=Ae,this._filterScalingX=1,this._filterScalingY=1,this._lastScaleX=Se,this._lastScaleY=t;return}r.filterBackend||(r.filterBackend=r.initFilterBackend());var Pe=r.util.createCanvasElement(),St=this._filteredEl?this.cacheKey+"_filtered":this.cacheKey,Ce=Ae.width,ke=Ae.height;Pe.width=Ce,Pe.height=ke,this._element=Pe,this._lastScaleX=xe.scaleX=Se,this._lastScaleY=xe.scaleY=t,r.filterBackend.applyFilters([xe],Ae,Ce,ke,this._element,St),this._filterScalingX=Pe.width/this._originalElement.width,this._filterScalingY=Pe.height/this._originalElement.height},applyFilters:function(xe){if(xe=xe||this.filters||[],xe=xe.filter(function(Ae){return Ae&&!Ae.isNeutralState()}),this.set("dirty",!0),this.removeTexture(this.cacheKey+"_filtered"),xe.length===0)return this._element=this._originalElement,this._filteredEl=null,this._filterScalingX=1,this._filterScalingY=1,this;var Te=this._originalElement,_e=Te.naturalWidth||Te.width,Se=Te.naturalHeight||Te.height;if(this._element===this._originalElement){var t=r.util.createCanvasElement();t.width=_e,t.height=Se,this._element=t,this._filteredEl=t}else this._element=this._filteredEl,this._filteredEl.getContext("2d").clearRect(0,0,_e,Se),this._lastScaleX=1,this._lastScaleY=1;return r.filterBackend||(r.filterBackend=r.initFilterBackend()),r.filterBackend.applyFilters(xe,this._originalElement,_e,Se,this._element,this.cacheKey),(this._originalElement.width!==this._element.width||this._originalElement.height!==this._element.height)&&(this._filterScalingX=this._element.width/this._originalElement.width,this._filterScalingY=this._element.height/this._originalElement.height),this},_render:function(xe){r.util.setImageSmoothing(xe,this.imageSmoothing),this.isMoving!==!0&&this.resizeFilter&&this._needsResize()&&this.applyResizeFilters(),this._stroke(xe),this._renderPaintInOrder(xe)},drawCacheOnCanvas:function(xe){r.util.setImageSmoothing(xe,this.imageSmoothing),r.Object.prototype.drawCacheOnCanvas.call(this,xe)},shouldCache:function(){return this.needsItsOwnCache()},_renderFill:function(xe){var Te=this._element;if(!!Te){var _e=this._filterScalingX,Se=this._filterScalingY,t=this.width,Ae=this.height,Pe=Math.min,St=Math.max,Ce=St(this.cropX,0),ke=St(this.cropY,0),De=Te.naturalWidth||Te.width,Re=Te.naturalHeight||Te.height,je=Ce*_e,We=ke*Se,Ke=Pe(t*_e,De-je),Je=Pe(Ae*Se,Re-We),hi=-t/2,oi=-Ae/2,ti=Pe(t,De/_e-Ce),ai=Pe(Ae,Re/Se-ke);Te&&xe.drawImage(Te,je,We,Ke,Je,hi,oi,ti,ai)}},_needsResize:function(){var xe=this.getTotalObjectScaling();return xe.scaleX!==this._lastScaleX||xe.scaleY!==this._lastScaleY},_resetWidthHeight:function(){this.set(this.getOriginalSize())},_initElement:function(xe,Te){this.setElement(r.util.getById(xe),Te),r.util.addClass(this.getElement(),r.Image.CSS_CANVAS)},_initConfig:function(xe){xe||(xe={}),this.setOptions(xe),this._setWidthHeight(xe)},_initFilters:function(xe,Te){xe&&xe.length?r.util.enlivenObjects(xe,function(_e){Te&&Te(_e)},"fabric.Image.filters"):Te&&Te()},_setWidthHeight:function(xe){xe||(xe={});var Te=this.getElement();this.width=xe.width||Te.naturalWidth||Te.width||0,this.height=xe.height||Te.naturalHeight||Te.height||0},parsePreserveAspectRatioAttribute:function(){var xe=r.util.parsePreserveAspectRatioAttribute(this.preserveAspectRatio||""),Te=this._element.width,_e=this._element.height,Se=1,t=1,Ae=0,Pe=0,St=0,Ce=0,ke,De=this.width,Re=this.height,je={width:De,height:Re};return xe&&(xe.alignX!=="none"||xe.alignY!=="none")?(xe.meetOrSlice==="meet"&&(Se=t=r.util.findScaleToFit(this._element,je),ke=(De-Te*Se)/2,xe.alignX==="Min"&&(Ae=-ke),xe.alignX==="Max"&&(Ae=ke),ke=(Re-_e*t)/2,xe.alignY==="Min"&&(Pe=-ke),xe.alignY==="Max"&&(Pe=ke)),xe.meetOrSlice==="slice"&&(Se=t=r.util.findScaleToCover(this._element,je),ke=Te-De/Se,xe.alignX==="Mid"&&(St=ke/2),xe.alignX==="Max"&&(St=ke),ke=_e-Re/t,xe.alignY==="Mid"&&(Ce=ke/2),xe.alignY==="Max"&&(Ce=ke),Te=De/Se,_e=Re/t)):(Se=De/Te,t=Re/_e),{width:Te,height:_e,scaleX:Se,scaleY:t,offsetLeft:Ae,offsetTop:Pe,cropX:St,cropY:Ce}}}),r.Image.CSS_CANVAS="canvas-img",r.Image.prototype.getSvgSrc=r.Image.prototype.getSrc,r.Image.fromObject=function(xe,Te){var _e=r.util.object.clone(xe);r.util.loadImage(_e.src,function(Se,t){if(t){Te&&Te(null,!0);return}r.Image.prototype._initFilters.call(_e,_e.filters,function(Ae){_e.filters=Ae||[],r.Image.prototype._initFilters.call(_e,[_e.resizeFilter],function(Pe){_e.resizeFilter=Pe[0],r.util.enlivenObjectEnlivables(_e,_e,function(){var St=new r.Image(Se,_e);Te(St,!1)})})})},null,_e.crossOrigin)},r.Image.fromURL=function(xe,Te,_e){r.util.loadImage(xe,function(Se,t){Te&&Te(new r.Image(Se,_e),t)},null,_e&&_e.crossOrigin)},r.Image.ATTRIBUTE_NAMES=r.SHARED_ATTRIBUTES.concat("x y width height preserveAspectRatio xlink:href crossOrigin image-rendering".split(" ")),r.Image.fromElement=function(xe,Te,_e){var Se=r.parseAttributes(xe,r.Image.ATTRIBUTE_NAMES);r.Image.fromURL(Se["xlink:href"],Te,e(_e?r.util.object.clone(_e):{},Se))}}(Ie),r.util.object.extend(r.Object.prototype,{_getAngleValueForStraighten:function(){var Ee=this.angle%360;return Ee>0?Math.round((Ee-1)/90)*90:Math.round(Ee/90)*90},straighten:function(){return this.rotate(this._getAngleValueForStraighten())},fxStraighten:function(Ee){Ee=Ee||{};var e=function(){},xe=Ee.onComplete||e,Te=Ee.onChange||e,_e=this;return r.util.animate({target:this,startValue:this.get("angle"),endValue:this._getAngleValueForStraighten(),duration:this.FX_DURATION,onChange:function(Se){_e.rotate(Se),Te()},onComplete:function(){_e.setCoords(),xe()}})}}),r.util.object.extend(r.StaticCanvas.prototype,{straightenObject:function(Ee){return Ee.straighten(),this.requestRenderAll(),this},fxStraightenObject:function(Ee){return Ee.fxStraighten({onChange:this.requestRenderAllBound})}}),function(){function Ee(xe,Te){var _e="precision "+Te+` float;
void main(){}`,Se=xe.createShader(xe.FRAGMENT_SHADER);return xe.shaderSource(Se,_e),xe.compileShader(Se),!!xe.getShaderParameter(Se,xe.COMPILE_STATUS)}r.isWebglSupported=function(xe){if(r.isLikelyNode)return!1;xe=xe||r.WebglFilterBackend.prototype.tileSize;var Te=document.createElement("canvas"),_e=Te.getContext("webgl")||Te.getContext("experimental-webgl"),Se=!1;if(_e){r.maxTextureSize=_e.getParameter(_e.MAX_TEXTURE_SIZE),Se=r.maxTextureSize>=xe;for(var t=["highp","mediump","lowp"],Ae=0;Ae<3;Ae++)if(Ee(_e,t[Ae])){r.webGlPrecision=t[Ae];break}}return this.isSupported=Se,Se},r.WebglFilterBackend=e;function e(xe){xe&&xe.tileSize&&(this.tileSize=xe.tileSize),this.setupGLContext(this.tileSize,this.tileSize),this.captureGPUInfo()}e.prototype={tileSize:2048,resources:{},setupGLContext:function(xe,Te){this.dispose(),this.createWebGLCanvas(xe,Te),this.aPosition=new Float32Array([0,0,0,1,1,0,1,1]),this.chooseFastestCopyGLTo2DMethod(xe,Te)},chooseFastestCopyGLTo2DMethod:function(xe,Te){var _e=typeof window.performance<"u",Se;try{new ImageData(1,1),Se=!0}catch{Se=!1}var t=typeof ArrayBuffer<"u",Ae=typeof Uint8ClampedArray<"u";if(!!(_e&&Se&&t&&Ae)){var Pe=r.util.createCanvasElement(),St=new ArrayBuffer(xe*Te*4);if(r.forceGLPutImageData){this.imageBuffer=St,this.copyGLTo2D=He;return}var Ce={imageBuffer:St,destinationWidth:xe,destinationHeight:Te,targetCanvas:Pe},ke,De,Re;Pe.width=xe,Pe.height=Te,ke=window.performance.now(),Ue.call(Ce,this.gl,Ce),De=window.performance.now()-ke,ke=window.performance.now(),He.call(Ce,this.gl,Ce),Re=window.performance.now()-ke,De>Re?(this.imageBuffer=St,this.copyGLTo2D=He):this.copyGLTo2D=Ue}},createWebGLCanvas:function(xe,Te){var _e=r.util.createCanvasElement();_e.width=xe,_e.height=Te;var Se={alpha:!0,premultipliedAlpha:!1,depth:!1,stencil:!1,antialias:!1},t=_e.getContext("webgl",Se);t||(t=_e.getContext("experimental-webgl",Se)),t&&(t.clearColor(0,0,0,0),this.canvas=_e,this.gl=t)},applyFilters:function(xe,Te,_e,Se,t,Ae){var Pe=this.gl,St;Ae&&(St=this.getCachedTexture(Ae,Te));var Ce={originalWidth:Te.width||Te.originalWidth,originalHeight:Te.height||Te.originalHeight,sourceWidth:_e,sourceHeight:Se,destinationWidth:_e,destinationHeight:Se,context:Pe,sourceTexture:this.createTexture(Pe,_e,Se,!St&&Te),targetTexture:this.createTexture(Pe,_e,Se),originalTexture:St||this.createTexture(Pe,_e,Se,!St&&Te),passes:xe.length,webgl:!0,aPosition:this.aPosition,programCache:this.programCache,pass:0,filterBackend:this,targetCanvas:t},ke=Pe.createFramebuffer();return Pe.bindFramebuffer(Pe.FRAMEBUFFER,ke),xe.forEach(function(De){De&&De.applyTo(Ce)}),Be(Ce),this.copyGLTo2D(Pe,Ce),Pe.bindTexture(Pe.TEXTURE_2D,null),Pe.deleteTexture(Ce.sourceTexture),Pe.deleteTexture(Ce.targetTexture),Pe.deleteFramebuffer(ke),t.getContext("2d").setTransform(1,0,0,1,0,0),Ce},dispose:function(){this.canvas&&(this.canvas=null,this.gl=null),this.clearWebGLCaches()},clearWebGLCaches:function(){this.programCache={},this.textureCache={}},createTexture:function(xe,Te,_e,Se){var t=xe.createTexture();return xe.bindTexture(xe.TEXTURE_2D,t),xe.texParameteri(xe.TEXTURE_2D,xe.TEXTURE_MAG_FILTER,xe.NEAREST),xe.texParameteri(xe.TEXTURE_2D,xe.TEXTURE_MIN_FILTER,xe.NEAREST),xe.texParameteri(xe.TEXTURE_2D,xe.TEXTURE_WRAP_S,xe.CLAMP_TO_EDGE),xe.texParameteri(xe.TEXTURE_2D,xe.TEXTURE_WRAP_T,xe.CLAMP_TO_EDGE),Se?xe.texImage2D(xe.TEXTURE_2D,0,xe.RGBA,xe.RGBA,xe.UNSIGNED_BYTE,Se):xe.texImage2D(xe.TEXTURE_2D,0,xe.RGBA,Te,_e,0,xe.RGBA,xe.UNSIGNED_BYTE,null),t},getCachedTexture:function(xe,Te){if(this.textureCache[xe])return this.textureCache[xe];var _e=this.createTexture(this.gl,Te.width,Te.height,Te);return this.textureCache[xe]=_e,_e},evictCachesForKey:function(xe){this.textureCache[xe]&&(this.gl.deleteTexture(this.textureCache[xe]),delete this.textureCache[xe])},copyGLTo2D:Ue,captureGPUInfo:function(){if(this.gpuInfo)return this.gpuInfo;var xe=this.gl,Te={renderer:"",vendor:""};if(!xe)return Te;var _e=xe.getExtension("WEBGL_debug_renderer_info");if(_e){var Se=xe.getParameter(_e.UNMASKED_RENDERER_WEBGL),t=xe.getParameter(_e.UNMASKED_VENDOR_WEBGL);Se&&(Te.renderer=Se.toLowerCase()),t&&(Te.vendor=t.toLowerCase())}return this.gpuInfo=Te,Te}}}();function Be(Ee){var e=Ee.targetCanvas,xe=e.width,Te=e.height,_e=Ee.destinationWidth,Se=Ee.destinationHeight;(xe!==_e||Te!==Se)&&(e.width=_e,e.height=Se)}function Ue(Ee,e){var xe=Ee.canvas,Te=e.targetCanvas,_e=Te.getContext("2d");_e.translate(0,Te.height),_e.scale(1,-1);var Se=xe.height-Te.height;_e.drawImage(xe,0,Se,Te.width,Te.height,0,0,Te.width,Te.height)}function He(Ee,e){var xe=e.targetCanvas,Te=xe.getContext("2d"),_e=e.destinationWidth,Se=e.destinationHeight,t=_e*Se*4,Ae=new Uint8Array(this.imageBuffer,0,t),Pe=new Uint8ClampedArray(this.imageBuffer,0,t);Ee.readPixels(0,0,_e,Se,Ee.RGBA,Ee.UNSIGNED_BYTE,Ae);var St=new ImageData(Pe,_e,Se);Te.putImageData(St,0,0)}(function(){var Ee=function(){};r.Canvas2dFilterBackend=e;function e(){}e.prototype={evictCachesForKey:Ee,dispose:Ee,clearWebGLCaches:Ee,resources:{},applyFilters:function(xe,Te,_e,Se,t){var Ae=t.getContext("2d");Ae.drawImage(Te,0,0,_e,Se);var Pe=Ae.getImageData(0,0,_e,Se),St=Ae.getImageData(0,0,_e,Se),Ce={sourceWidth:_e,sourceHeight:Se,imageData:Pe,originalEl:Te,originalImageData:St,canvasEl:t,ctx:Ae,filterBackend:this};return xe.forEach(function(ke){ke.applyTo(Ce)}),(Ce.imageData.width!==_e||Ce.imageData.height!==Se)&&(t.width=Ce.imageData.width,t.height=Ce.imageData.height),Ae.putImageData(Ce.imageData,0,0),Ce}}})(),r.Image=r.Image||{},r.Image.filters=r.Image.filters||{},r.Image.filters.BaseFilter=r.util.createClass({type:"BaseFilter",vertexSource:`attribute vec2 aPosition;
varying vec2 vTexCoord;
void main() {
vTexCoord = aPosition;
gl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);
}`,fragmentSource:`precision highp float;
varying vec2 vTexCoord;
uniform sampler2D uTexture;
void main() {
gl_FragColor = texture2D(uTexture, vTexCoord);
}`,initialize:function(Ee){Ee&&this.setOptions(Ee)},setOptions:function(Ee){for(var e in Ee)this[e]=Ee[e]},createProgram:function(Ee,e,xe){e=e||this.fragmentSource,xe=xe||this.vertexSource,r.webGlPrecision!=="highp"&&(e=e.replace(/precision highp float/g,"precision "+r.webGlPrecision+" float"));var Te=Ee.createShader(Ee.VERTEX_SHADER);if(Ee.shaderSource(Te,xe),Ee.compileShader(Te),!Ee.getShaderParameter(Te,Ee.COMPILE_STATUS))throw new Error("Vertex shader compile error for "+this.type+": "+Ee.getShaderInfoLog(Te));var _e=Ee.createShader(Ee.FRAGMENT_SHADER);if(Ee.shaderSource(_e,e),Ee.compileShader(_e),!Ee.getShaderParameter(_e,Ee.COMPILE_STATUS))throw new Error("Fragment shader compile error for "+this.type+": "+Ee.getShaderInfoLog(_e));var Se=Ee.createProgram();if(Ee.attachShader(Se,Te),Ee.attachShader(Se,_e),Ee.linkProgram(Se),!Ee.getProgramParameter(Se,Ee.LINK_STATUS))throw new Error('Shader link error for "${this.type}" '+Ee.getProgramInfoLog(Se));var t=this.getAttributeLocations(Ee,Se),Ae=this.getUniformLocations(Ee,Se)||{};return Ae.uStepW=Ee.getUniformLocation(Se,"uStepW"),Ae.uStepH=Ee.getUniformLocation(Se,"uStepH"),{program:Se,attributeLocations:t,uniformLocations:Ae}},getAttributeLocations:function(Ee,e){return{aPosition:Ee.getAttribLocation(e,"aPosition")}},getUniformLocations:function(){return{}},sendAttributeData:function(Ee,e,xe){var Te=e.aPosition,_e=Ee.createBuffer();Ee.bindBuffer(Ee.ARRAY_BUFFER,_e),Ee.enableVertexAttribArray(Te),Ee.vertexAttribPointer(Te,2,Ee.FLOAT,!1,0,0),Ee.bufferData(Ee.ARRAY_BUFFER,xe,Ee.STATIC_DRAW)},_setupFrameBuffer:function(Ee){var e=Ee.context,xe,Te;Ee.passes>1?(xe=Ee.destinationWidth,Te=Ee.destinationHeight,(Ee.sourceWidth!==xe||Ee.sourceHeight!==Te)&&(e.deleteTexture(Ee.targetTexture),Ee.targetTexture=Ee.filterBackend.createTexture(e,xe,Te)),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,Ee.targetTexture,0)):(e.bindFramebuffer(e.FRAMEBUFFER,null),e.finish())},_swapTextures:function(Ee){Ee.passes--,Ee.pass++;var e=Ee.targetTexture;Ee.targetTexture=Ee.sourceTexture,Ee.sourceTexture=e},isNeutralState:function(){var Ee=this.mainParameter,e=r.Image.filters[this.type].prototype;if(Ee)if(Array.isArray(e[Ee])){for(var xe=e[Ee].length;xe--;)if(this[Ee][xe]!==e[Ee][xe])return!1;return!0}else return e[Ee]===this[Ee];else return!1},applyTo:function(Ee){Ee.webgl?(this._setupFrameBuffer(Ee),this.applyToWebGL(Ee),this._swapTextures(Ee)):this.applyTo2d(Ee)},retrieveShader:function(Ee){return Ee.programCache.hasOwnProperty(this.type)||(Ee.programCache[this.type]=this.createProgram(Ee.context)),Ee.programCache[this.type]},applyToWebGL:function(Ee){var e=Ee.context,xe=this.retrieveShader(Ee);Ee.pass===0&&Ee.originalTexture?e.bindTexture(e.TEXTURE_2D,Ee.originalTexture):e.bindTexture(e.TEXTURE_2D,Ee.sourceTexture),e.useProgram(xe.program),this.sendAttributeData(e,xe.attributeLocations,Ee.aPosition),e.uniform1f(xe.uniformLocations.uStepW,1/Ee.sourceWidth),e.uniform1f(xe.uniformLocations.uStepH,1/Ee.sourceHeight),this.sendUniformData(e,xe.uniformLocations),e.viewport(0,0,Ee.destinationWidth,Ee.destinationHeight),e.drawArrays(e.TRIANGLE_STRIP,0,4)},bindAdditionalTexture:function(Ee,e,xe){Ee.activeTexture(xe),Ee.bindTexture(Ee.TEXTURE_2D,e),Ee.activeTexture(Ee.TEXTURE0)},unbindAdditionalTexture:function(Ee,e){Ee.activeTexture(e),Ee.bindTexture(Ee.TEXTURE_2D,null),Ee.activeTexture(Ee.TEXTURE0)},getMainParameter:function(){return this[this.mainParameter]},setMainParameter:function(Ee){this[this.mainParameter]=Ee},sendUniformData:function(){},createHelpLayer:function(Ee){if(!Ee.helpLayer){var e=document.createElement("canvas");e.width=Ee.sourceWidth,e.height=Ee.sourceHeight,Ee.helpLayer=e}},toObject:function(){var Ee={type:this.type},e=this.mainParameter;return e&&(Ee[e]=this[e]),Ee},toJSON:function(){return this.toObject()}}),r.Image.filters.BaseFilter.fromObject=function(Ee,e){var xe=new r.Image.filters[Ee.type](Ee);return e&&e(xe),xe},function(Ee){var e=Ee.fabric||(Ee.fabric={}),xe=e.Image.filters,Te=e.util.createClass;xe.ColorMatrix=Te(xe.BaseFilter,{type:"ColorMatrix",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
varying vec2 vTexCoord;
uniform mat4 uColorMatrix;
uniform vec4 uConstants;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
color *= uColorMatrix;
color += uConstants;
gl_FragColor = color;
}`,matrix:[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],mainParameter:"matrix",colorsOnly:!0,initialize:function(_e){this.callSuper("initialize",_e),this.matrix=this.matrix.slice(0)},applyTo2d:function(_e){var Se=_e.imageData,t=Se.data,Ae=t.length,Pe=this.matrix,St,Ce,ke,De,Re,je=this.colorsOnly;for(Re=0;Re<Ae;Re+=4)St=t[Re],Ce=t[Re+1],ke=t[Re+2],je?(t[Re]=St*Pe[0]+Ce*Pe[1]+ke*Pe[2]+Pe[4]*255,t[Re+1]=St*Pe[5]+Ce*Pe[6]+ke*Pe[7]+Pe[9]*255,t[Re+2]=St*Pe[10]+Ce*Pe[11]+ke*Pe[12]+Pe[14]*255):(De=t[Re+3],t[Re]=St*Pe[0]+Ce*Pe[1]+ke*Pe[2]+De*Pe[3]+Pe[4]*255,t[Re+1]=St*Pe[5]+Ce*Pe[6]+ke*Pe[7]+De*Pe[8]+Pe[9]*255,t[Re+2]=St*Pe[10]+Ce*Pe[11]+ke*Pe[12]+De*Pe[13]+Pe[14]*255,t[Re+3]=St*Pe[15]+Ce*Pe[16]+ke*Pe[17]+De*Pe[18]+Pe[19]*255)},getUniformLocations:function(_e,Se){return{uColorMatrix:_e.getUniformLocation(Se,"uColorMatrix"),uConstants:_e.getUniformLocation(Se,"uConstants")}},sendUniformData:function(_e,Se){var t=this.matrix,Ae=[t[0],t[1],t[2],t[3],t[5],t[6],t[7],t[8],t[10],t[11],t[12],t[13],t[15],t[16],t[17],t[18]],Pe=[t[4],t[9],t[14],t[19]];_e.uniformMatrix4fv(Se.uColorMatrix,!1,Ae),_e.uniform4fv(Se.uConstants,Pe)}}),e.Image.filters.ColorMatrix.fromObject=e.Image.filters.BaseFilter.fromObject}(Ie),function(Ee){var e=Ee.fabric||(Ee.fabric={}),xe=e.Image.filters,Te=e.util.createClass;xe.Brightness=Te(xe.BaseFilter,{type:"Brightness",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uBrightness;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
color.rgb += uBrightness;
gl_FragColor = color;
}`,brightness:0,mainParameter:"brightness",applyTo2d:function(_e){if(this.brightness!==0){var Se=_e.imageData,t=Se.data,Ae,Pe=t.length,St=Math.round(this.brightness*255);for(Ae=0;Ae<Pe;Ae+=4)t[Ae]=t[Ae]+St,t[Ae+1]=t[Ae+1]+St,t[Ae+2]=t[Ae+2]+St}},getUniformLocations:function(_e,Se){return{uBrightness:_e.getUniformLocation(Se,"uBrightness")}},sendUniformData:function(_e,Se){_e.uniform1f(Se.uBrightness,this.brightness)}}),e.Image.filters.Brightness.fromObject=e.Image.filters.BaseFilter.fromObject}(Ie),function(Ee){var e=Ee.fabric||(Ee.fabric={}),xe=e.util.object.extend,Te=e.Image.filters,_e=e.util.createClass;Te.Convolute=_e(Te.BaseFilter,{type:"Convolute",opaque:!1,matrix:[0,0,0,0,1,0,0,0,0],fragmentSource:{Convolute_3_1:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[9];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 0);
for (float h = 0.0; h < 3.0; h+=1.0) {
for (float w = 0.0; w < 3.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 1), uStepH * (h - 1));
color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 3.0 + w)];
}
}
gl_FragColor = color;
}`,Convolute_3_0:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[9];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 1);
for (float h = 0.0; h < 3.0; h+=1.0) {
for (float w = 0.0; w < 3.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 1.0), uStepH * (h - 1.0));
color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 3.0 + w)];
}
}
float alpha = texture2D(uTexture, vTexCoord).a;
gl_FragColor = color;
gl_FragColor.a = alpha;
}`,Convolute_5_1:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[25];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 0);
for (float h = 0.0; h < 5.0; h+=1.0) {
for (float w = 0.0; w < 5.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));
color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 5.0 + w)];
}
}
gl_FragColor = color;
}`,Convolute_5_0:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[25];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 1);
for (float h = 0.0; h < 5.0; h+=1.0) {
for (float w = 0.0; w < 5.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));
color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 5.0 + w)];
}
}
float alpha = texture2D(uTexture, vTexCoord).a;
gl_FragColor = color;
gl_FragColor.a = alpha;
}`,Convolute_7_1:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[49];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 0);
for (float h = 0.0; h < 7.0; h+=1.0) {
for (float w = 0.0; w < 7.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));
color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 7.0 + w)];
}
}
gl_FragColor = color;
}`,Convolute_7_0:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[49];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 1);
for (float h = 0.0; h < 7.0; h+=1.0) {
for (float w = 0.0; w < 7.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));
color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 7.0 + w)];
}
}
float alpha = texture2D(uTexture, vTexCoord).a;
gl_FragColor = color;
gl_FragColor.a = alpha;
}`,Convolute_9_1:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[81];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 0);
for (float h = 0.0; h < 9.0; h+=1.0) {
for (float w = 0.0; w < 9.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));
color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 9.0 + w)];
}
}
gl_FragColor = color;
}`,Convolute_9_0:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[81];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 1);
for (float h = 0.0; h < 9.0; h+=1.0) {
for (float w = 0.0; w < 9.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));
color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 9.0 + w)];
}
}
float alpha = texture2D(uTexture, vTexCoord).a;
gl_FragColor = color;
gl_FragColor.a = alpha;
}`},retrieveShader:function(Se){var t=Math.sqrt(this.matrix.length),Ae=this.type+"_"+t+"_"+(this.opaque?1:0),Pe=this.fragmentSource[Ae];return Se.programCache.hasOwnProperty(Ae)||(Se.programCache[Ae]=this.createProgram(Se.context,Pe)),Se.programCache[Ae]},applyTo2d:function(Se){var t=Se.imageData,Ae=t.data,Pe=this.matrix,St=Math.round(Math.sqrt(Pe.length)),Ce=Math.floor(St/2),ke=t.width,De=t.height,Re=Se.ctx.createImageData(ke,De),je=Re.data,We=this.opaque?1:0,Ke,Je,hi,oi,ti,ai,yi,di,bi,vi,Pi,xi,ni;for(Pi=0;Pi<De;Pi++)for(vi=0;vi<ke;vi++){for(ti=(Pi*ke+vi)*4,Ke=0,Je=0,hi=0,oi=0,ni=0;ni<St;ni++)for(xi=0;xi<St;xi++)yi=Pi+ni-Ce,ai=vi+xi-Ce,!(yi<0||yi>=De||ai<0||ai>=ke)&&(di=(yi*ke+ai)*4,bi=Pe[ni*St+xi],Ke+=Ae[di]*bi,Je+=Ae[di+1]*bi,hi+=Ae[di+2]*bi,We||(oi+=Ae[di+3]*bi));je[ti]=Ke,je[ti+1]=Je,je[ti+2]=hi,We?je[ti+3]=Ae[ti+3]:je[ti+3]=oi}Se.imageData=Re},getUniformLocations:function(Se,t){return{uMatrix:Se.getUniformLocation(t,"uMatrix"),uOpaque:Se.getUniformLocation(t,"uOpaque"),uHalfSize:Se.getUniformLocation(t,"uHalfSize"),uSize:Se.getUniformLocation(t,"uSize")}},sendUniformData:function(Se,t){Se.uniform1fv(t.uMatrix,this.matrix)},toObject:function(){return xe(this.callSuper("toObject"),{opaque:this.opaque,matrix:this.matrix})}}),e.Image.filters.Convolute.fromObject=e.Image.filters.BaseFilter.fromObject}(Ie),function(Ee){var e=Ee.fabric||(Ee.fabric={}),xe=e.Image.filters,Te=e.util.createClass;xe.Grayscale=Te(xe.BaseFilter,{type:"Grayscale",fragmentSource:{average:`precision highp float;
uniform sampler2D uTexture;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
float average = (color.r + color.b + color.g) / 3.0;
gl_FragColor = vec4(average, average, average, color.a);
}`,lightness:`precision highp float;
uniform sampler2D uTexture;
uniform int uMode;
varying vec2 vTexCoord;
void main() {
vec4 col = texture2D(uTexture, vTexCoord);
float average = (max(max(col.r, col.g),col.b) + min(min(col.r, col.g),col.b)) / 2.0;
gl_FragColor = vec4(average, average, average, col.a);
}`,luminosity:`precision highp float;
uniform sampler2D uTexture;
uniform int uMode;
varying vec2 vTexCoord;
void main() {
vec4 col = texture2D(uTexture, vTexCoord);
float average = 0.21 * col.r + 0.72 * col.g + 0.07 * col.b;
gl_FragColor = vec4(average, average, average, col.a);
}`},mode:"average",mainParameter:"mode",applyTo2d:function(_e){var Se=_e.imageData,t=Se.data,Ae,Pe=t.length,St,Ce=this.mode;for(Ae=0;Ae<Pe;Ae+=4)Ce==="average"?St=(t[Ae]+t[Ae+1]+t[Ae+2])/3:Ce==="lightness"?St=(Math.min(t[Ae],t[Ae+1],t[Ae+2])+Math.max(t[Ae],t[Ae+1],t[Ae+2]))/2:Ce==="luminosity"&&(St=.21*t[Ae]+.72*t[Ae+1]+.07*t[Ae+2]),t[Ae]=St,t[Ae+1]=St,t[Ae+2]=St},retrieveShader:function(_e){var Se=this.type+"_"+this.mode;if(!_e.programCache.hasOwnProperty(Se)){var t=this.fragmentSource[this.mode];_e.programCache[Se]=this.createProgram(_e.context,t)}return _e.programCache[Se]},getUniformLocations:function(_e,Se){return{uMode:_e.getUniformLocation(Se,"uMode")}},sendUniformData:function(_e,Se){var t=1;_e.uniform1i(Se.uMode,t)},isNeutralState:function(){return!1}}),e.Image.filters.Grayscale.fromObject=e.Image.filters.BaseFilter.fromObject}(Ie),function(Ee){var e=Ee.fabric||(Ee.fabric={}),xe=e.Image.filters,Te=e.util.createClass;xe.Invert=Te(xe.BaseFilter,{type:"Invert",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform int uInvert;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
if (uInvert == 1) {
gl_FragColor = vec4(1.0 - color.r,1.0 -color.g,1.0 -color.b,color.a);
} else {
gl_FragColor = color;
}
}`,invert:!0,mainParameter:"invert",applyTo2d:function(_e){var Se=_e.imageData,t=Se.data,Ae,Pe=t.length;for(Ae=0;Ae<Pe;Ae+=4)t[Ae]=255-t[Ae],t[Ae+1]=255-t[Ae+1],t[Ae+2]=255-t[Ae+2]},isNeutralState:function(){return!this.invert},getUniformLocations:function(_e,Se){return{uInvert:_e.getUniformLocation(Se,"uInvert")}},sendUniformData:function(_e,Se){_e.uniform1i(Se.uInvert,this.invert)}}),e.Image.filters.Invert.fromObject=e.Image.filters.BaseFilter.fromObject}(Ie),function(Ee){var e=Ee.fabric||(Ee.fabric={}),xe=e.util.object.extend,Te=e.Image.filters,_e=e.util.createClass;Te.Noise=_e(Te.BaseFilter,{type:"Noise",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uStepH;
uniform float uNoise;
uniform float uSeed;
varying vec2 vTexCoord;
float rand(vec2 co, float seed, float vScale) {
return fract(sin(dot(co.xy * vScale ,vec2(12.9898 , 78.233))) * 43758.5453 * (seed + 0.01) / 2.0);
}
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
color.rgb += (0.5 - rand(vTexCoord, uSeed, 0.1 / uStepH)) * uNoise;
gl_FragColor = color;
}`,mainParameter:"noise",noise:0,applyTo2d:function(Se){if(this.noise!==0){var t=Se.imageData,Ae=t.data,Pe,St=Ae.length,Ce=this.noise,ke;for(Pe=0,St=Ae.length;Pe<St;Pe+=4)ke=(.5-Math.random())*Ce,Ae[Pe]+=ke,Ae[Pe+1]+=ke,Ae[Pe+2]+=ke}},getUniformLocations:function(Se,t){return{uNoise:Se.getUniformLocation(t,"uNoise"),uSeed:Se.getUniformLocation(t,"uSeed")}},sendUniformData:function(Se,t){Se.uniform1f(t.uNoise,this.noise/255),Se.uniform1f(t.uSeed,Math.random())},toObject:function(){return xe(this.callSuper("toObject"),{noise:this.noise})}}),e.Image.filters.Noise.fromObject=e.Image.filters.BaseFilter.fromObject}(Ie),function(Ee){var e=Ee.fabric||(Ee.fabric={}),xe=e.Image.filters,Te=e.util.createClass;xe.Pixelate=Te(xe.BaseFilter,{type:"Pixelate",blocksize:4,mainParameter:"blocksize",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uBlocksize;
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
float blockW = uBlocksize * uStepW;
float blockH = uBlocksize * uStepW;
int posX = int(vTexCoord.x / blockW);
int posY = int(vTexCoord.y / blockH);
float fposX = float(posX);
float fposY = float(posY);
vec2 squareCoords = vec2(fposX * blockW, fposY * blockH);
vec4 color = texture2D(uTexture, squareCoords);
gl_FragColor = color;
}`,applyTo2d:function(_e){var Se=_e.imageData,t=Se.data,Ae=Se.height,Pe=Se.width,St,Ce,ke,De,Re,je,We,Ke,Je,hi,oi;for(Ce=0;Ce<Ae;Ce+=this.blocksize)for(ke=0;ke<Pe;ke+=this.blocksize)for(St=Ce*4*Pe+ke*4,De=t[St],Re=t[St+1],je=t[St+2],We=t[St+3],hi=Math.min(Ce+this.blocksize,Ae),oi=Math.min(ke+this.blocksize,Pe),Ke=Ce;Ke<hi;Ke++)for(Je=ke;Je<oi;Je++)St=Ke*4*Pe+Je*4,t[St]=De,t[St+1]=Re,t[St+2]=je,t[St+3]=We},isNeutralState:function(){return this.blocksize===1},getUniformLocations:function(_e,Se){return{uBlocksize:_e.getUniformLocation(Se,"uBlocksize"),uStepW:_e.getUniformLocation(Se,"uStepW"),uStepH:_e.getUniformLocation(Se,"uStepH")}},sendUniformData:function(_e,Se){_e.uniform1f(Se.uBlocksize,this.blocksize)}}),e.Image.filters.Pixelate.fromObject=e.Image.filters.BaseFilter.fromObject}(Ie),function(Ee){var e=Ee.fabric||(Ee.fabric={}),xe=e.util.object.extend,Te=e.Image.filters,_e=e.util.createClass;Te.RemoveColor=_e(Te.BaseFilter,{type:"RemoveColor",color:"#FFFFFF",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform vec4 uLow;
uniform vec4 uHigh;
varying vec2 vTexCoord;
void main() {
gl_FragColor = texture2D(uTexture, vTexCoord);
if(all(greaterThan(gl_FragColor.rgb,uLow.rgb)) && all(greaterThan(uHigh.rgb,gl_FragColor.rgb))) {
gl_FragColor.a = 0.0;
}
}`,distance:.02,useAlpha:!1,applyTo2d:function(Se){var t=Se.imageData,Ae=t.data,Pe,St=this.distance*255,Ce,ke,De,Re=new e.Color(this.color).getSource(),je=[Re[0]-St,Re[1]-St,Re[2]-St],We=[Re[0]+St,Re[1]+St,Re[2]+St];for(Pe=0;Pe<Ae.length;Pe+=4)Ce=Ae[Pe],ke=Ae[Pe+1],De=Ae[Pe+2],Ce>je[0]&&ke>je[1]&&De>je[2]&&Ce<We[0]&&ke<We[1]&&De<We[2]&&(Ae[Pe+3]=0)},getUniformLocations:function(Se,t){return{uLow:Se.getUniformLocation(t,"uLow"),uHigh:Se.getUniformLocation(t,"uHigh")}},sendUniformData:function(Se,t){var Ae=new e.Color(this.color).getSource(),Pe=parseFloat(this.distance),St=[0+Ae[0]/255-Pe,0+Ae[1]/255-Pe,0+Ae[2]/255-Pe,1],Ce=[Ae[0]/255+Pe,Ae[1]/255+Pe,Ae[2]/255+Pe,1];Se.uniform4fv(t.uLow,St),Se.uniform4fv(t.uHigh,Ce)},toObject:function(){return xe(this.callSuper("toObject"),{color:this.color,distance:this.distance})}}),e.Image.filters.RemoveColor.fromObject=e.Image.filters.BaseFilter.fromObject}(Ie),function(Ee){var e=Ee.fabric||(Ee.fabric={}),xe=e.Image.filters,Te=e.util.createClass,_e={Brownie:[.5997,.34553,-.27082,0,.186,-.0377,.86095,.15059,0,-.1449,.24113,-.07441,.44972,0,-.02965,0,0,0,1,0],Vintage:[.62793,.32021,-.03965,0,.03784,.02578,.64411,.03259,0,.02926,.0466,-.08512,.52416,0,.02023,0,0,0,1,0],Kodachrome:[1.12855,-.39673,-.03992,0,.24991,-.16404,1.08352,-.05498,0,.09698,-.16786,-.56034,1.60148,0,.13972,0,0,0,1,0],Technicolor:[1.91252,-.85453,-.09155,0,.04624,-.30878,1.76589,-.10601,0,-.27589,-.2311,-.75018,1.84759,0,.12137,0,0,0,1,0],Polaroid:[1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0],Sepia:[.393,.769,.189,0,0,.349,.686,.168,0,0,.272,.534,.131,0,0,0,0,0,1,0],BlackWhite:[1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,0,0,0,1,0]};for(var Se in _e)xe[Se]=Te(xe.ColorMatrix,{type:Se,matrix:_e[Se],mainParameter:!1,colorsOnly:!0}),e.Image.filters[Se].fromObject=e.Image.filters.BaseFilter.fromObject}(Ie),function(Ee){var e=Ee.fabric,xe=e.Image.filters,Te=e.util.createClass;xe.BlendColor=Te(xe.BaseFilter,{type:"BlendColor",color:"#F95C63",mode:"multiply",alpha:1,fragmentSource:{multiply:`gl_FragColor.rgb *= uColor.rgb;
`,screen:`gl_FragColor.rgb = 1.0 - (1.0 - gl_FragColor.rgb) * (1.0 - uColor.rgb);
`,add:`gl_FragColor.rgb += uColor.rgb;
`,diff:`gl_FragColor.rgb = abs(gl_FragColor.rgb - uColor.rgb);
`,subtract:`gl_FragColor.rgb -= uColor.rgb;
`,lighten:`gl_FragColor.rgb = max(gl_FragColor.rgb, uColor.rgb);
`,darken:`gl_FragColor.rgb = min(gl_FragColor.rgb, uColor.rgb);
`,exclusion:`gl_FragColor.rgb += uColor.rgb - 2.0 * (uColor.rgb * gl_FragColor.rgb);
`,overlay:`if (uColor.r < 0.5) {
gl_FragColor.r *= 2.0 * uColor.r;
} else {
gl_FragColor.r = 1.0 - 2.0 * (1.0 - gl_FragColor.r) * (1.0 - uColor.r);
}
if (uColor.g < 0.5) {
gl_FragColor.g *= 2.0 * uColor.g;
} else {
gl_FragColor.g = 1.0 - 2.0 * (1.0 - gl_FragColor.g) * (1.0 - uColor.g);
}
if (uColor.b < 0.5) {
gl_FragColor.b *= 2.0 * uColor.b;
} else {
gl_FragColor.b = 1.0 - 2.0 * (1.0 - gl_FragColor.b) * (1.0 - uColor.b);
}
`,tint:`gl_FragColor.rgb *= (1.0 - uColor.a);
gl_FragColor.rgb += uColor.rgb;
`},buildSource:function(_e){return`precision highp float;
uniform sampler2D uTexture;
uniform vec4 uColor;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
gl_FragColor = color;
if (color.a > 0.0) {
`+this.fragmentSource[_e]+`}
}`},retrieveShader:function(_e){var Se=this.type+"_"+this.mode,t;return _e.programCache.hasOwnProperty(Se)||(t=this.buildSource(this.mode),_e.programCache[Se]=this.createProgram(_e.context,t)),_e.programCache[Se]},applyTo2d:function(_e){var Se=_e.imageData,t=Se.data,Ae=t.length,Pe,St,Ce,ke,De,Re,je,We=1-this.alpha;je=new e.Color(this.color).getSource(),Pe=je[0]*this.alpha,St=je[1]*this.alpha,Ce=je[2]*this.alpha;for(var Ke=0;Ke<Ae;Ke+=4)switch(ke=t[Ke],De=t[Ke+1],Re=t[Ke+2],this.mode){case"multiply":t[Ke]=ke*Pe/255,t[Ke+1]=De*St/255,t[Ke+2]=Re*Ce/255;break;case"screen":t[Ke]=255-(255-ke)*(255-Pe)/255,t[Ke+1]=255-(255-De)*(255-St)/255,t[Ke+2]=255-(255-Re)*(255-Ce)/255;break;case"add":t[Ke]=ke+Pe,t[Ke+1]=De+St,t[Ke+2]=Re+Ce;break;case"diff":case"difference":t[Ke]=Math.abs(ke-Pe),t[Ke+1]=Math.abs(De-St),t[Ke+2]=Math.abs(Re-Ce);break;case"subtract":t[Ke]=ke-Pe,t[Ke+1]=De-St,t[Ke+2]=Re-Ce;break;case"darken":t[Ke]=Math.min(ke,Pe),t[Ke+1]=Math.min(De,St),t[Ke+2]=Math.min(Re,Ce);break;case"lighten":t[Ke]=Math.max(ke,Pe),t[Ke+1]=Math.max(De,St),t[Ke+2]=Math.max(Re,Ce);break;case"overlay":t[Ke]=Pe<128?2*ke*Pe/255:255-2*(255-ke)*(255-Pe)/255,t[Ke+1]=St<128?2*De*St/255:255-2*(255-De)*(255-St)/255,t[Ke+2]=Ce<128?2*Re*Ce/255:255-2*(255-Re)*(255-Ce)/255;break;case"exclusion":t[Ke]=Pe+ke-2*Pe*ke/255,t[Ke+1]=St+De-2*St*De/255,t[Ke+2]=Ce+Re-2*Ce*Re/255;break;case"tint":t[Ke]=Pe+ke*We,t[Ke+1]=St+De*We,t[Ke+2]=Ce+Re*We}},getUniformLocations:function(_e,Se){return{uColor:_e.getUniformLocation(Se,"uColor")}},sendUniformData:function(_e,Se){var t=new e.Color(this.color).getSource();t[0]=this.alpha*t[0]/255,t[1]=this.alpha*t[1]/255,t[2]=this.alpha*t[2]/255,t[3]=this.alpha,_e.uniform4fv(Se.uColor,t)},toObject:function(){return{type:this.type,color:this.color,mode:this.mode,alpha:this.alpha}}}),e.Image.filters.BlendColor.fromObject=e.Image.filters.BaseFilter.fromObject}(Ie),function(Ee){var e=Ee.fabric,xe=e.Image.filters,Te=e.util.createClass;xe.BlendImage=Te(xe.BaseFilter,{type:"BlendImage",image:null,mode:"multiply",alpha:1,vertexSource:`attribute vec2 aPosition;
varying vec2 vTexCoord;
varying vec2 vTexCoord2;
uniform mat3 uTransformMatrix;
void main() {
vTexCoord = aPosition;
vTexCoord2 = (uTransformMatrix * vec3(aPosition, 1.0)).xy;
gl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);
}`,fragmentSource:{multiply:`precision highp float;
uniform sampler2D uTexture;
uniform sampler2D uImage;
uniform vec4 uColor;
varying vec2 vTexCoord;
varying vec2 vTexCoord2;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
vec4 color2 = texture2D(uImage, vTexCoord2);
color.rgba *= color2.rgba;
gl_FragColor = color;
}`,mask:`precision highp float;
uniform sampler2D uTexture;
uniform sampler2D uImage;
uniform vec4 uColor;
varying vec2 vTexCoord;
varying vec2 vTexCoord2;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
vec4 color2 = texture2D(uImage, vTexCoord2);
color.a = color2.a;
gl_FragColor = color;
}`},retrieveShader:function(_e){var Se=this.type+"_"+this.mode,t=this.fragmentSource[this.mode];return _e.programCache.hasOwnProperty(Se)||(_e.programCache[Se]=this.createProgram(_e.context,t)),_e.programCache[Se]},applyToWebGL:function(_e){var Se=_e.context,t=this.createTexture(_e.filterBackend,this.image);this.bindAdditionalTexture(Se,t,Se.TEXTURE1),this.callSuper("applyToWebGL",_e),this.unbindAdditionalTexture(Se,Se.TEXTURE1)},createTexture:function(_e,Se){return _e.getCachedTexture(Se.cacheKey,Se._element)},calculateMatrix:function(){var _e=this.image,Se=_e._element.width,t=_e._element.height;return[1/_e.scaleX,0,0,0,1/_e.scaleY,0,-_e.left/Se,-_e.top/t,1]},applyTo2d:function(_e){var Se=_e.imageData,t=_e.filterBackend.resources,Ae=Se.data,Pe=Ae.length,St=Se.width,Ce=Se.height,ke,De,Re,je,We,Ke,Je,hi,oi,ti,ai=this.image,yi;t.blendImage||(t.blendImage=e.util.createCanvasElement()),oi=t.blendImage,ti=oi.getContext("2d"),oi.width!==St||oi.height!==Ce?(oi.width=St,oi.height=Ce):ti.clearRect(0,0,St,Ce),ti.setTransform(ai.scaleX,0,0,ai.scaleY,ai.left,ai.top),ti.drawImage(ai._element,0,0,St,Ce),yi=ti.getImageData(0,0,St,Ce).data;for(var di=0;di<Pe;di+=4)switch(We=Ae[di],Ke=Ae[di+1],Je=Ae[di+2],hi=Ae[di+3],ke=yi[di],De=yi[di+1],Re=yi[di+2],je=yi[di+3],this.mode){case"multiply":Ae[di]=We*ke/255,Ae[di+1]=Ke*De/255,Ae[di+2]=Je*Re/255,Ae[di+3]=hi*je/255;break;case"mask":Ae[di+3]=je;break}},getUniformLocations:function(_e,Se){return{uTransformMatrix:_e.getUniformLocation(Se,"uTransformMatrix"),uImage:_e.getUniformLocation(Se,"uImage")}},sendUniformData:function(_e,Se){var t=this.calculateMatrix();_e.uniform1i(Se.uImage,1),_e.uniformMatrix3fv(Se.uTransformMatrix,!1,t)},toObject:function(){return{type:this.type,image:this.image&&this.image.toObject(),mode:this.mode,alpha:this.alpha}}}),e.Image.filters.BlendImage.fromObject=function(_e,Se){e.Image.fromObject(_e.image,function(t){var Ae=e.util.object.clone(_e);Ae.image=t,Se(new e.Image.filters.BlendImage(Ae))})}}(Ie),function(Ee){var e=Ee.fabric||(Ee.fabric={}),xe=Math.pow,Te=Math.floor,_e=Math.sqrt,Se=Math.abs,t=Math.round,Ae=Math.sin,Pe=Math.ceil,St=e.Image.filters,Ce=e.util.createClass;St.Resize=Ce(St.BaseFilter,{type:"Resize",resizeType:"hermite",scaleX:1,scaleY:1,lanczosLobes:3,getUniformLocations:function(ke,De){return{uDelta:ke.getUniformLocation(De,"uDelta"),uTaps:ke.getUniformLocation(De,"uTaps")}},sendUniformData:function(ke,De){ke.uniform2fv(De.uDelta,this.horizontal?[1/this.width,0]:[0,1/this.height]),ke.uniform1fv(De.uTaps,this.taps)},retrieveShader:function(ke){var De=this.getFilterWindow(),Re=this.type+"_"+De;if(!ke.programCache.hasOwnProperty(Re)){var je=this.generateShader(De);ke.programCache[Re]=this.createProgram(ke.context,je)}return ke.programCache[Re]},getFilterWindow:function(){var ke=this.tempScale;return Math.ceil(this.lanczosLobes/ke)},getTaps:function(){for(var ke=this.lanczosCreate(this.lanczosLobes),De=this.tempScale,Re=this.getFilterWindow(),je=new Array(Re),We=1;We<=Re;We++)je[We-1]=ke(We*De);return je},generateShader:function(je){for(var De=new Array(je),Re=this.fragmentSourceTOP,je,We=1;We<=je;We++)De[We-1]=We+".0 * uDelta";return Re+="uniform float uTaps["+je+`];
`,Re+=`void main() {
`,Re+=`  vec4 color = texture2D(uTexture, vTexCoord);
`,Re+=`  float sum = 1.0;
`,De.forEach(function(Ke,Je){Re+="  color += texture2D(uTexture, vTexCoord + "+Ke+") * uTaps["+Je+`];
`,Re+="  color += texture2D(uTexture, vTexCoord - "+Ke+") * uTaps["+Je+`];
`,Re+="  sum += 2.0 * uTaps["+Je+`];
`}),Re+=`  gl_FragColor = color / sum;
`,Re+="}",Re},fragmentSourceTOP:`precision highp float;
uniform sampler2D uTexture;
uniform vec2 uDelta;
varying vec2 vTexCoord;
`,applyTo:function(ke){ke.webgl?(ke.passes++,this.width=ke.sourceWidth,this.horizontal=!0,this.dW=Math.round(this.width*this.scaleX),this.dH=ke.sourceHeight,this.tempScale=this.dW/this.width,this.taps=this.getTaps(),ke.destinationWidth=this.dW,this._setupFrameBuffer(ke),this.applyToWebGL(ke),this._swapTextures(ke),ke.sourceWidth=ke.destinationWidth,this.height=ke.sourceHeight,this.horizontal=!1,this.dH=Math.round(this.height*this.scaleY),this.tempScale=this.dH/this.height,this.taps=this.getTaps(),ke.destinationHeight=this.dH,this._setupFrameBuffer(ke),this.applyToWebGL(ke),this._swapTextures(ke),ke.sourceHeight=ke.destinationHeight):this.applyTo2d(ke)},isNeutralState:function(){return this.scaleX===1&&this.scaleY===1},lanczosCreate:function(ke){return function(De){if(De>=ke||De<=-ke)return 0;if(De<11920929e-14&&De>-11920929e-14)return 1;De*=Math.PI;var Re=De/ke;return Ae(De)/De*Ae(Re)/Re}},applyTo2d:function(ke){var De=ke.imageData,Re=this.scaleX,je=this.scaleY;this.rcpScaleX=1/Re,this.rcpScaleY=1/je;var We=De.width,Ke=De.height,Je=t(We*Re),hi=t(Ke*je),oi;this.resizeType==="sliceHack"?oi=this.sliceByTwo(ke,We,Ke,Je,hi):this.resizeType==="hermite"?oi=this.hermiteFastResize(ke,We,Ke,Je,hi):this.resizeType==="bilinear"?oi=this.bilinearFiltering(ke,We,Ke,Je,hi):this.resizeType==="lanczos"&&(oi=this.lanczosResize(ke,We,Ke,Je,hi)),ke.imageData=oi},sliceByTwo:function(ke,De,Re,je,We){var Ke=ke.imageData,Je=.5,hi=!1,oi=!1,ti=De*Je,ai=Re*Je,yi=e.filterBackend.resources,di,bi,vi=0,Pi=0,xi=De,ni=0;for(yi.sliceByTwo||(yi.sliceByTwo=document.createElement("canvas")),di=yi.sliceByTwo,(di.width<De*1.5||di.height<Re)&&(di.width=De*1.5,di.height=Re),bi=di.getContext("2d"),bi.clearRect(0,0,De*1.5,Re),bi.putImageData(Ke,0,0),je=Te(je),We=Te(We);!hi||!oi;)De=ti,Re=ai,je<Te(ti*Je)?ti=Te(ti*Je):(ti=je,hi=!0),We<Te(ai*Je)?ai=Te(ai*Je):(ai=We,oi=!0),bi.drawImage(di,vi,Pi,De,Re,xi,ni,ti,ai),vi=xi,Pi=ni,ni+=ai;return bi.getImageData(vi,Pi,je,We)},lanczosResize:function(ke,De,Re,je,We){function Ke(Si){var Xe,Ge,ze,Ve,ei,si,li,ci,Ci,Fi,Oi;for(ni.x=(Si+.5)*ai,fi.x=Te(ni.x),Xe=0;Xe<We;Xe++){for(ni.y=(Xe+.5)*yi,fi.y=Te(ni.y),ei=0,si=0,li=0,ci=0,Ci=0,Ge=fi.x-vi;Ge<=fi.x+vi;Ge++)if(!(Ge<0||Ge>=De)){Fi=Te(1e3*Se(Ge-ni.x)),xi[Fi]||(xi[Fi]={});for(var Ti=fi.y-Pi;Ti<=fi.y+Pi;Ti++)Ti<0||Ti>=Re||(Oi=Te(1e3*Se(Ti-ni.y)),xi[Fi][Oi]||(xi[Fi][Oi]=ti(_e(xe(Fi*di,2)+xe(Oi*bi,2))/1e3)),ze=xi[Fi][Oi],ze>0&&(Ve=(Ti*De+Ge)*4,ei+=ze,si+=ze*Je[Ve],li+=ze*Je[Ve+1],ci+=ze*Je[Ve+2],Ci+=ze*Je[Ve+3]))}Ve=(Xe*je+Si)*4,oi[Ve]=si/ei,oi[Ve+1]=li/ei,oi[Ve+2]=ci/ei,oi[Ve+3]=Ci/ei}return++Si<je?Ke(Si):hi}var Je=ke.imageData.data,hi=ke.ctx.createImageData(je,We),oi=hi.data,ti=this.lanczosCreate(this.lanczosLobes),ai=this.rcpScaleX,yi=this.rcpScaleY,di=2/this.rcpScaleX,bi=2/this.rcpScaleY,vi=Pe(ai*this.lanczosLobes/2),Pi=Pe(yi*this.lanczosLobes/2),xi={},ni={},fi={};return Ke(0)},bilinearFiltering:function(ke,De,Re,je,We){var Ke,Je,hi,oi,ti,ai,yi,di,bi,vi,Pi,xi,ni=0,fi,Si=this.rcpScaleX,Xe=this.rcpScaleY,Ge=4*(De-1),ze=ke.imageData,Ve=ze.data,ei=ke.ctx.createImageData(je,We),si=ei.data;for(yi=0;yi<We;yi++)for(di=0;di<je;di++)for(ti=Te(Si*di),ai=Te(Xe*yi),bi=Si*di-ti,vi=Xe*yi-ai,fi=4*(ai*De+ti),Pi=0;Pi<4;Pi++)Ke=Ve[fi+Pi],Je=Ve[fi+4+Pi],hi=Ve[fi+Ge+Pi],oi=Ve[fi+Ge+4+Pi],xi=Ke*(1-bi)*(1-vi)+Je*bi*(1-vi)+hi*vi*(1-bi)+oi*bi*vi,si[ni++]=xi;return ei},hermiteFastResize:function(ke,De,Re,je,We){for(var Ke=this.rcpScaleX,Je=this.rcpScaleY,hi=Pe(Ke/2),oi=Pe(Je/2),ti=ke.imageData,ai=ti.data,yi=ke.ctx.createImageData(je,We),di=yi.data,bi=0;bi<We;bi++)for(var vi=0;vi<je;vi++){for(var Pi=(vi+bi*je)*4,xi=0,ni=0,fi=0,Si=0,Xe=0,Ge=0,ze=0,Ve=(bi+.5)*Je,ei=Te(bi*Je);ei<(bi+1)*Je;ei++)for(var si=Se(Ve-(ei+.5))/oi,li=(vi+.5)*Ke,ci=si*si,Ci=Te(vi*Ke);Ci<(vi+1)*Ke;Ci++){var Fi=Se(li-(Ci+.5))/hi,Oi=_e(ci+Fi*Fi);Oi>1&&Oi<-1||(xi=2*Oi*Oi*Oi-3*Oi*Oi+1,xi>0&&(Fi=4*(Ci+ei*De),ze+=xi*ai[Fi+3],fi+=xi,ai[Fi+3]<255&&(xi=xi*ai[Fi+3]/250),Si+=xi*ai[Fi],Xe+=xi*ai[Fi+1],Ge+=xi*ai[Fi+2],ni+=xi))}di[Pi]=Si/ni,di[Pi+1]=Xe/ni,di[Pi+2]=Ge/ni,di[Pi+3]=ze/fi}return yi},toObject:function(){return{type:this.type,scaleX:this.scaleX,scaleY:this.scaleY,resizeType:this.resizeType,lanczosLobes:this.lanczosLobes}}}),e.Image.filters.Resize.fromObject=e.Image.filters.BaseFilter.fromObject}(Ie),function(Ee){var e=Ee.fabric||(Ee.fabric={}),xe=e.Image.filters,Te=e.util.createClass;xe.Contrast=Te(xe.BaseFilter,{type:"Contrast",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uContrast;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
float contrastF = 1.015 * (uContrast + 1.0) / (1.0 * (1.015 - uContrast));
color.rgb = contrastF * (color.rgb - 0.5) + 0.5;
gl_FragColor = color;
}`,contrast:0,mainParameter:"contrast",applyTo2d:function(_e){if(this.contrast!==0){var Se=_e.imageData,t,Pe,Ae=Se.data,Pe=Ae.length,St=Math.floor(this.contrast*255),Ce=259*(St+255)/(255*(259-St));for(t=0;t<Pe;t+=4)Ae[t]=Ce*(Ae[t]-128)+128,Ae[t+1]=Ce*(Ae[t+1]-128)+128,Ae[t+2]=Ce*(Ae[t+2]-128)+128}},getUniformLocations:function(_e,Se){return{uContrast:_e.getUniformLocation(Se,"uContrast")}},sendUniformData:function(_e,Se){_e.uniform1f(Se.uContrast,this.contrast)}}),e.Image.filters.Contrast.fromObject=e.Image.filters.BaseFilter.fromObject}(Ie),function(Ee){var e=Ee.fabric||(Ee.fabric={}),xe=e.Image.filters,Te=e.util.createClass;xe.Saturation=Te(xe.BaseFilter,{type:"Saturation",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uSaturation;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
float rgMax = max(color.r, color.g);
float rgbMax = max(rgMax, color.b);
color.r += rgbMax != color.r ? (rgbMax - color.r) * uSaturation : 0.00;
color.g += rgbMax != color.g ? (rgbMax - color.g) * uSaturation : 0.00;
color.b += rgbMax != color.b ? (rgbMax - color.b) * uSaturation : 0.00;
gl_FragColor = color;
}`,saturation:0,mainParameter:"saturation",applyTo2d:function(_e){if(this.saturation!==0){var Se=_e.imageData,t=Se.data,Ae=t.length,Pe=-this.saturation,St,Ce;for(St=0;St<Ae;St+=4)Ce=Math.max(t[St],t[St+1],t[St+2]),t[St]+=Ce!==t[St]?(Ce-t[St])*Pe:0,t[St+1]+=Ce!==t[St+1]?(Ce-t[St+1])*Pe:0,t[St+2]+=Ce!==t[St+2]?(Ce-t[St+2])*Pe:0}},getUniformLocations:function(_e,Se){return{uSaturation:_e.getUniformLocation(Se,"uSaturation")}},sendUniformData:function(_e,Se){_e.uniform1f(Se.uSaturation,-this.saturation)}}),e.Image.filters.Saturation.fromObject=e.Image.filters.BaseFilter.fromObject}(Ie),function(Ee){var e=Ee.fabric||(Ee.fabric={}),xe=e.Image.filters,Te=e.util.createClass;xe.Vibrance=Te(xe.BaseFilter,{type:"Vibrance",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uVibrance;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
float max = max(color.r, max(color.g, color.b));
float avg = (color.r + color.g + color.b) / 3.0;
float amt = (abs(max - avg) * 2.0) * uVibrance;
color.r += max != color.r ? (max - color.r) * amt : 0.00;
color.g += max != color.g ? (max - color.g) * amt : 0.00;
color.b += max != color.b ? (max - color.b) * amt : 0.00;
gl_FragColor = color;
}`,vibrance:0,mainParameter:"vibrance",applyTo2d:function(_e){if(this.vibrance!==0){var Se=_e.imageData,t=Se.data,Ae=t.length,Pe=-this.vibrance,St,Ce,ke,De;for(St=0;St<Ae;St+=4)Ce=Math.max(t[St],t[St+1],t[St+2]),ke=(t[St]+t[St+1]+t[St+2])/3,De=Math.abs(Ce-ke)*2/255*Pe,t[St]+=Ce!==t[St]?(Ce-t[St])*De:0,t[St+1]+=Ce!==t[St+1]?(Ce-t[St+1])*De:0,t[St+2]+=Ce!==t[St+2]?(Ce-t[St+2])*De:0}},getUniformLocations:function(_e,Se){return{uVibrance:_e.getUniformLocation(Se,"uVibrance")}},sendUniformData:function(_e,Se){_e.uniform1f(Se.uVibrance,-this.vibrance)}}),e.Image.filters.Vibrance.fromObject=e.Image.filters.BaseFilter.fromObject}(Ie),function(Ee){var e=Ee.fabric||(Ee.fabric={}),xe=e.Image.filters,Te=e.util.createClass;xe.Blur=Te(xe.BaseFilter,{type:"Blur",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform vec2 uDelta;
varying vec2 vTexCoord;
const float nSamples = 15.0;
vec3 v3offset = vec3(12.9898, 78.233, 151.7182);
float random(vec3 scale) {
return fract(sin(dot(gl_FragCoord.xyz, scale)) * 43758.5453);
}
void main() {
vec4 color = vec4(0.0);
float total = 0.0;
float offset = random(v3offset);
for (float t = -nSamples; t <= nSamples; t++) {
float percent = (t + offset - 0.5) / nSamples;
float weight = 1.0 - abs(percent);
color += texture2D(uTexture, vTexCoord + uDelta * percent) * weight;
total += weight;
}
gl_FragColor = color / total;
}`,blur:0,mainParameter:"blur",applyTo:function(_e){_e.webgl?(this.aspectRatio=_e.sourceWidth/_e.sourceHeight,_e.passes++,this._setupFrameBuffer(_e),this.horizontal=!0,this.applyToWebGL(_e),this._swapTextures(_e),this._setupFrameBuffer(_e),this.horizontal=!1,this.applyToWebGL(_e),this._swapTextures(_e)):this.applyTo2d(_e)},applyTo2d:function(_e){_e.imageData=this.simpleBlur(_e)},simpleBlur:function(_e){var Se=_e.filterBackend.resources,t,Ae,Pe=_e.imageData.width,St=_e.imageData.height;Se.blurLayer1||(Se.blurLayer1=e.util.createCanvasElement(),Se.blurLayer2=e.util.createCanvasElement()),t=Se.blurLayer1,Ae=Se.blurLayer2,(t.width!==Pe||t.height!==St)&&(Ae.width=t.width=Pe,Ae.height=t.height=St);var Ce=t.getContext("2d"),ke=Ae.getContext("2d"),De=15,Re,je,We,Ke,Je=this.blur*.06*.5;for(Ce.putImageData(_e.imageData,0,0),ke.clearRect(0,0,Pe,St),Ke=-De;Ke<=De;Ke++)Re=(Math.random()-.5)/4,je=Ke/De,We=Je*je*Pe+Re,ke.globalAlpha=1-Math.abs(je),ke.drawImage(t,We,Re),Ce.drawImage(Ae,0,0),ke.globalAlpha=1,ke.clearRect(0,0,Ae.width,Ae.height);for(Ke=-De;Ke<=De;Ke++)Re=(Math.random()-.5)/4,je=Ke/De,We=Je*je*St+Re,ke.globalAlpha=1-Math.abs(je),ke.drawImage(t,Re,We),Ce.drawImage(Ae,0,0),ke.globalAlpha=1,ke.clearRect(0,0,Ae.width,Ae.height);_e.ctx.drawImage(t,0,0);var hi=_e.ctx.getImageData(0,0,t.width,t.height);return Ce.globalAlpha=1,Ce.clearRect(0,0,t.width,t.height),hi},getUniformLocations:function(_e,Se){return{delta:_e.getUniformLocation(Se,"uDelta")}},sendUniformData:function(_e,Se){var t=this.chooseRightDelta();_e.uniform2fv(Se.delta,t)},chooseRightDelta:function(){var _e=1,Se=[0,0],t;return this.horizontal?this.aspectRatio>1&&(_e=1/this.aspectRatio):this.aspectRatio<1&&(_e=this.aspectRatio),t=_e*this.blur*.12,this.horizontal?Se[0]=t:Se[1]=t,Se}}),xe.Blur.fromObject=e.Image.filters.BaseFilter.fromObject}(Ie),function(Ee){var e=Ee.fabric||(Ee.fabric={}),xe=e.Image.filters,Te=e.util.createClass;xe.Gamma=Te(xe.BaseFilter,{type:"Gamma",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform vec3 uGamma;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
vec3 correction = (1.0 / uGamma);
color.r = pow(color.r, correction.r);
color.g = pow(color.g, correction.g);
color.b = pow(color.b, correction.b);
gl_FragColor = color;
gl_FragColor.rgb *= color.a;
}`,gamma:[1,1,1],mainParameter:"gamma",initialize:function(_e){this.gamma=[1,1,1],xe.BaseFilter.prototype.initialize.call(this,_e)},applyTo2d:function(_e){var Se=_e.imageData,t=Se.data,Ae=this.gamma,Pe=t.length,St=1/Ae[0],Ce=1/Ae[1],ke=1/Ae[2],De;for(this.rVals||(this.rVals=new Uint8Array(256),this.gVals=new Uint8Array(256),this.bVals=new Uint8Array(256)),De=0,Pe=256;De<Pe;De++)this.rVals[De]=Math.pow(De/255,St)*255,this.gVals[De]=Math.pow(De/255,Ce)*255,this.bVals[De]=Math.pow(De/255,ke)*255;for(De=0,Pe=t.length;De<Pe;De+=4)t[De]=this.rVals[t[De]],t[De+1]=this.gVals[t[De+1]],t[De+2]=this.bVals[t[De+2]]},getUniformLocations:function(_e,Se){return{uGamma:_e.getUniformLocation(Se,"uGamma")}},sendUniformData:function(_e,Se){_e.uniform3fv(Se.uGamma,this.gamma)}}),e.Image.filters.Gamma.fromObject=e.Image.filters.BaseFilter.fromObject}(Ie),function(Ee){var e=Ee.fabric||(Ee.fabric={}),xe=e.Image.filters,Te=e.util.createClass;xe.Composed=Te(xe.BaseFilter,{type:"Composed",subFilters:[],initialize:function(_e){this.callSuper("initialize",_e),this.subFilters=this.subFilters.slice(0)},applyTo:function(_e){_e.passes+=this.subFilters.length-1,this.subFilters.forEach(function(Se){Se.applyTo(_e)})},toObject:function(){return e.util.object.extend(this.callSuper("toObject"),{subFilters:this.subFilters.map(function(_e){return _e.toObject()})})},isNeutralState:function(){return!this.subFilters.some(function(_e){return!_e.isNeutralState()})}}),e.Image.filters.Composed.fromObject=function(_e,Se){var t=_e.subFilters||[],Ae=t.map(function(St){return new e.Image.filters[St.type](St)}),Pe=new e.Image.filters.Composed({subFilters:Ae});return Se&&Se(Pe),Pe}}(Ie),function(Ee){var e=Ee.fabric||(Ee.fabric={}),xe=e.Image.filters,Te=e.util.createClass;xe.HueRotation=Te(xe.ColorMatrix,{type:"HueRotation",rotation:0,mainParameter:"rotation",calculateMatrix:function(){var _e=this.rotation*Math.PI,Se=e.util.cos(_e),t=e.util.sin(_e),Ae=1/3,Pe=Math.sqrt(Ae)*t,St=1-Se;this.matrix=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],this.matrix[0]=Se+St/3,this.matrix[1]=Ae*St-Pe,this.matrix[2]=Ae*St+Pe,this.matrix[5]=Ae*St+Pe,this.matrix[6]=Se+Ae*St,this.matrix[7]=Ae*St-Pe,this.matrix[10]=Ae*St-Pe,this.matrix[11]=Ae*St+Pe,this.matrix[12]=Se+Ae*St},isNeutralState:function(_e){return this.calculateMatrix(),xe.BaseFilter.prototype.isNeutralState.call(this,_e)},applyTo:function(_e){this.calculateMatrix(),xe.BaseFilter.prototype.applyTo.call(this,_e)}}),e.Image.filters.HueRotation.fromObject=e.Image.filters.BaseFilter.fromObject}(Ie),function(Ee){var e=Ee.fabric||(Ee.fabric={}),xe=e.util.object.clone;if(e.Text){e.warn("fabric.Text is already defined");return}var Te="fontFamily fontWeight fontSize text underline overline linethrough textAlign fontStyle lineHeight textBackgroundColor charSpacing styles direction path pathStartOffset pathSide pathAlign".split(" ");e.Text=e.util.createClass(e.Object,{_dimensionAffectingProps:["fontSize","fontWeight","fontFamily","fontStyle","lineHeight","text","charSpacing","textAlign","styles","path","pathStartOffset","pathSide","pathAlign"],_reNewline:/\r?\n/,_reSpacesAndTabs:/[ \t\r]/g,_reSpaceAndTab:/[ \t\r]/,_reWords:/\S+/g,type:"text",fontSize:40,fontWeight:"normal",fontFamily:"Times New Roman",underline:!1,overline:!1,linethrough:!1,textAlign:"left",fontStyle:"normal",lineHeight:1.16,superscript:{size:.6,baseline:-.35},subscript:{size:.6,baseline:.11},textBackgroundColor:"",stateProperties:e.Object.prototype.stateProperties.concat(Te),cacheProperties:e.Object.prototype.cacheProperties.concat(Te),stroke:null,shadow:null,path:null,pathStartOffset:0,pathSide:"left",pathAlign:"baseline",_fontSizeFraction:.222,offsets:{underline:.1,linethrough:-.315,overline:-.88},_fontSizeMult:1.13,charSpacing:0,styles:null,_measuringContext:null,deltaY:0,direction:"ltr",_styleProperties:["stroke","strokeWidth","fill","fontFamily","fontSize","fontWeight","fontStyle","underline","overline","linethrough","deltaY","textBackgroundColor"],__charBounds:[],CACHE_FONT_SIZE:400,MIN_TEXT_WIDTH:2,initialize:function(_e,Se){this.styles=Se?Se.styles||{}:{},this.text=_e,this.__skipDimension=!0,this.callSuper("initialize",Se),this.path&&this.setPathInfo(),this.__skipDimension=!1,this.initDimensions(),this.setCoords(),this.setupState({propertySet:"_dimensionAffectingProps"})},setPathInfo:function(){var _e=this.path;_e&&(_e.segmentsInfo=e.util.getPathSegmentsInfo(_e.path))},getMeasuringContext:function(){return e._measuringContext||(e._measuringContext=this.canvas&&this.canvas.contextCache||e.util.createCanvasElement().getContext("2d")),e._measuringContext},_splitText:function(){var _e=this._splitTextIntoLines(this.text);return this.textLines=_e.lines,this._textLines=_e.graphemeLines,this._unwrappedTextLines=_e._unwrappedLines,this._text=_e.graphemeText,_e},initDimensions:function(){this.__skipDimension||(this._splitText(),this._clearCache(),this.path?(this.width=this.path.width,this.height=this.path.height):(this.width=this.calcTextWidth()||this.cursorWidth||this.MIN_TEXT_WIDTH,this.height=this.calcTextHeight()),this.textAlign.indexOf("justify")!==-1&&this.enlargeSpaces(),this.saveState({propertySet:"_dimensionAffectingProps"}))},enlargeSpaces:function(){for(var _e,Se,t,Ae,Pe,St,Ce,ke=0,De=this._textLines.length;ke<De;ke++)if(!(this.textAlign!=="justify"&&(ke===De-1||this.isEndOfWrapping(ke)))&&(Ae=0,Pe=this._textLines[ke],Se=this.getLineWidth(ke),Se<this.width&&(Ce=this.textLines[ke].match(this._reSpacesAndTabs)))){t=Ce.length,_e=(this.width-Se)/t;for(var Re=0,je=Pe.length;Re<=je;Re++)St=this.__charBounds[ke][Re],this._reSpaceAndTab.test(Pe[Re])?(St.width+=_e,St.kernedWidth+=_e,St.left+=Ae,Ae+=_e):St.left+=Ae}},isEndOfWrapping:function(_e){return _e===this._textLines.length-1},missingNewlineOffset:function(){return 1},toString:function(){return"#<fabric.Text ("+this.complexity()+'): { "text": "'+this.text+'", "fontFamily": "'+this.fontFamily+'" }>'},_getCacheCanvasDimensions:function(){var _e=this.callSuper("_getCacheCanvasDimensions"),Se=this.fontSize;return _e.width+=Se*_e.zoomX,_e.height+=Se*_e.zoomY,_e},_render:function(_e){var Se=this.path;Se&&!Se.isNotVisible()&&Se._render(_e),this._setTextStyles(_e),this._renderTextLinesBackground(_e),this._renderTextDecoration(_e,"underline"),this._renderText(_e),this._renderTextDecoration(_e,"overline"),this._renderTextDecoration(_e,"linethrough")},_renderText:function(_e){this.paintFirst==="stroke"?(this._renderTextStroke(_e),this._renderTextFill(_e)):(this._renderTextFill(_e),this._renderTextStroke(_e))},_setTextStyles:function(_e,Se,t){if(_e.textBaseline="alphabetical",this.path)switch(this.pathAlign){case"center":_e.textBaseline="middle";break;case"ascender":_e.textBaseline="top";break;case"descender":_e.textBaseline="bottom";break}_e.font=this._getFontDeclaration(Se,t)},calcTextWidth:function(){for(var _e=this.getLineWidth(0),Se=1,t=this._textLines.length;Se<t;Se++){var Ae=this.getLineWidth(Se);Ae>_e&&(_e=Ae)}return _e},_renderTextLine:function(_e,Se,t,Ae,Pe,St){this._renderChars(_e,Se,t,Ae,Pe,St)},_renderTextLinesBackground:function(_e){if(!(!this.textBackgroundColor&&!this.styleHas("textBackgroundColor"))){for(var Se,t,Ae=_e.fillStyle,Pe,St,Ce=this._getLeftOffset(),ke=this._getTopOffset(),De=0,Re=0,je,We,Ke=this.path,Je,hi=0,oi=this._textLines.length;hi<oi;hi++){if(Se=this.getHeightOfLine(hi),!this.textBackgroundColor&&!this.styleHas("textBackgroundColor",hi)){ke+=Se;continue}Pe=this._textLines[hi],t=this._getLineLeftOffset(hi),Re=0,De=0,St=this.getValueOfPropertyAt(hi,0,"textBackgroundColor");for(var ti=0,ai=Pe.length;ti<ai;ti++)je=this.__charBounds[hi][ti],We=this.getValueOfPropertyAt(hi,ti,"textBackgroundColor"),Ke?(_e.save(),_e.translate(je.renderLeft,je.renderTop),_e.rotate(je.angle),_e.fillStyle=We,We&&_e.fillRect(-je.width/2,-Se/this.lineHeight*(1-this._fontSizeFraction),je.width,Se/this.lineHeight),_e.restore()):We!==St?(Je=Ce+t+De,this.direction==="rtl"&&(Je=this.width-Je-Re),_e.fillStyle=St,St&&_e.fillRect(Je,ke,Re,Se/this.lineHeight),De=je.left,Re=je.width,St=We):Re+=je.kernedWidth;We&&!Ke&&(Je=Ce+t+De,this.direction==="rtl"&&(Je=this.width-Je-Re),_e.fillStyle=We,_e.fillRect(Je,ke,Re,Se/this.lineHeight)),ke+=Se}_e.fillStyle=Ae,this._removeShadow(_e)}},getFontCache:function(_e){var Se=_e.fontFamily.toLowerCase();e.charWidthsCache[Se]||(e.charWidthsCache[Se]={});var t=e.charWidthsCache[Se],Ae=_e.fontStyle.toLowerCase()+"_"+(_e.fontWeight+"").toLowerCase();return t[Ae]||(t[Ae]={}),t[Ae]},_measureChar:function(_e,Se,t,Ae){var Pe=this.getFontCache(Se),St=this._getFontDeclaration(Se),Ce=this._getFontDeclaration(Ae),ke=t+_e,De=St===Ce,Re,je,We,Ke=Se.fontSize/this.CACHE_FONT_SIZE,Je;if(t&&Pe[t]!==void 0&&(We=Pe[t]),Pe[_e]!==void 0&&(Je=Re=Pe[_e]),De&&Pe[ke]!==void 0&&(je=Pe[ke],Je=je-We),Re===void 0||We===void 0||je===void 0){var hi=this.getMeasuringContext();this._setTextStyles(hi,Se,!0)}return Re===void 0&&(Je=Re=hi.measureText(_e).width,Pe[_e]=Re),We===void 0&&De&&t&&(We=hi.measureText(t).width,Pe[t]=We),De&&je===void 0&&(je=hi.measureText(ke).width,Pe[ke]=je,Je=je-We),{width:Re*Ke,kernedWidth:Je*Ke}},getHeightOfChar:function(_e,Se){return this.getValueOfPropertyAt(_e,Se,"fontSize")},measureLine:function(_e){var Se=this._measureLine(_e);return this.charSpacing!==0&&(Se.width-=this._getWidthOfCharSpacing()),Se.width<0&&(Se.width=0),Se},_measureLine:function(_e){var Se=0,t,Ae,Pe=this._textLines[_e],St,Ce,ke=0,De=new Array(Pe.length),Re=0,je,We,Ke=this.path,Je=this.pathSide==="right";for(this.__charBounds[_e]=De,t=0;t<Pe.length;t++)Ae=Pe[t],Ce=this._getGraphemeBox(Ae,_e,t,St),De[t]=Ce,Se+=Ce.kernedWidth,St=Ae;if(De[t]={left:Ce?Ce.left+Ce.width:0,width:0,kernedWidth:0,height:this.fontSize},Ke){switch(We=Ke.segmentsInfo[Ke.segmentsInfo.length-1].length,je=e.util.getPointOnPath(Ke.path,0,Ke.segmentsInfo),je.x+=Ke.pathOffset.x,je.y+=Ke.pathOffset.y,this.textAlign){case"left":Re=Je?We-Se:0;break;case"center":Re=(We-Se)/2;break;case"right":Re=Je?0:We-Se;break}for(Re+=this.pathStartOffset*(Je?-1:1),t=Je?Pe.length-1:0;Je?t>=0:t<Pe.length;Je?t--:t++)Ce=De[t],Re>We?Re%=We:Re<0&&(Re+=We),this._setGraphemeOnPath(Re,Ce,je),Re+=Ce.kernedWidth}return{width:Se,numOfSpaces:ke}},_setGraphemeOnPath:function(_e,Se,t){var Ae=_e+Se.kernedWidth/2,Pe=this.path,St=e.util.getPointOnPath(Pe.path,Ae,Pe.segmentsInfo);Se.renderLeft=St.x-t.x,Se.renderTop=St.y-t.y,Se.angle=St.angle+(this.pathSide==="right"?Math.PI:0)},_getGraphemeBox:function(_e,Se,t,Ae,Pe){var St=this.getCompleteStyleDeclaration(Se,t),Ce=Ae?this.getCompleteStyleDeclaration(Se,t-1):{},ke=this._measureChar(_e,St,Ae,Ce),De=ke.kernedWidth,Re=ke.width,je;this.charSpacing!==0&&(je=this._getWidthOfCharSpacing(),Re+=je,De+=je);var We={width:Re,left:0,height:St.fontSize,kernedWidth:De,deltaY:St.deltaY};if(t>0&&!Pe){var Ke=this.__charBounds[Se][t-1];We.left=Ke.left+Ke.width+ke.kernedWidth-ke.width}return We},getHeightOfLine:function(_e){if(this.__lineHeights[_e])return this.__lineHeights[_e];for(var Se=this._textLines[_e],t=this.getHeightOfChar(_e,0),Ae=1,Pe=Se.length;Ae<Pe;Ae++)t=Math.max(this.getHeightOfChar(_e,Ae),t);return this.__lineHeights[_e]=t*this.lineHeight*this._fontSizeMult},calcTextHeight:function(){for(var _e,Se=0,t=0,Ae=this._textLines.length;t<Ae;t++)_e=this.getHeightOfLine(t),Se+=t===Ae-1?_e/this.lineHeight:_e;return Se},_getLeftOffset:function(){return this.direction==="ltr"?-this.width/2:this.width/2},_getTopOffset:function(){return-this.height/2},_renderTextCommon:function(_e,Se){_e.save();for(var t=0,Ae=this._getLeftOffset(),Pe=this._getTopOffset(),St=0,Ce=this._textLines.length;St<Ce;St++){var ke=this.getHeightOfLine(St),De=ke/this.lineHeight,Re=this._getLineLeftOffset(St);this._renderTextLine(Se,_e,this._textLines[St],Ae+Re,Pe+t+De,St),t+=ke}_e.restore()},_renderTextFill:function(_e){!this.fill&&!this.styleHas("fill")||this._renderTextCommon(_e,"fillText")},_renderTextStroke:function(_e){(!this.stroke||this.strokeWidth===0)&&this.isEmptyStyles()||(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(_e),_e.save(),this._setLineDash(_e,this.strokeDashArray),_e.beginPath(),this._renderTextCommon(_e,"strokeText"),_e.closePath(),_e.restore())},_renderChars:function(_e,Se,t,Ae,Pe,St){var Ce=this.getHeightOfLine(St),ke=this.textAlign.indexOf("justify")!==-1,De,Re,je="",We,Ke=0,Je,hi=this.path,oi=!ke&&this.charSpacing===0&&this.isEmptyStyles(St)&&!hi,ti=this.direction==="ltr",ai=this.direction==="ltr"?1:-1,yi,di=Se.canvas.getAttribute("dir");if(Se.save(),di!==this.direction&&(Se.canvas.setAttribute("dir",ti?"ltr":"rtl"),Se.direction=ti?"ltr":"rtl",Se.textAlign=ti?"left":"right"),Pe-=Ce*this._fontSizeFraction/this.lineHeight,oi){this._renderChar(_e,Se,St,0,t.join(""),Ae,Pe,Ce),Se.restore();return}for(var bi=0,vi=t.length-1;bi<=vi;bi++)Je=bi===vi||this.charSpacing||hi,je+=t[bi],We=this.__charBounds[St][bi],Ke===0?(Ae+=ai*(We.kernedWidth-We.width),Ke+=We.width):Ke+=We.kernedWidth,ke&&!Je&&this._reSpaceAndTab.test(t[bi])&&(Je=!0),Je||(De=De||this.getCompleteStyleDeclaration(St,bi),Re=this.getCompleteStyleDeclaration(St,bi+1),Je=e.util.hasStyleChanged(De,Re,!1)),Je&&(hi?(Se.save(),Se.translate(We.renderLeft,We.renderTop),Se.rotate(We.angle),this._renderChar(_e,Se,St,bi,je,-Ke/2,0,Ce),Se.restore()):(yi=Ae,this._renderChar(_e,Se,St,bi,je,yi,Pe,Ce)),je="",De=Re,Ae+=ai*Ke,Ke=0);Se.restore()},_applyPatternGradientTransformText:function(_e){var Se=e.util.createCanvasElement(),t,Ae=this.width+this.strokeWidth,Pe=this.height+this.strokeWidth;return Se.width=Ae,Se.height=Pe,t=Se.getContext("2d"),t.beginPath(),t.moveTo(0,0),t.lineTo(Ae,0),t.lineTo(Ae,Pe),t.lineTo(0,Pe),t.closePath(),t.translate(Ae/2,Pe/2),t.fillStyle=_e.toLive(t),this._applyPatternGradientTransform(t,_e),t.fill(),t.createPattern(Se,"no-repeat")},handleFiller:function(_e,Se,t){var Ae,Pe;return t.toLive?t.gradientUnits==="percentage"||t.gradientTransform||t.patternTransform?(Ae=-this.width/2,Pe=-this.height/2,_e.translate(Ae,Pe),_e[Se]=this._applyPatternGradientTransformText(t),{offsetX:Ae,offsetY:Pe}):(_e[Se]=t.toLive(_e,this),this._applyPatternGradientTransform(_e,t)):(_e[Se]=t,{offsetX:0,offsetY:0})},_setStrokeStyles:function(_e,Se){return _e.lineWidth=Se.strokeWidth,_e.lineCap=this.strokeLineCap,_e.lineDashOffset=this.strokeDashOffset,_e.lineJoin=this.strokeLineJoin,_e.miterLimit=this.strokeMiterLimit,this.handleFiller(_e,"strokeStyle",Se.stroke)},_setFillStyles:function(_e,Se){return this.handleFiller(_e,"fillStyle",Se.fill)},_renderChar:function(_e,Se,t,Ae,Pe,St,Ce){var ke=this._getStyleDeclaration(t,Ae),De=this.getCompleteStyleDeclaration(t,Ae),Re=_e==="fillText"&&De.fill,je=_e==="strokeText"&&De.stroke&&De.strokeWidth,We,Ke;!je&&!Re||(Se.save(),Re&&(We=this._setFillStyles(Se,De)),je&&(Ke=this._setStrokeStyles(Se,De)),Se.font=this._getFontDeclaration(De),ke&&ke.textBackgroundColor&&this._removeShadow(Se),ke&&ke.deltaY&&(Ce+=ke.deltaY),Re&&Se.fillText(Pe,St-We.offsetX,Ce-We.offsetY),je&&Se.strokeText(Pe,St-Ke.offsetX,Ce-Ke.offsetY),Se.restore())},setSuperscript:function(_e,Se){return this._setScript(_e,Se,this.superscript)},setSubscript:function(_e,Se){return this._setScript(_e,Se,this.subscript)},_setScript:function(_e,Se,t){var Ae=this.get2DCursorLocation(_e,!0),Pe=this.getValueOfPropertyAt(Ae.lineIndex,Ae.charIndex,"fontSize"),St=this.getValueOfPropertyAt(Ae.lineIndex,Ae.charIndex,"deltaY"),Ce={fontSize:Pe*t.size,deltaY:St+Pe*t.baseline};return this.setSelectionStyles(Ce,_e,Se),this},_getLineLeftOffset:function(_e){var Se=this.getLineWidth(_e),t=this.width-Se,Ae=this.textAlign,Pe=this.direction,Ce,St=0,Ce=this.isEndOfWrapping(_e);return Ae==="justify"||Ae==="justify-center"&&!Ce||Ae==="justify-right"&&!Ce||Ae==="justify-left"&&!Ce?0:(Ae==="center"&&(St=t/2),Ae==="right"&&(St=t),Ae==="justify-center"&&(St=t/2),Ae==="justify-right"&&(St=t),Pe==="rtl"&&(St-=t),St)},_clearCache:function(){this.__lineWidths=[],this.__lineHeights=[],this.__charBounds=[]},_shouldClearDimensionCache:function(){var _e=this._forceClearCache;return _e||(_e=this.hasStateChanged("_dimensionAffectingProps")),_e&&(this.dirty=!0,this._forceClearCache=!1),_e},getLineWidth:function(_e){if(this.__lineWidths[_e]!==void 0)return this.__lineWidths[_e];var Se=this.measureLine(_e),t=Se.width;return this.__lineWidths[_e]=t,t},_getWidthOfCharSpacing:function(){return this.charSpacing!==0?this.fontSize*this.charSpacing/1e3:0},getValueOfPropertyAt:function(_e,Se,t){var Ae=this._getStyleDeclaration(_e,Se);return Ae&&typeof Ae[t]<"u"?Ae[t]:this[t]},_renderTextDecoration:function(_e,Se){if(!(!this[Se]&&!this.styleHas(Se))){for(var t,Ae,Pe,St,Ce,ke,De,Re,je=this._getLeftOffset(),We=this._getTopOffset(),Ke,Je,hi,oi,ti,ai,yi,di,bi=this.path,vi=this._getWidthOfCharSpacing(),Pi=this.offsets[Se],xi=0,ni=this._textLines.length;xi<ni;xi++){if(t=this.getHeightOfLine(xi),!this[Se]&&!this.styleHas(Se,xi)){We+=t;continue}De=this._textLines[xi],ai=t/this.lineHeight,St=this._getLineLeftOffset(xi),Je=0,hi=0,Re=this.getValueOfPropertyAt(xi,0,Se),di=this.getValueOfPropertyAt(xi,0,"fill"),Ke=We+ai*(1-this._fontSizeFraction),Ae=this.getHeightOfChar(xi,0),Ce=this.getValueOfPropertyAt(xi,0,"deltaY");for(var fi=0,Si=De.length;fi<Si;fi++)if(oi=this.__charBounds[xi][fi],ti=this.getValueOfPropertyAt(xi,fi,Se),yi=this.getValueOfPropertyAt(xi,fi,"fill"),Pe=this.getHeightOfChar(xi,fi),ke=this.getValueOfPropertyAt(xi,fi,"deltaY"),bi&&ti&&yi)_e.save(),_e.fillStyle=di,_e.translate(oi.renderLeft,oi.renderTop),_e.rotate(oi.angle),_e.fillRect(-oi.kernedWidth/2,Pi*Pe+ke,oi.kernedWidth,this.fontSize/15),_e.restore();else if((ti!==Re||yi!==di||Pe!==Ae||ke!==Ce)&&hi>0){var Xe=je+St+Je;this.direction==="rtl"&&(Xe=this.width-Xe-hi),Re&&di&&(_e.fillStyle=di,_e.fillRect(Xe,Ke+Pi*Ae+Ce,hi,this.fontSize/15)),Je=oi.left,hi=oi.width,Re=ti,di=yi,Ae=Pe,Ce=ke}else hi+=oi.kernedWidth;var Xe=je+St+Je;this.direction==="rtl"&&(Xe=this.width-Xe-hi),_e.fillStyle=yi,ti&&yi&&_e.fillRect(Xe,Ke+Pi*Ae+Ce,hi-vi,this.fontSize/15),We+=t}this._removeShadow(_e)}},_getFontDeclaration:function(_e,Se){var t=_e||this,Ae=this.fontFamily,Pe=e.Text.genericFonts.indexOf(Ae.toLowerCase())>-1,St=Ae===void 0||Ae.indexOf("'")>-1||Ae.indexOf(",")>-1||Ae.indexOf('"')>-1||Pe?t.fontFamily:'"'+t.fontFamily+'"';return[e.isLikelyNode?t.fontWeight:t.fontStyle,e.isLikelyNode?t.fontStyle:t.fontWeight,Se?this.CACHE_FONT_SIZE+"px":t.fontSize+"px",St].join(" ")},render:function(_e){!this.visible||this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(this._shouldClearDimensionCache()&&this.initDimensions(),this.callSuper("render",_e))},_splitTextIntoLines:function(_e){for(var Se=_e.split(this._reNewline),t=new Array(Se.length),Ae=[`
`],Pe=[],St=0;St<Se.length;St++)t[St]=e.util.string.graphemeSplit(Se[St]),Pe=Pe.concat(t[St],Ae);return Pe.pop(),{_unwrappedLines:t,lines:Se,graphemeText:Pe,graphemeLines:t}},toObject:function(_e){var Se=Te.concat(_e),t=this.callSuper("toObject",Se);return t.styles=e.util.stylesToArray(this.styles,this.text),t.path&&(t.path=this.path.toObject()),t},set:function(_e,Se){this.callSuper("set",_e,Se);var t=!1,Ae=!1;if(typeof _e=="object")for(var Pe in _e)Pe==="path"&&this.setPathInfo(),t=t||this._dimensionAffectingProps.indexOf(Pe)!==-1,Ae=Ae||Pe==="path";else t=this._dimensionAffectingProps.indexOf(_e)!==-1,Ae=_e==="path";return Ae&&this.setPathInfo(),t&&(this.initDimensions(),this.setCoords()),this},complexity:function(){return 1}}),e.Text.ATTRIBUTE_NAMES=e.SHARED_ATTRIBUTES.concat("x y dx dy font-family font-style font-weight font-size letter-spacing text-decoration text-anchor".split(" ")),e.Text.DEFAULT_SVG_FONT_SIZE=16,e.Text.fromElement=function(_e,Se,t){if(!_e)return Se(null);var Ae=e.parseAttributes(_e,e.Text.ATTRIBUTE_NAMES),Pe=Ae.textAnchor||"left";if(t=e.util.object.extend(t?xe(t):{},Ae),t.top=t.top||0,t.left=t.left||0,Ae.textDecoration){var St=Ae.textDecoration;St.indexOf("underline")!==-1&&(t.underline=!0),St.indexOf("overline")!==-1&&(t.overline=!0),St.indexOf("line-through")!==-1&&(t.linethrough=!0),delete t.textDecoration}"dx"in Ae&&(t.left+=Ae.dx),"dy"in Ae&&(t.top+=Ae.dy),"fontSize"in t||(t.fontSize=e.Text.DEFAULT_SVG_FONT_SIZE);var Ce="";"textContent"in _e?Ce=_e.textContent:"firstChild"in _e&&_e.firstChild!==null&&"data"in _e.firstChild&&_e.firstChild.data!==null&&(Ce=_e.firstChild.data),Ce=Ce.replace(/^\s+|\s+$|\n+/g,"").replace(/\s+/g," ");var ke=t.strokeWidth;t.strokeWidth=0;var De=new e.Text(Ce,t),Re=De.getScaledHeight()/De.height,je=(De.height+De.strokeWidth)*De.lineHeight-De.height,We=je*Re,Ke=De.getScaledHeight()+We,Je=0;Pe==="center"&&(Je=De.getScaledWidth()/2),Pe==="right"&&(Je=De.getScaledWidth()),De.set({left:De.left-Je,top:De.top-(Ke-De.fontSize*(.07+De._fontSizeFraction))/De.lineHeight,strokeWidth:typeof ke<"u"?ke:1}),Se(De)},e.Text.fromObject=function(_e,Se){var t=xe(_e),Ae=_e.path;return delete t.path,e.Object._fromObject("Text",t,function(Pe){Pe.styles=e.util.stylesFromArray(_e.styles,_e.text),Ae?e.Object._fromObject("Path",Ae,function(St){Pe.set("path",St),Se(Pe)},"path"):Se(Pe)},"text")},e.Text.genericFonts=["sans-serif","serif","cursive","fantasy","monospace"],e.util.createAccessors&&e.util.createAccessors(e.Text)}(Ie),function(){r.util.object.extend(r.Text.prototype,{isEmptyStyles:function(Ee){if(!this.styles||typeof Ee<"u"&&!this.styles[Ee])return!0;var e=typeof Ee>"u"?this.styles:{line:this.styles[Ee]};for(var xe in e)for(var Te in e[xe])for(var _e in e[xe][Te])return!1;return!0},styleHas:function(Ee,e){if(!this.styles||!Ee||Ee===""||typeof e<"u"&&!this.styles[e])return!1;var xe=typeof e>"u"?this.styles:{0:this.styles[e]};for(var Te in xe)for(var _e in xe[Te])if(typeof xe[Te][_e][Ee]<"u")return!0;return!1},cleanStyle:function(Ee){if(!this.styles||!Ee||Ee==="")return!1;var e=this.styles,xe=0,Te,_e,Se=!0,t=0,Ae;for(var Pe in e){Te=0;for(var St in e[Pe]){var Ae=e[Pe][St],Ce=Ae.hasOwnProperty(Ee);xe++,Ce?(_e?Ae[Ee]!==_e&&(Se=!1):_e=Ae[Ee],Ae[Ee]===this[Ee]&&delete Ae[Ee]):Se=!1,Object.keys(Ae).length!==0?Te++:delete e[Pe][St]}Te===0&&delete e[Pe]}for(var ke=0;ke<this._textLines.length;ke++)t+=this._textLines[ke].length;Se&&xe===t&&(this[Ee]=_e,this.removeStyle(Ee))},removeStyle:function(Ee){if(!(!this.styles||!Ee||Ee==="")){var e=this.styles,xe,Te,_e;for(Te in e){xe=e[Te];for(_e in xe)delete xe[_e][Ee],Object.keys(xe[_e]).length===0&&delete xe[_e];Object.keys(xe).length===0&&delete e[Te]}}},_extendStyles:function(Ee,e){var xe=this.get2DCursorLocation(Ee);this._getLineStyle(xe.lineIndex)||this._setLineStyle(xe.lineIndex),this._getStyleDeclaration(xe.lineIndex,xe.charIndex)||this._setStyleDeclaration(xe.lineIndex,xe.charIndex,{}),r.util.object.extend(this._getStyleDeclaration(xe.lineIndex,xe.charIndex),e)},get2DCursorLocation:function(Ee,e){typeof Ee>"u"&&(Ee=this.selectionStart);for(var xe=e?this._unwrappedTextLines:this._textLines,Te=xe.length,_e=0;_e<Te;_e++){if(Ee<=xe[_e].length)return{lineIndex:_e,charIndex:Ee};Ee-=xe[_e].length+this.missingNewlineOffset(_e)}return{lineIndex:_e-1,charIndex:xe[_e-1].length<Ee?xe[_e-1].length:Ee}},getSelectionStyles:function(Ee,e,xe){typeof Ee>"u"&&(Ee=this.selectionStart||0),typeof e>"u"&&(e=this.selectionEnd||Ee);for(var Te=[],_e=Ee;_e<e;_e++)Te.push(this.getStyleAtPosition(_e,xe));return Te},getStyleAtPosition:function(Ee,e){var xe=this.get2DCursorLocation(Ee),Te=e?this.getCompleteStyleDeclaration(xe.lineIndex,xe.charIndex):this._getStyleDeclaration(xe.lineIndex,xe.charIndex);return Te||{}},setSelectionStyles:function(Ee,e,xe){typeof e>"u"&&(e=this.selectionStart||0),typeof xe>"u"&&(xe=this.selectionEnd||e);for(var Te=e;Te<xe;Te++)this._extendStyles(Te,Ee);return this._forceClearCache=!0,this},_getStyleDeclaration:function(Ee,e){var xe=this.styles&&this.styles[Ee];return xe?xe[e]:null},getCompleteStyleDeclaration:function(Ee,e){for(var xe=this._getStyleDeclaration(Ee,e)||{},Te={},_e,Se=0;Se<this._styleProperties.length;Se++)_e=this._styleProperties[Se],Te[_e]=typeof xe[_e]>"u"?this[_e]:xe[_e];return Te},_setStyleDeclaration:function(Ee,e,xe){this.styles[Ee][e]=xe},_deleteStyleDeclaration:function(Ee,e){delete this.styles[Ee][e]},_getLineStyle:function(Ee){return!!this.styles[Ee]},_setLineStyle:function(Ee){this.styles[Ee]={}},_deleteLineStyle:function(Ee){delete this.styles[Ee]}})}(),function(){function Ee(e){e.textDecoration&&(e.textDecoration.indexOf("underline")>-1&&(e.underline=!0),e.textDecoration.indexOf("line-through")>-1&&(e.linethrough=!0),e.textDecoration.indexOf("overline")>-1&&(e.overline=!0),delete e.textDecoration)}r.IText=r.util.createClass(r.Text,r.Observable,{type:"i-text",selectionStart:0,selectionEnd:0,selectionColor:"rgba(17,119,255,0.3)",isEditing:!1,editable:!0,editingBorderColor:"rgba(102,153,255,0.25)",cursorWidth:2,cursorColor:"",cursorDelay:1e3,cursorDuration:600,caching:!0,hiddenTextareaContainer:null,_reSpace:/\s|\n/,_currentCursorOpacity:0,_selectionDirection:null,_abortCursorAnimation:!1,__widthOfSpace:[],inCompositionMode:!1,initialize:function(e,xe){this.callSuper("initialize",e,xe),this.initBehavior()},setSelectionStart:function(e){e=Math.max(e,0),this._updateAndFire("selectionStart",e)},setSelectionEnd:function(e){e=Math.min(e,this.text.length),this._updateAndFire("selectionEnd",e)},_updateAndFire:function(e,xe){this[e]!==xe&&(this._fireSelectionChanged(),this[e]=xe),this._updateTextarea()},_fireSelectionChanged:function(){this.fire("selection:changed"),this.canvas&&this.canvas.fire("text:selection:changed",{target:this})},initDimensions:function(){this.isEditing&&this.initDelayedCursor(),this.clearContextTop(),this.callSuper("initDimensions")},render:function(e){this.clearContextTop(),this.callSuper("render",e),this.cursorOffsetCache={},this.renderCursorOrSelection()},_render:function(e){this.callSuper("_render",e)},clearContextTop:function(e){if(!(!this.isEditing||!this.canvas||!this.canvas.contextTop)){var xe=this.canvas.contextTop,Te=this.canvas.viewportTransform;xe.save(),xe.transform(Te[0],Te[1],Te[2],Te[3],Te[4],Te[5]),this.transform(xe),this._clearTextArea(xe),e||xe.restore()}},renderCursorOrSelection:function(){if(!(!this.isEditing||!this.canvas||!this.canvas.contextTop)){var e=this._getCursorBoundaries(),xe=this.canvas.contextTop;this.clearContextTop(!0),this.selectionStart===this.selectionEnd?this.renderCursor(e,xe):this.renderSelection(e,xe),xe.restore()}},_clearTextArea:function(e){var xe=this.width+4,Te=this.height+4;e.clearRect(-xe/2,-Te/2,xe,Te)},_getCursorBoundaries:function(e){typeof e>"u"&&(e=this.selectionStart);var xe=this._getLeftOffset(),Te=this._getTopOffset(),_e=this._getCursorBoundariesOffsets(e);return{left:xe,top:Te,leftOffset:_e.left,topOffset:_e.top}},_getCursorBoundariesOffsets:function(e){if(this.cursorOffsetCache&&"top"in this.cursorOffsetCache)return this.cursorOffsetCache;var xe,Te,_e,Se=0,t=0,Ae,Pe=this.get2DCursorLocation(e);_e=Pe.charIndex,Te=Pe.lineIndex;for(var St=0;St<Te;St++)Se+=this.getHeightOfLine(St);xe=this._getLineLeftOffset(Te);var Ce=this.__charBounds[Te][_e];return Ce&&(t=Ce.left),this.charSpacing!==0&&_e===this._textLines[Te].length&&(t-=this._getWidthOfCharSpacing()),Ae={top:Se,left:xe+(t>0?t:0)},this.direction==="rtl"&&(Ae.left*=-1),this.cursorOffsetCache=Ae,this.cursorOffsetCache},renderCursor:function(e,xe){var Te=this.get2DCursorLocation(),_e=Te.lineIndex,Se=Te.charIndex>0?Te.charIndex-1:0,t=this.getValueOfPropertyAt(_e,Se,"fontSize"),Ae=this.scaleX*this.canvas.getZoom(),Pe=this.cursorWidth/Ae,St=e.topOffset,Ce=this.getValueOfPropertyAt(_e,Se,"deltaY");St+=(1-this._fontSizeFraction)*this.getHeightOfLine(_e)/this.lineHeight-t*(1-this._fontSizeFraction),this.inCompositionMode&&this.renderSelection(e,xe),xe.fillStyle=this.cursorColor||this.getValueOfPropertyAt(_e,Se,"fill"),xe.globalAlpha=this.__isMousedown?1:this._currentCursorOpacity,xe.fillRect(e.left+e.leftOffset-Pe/2,St+e.top+Ce,Pe,t)},renderSelection:function(e,xe){for(var Te=this.inCompositionMode?this.hiddenTextarea.selectionStart:this.selectionStart,_e=this.inCompositionMode?this.hiddenTextarea.selectionEnd:this.selectionEnd,Se=this.textAlign.indexOf("justify")!==-1,t=this.get2DCursorLocation(Te),Ae=this.get2DCursorLocation(_e),Pe=t.lineIndex,St=Ae.lineIndex,Ce=t.charIndex<0?0:t.charIndex,ke=Ae.charIndex<0?0:Ae.charIndex,De=Pe;De<=St;De++){var Re=this._getLineLeftOffset(De)||0,je=this.getHeightOfLine(De),We=0,Ke=0,Je=0;if(De===Pe&&(Ke=this.__charBounds[Pe][Ce].left),De>=Pe&&De<St)Je=Se&&!this.isEndOfWrapping(De)?this.width:this.getLineWidth(De)||5;else if(De===St)if(ke===0)Je=this.__charBounds[St][ke].left;else{var hi=this._getWidthOfCharSpacing();Je=this.__charBounds[St][ke-1].left+this.__charBounds[St][ke-1].width-hi}We=je,(this.lineHeight<1||De===St&&this.lineHeight>1)&&(je/=this.lineHeight);var oi=e.left+Re+Ke,ti=Je-Ke,ai=je,yi=0;this.inCompositionMode?(xe.fillStyle=this.compositionColor||"black",ai=1,yi=je):xe.fillStyle=this.selectionColor,this.direction==="rtl"&&(oi=this.width-oi-ti),xe.fillRect(oi,e.top+e.topOffset+yi,ti,ai),e.topOffset+=We}},getCurrentCharFontSize:function(){var e=this._getCurrentCharIndex();return this.getValueOfPropertyAt(e.l,e.c,"fontSize")},getCurrentCharColor:function(){var e=this._getCurrentCharIndex();return this.getValueOfPropertyAt(e.l,e.c,"fill")},_getCurrentCharIndex:function(){var e=this.get2DCursorLocation(this.selectionStart,!0),xe=e.charIndex>0?e.charIndex-1:0;return{l:e.lineIndex,c:xe}}}),r.IText.fromObject=function(e,xe){var Te=r.util.stylesFromArray(e.styles,e.text),_e=Object.assign({},e,{styles:Te});if(Ee(_e),_e.styles)for(var Se in _e.styles)for(var t in _e.styles[Se])Ee(_e.styles[Se][t]);r.Object._fromObject("IText",_e,xe,"text")}}(),function(){var Ee=r.util.object.clone;r.util.object.extend(r.IText.prototype,{initBehavior:function(){this.initAddedHandler(),this.initRemovedHandler(),this.initCursorSelectionHandlers(),this.initDoubleClickSimulation(),this.mouseMoveHandler=this.mouseMoveHandler.bind(this)},onDeselect:function(){this.isEditing&&this.exitEditing(),this.selected=!1},initAddedHandler:function(){var e=this;this.on("added",function(){var xe=e.canvas;xe&&(xe._hasITextHandlers||(xe._hasITextHandlers=!0,e._initCanvasHandlers(xe)),xe._iTextInstances=xe._iTextInstances||[],xe._iTextInstances.push(e))})},initRemovedHandler:function(){var e=this;this.on("removed",function(){var xe=e.canvas;xe&&(xe._iTextInstances=xe._iTextInstances||[],r.util.removeFromArray(xe._iTextInstances,e),xe._iTextInstances.length===0&&(xe._hasITextHandlers=!1,e._removeCanvasHandlers(xe)))})},_initCanvasHandlers:function(e){e._mouseUpITextHandler=function(){e._iTextInstances&&e._iTextInstances.forEach(function(xe){xe.__isMousedown=!1})},e.on("mouse:up",e._mouseUpITextHandler)},_removeCanvasHandlers:function(e){e.off("mouse:up",e._mouseUpITextHandler)},_tick:function(){this._currentTickState=this._animateCursor(this,1,this.cursorDuration,"_onTickComplete")},_animateCursor:function(e,xe,Te,_e){var Se;return Se={isAborted:!1,abort:function(){this.isAborted=!0}},e.animate("_currentCursorOpacity",xe,{duration:Te,onComplete:function(){Se.isAborted||e[_e]()},onChange:function(){e.canvas&&e.selectionStart===e.selectionEnd&&e.renderCursorOrSelection()},abort:function(){return Se.isAborted}}),Se},_onTickComplete:function(){var e=this;this._cursorTimeout1&&clearTimeout(this._cursorTimeout1),this._cursorTimeout1=setTimeout(function(){e._currentTickCompleteState=e._animateCursor(e,0,this.cursorDuration/2,"_tick")},100)},initDelayedCursor:function(e){var xe=this,Te=e?0:this.cursorDelay;this.abortCursorAnimation(),this._currentCursorOpacity=1,this._cursorTimeout2=setTimeout(function(){xe._tick()},Te)},abortCursorAnimation:function(){var e=this._currentTickState||this._currentTickCompleteState,xe=this.canvas;this._currentTickState&&this._currentTickState.abort(),this._currentTickCompleteState&&this._currentTickCompleteState.abort(),clearTimeout(this._cursorTimeout1),clearTimeout(this._cursorTimeout2),this._currentCursorOpacity=0,e&&xe&&xe.clearContext(xe.contextTop||xe.contextContainer)},selectAll:function(){return this.selectionStart=0,this.selectionEnd=this._text.length,this._fireSelectionChanged(),this._updateTextarea(),this},getSelectedText:function(){return this._text.slice(this.selectionStart,this.selectionEnd).join("")},findWordBoundaryLeft:function(e){var xe=0,Te=e-1;if(this._reSpace.test(this._text[Te]))for(;this._reSpace.test(this._text[Te]);)xe++,Te--;for(;/\S/.test(this._text[Te])&&Te>-1;)xe++,Te--;return e-xe},findWordBoundaryRight:function(e){var xe=0,Te=e;if(this._reSpace.test(this._text[Te]))for(;this._reSpace.test(this._text[Te]);)xe++,Te++;for(;/\S/.test(this._text[Te])&&Te<this._text.length;)xe++,Te++;return e+xe},findLineBoundaryLeft:function(e){for(var xe=0,Te=e-1;!/\n/.test(this._text[Te])&&Te>-1;)xe++,Te--;return e-xe},findLineBoundaryRight:function(e){for(var xe=0,Te=e;!/\n/.test(this._text[Te])&&Te<this._text.length;)xe++,Te++;return e+xe},searchWordBoundary:function(e,xe){for(var Te=this._text,_e=this._reSpace.test(Te[e])?e-1:e,Se=Te[_e],t=r.reNonWord;!t.test(Se)&&_e>0&&_e<Te.length;)_e+=xe,Se=Te[_e];return t.test(Se)&&(_e+=xe===1?0:1),_e},selectWord:function(e){e=e||this.selectionStart;var xe=this.searchWordBoundary(e,-1),Te=this.searchWordBoundary(e,1);this.selectionStart=xe,this.selectionEnd=Te,this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()},selectLine:function(e){e=e||this.selectionStart;var xe=this.findLineBoundaryLeft(e),Te=this.findLineBoundaryRight(e);return this.selectionStart=xe,this.selectionEnd=Te,this._fireSelectionChanged(),this._updateTextarea(),this},enterEditing:function(e){if(!(this.isEditing||!this.editable))return this.canvas&&(this.canvas.calcOffset(),this.exitEditingOnOthers(this.canvas)),this.isEditing=!0,this.initHiddenTextarea(e),this.hiddenTextarea.focus(),this.hiddenTextarea.value=this.text,this._updateTextarea(),this._saveEditingProps(),this._setEditingProps(),this._textBeforeEdit=this.text,this._tick(),this.fire("editing:entered"),this._fireSelectionChanged(),this.canvas?(this.canvas.fire("text:editing:entered",{target:this}),this.initMouseMoveHandler(),this.canvas.requestRenderAll(),this):this},exitEditingOnOthers:function(e){e._iTextInstances&&e._iTextInstances.forEach(function(xe){xe.selected=!1,xe.isEditing&&xe.exitEditing()})},initMouseMoveHandler:function(){this.canvas.on("mouse:move",this.mouseMoveHandler)},mouseMoveHandler:function(e){if(!(!this.__isMousedown||!this.isEditing)){document.activeElement!==this.hiddenTextarea&&this.hiddenTextarea.focus();var xe=this.getSelectionStartFromPointer(e.e),Te=this.selectionStart,_e=this.selectionEnd;(xe!==this.__selectionStartOnMouseDown||Te===_e)&&(Te===xe||_e===xe)||(xe>this.__selectionStartOnMouseDown?(this.selectionStart=this.__selectionStartOnMouseDown,this.selectionEnd=xe):(this.selectionStart=xe,this.selectionEnd=this.__selectionStartOnMouseDown),(this.selectionStart!==Te||this.selectionEnd!==_e)&&(this.restartCursorIfNeeded(),this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()))}},_setEditingProps:function(){this.hoverCursor="text",this.canvas&&(this.canvas.defaultCursor=this.canvas.moveCursor="text"),this.borderColor=this.editingBorderColor,this.hasControls=this.selectable=!1,this.lockMovementX=this.lockMovementY=!0},fromStringToGraphemeSelection:function(e,xe,Te){var _e=Te.slice(0,e),Se=r.util.string.graphemeSplit(_e).length;if(e===xe)return{selectionStart:Se,selectionEnd:Se};var t=Te.slice(e,xe),Ae=r.util.string.graphemeSplit(t).length;return{selectionStart:Se,selectionEnd:Se+Ae}},fromGraphemeToStringSelection:function(e,xe,Te){var _e=Te.slice(0,e),Se=_e.join("").length;if(e===xe)return{selectionStart:Se,selectionEnd:Se};var t=Te.slice(e,xe),Ae=t.join("").length;return{selectionStart:Se,selectionEnd:Se+Ae}},_updateTextarea:function(){if(this.cursorOffsetCache={},!!this.hiddenTextarea){if(!this.inCompositionMode){var e=this.fromGraphemeToStringSelection(this.selectionStart,this.selectionEnd,this._text);this.hiddenTextarea.selectionStart=e.selectionStart,this.hiddenTextarea.selectionEnd=e.selectionEnd}this.updateTextareaPosition()}},updateFromTextArea:function(){if(!!this.hiddenTextarea){this.cursorOffsetCache={},this.text=this.hiddenTextarea.value,this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords());var e=this.fromStringToGraphemeSelection(this.hiddenTextarea.selectionStart,this.hiddenTextarea.selectionEnd,this.hiddenTextarea.value);this.selectionEnd=this.selectionStart=e.selectionEnd,this.inCompositionMode||(this.selectionStart=e.selectionStart),this.updateTextareaPosition()}},updateTextareaPosition:function(){if(this.selectionStart===this.selectionEnd){var e=this._calcTextareaPosition();this.hiddenTextarea.style.left=e.left,this.hiddenTextarea.style.top=e.top}},_calcTextareaPosition:function(){if(!this.canvas)return{x:1,y:1};var e=this.inCompositionMode?this.compositionStart:this.selectionStart,xe=this._getCursorBoundaries(e),Te=this.get2DCursorLocation(e),_e=Te.lineIndex,Se=Te.charIndex,t=this.getValueOfPropertyAt(_e,Se,"fontSize")*this.lineHeight,Ae=xe.leftOffset,Pe=this.calcTransformMatrix(),St={x:xe.left+Ae,y:xe.top+xe.topOffset+t},Ce=this.canvas.getRetinaScaling(),ke=this.canvas.upperCanvasEl,De=ke.width/Ce,Re=ke.height/Ce,je=De-t,We=Re-t,Ke=ke.clientWidth/De,Je=ke.clientHeight/Re;return St=r.util.transformPoint(St,Pe),St=r.util.transformPoint(St,this.canvas.viewportTransform),St.x*=Ke,St.y*=Je,St.x<0&&(St.x=0),St.x>je&&(St.x=je),St.y<0&&(St.y=0),St.y>We&&(St.y=We),St.x+=this.canvas._offset.left,St.y+=this.canvas._offset.top,{left:St.x+"px",top:St.y+"px",fontSize:t+"px",charHeight:t}},_saveEditingProps:function(){this._savedProps={hasControls:this.hasControls,borderColor:this.borderColor,lockMovementX:this.lockMovementX,lockMovementY:this.lockMovementY,hoverCursor:this.hoverCursor,selectable:this.selectable,defaultCursor:this.canvas&&this.canvas.defaultCursor,moveCursor:this.canvas&&this.canvas.moveCursor}},_restoreEditingProps:function(){!this._savedProps||(this.hoverCursor=this._savedProps.hoverCursor,this.hasControls=this._savedProps.hasControls,this.borderColor=this._savedProps.borderColor,this.selectable=this._savedProps.selectable,this.lockMovementX=this._savedProps.lockMovementX,this.lockMovementY=this._savedProps.lockMovementY,this.canvas&&(this.canvas.defaultCursor=this._savedProps.defaultCursor,this.canvas.moveCursor=this._savedProps.moveCursor))},exitEditing:function(){var e=this._textBeforeEdit!==this.text,xe=this.hiddenTextarea;return this.selected=!1,this.isEditing=!1,this.selectionEnd=this.selectionStart,xe&&(xe.blur&&xe.blur(),xe.parentNode&&xe.parentNode.removeChild(xe)),this.hiddenTextarea=null,this.abortCursorAnimation(),this._restoreEditingProps(),this._currentCursorOpacity=0,this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords()),this.fire("editing:exited"),e&&this.fire("modified"),this.canvas&&(this.canvas.off("mouse:move",this.mouseMoveHandler),this.canvas.fire("text:editing:exited",{target:this}),e&&this.canvas.fire("object:modified",{target:this})),this},_removeExtraneousStyles:function(){for(var e in this.styles)this._textLines[e]||delete this.styles[e]},removeStyleFromTo:function(e,xe){var Te=this.get2DCursorLocation(e,!0),_e=this.get2DCursorLocation(xe,!0),Se=Te.lineIndex,t=Te.charIndex,Ae=_e.lineIndex,Pe=_e.charIndex,St,Ce;if(Se!==Ae){if(this.styles[Se])for(St=t;St<this._unwrappedTextLines[Se].length;St++)delete this.styles[Se][St];if(this.styles[Ae])for(St=Pe;St<this._unwrappedTextLines[Ae].length;St++)Ce=this.styles[Ae][St],Ce&&(this.styles[Se]||(this.styles[Se]={}),this.styles[Se][t+St-Pe]=Ce);for(St=Se+1;St<=Ae;St++)delete this.styles[St];this.shiftLineStyles(Ae,Se-Ae)}else if(this.styles[Se]){Ce=this.styles[Se];var ke=Pe-t,De,Re;for(St=t;St<Pe;St++)delete Ce[St];for(Re in this.styles[Se])De=parseInt(Re,10),De>=Pe&&(Ce[De-ke]=Ce[Re],delete Ce[Re])}},shiftLineStyles:function(e,xe){var Te=Ee(this.styles);for(var _e in this.styles){var Se=parseInt(_e,10);Se>e&&(this.styles[Se+xe]=Te[Se],Te[Se-xe]||delete this.styles[Se])}},restartCursorIfNeeded:function(){(!this._currentTickState||this._currentTickState.isAborted||!this._currentTickCompleteState||this._currentTickCompleteState.isAborted)&&this.initDelayedCursor()},insertNewlineStyleObject:function(e,xe,Te,_e){var Se,t={},Ae=!1,Pe=this._unwrappedTextLines[e].length===xe;Te||(Te=1),this.shiftLineStyles(e,Te),this.styles[e]&&(Se=this.styles[e][xe===0?xe:xe-1]);for(var St in this.styles[e]){var Ce=parseInt(St,10);Ce>=xe&&(Ae=!0,t[Ce-xe]=this.styles[e][St],Pe&&xe===0||delete this.styles[e][St])}var ke=!1;for(Ae&&!Pe&&(this.styles[e+Te]=t,ke=!0),ke&&Te--;Te>0;)_e&&_e[Te-1]?this.styles[e+Te]={0:Ee(_e[Te-1])}:Se?this.styles[e+Te]={0:Ee(Se)}:delete this.styles[e+Te],Te--;this._forceClearCache=!0},insertCharStyleObject:function(e,xe,Te,_e){this.styles||(this.styles={});var Se=this.styles[e],t=Se?Ee(Se):{};Te||(Te=1);for(var Ae in t){var Pe=parseInt(Ae,10);Pe>=xe&&(Se[Pe+Te]=t[Pe],t[Pe-Te]||delete Se[Pe])}if(this._forceClearCache=!0,_e){for(;Te--;)!Object.keys(_e[Te]).length||(this.styles[e]||(this.styles[e]={}),this.styles[e][xe+Te]=Ee(_e[Te]));return}if(!!Se)for(var St=Se[xe?xe-1:1];St&&Te--;)this.styles[e][xe+Te]=Ee(St)},insertNewStyleBlock:function(e,xe,Te){for(var _e=this.get2DCursorLocation(xe,!0),Se=[0],t=0,Ae=0;Ae<e.length;Ae++)e[Ae]===`
`?(t++,Se[t]=0):Se[t]++;Se[0]>0&&(this.insertCharStyleObject(_e.lineIndex,_e.charIndex,Se[0],Te),Te=Te&&Te.slice(Se[0]+1)),t&&this.insertNewlineStyleObject(_e.lineIndex,_e.charIndex+Se[0],t);for(var Ae=1;Ae<t;Ae++)Se[Ae]>0?this.insertCharStyleObject(_e.lineIndex+Ae,0,Se[Ae],Te):Te&&this.styles[_e.lineIndex+Ae]&&Te[0]&&(this.styles[_e.lineIndex+Ae][0]=Te[0]),Te=Te&&Te.slice(Se[Ae]+1);Se[Ae]>0&&this.insertCharStyleObject(_e.lineIndex+Ae,0,Se[Ae],Te)},setSelectionStartEndWithShift:function(e,xe,Te){Te<=e?(xe===e?this._selectionDirection="left":this._selectionDirection==="right"&&(this._selectionDirection="left",this.selectionEnd=e),this.selectionStart=Te):Te>e&&Te<xe?this._selectionDirection==="right"?this.selectionEnd=Te:this.selectionStart=Te:(xe===e?this._selectionDirection="right":this._selectionDirection==="left"&&(this._selectionDirection="right",this.selectionStart=xe),this.selectionEnd=Te)},setSelectionInBoundaries:function(){var e=this.text.length;this.selectionStart>e?this.selectionStart=e:this.selectionStart<0&&(this.selectionStart=0),this.selectionEnd>e?this.selectionEnd=e:this.selectionEnd<0&&(this.selectionEnd=0)}})}(),r.util.object.extend(r.IText.prototype,{initDoubleClickSimulation:function(){this.__lastClickTime=+new Date,this.__lastLastClickTime=+new Date,this.__lastPointer={},this.on("mousedown",this.onMouseDown)},onMouseDown:function(Ee){if(!!this.canvas){this.__newClickTime=+new Date;var e=Ee.pointer;this.isTripleClick(e)&&(this.fire("tripleclick",Ee),this._stopEvent(Ee.e)),this.__lastLastClickTime=this.__lastClickTime,this.__lastClickTime=this.__newClickTime,this.__lastPointer=e,this.__lastIsEditing=this.isEditing,this.__lastSelected=this.selected}},isTripleClick:function(Ee){return this.__newClickTime-this.__lastClickTime<500&&this.__lastClickTime-this.__lastLastClickTime<500&&this.__lastPointer.x===Ee.x&&this.__lastPointer.y===Ee.y},_stopEvent:function(Ee){Ee.preventDefault&&Ee.preventDefault(),Ee.stopPropagation&&Ee.stopPropagation()},initCursorSelectionHandlers:function(){this.initMousedownHandler(),this.initMouseupHandler(),this.initClicks()},doubleClickHandler:function(Ee){!this.isEditing||this.selectWord(this.getSelectionStartFromPointer(Ee.e))},tripleClickHandler:function(Ee){!this.isEditing||this.selectLine(this.getSelectionStartFromPointer(Ee.e))},initClicks:function(){this.on("mousedblclick",this.doubleClickHandler),this.on("tripleclick",this.tripleClickHandler)},_mouseDownHandler:function(Ee){!this.canvas||!this.editable||Ee.e.button&&Ee.e.button!==1||(this.__isMousedown=!0,this.selected&&(this.inCompositionMode=!1,this.setCursorByClick(Ee.e)),this.isEditing&&(this.__selectionStartOnMouseDown=this.selectionStart,this.selectionStart===this.selectionEnd&&this.abortCursorAnimation(),this.renderCursorOrSelection()))},_mouseDownHandlerBefore:function(Ee){!this.canvas||!this.editable||Ee.e.button&&Ee.e.button!==1||(this.selected=this===this.canvas._activeObject)},initMousedownHandler:function(){this.on("mousedown",this._mouseDownHandler),this.on("mousedown:before",this._mouseDownHandlerBefore)},initMouseupHandler:function(){this.on("mouseup",this.mouseUpHandler)},mouseUpHandler:function(Ee){if(this.__isMousedown=!1,!(!this.editable||this.group||Ee.transform&&Ee.transform.actionPerformed||Ee.e.button&&Ee.e.button!==1)){if(this.canvas){var e=this.canvas._activeObject;if(e&&e!==this)return}this.__lastSelected&&!this.__corner?(this.selected=!1,this.__lastSelected=!1,this.enterEditing(Ee.e),this.selectionStart===this.selectionEnd?this.initDelayedCursor(!0):this.renderCursorOrSelection()):this.selected=!0}},setCursorByClick:function(Ee){var e=this.getSelectionStartFromPointer(Ee),xe=this.selectionStart,Te=this.selectionEnd;Ee.shiftKey?this.setSelectionStartEndWithShift(xe,Te,e):(this.selectionStart=e,this.selectionEnd=e),this.isEditing&&(this._fireSelectionChanged(),this._updateTextarea())},getSelectionStartFromPointer:function(Ee){for(var e=this.getLocalPointer(Ee),xe=0,Te=0,_e=0,Se=0,t=0,Ae,Pe,St=0,Ce=this._textLines.length;St<Ce&&_e<=e.y;St++)_e+=this.getHeightOfLine(St)*this.scaleY,t=St,St>0&&(Se+=this._textLines[St-1].length+this.missingNewlineOffset(St-1));Ae=this._getLineLeftOffset(t),Te=Ae*this.scaleX,Pe=this._textLines[t],this.direction==="rtl"&&(e.x=this.width*this.scaleX-e.x+Te);for(var ke=0,De=Pe.length;ke<De&&(xe=Te,Te+=this.__charBounds[t][ke].kernedWidth*this.scaleX,Te<=e.x);ke++)Se++;return this._getNewSelectionStartFromOffset(e,xe,Te,Se,De)},_getNewSelectionStartFromOffset:function(Ee,e,xe,Te,_e){var Se=Ee.x-e,t=xe-Ee.x,Ae=t>Se||t<0?0:1,Pe=Te+Ae;return this.flipX&&(Pe=_e-Pe),Pe>this._text.length&&(Pe=this._text.length),Pe}}),r.util.object.extend(r.IText.prototype,{initHiddenTextarea:function(){this.hiddenTextarea=r.document.createElement("textarea"),this.hiddenTextarea.setAttribute("autocapitalize","off"),this.hiddenTextarea.setAttribute("autocorrect","off"),this.hiddenTextarea.setAttribute("autocomplete","off"),this.hiddenTextarea.setAttribute("spellcheck","false"),this.hiddenTextarea.setAttribute("data-fabric-hiddentextarea",""),this.hiddenTextarea.setAttribute("wrap","off");var Ee=this._calcTextareaPosition();this.hiddenTextarea.style.cssText="position: absolute; top: "+Ee.top+"; left: "+Ee.left+"; z-index: -999; opacity: 0; width: 1px; height: 1px; font-size: 1px; padding\uFF70top: "+Ee.fontSize+";",this.hiddenTextareaContainer?this.hiddenTextareaContainer.appendChild(this.hiddenTextarea):r.document.body.appendChild(this.hiddenTextarea),r.util.addListener(this.hiddenTextarea,"keydown",this.onKeyDown.bind(this)),r.util.addListener(this.hiddenTextarea,"keyup",this.onKeyUp.bind(this)),r.util.addListener(this.hiddenTextarea,"input",this.onInput.bind(this)),r.util.addListener(this.hiddenTextarea,"copy",this.copy.bind(this)),r.util.addListener(this.hiddenTextarea,"cut",this.copy.bind(this)),r.util.addListener(this.hiddenTextarea,"paste",this.paste.bind(this)),r.util.addListener(this.hiddenTextarea,"compositionstart",this.onCompositionStart.bind(this)),r.util.addListener(this.hiddenTextarea,"compositionupdate",this.onCompositionUpdate.bind(this)),r.util.addListener(this.hiddenTextarea,"compositionend",this.onCompositionEnd.bind(this)),!this._clickHandlerInitialized&&this.canvas&&(r.util.addListener(this.canvas.upperCanvasEl,"click",this.onClick.bind(this)),this._clickHandlerInitialized=!0)},keysMap:{9:"exitEditing",27:"exitEditing",33:"moveCursorUp",34:"moveCursorDown",35:"moveCursorRight",36:"moveCursorLeft",37:"moveCursorLeft",38:"moveCursorUp",39:"moveCursorRight",40:"moveCursorDown"},keysMapRtl:{9:"exitEditing",27:"exitEditing",33:"moveCursorUp",34:"moveCursorDown",35:"moveCursorLeft",36:"moveCursorRight",37:"moveCursorRight",38:"moveCursorUp",39:"moveCursorLeft",40:"moveCursorDown"},ctrlKeysMapUp:{67:"copy",88:"cut"},ctrlKeysMapDown:{65:"selectAll"},onClick:function(){this.hiddenTextarea&&this.hiddenTextarea.focus()},onKeyDown:function(Ee){if(!!this.isEditing){var e=this.direction==="rtl"?this.keysMapRtl:this.keysMap;if(Ee.keyCode in e)this[e[Ee.keyCode]](Ee);else if(Ee.keyCode in this.ctrlKeysMapDown&&(Ee.ctrlKey||Ee.metaKey))this[this.ctrlKeysMapDown[Ee.keyCode]](Ee);else return;Ee.stopImmediatePropagation(),Ee.preventDefault(),Ee.keyCode>=33&&Ee.keyCode<=40?(this.inCompositionMode=!1,this.clearContextTop(),this.renderCursorOrSelection()):this.canvas&&this.canvas.requestRenderAll()}},onKeyUp:function(Ee){if(!this.isEditing||this._copyDone||this.inCompositionMode){this._copyDone=!1;return}if(Ee.keyCode in this.ctrlKeysMapUp&&(Ee.ctrlKey||Ee.metaKey))this[this.ctrlKeysMapUp[Ee.keyCode]](Ee);else return;Ee.stopImmediatePropagation(),Ee.preventDefault(),this.canvas&&this.canvas.requestRenderAll()},onInput:function(Ee){var e=this.fromPaste;if(this.fromPaste=!1,Ee&&Ee.stopPropagation(),!!this.isEditing){var xe=this._splitTextIntoLines(this.hiddenTextarea.value).graphemeText,Te=this._text.length,_e=xe.length,Se,t,Ae=_e-Te,Pe=this.selectionStart,St=this.selectionEnd,Ce=Pe!==St,ke,De,Re;if(this.hiddenTextarea.value===""){this.styles={},this.updateFromTextArea(),this.fire("changed"),this.canvas&&(this.canvas.fire("text:changed",{target:this}),this.canvas.requestRenderAll());return}var je=this.fromStringToGraphemeSelection(this.hiddenTextarea.selectionStart,this.hiddenTextarea.selectionEnd,this.hiddenTextarea.value),We=Pe>je.selectionStart;Ce?(Se=this._text.slice(Pe,St),Ae+=St-Pe):_e<Te&&(We?Se=this._text.slice(St+Ae,St):Se=this._text.slice(Pe,Pe-Ae)),t=xe.slice(je.selectionEnd-Ae,je.selectionEnd),Se&&Se.length&&(t.length&&(ke=this.getSelectionStyles(Pe,Pe+1,!1),ke=t.map(function(){return ke[0]})),Ce?(De=Pe,Re=St):We?(De=St-Se.length,Re=St):(De=St,Re=St+Se.length),this.removeStyleFromTo(De,Re)),t.length&&(e&&t.join("")===r.copiedText&&!r.disableStyleCopyPaste&&(ke=r.copiedTextStyle),this.insertNewStyleBlock(t,Pe,ke)),this.updateFromTextArea(),this.fire("changed"),this.canvas&&(this.canvas.fire("text:changed",{target:this}),this.canvas.requestRenderAll())}},onCompositionStart:function(){this.inCompositionMode=!0},onCompositionEnd:function(){this.inCompositionMode=!1},onCompositionUpdate:function(Ee){this.compositionStart=Ee.target.selectionStart,this.compositionEnd=Ee.target.selectionEnd,this.updateTextareaPosition()},copy:function(){this.selectionStart!==this.selectionEnd&&(r.copiedText=this.getSelectedText(),r.disableStyleCopyPaste?r.copiedTextStyle=null:r.copiedTextStyle=this.getSelectionStyles(this.selectionStart,this.selectionEnd,!0),this._copyDone=!0)},paste:function(){this.fromPaste=!0},_getClipboardData:function(Ee){return Ee&&Ee.clipboardData||r.window.clipboardData},_getWidthBeforeCursor:function(Ee,e){var xe=this._getLineLeftOffset(Ee),Te;return e>0&&(Te=this.__charBounds[Ee][e-1],xe+=Te.left+Te.width),xe},getDownCursorOffset:function(Ee,e){var xe=this._getSelectionForOffset(Ee,e),Te=this.get2DCursorLocation(xe),_e=Te.lineIndex;if(_e===this._textLines.length-1||Ee.metaKey||Ee.keyCode===34)return this._text.length-xe;var Se=Te.charIndex,t=this._getWidthBeforeCursor(_e,Se),Ae=this._getIndexOnLine(_e+1,t),Pe=this._textLines[_e].slice(Se);return Pe.length+Ae+1+this.missingNewlineOffset(_e)},_getSelectionForOffset:function(Ee,e){return Ee.shiftKey&&this.selectionStart!==this.selectionEnd&&e?this.selectionEnd:this.selectionStart},getUpCursorOffset:function(Ee,e){var xe=this._getSelectionForOffset(Ee,e),Te=this.get2DCursorLocation(xe),_e=Te.lineIndex;if(_e===0||Ee.metaKey||Ee.keyCode===33)return-xe;var Se=Te.charIndex,t=this._getWidthBeforeCursor(_e,Se),Ae=this._getIndexOnLine(_e-1,t),Pe=this._textLines[_e].slice(0,Se),St=this.missingNewlineOffset(_e-1);return-this._textLines[_e-1].length+Ae-Pe.length+(1-St)},_getIndexOnLine:function(Ee,e){for(var xe=this._textLines[Ee],Te=this._getLineLeftOffset(Ee),_e=Te,Se=0,t,Ae,Pe=0,St=xe.length;Pe<St;Pe++)if(t=this.__charBounds[Ee][Pe].width,_e+=t,_e>e){Ae=!0;var Ce=_e-t,ke=_e,De=Math.abs(Ce-e),Re=Math.abs(ke-e);Se=Re<De?Pe:Pe-1;break}return Ae||(Se=xe.length-1),Se},moveCursorDown:function(Ee){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorUpOrDown("Down",Ee)},moveCursorUp:function(Ee){this.selectionStart===0&&this.selectionEnd===0||this._moveCursorUpOrDown("Up",Ee)},_moveCursorUpOrDown:function(Ee,e){var xe="get"+Ee+"CursorOffset",Te=this[xe](e,this._selectionDirection==="right");e.shiftKey?this.moveCursorWithShift(Te):this.moveCursorWithoutShift(Te),Te!==0&&(this.setSelectionInBoundaries(),this.abortCursorAnimation(),this._currentCursorOpacity=1,this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea())},moveCursorWithShift:function(Ee){var e=this._selectionDirection==="left"?this.selectionStart+Ee:this.selectionEnd+Ee;return this.setSelectionStartEndWithShift(this.selectionStart,this.selectionEnd,e),Ee!==0},moveCursorWithoutShift:function(Ee){return Ee<0?(this.selectionStart+=Ee,this.selectionEnd=this.selectionStart):(this.selectionEnd+=Ee,this.selectionStart=this.selectionEnd),Ee!==0},moveCursorLeft:function(Ee){this.selectionStart===0&&this.selectionEnd===0||this._moveCursorLeftOrRight("Left",Ee)},_move:function(Ee,e,xe){var Te;if(Ee.altKey)Te=this["findWordBoundary"+xe](this[e]);else if(Ee.metaKey||Ee.keyCode===35||Ee.keyCode===36)Te=this["findLineBoundary"+xe](this[e]);else return this[e]+=xe==="Left"?-1:1,!0;if(typeof Te<"u"&&this[e]!==Te)return this[e]=Te,!0},_moveLeft:function(Ee,e){return this._move(Ee,e,"Left")},_moveRight:function(Ee,e){return this._move(Ee,e,"Right")},moveCursorLeftWithoutShift:function(Ee){var e=!0;return this._selectionDirection="left",this.selectionEnd===this.selectionStart&&this.selectionStart!==0&&(e=this._moveLeft(Ee,"selectionStart")),this.selectionEnd=this.selectionStart,e},moveCursorLeftWithShift:function(Ee){if(this._selectionDirection==="right"&&this.selectionStart!==this.selectionEnd)return this._moveLeft(Ee,"selectionEnd");if(this.selectionStart!==0)return this._selectionDirection="left",this._moveLeft(Ee,"selectionStart")},moveCursorRight:function(Ee){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorLeftOrRight("Right",Ee)},_moveCursorLeftOrRight:function(Ee,e){var xe="moveCursor"+Ee+"With";this._currentCursorOpacity=1,e.shiftKey?xe+="Shift":xe+="outShift",this[xe](e)&&(this.abortCursorAnimation(),this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea())},moveCursorRightWithShift:function(Ee){if(this._selectionDirection==="left"&&this.selectionStart!==this.selectionEnd)return this._moveRight(Ee,"selectionStart");if(this.selectionEnd!==this._text.length)return this._selectionDirection="right",this._moveRight(Ee,"selectionEnd")},moveCursorRightWithoutShift:function(Ee){var e=!0;return this._selectionDirection="right",this.selectionStart===this.selectionEnd?(e=this._moveRight(Ee,"selectionStart"),this.selectionEnd=this.selectionStart):this.selectionStart=this.selectionEnd,e},removeChars:function(Ee,e){typeof e>"u"&&(e=Ee+1),this.removeStyleFromTo(Ee,e),this._text.splice(Ee,e-Ee),this.text=this._text.join(""),this.set("dirty",!0),this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords()),this._removeExtraneousStyles()},insertChars:function(Ee,e,xe,Te){typeof Te>"u"&&(Te=xe),Te>xe&&this.removeStyleFromTo(xe,Te);var _e=r.util.string.graphemeSplit(Ee);this.insertNewStyleBlock(_e,xe,e),this._text=[].concat(this._text.slice(0,xe),_e,this._text.slice(Te)),this.text=this._text.join(""),this.set("dirty",!0),this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords()),this._removeExtraneousStyles()}}),function(){var Ee=r.util.toFixed,e=/  +/g;r.util.object.extend(r.Text.prototype,{_toSVG:function(){var xe=this._getSVGLeftTopOffsets(),Te=this._getSVGTextAndBg(xe.textTop,xe.textLeft);return this._wrapSVGTextAndBg(Te)},toSVG:function(xe){return this._createBaseSVGMarkup(this._toSVG(),{reviver:xe,noStyle:!0,withShadow:!0})},_getSVGLeftTopOffsets:function(){return{textLeft:-this.width/2,textTop:-this.height/2,lineTop:this.getHeightOfLine(0)}},_wrapSVGTextAndBg:function(xe){var Te=!0,_e=this.getSvgTextDecoration(this);return[xe.textBgRects.join(""),'		<text xml:space="preserve" ',this.fontFamily?'font-family="'+this.fontFamily.replace(/"/g,"'")+'" ':"",this.fontSize?'font-size="'+this.fontSize+'" ':"",this.fontStyle?'font-style="'+this.fontStyle+'" ':"",this.fontWeight?'font-weight="'+this.fontWeight+'" ':"",_e?'text-decoration="'+_e+'" ':"",'style="',this.getSvgStyles(Te),'"',this.addPaintOrder()," >",xe.textSpans.join(""),`</text>
`]},_getSVGTextAndBg:function(xe,Te){var _e=[],Se=[],t=xe,Ae;this._setSVGBg(Se);for(var Pe=0,St=this._textLines.length;Pe<St;Pe++)Ae=this._getLineLeftOffset(Pe),(this.textBackgroundColor||this.styleHas("textBackgroundColor",Pe))&&this._setSVGTextLineBg(Se,Pe,Te+Ae,t),this._setSVGTextLineText(_e,Pe,Te+Ae,t),t+=this.getHeightOfLine(Pe);return{textSpans:_e,textBgRects:Se}},_createTextCharSpan:function(xe,Te,_e,Se){var t=xe!==xe.trim()||xe.match(e),Ae=this.getSvgSpanStyles(Te,t),Pe=Ae?'style="'+Ae+'"':"",St=Te.deltaY,Ce="",ke=r.Object.NUM_FRACTION_DIGITS;return St&&(Ce=' dy="'+Ee(St,ke)+'" '),['<tspan x="',Ee(_e,ke),'" y="',Ee(Se,ke),'" ',Ce,Pe,">",r.util.string.escapeXml(xe),"</tspan>"].join("")},_setSVGTextLineText:function(xe,Te,_e,Se){var t=this.getHeightOfLine(Te),Ae=this.textAlign.indexOf("justify")!==-1,Pe,St,Ce="",ke,De,Re=0,je=this._textLines[Te],We;Se+=t*(1-this._fontSizeFraction)/this.lineHeight;for(var Ke=0,Je=je.length-1;Ke<=Je;Ke++)We=Ke===Je||this.charSpacing,Ce+=je[Ke],ke=this.__charBounds[Te][Ke],Re===0?(_e+=ke.kernedWidth-ke.width,Re+=ke.width):Re+=ke.kernedWidth,Ae&&!We&&this._reSpaceAndTab.test(je[Ke])&&(We=!0),We||(Pe=Pe||this.getCompleteStyleDeclaration(Te,Ke),St=this.getCompleteStyleDeclaration(Te,Ke+1),We=r.util.hasStyleChanged(Pe,St,!0)),We&&(De=this._getStyleDeclaration(Te,Ke)||{},xe.push(this._createTextCharSpan(Ce,De,_e,Se)),Ce="",Pe=St,_e+=Re,Re=0)},_pushTextBgRect:function(xe,Te,_e,Se,t,Ae){var Pe=r.Object.NUM_FRACTION_DIGITS;xe.push("		<rect ",this._getFillAttributes(Te),' x="',Ee(_e,Pe),'" y="',Ee(Se,Pe),'" width="',Ee(t,Pe),'" height="',Ee(Ae,Pe),`"></rect>
`)},_setSVGTextLineBg:function(xe,Te,_e,Se){for(var t=this._textLines[Te],Ae=this.getHeightOfLine(Te)/this.lineHeight,Pe=0,St=0,Ce,ke,De=this.getValueOfPropertyAt(Te,0,"textBackgroundColor"),Re=0,je=t.length;Re<je;Re++)Ce=this.__charBounds[Te][Re],ke=this.getValueOfPropertyAt(Te,Re,"textBackgroundColor"),ke!==De?(De&&this._pushTextBgRect(xe,De,_e+St,Se,Pe,Ae),St=Ce.left,Pe=Ce.width,De=ke):Pe+=Ce.kernedWidth;ke&&this._pushTextBgRect(xe,ke,_e+St,Se,Pe,Ae)},_getFillAttributes:function(xe){var Te=xe&&typeof xe=="string"?new r.Color(xe):"";return!Te||!Te.getSource()||Te.getAlpha()===1?'fill="'+xe+'"':'opacity="'+Te.getAlpha()+'" fill="'+Te.setAlpha(1).toRgb()+'"'},_getSVGLineTopOffset:function(xe){for(var Te=0,_e=0,Se=0;Se<xe;Se++)Te+=this.getHeightOfLine(Se);return _e=this.getHeightOfLine(Se),{lineTop:Te,offset:(this._fontSizeMult-this._fontSizeFraction)*_e/(this.lineHeight*this._fontSizeMult)}},getSvgStyles:function(xe){var Te=r.Object.prototype.getSvgStyles.call(this,xe);return Te+" white-space: pre;"}})}(),function(Ee){var e=Ee.fabric||(Ee.fabric={});e.Textbox=e.util.createClass(e.IText,e.Observable,{type:"textbox",minWidth:20,dynamicMinWidth:2,__cachedLines:null,lockScalingFlip:!0,noScaleCache:!1,_dimensionAffectingProps:e.Text.prototype._dimensionAffectingProps.concat("width"),_wordJoiners:/[ \t\r]/,splitByGrapheme:!1,initDimensions:function(){this.__skipDimension||(this.isEditing&&this.initDelayedCursor(),this.clearContextTop(),this._clearCache(),this.dynamicMinWidth=0,this._styleMap=this._generateStyleMap(this._splitText()),this.dynamicMinWidth>this.width&&this._set("width",this.dynamicMinWidth),this.textAlign.indexOf("justify")!==-1&&this.enlargeSpaces(),this.height=this.calcTextHeight(),this.saveState({propertySet:"_dimensionAffectingProps"}))},_generateStyleMap:function(xe){for(var Te=0,_e=0,Se=0,t={},Ae=0;Ae<xe.graphemeLines.length;Ae++)xe.graphemeText[Se]===`
`&&Ae>0?(_e=0,Se++,Te++):!this.splitByGrapheme&&this._reSpaceAndTab.test(xe.graphemeText[Se])&&Ae>0&&(_e++,Se++),t[Ae]={line:Te,offset:_e},Se+=xe.graphemeLines[Ae].length,_e+=xe.graphemeLines[Ae].length;return t},styleHas:function(xe,Te){if(this._styleMap&&!this.isWrapping){var _e=this._styleMap[Te];_e&&(Te=_e.line)}return e.Text.prototype.styleHas.call(this,xe,Te)},isEmptyStyles:function(xe){if(!this.styles)return!0;var Te=0,_e=xe+1,Se,t,Ae=!1,Pe=this._styleMap[xe],St=this._styleMap[xe+1];Pe&&(xe=Pe.line,Te=Pe.offset),St&&(_e=St.line,Ae=_e===xe,Se=St.offset),t=typeof xe>"u"?this.styles:{line:this.styles[xe]};for(var Ce in t)for(var ke in t[Ce])if(ke>=Te&&(!Ae||ke<Se))for(var De in t[Ce][ke])return!1;return!0},_getStyleDeclaration:function(xe,Te){if(this._styleMap&&!this.isWrapping){var _e=this._styleMap[xe];if(!_e)return null;xe=_e.line,Te=_e.offset+Te}return this.callSuper("_getStyleDeclaration",xe,Te)},_setStyleDeclaration:function(xe,Te,_e){var Se=this._styleMap[xe];xe=Se.line,Te=Se.offset+Te,this.styles[xe][Te]=_e},_deleteStyleDeclaration:function(xe,Te){var _e=this._styleMap[xe];xe=_e.line,Te=_e.offset+Te,delete this.styles[xe][Te]},_getLineStyle:function(xe){var Te=this._styleMap[xe];return!!this.styles[Te.line]},_setLineStyle:function(xe){var Te=this._styleMap[xe];this.styles[Te.line]={}},_wrapText:function(xe,Te){var _e=[],Se;for(this.isWrapping=!0,Se=0;Se<xe.length;Se++)_e=_e.concat(this._wrapLine(xe[Se],Se,Te));return this.isWrapping=!1,_e},_measureWord:function(xe,Te,_e){var Se=0,t,Ae=!0;_e=_e||0;for(var Pe=0,St=xe.length;Pe<St;Pe++){var Ce=this._getGraphemeBox(xe[Pe],Te,Pe+_e,t,Ae);Se+=Ce.kernedWidth,t=xe[Pe]}return Se},_wrapLine:function(xe,Te,_e,oi){var t=0,Ae=this.splitByGrapheme,Pe=[],St=[],Ce=Ae?e.util.string.graphemeSplit(xe):xe.split(this._wordJoiners),ke="",De=0,Re=Ae?"":" ",je=0,We=0,Ke=0,Je=!0,hi=this._getWidthOfCharSpacing(),oi=oi||0;Ce.length===0&&Ce.push([]),_e-=oi;for(var ti=0;ti<Ce.length;ti++)ke=Ae?Ce[ti]:e.util.string.graphemeSplit(Ce[ti]),je=this._measureWord(ke,Te,De),De+=ke.length,t+=We+je-hi,t>_e&&!Je?(Pe.push(St),St=[],t=je,Je=!0):t+=hi,!Je&&!Ae&&St.push(Re),St=St.concat(ke),We=Ae?0:this._measureWord([Re],Te,De),De++,Je=!1,je>Ke&&(Ke=je);return ti&&Pe.push(St),Ke+oi>this.dynamicMinWidth&&(this.dynamicMinWidth=Ke-hi+oi),Pe},isEndOfWrapping:function(xe){return!this._styleMap[xe+1]||this._styleMap[xe+1].line!==this._styleMap[xe].line},missingNewlineOffset:function(xe){return this.splitByGrapheme?this.isEndOfWrapping(xe)?1:0:1},_splitTextIntoLines:function(xe){for(var Te=e.Text.prototype._splitTextIntoLines.call(this,xe),_e=this._wrapText(Te.lines,this.width),Se=new Array(_e.length),t=0;t<_e.length;t++)Se[t]=_e[t].join("");return Te.lines=Se,Te.graphemeLines=_e,Te},getMinWidth:function(){return Math.max(this.minWidth,this.dynamicMinWidth)},_removeExtraneousStyles:function(){var xe={};for(var Te in this._styleMap)this._textLines[Te]&&(xe[this._styleMap[Te].line]=1);for(var Te in this.styles)xe[Te]||delete this.styles[Te]},toObject:function(xe){return this.callSuper("toObject",["minWidth","splitByGrapheme"].concat(xe))}}),e.Textbox.fromObject=function(xe,Te){var _e=e.util.stylesFromArray(xe.styles,xe.text),Se=Object.assign({},xe,{styles:_e});return e.Object._fromObject("Textbox",Se,Te,"text")}}(Ie),function(){var Ee=r.controlsUtils,e=Ee.scaleSkewCursorStyleHandler,xe=Ee.scaleCursorStyleHandler,Te=Ee.scalingEqually,_e=Ee.scalingYOrSkewingX,Se=Ee.scalingXOrSkewingY,t=Ee.scaleOrSkewActionName,Ae=r.Object.prototype.controls;if(Ae.ml=new r.Control({x:-.5,y:0,cursorStyleHandler:e,actionHandler:Se,getActionName:t}),Ae.mr=new r.Control({x:.5,y:0,cursorStyleHandler:e,actionHandler:Se,getActionName:t}),Ae.mb=new r.Control({x:0,y:.5,cursorStyleHandler:e,actionHandler:_e,getActionName:t}),Ae.mt=new r.Control({x:0,y:-.5,cursorStyleHandler:e,actionHandler:_e,getActionName:t}),Ae.tl=new r.Control({x:-.5,y:-.5,cursorStyleHandler:xe,actionHandler:Te}),Ae.tr=new r.Control({x:.5,y:-.5,cursorStyleHandler:xe,actionHandler:Te}),Ae.bl=new r.Control({x:-.5,y:.5,cursorStyleHandler:xe,actionHandler:Te}),Ae.br=new r.Control({x:.5,y:.5,cursorStyleHandler:xe,actionHandler:Te}),Ae.mtr=new r.Control({x:0,y:-.5,actionHandler:Ee.rotationWithSnapping,cursorStyleHandler:Ee.rotationStyleHandler,offsetY:-40,withConnection:!0,actionName:"rotate"}),r.Textbox){var Pe=r.Textbox.prototype.controls={};Pe.mtr=Ae.mtr,Pe.tr=Ae.tr,Pe.br=Ae.br,Pe.tl=Ae.tl,Pe.bl=Ae.bl,Pe.mt=Ae.mt,Pe.mb=Ae.mb,Pe.mr=new r.Control({x:.5,y:0,actionHandler:Ee.changeWidth,cursorStyleHandler:e,actionName:"resizing"}),Pe.ml=new r.Control({x:-.5,y:0,actionHandler:Ee.changeWidth,cursorStyleHandler:e,actionName:"resizing"})}}()})(fabric);function commonjsRequire(Ie){throw new Error('Could not dynamically require "'+Ie+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var pdf={exports:{}};(function(module,exports){(function(r,Me){module.exports=Me()})(globalThis,()=>(()=>{var __webpack_modules__=[,(Ie,r)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.VerbosityLevel=r.Util=r.UnknownErrorException=r.UnexpectedResponseException=r.UNSUPPORTED_FEATURES=r.TextRenderingMode=r.StreamType=r.RenderingIntentFlag=r.PermissionFlag=r.PasswordResponses=r.PasswordException=r.PageActionEventType=r.OPS=r.MissingPDFException=r.LINE_FACTOR=r.LINE_DESCENT_FACTOR=r.InvalidPDFException=r.ImageKind=r.IDENTITY_MATRIX=r.FormatError=r.FontType=r.FeatureTest=r.FONT_IDENTITY_MATRIX=r.DocumentActionEventType=r.CMapCompressionType=r.BaseException=r.AnnotationType=r.AnnotationStateModelType=r.AnnotationReviewState=r.AnnotationReplyType=r.AnnotationMode=r.AnnotationMarkedState=r.AnnotationFlag=r.AnnotationFieldFlag=r.AnnotationEditorType=r.AnnotationEditorPrefix=r.AnnotationEditorParamsType=r.AnnotationBorderStyleType=r.AnnotationActionEventType=r.AbortException=void 0,r.arrayByteLength=Qe,r.arraysToBytes=ui,r.assert=Xe,r.bytesToString=Ze,r.createPromiseCapability=$n,r.createValidAbsoluteUrl=ze,r.escapeString=zi,r.getModificationDate=Bn,r.getVerbosityLevel=xi,r.info=ni,r.isArrayBuffer=xn,r.isArrayEqual=Tn,r.isAscii=Ji,r.objectFromMap=Ri,r.objectSize=_i,r.setVerbosityLevel=Pi,r.shadow=Ve,r.string32=gi,r.stringToBytes=ii,r.stringToPDFString=en,r.stringToUTF16BEString=pn,r.stringToUTF8String=an,r.unreachable=Si,r.utf8StringToString=kn,r.warn=fi;const Me=[1,0,0,1,0,0];r.IDENTITY_MATRIX=Me;const Oe=[.001,0,0,.001,0,0];r.FONT_IDENTITY_MATRIX=Oe;const Be=1.35;r.LINE_FACTOR=Be;const Ue=.35;r.LINE_DESCENT_FACTOR=Ue;const He={ANY:1,DISPLAY:2,PRINT:4,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,OPLIST:256};r.RenderingIntentFlag=He;const Ee={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3};r.AnnotationMode=Ee;const e="pdfjs_internal_editor_";r.AnnotationEditorPrefix=e;const xe={DISABLE:-1,NONE:0,FREETEXT:3,INK:15};r.AnnotationEditorType=xe;const Te={FREETEXT_SIZE:1,FREETEXT_COLOR:2,FREETEXT_OPACITY:3,INK_COLOR:11,INK_THICKNESS:12,INK_OPACITY:13};r.AnnotationEditorParamsType=Te;const _e={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048};r.PermissionFlag=_e;const Se={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4};r.TextRenderingMode=Se;const t={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3};r.ImageKind=t;const Ae={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26};r.AnnotationType=Ae;const Pe={MARKED:"Marked",REVIEW:"Review"};r.AnnotationStateModelType=Pe;const St={MARKED:"Marked",UNMARKED:"Unmarked"};r.AnnotationMarkedState=St;const Ce={ACCEPTED:"Accepted",REJECTED:"Rejected",CANCELLED:"Cancelled",COMPLETED:"Completed",NONE:"None"};r.AnnotationReviewState=Ce;const ke={GROUP:"Group",REPLY:"R"};r.AnnotationReplyType=ke;const De={INVISIBLE:1,HIDDEN:2,PRINT:4,NOZOOM:8,NOROTATE:16,NOVIEW:32,READONLY:64,LOCKED:128,TOGGLENOVIEW:256,LOCKEDCONTENTS:512};r.AnnotationFlag=De;const Re={READONLY:1,REQUIRED:2,NOEXPORT:4,MULTILINE:4096,PASSWORD:8192,NOTOGGLETOOFF:16384,RADIO:32768,PUSHBUTTON:65536,COMBO:131072,EDIT:262144,SORT:524288,FILESELECT:1048576,MULTISELECT:2097152,DONOTSPELLCHECK:4194304,DONOTSCROLL:8388608,COMB:16777216,RICHTEXT:33554432,RADIOSINUNISON:33554432,COMMITONSELCHANGE:67108864};r.AnnotationFieldFlag=Re;const je={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5};r.AnnotationBorderStyleType=je;const We={E:"Mouse Enter",X:"Mouse Exit",D:"Mouse Down",U:"Mouse Up",Fo:"Focus",Bl:"Blur",PO:"PageOpen",PC:"PageClose",PV:"PageVisible",PI:"PageInvisible",K:"Keystroke",F:"Format",V:"Validate",C:"Calculate"};r.AnnotationActionEventType=We;const Ke={WC:"WillClose",WS:"WillSave",DS:"DidSave",WP:"WillPrint",DP:"DidPrint"};r.DocumentActionEventType=Ke;const Je={O:"PageOpen",C:"PageClose"};r.PageActionEventType=Je;const hi={UNKNOWN:"UNKNOWN",FLATE:"FLATE",LZW:"LZW",DCT:"DCT",JPX:"JPX",JBIG:"JBIG",A85:"A85",AHX:"AHX",CCF:"CCF",RLX:"RLX"};r.StreamType=hi;const oi={UNKNOWN:"UNKNOWN",TYPE1:"TYPE1",TYPE1STANDARD:"TYPE1STANDARD",TYPE1C:"TYPE1C",CIDFONTTYPE0:"CIDFONTTYPE0",CIDFONTTYPE0C:"CIDFONTTYPE0C",TRUETYPE:"TRUETYPE",CIDFONTTYPE2:"CIDFONTTYPE2",TYPE3:"TYPE3",OPENTYPE:"OPENTYPE",TYPE0:"TYPE0",MMTYPE1:"MMTYPE1"};r.FontType=oi;const ti={ERRORS:0,WARNINGS:1,INFOS:5};r.VerbosityLevel=ti;const ai={NONE:0,BINARY:1};r.CMapCompressionType=ai;const yi={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91};r.OPS=yi;const di={forms:"forms",javaScript:"javaScript",signatures:"signatures",smask:"smask",shadingPattern:"shadingPattern",errorTilingPattern:"errorTilingPattern",errorExtGState:"errorExtGState",errorXObject:"errorXObject",errorFontLoadType3:"errorFontLoadType3",errorFontState:"errorFontState",errorFontMissing:"errorFontMissing",errorFontTranslate:"errorFontTranslate",errorColorSpace:"errorColorSpace",errorOperatorList:"errorOperatorList",errorFontToUnicode:"errorFontToUnicode",errorFontLoadNative:"errorFontLoadNative",errorFontBuildPath:"errorFontBuildPath",errorFontGetPath:"errorFontGetPath",errorMarkedContent:"errorMarkedContent",errorContentSubStream:"errorContentSubStream"};r.UNSUPPORTED_FEATURES=di;const bi={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};r.PasswordResponses=bi;let vi=ti.WARNINGS;function Pi(Bi){Number.isInteger(Bi)&&(vi=Bi)}function xi(){return vi}function ni(Bi){vi>=ti.INFOS&&console.log(`Info: ${Bi}`)}function fi(Bi){vi>=ti.WARNINGS&&console.log(`Warning: ${Bi}`)}function Si(Bi){throw new Error(Bi)}function Xe(Bi,Ni){Bi||Si(Ni)}function Ge(Bi){if(!Bi)return!1;switch(Bi.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function ze(Bi,Ni=null,qi=null){if(!Bi)return null;try{if(qi&&typeof Bi=="string"){if(qi.addDefaultProtocol&&Bi.startsWith("www.")){const bn=Bi.match(/\./g);bn&&bn.length>=2&&(Bi=`http://${Bi}`)}if(qi.tryConvertEncoding)try{Bi=an(Bi)}catch{}}const on=Ni?new URL(Bi,Ni):new URL(Bi);if(Ge(on))return on}catch{}return null}function Ve(Bi,Ni,qi){return Object.defineProperty(Bi,Ni,{value:qi,enumerable:!0,configurable:!0,writable:!1}),qi}const ei=function(){function Ni(qi,on){this.constructor===Ni&&Si("Cannot initialize BaseException."),this.message=qi,this.name=on}return Ni.prototype=new Error,Ni.constructor=Ni,Ni}();r.BaseException=ei;class si extends ei{constructor(Ni,qi){super(Ni,"PasswordException"),this.code=qi}}r.PasswordException=si;class li extends ei{constructor(Ni,qi){super(Ni,"UnknownErrorException"),this.details=qi}}r.UnknownErrorException=li;class ci extends ei{constructor(Ni){super(Ni,"InvalidPDFException")}}r.InvalidPDFException=ci;class Ci extends ei{constructor(Ni){super(Ni,"MissingPDFException")}}r.MissingPDFException=Ci;class Fi extends ei{constructor(Ni,qi){super(Ni,"UnexpectedResponseException"),this.status=qi}}r.UnexpectedResponseException=Fi;class Oi extends ei{constructor(Ni){super(Ni,"FormatError")}}r.FormatError=Oi;class Ti extends ei{constructor(Ni){super(Ni,"AbortException")}}r.AbortException=Ti;function Ze(Bi){(typeof Bi!="object"||Bi===null||Bi.length===void 0)&&Si("Invalid argument for bytesToString");const Ni=Bi.length,qi=8192;if(Ni<qi)return String.fromCharCode.apply(null,Bi);const on=[];for(let bn=0;bn<Ni;bn+=qi){const En=Math.min(bn+qi,Ni),vn=Bi.subarray(bn,En);on.push(String.fromCharCode.apply(null,vn))}return on.join("")}function ii(Bi){typeof Bi!="string"&&Si("Invalid argument for stringToBytes");const Ni=Bi.length,qi=new Uint8Array(Ni);for(let on=0;on<Ni;++on)qi[on]=Bi.charCodeAt(on)&255;return qi}function Qe(Bi){if(Bi.length!==void 0)return Bi.length;if(Bi.byteLength!==void 0)return Bi.byteLength;Si("Invalid argument for arrayByteLength")}function ui(Bi){const Ni=Bi.length;if(Ni===1&&Bi[0]instanceof Uint8Array)return Bi[0];let qi=0;for(let En=0;En<Ni;En++)qi+=Qe(Bi[En]);let on=0;const bn=new Uint8Array(qi);for(let En=0;En<Ni;En++){let vn=Bi[En];vn instanceof Uint8Array||(typeof vn=="string"?vn=ii(vn):vn=new Uint8Array(vn));const mn=vn.byteLength;bn.set(vn,on),on+=mn}return bn}function gi(Bi){return String.fromCharCode(Bi>>24&255,Bi>>16&255,Bi>>8&255,Bi&255)}function _i(Bi){return Object.keys(Bi).length}function Ri(Bi){const Ni=Object.create(null);for(const[qi,on]of Bi)Ni[qi]=on;return Ni}function Ui(){const Bi=new Uint8Array(4);return Bi[0]=1,new Uint32Array(Bi.buffer,0,1)[0]===1}function ki(){try{return new Function(""),!0}catch{return!1}}class Vi{static get isLittleEndian(){return Ve(this,"isLittleEndian",Ui())}static get isEvalSupported(){return Ve(this,"isEvalSupported",ki())}static get isOffscreenCanvasSupported(){return Ve(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}}r.FeatureTest=Vi;const Ii=[...Array(256).keys()].map(Bi=>Bi.toString(16).padStart(2,"0"));class $i{static makeHexColor(Ni,qi,on){return`#${Ii[Ni]}${Ii[qi]}${Ii[on]}`}static scaleMinMax(Ni,qi){let on;Ni[0]?(Ni[0]<0&&(on=qi[0],qi[0]=qi[1],qi[1]=on),qi[0]*=Ni[0],qi[1]*=Ni[0],Ni[3]<0&&(on=qi[2],qi[2]=qi[3],qi[3]=on),qi[2]*=Ni[3],qi[3]*=Ni[3]):(on=qi[0],qi[0]=qi[2],qi[2]=on,on=qi[1],qi[1]=qi[3],qi[3]=on,Ni[1]<0&&(on=qi[2],qi[2]=qi[3],qi[3]=on),qi[2]*=Ni[1],qi[3]*=Ni[1],Ni[2]<0&&(on=qi[0],qi[0]=qi[1],qi[1]=on),qi[0]*=Ni[2],qi[1]*=Ni[2]),qi[0]+=Ni[4],qi[1]+=Ni[4],qi[2]+=Ni[5],qi[3]+=Ni[5]}static transform(Ni,qi){return[Ni[0]*qi[0]+Ni[2]*qi[1],Ni[1]*qi[0]+Ni[3]*qi[1],Ni[0]*qi[2]+Ni[2]*qi[3],Ni[1]*qi[2]+Ni[3]*qi[3],Ni[0]*qi[4]+Ni[2]*qi[5]+Ni[4],Ni[1]*qi[4]+Ni[3]*qi[5]+Ni[5]]}static applyTransform(Ni,qi){const on=Ni[0]*qi[0]+Ni[1]*qi[2]+qi[4],bn=Ni[0]*qi[1]+Ni[1]*qi[3]+qi[5];return[on,bn]}static applyInverseTransform(Ni,qi){const on=qi[0]*qi[3]-qi[1]*qi[2],bn=(Ni[0]*qi[3]-Ni[1]*qi[2]+qi[2]*qi[5]-qi[4]*qi[3])/on,En=(-Ni[0]*qi[1]+Ni[1]*qi[0]+qi[4]*qi[1]-qi[5]*qi[0])/on;return[bn,En]}static getAxialAlignedBoundingBox(Ni,qi){const on=$i.applyTransform(Ni,qi),bn=$i.applyTransform(Ni.slice(2,4),qi),En=$i.applyTransform([Ni[0],Ni[3]],qi),vn=$i.applyTransform([Ni[2],Ni[1]],qi);return[Math.min(on[0],bn[0],En[0],vn[0]),Math.min(on[1],bn[1],En[1],vn[1]),Math.max(on[0],bn[0],En[0],vn[0]),Math.max(on[1],bn[1],En[1],vn[1])]}static inverseTransform(Ni){const qi=Ni[0]*Ni[3]-Ni[1]*Ni[2];return[Ni[3]/qi,-Ni[1]/qi,-Ni[2]/qi,Ni[0]/qi,(Ni[2]*Ni[5]-Ni[4]*Ni[3])/qi,(Ni[4]*Ni[1]-Ni[5]*Ni[0])/qi]}static singularValueDecompose2dScale(Ni){const qi=[Ni[0],Ni[2],Ni[1],Ni[3]],on=Ni[0]*qi[0]+Ni[1]*qi[2],bn=Ni[0]*qi[1]+Ni[1]*qi[3],En=Ni[2]*qi[0]+Ni[3]*qi[2],vn=Ni[2]*qi[1]+Ni[3]*qi[3],mn=(on+vn)/2,Pn=Math.sqrt((on+vn)**2-4*(on*vn-En*bn))/2,In=mn+Pn||1,Mn=mn-Pn||1;return[Math.sqrt(In),Math.sqrt(Mn)]}static normalizeRect(Ni){const qi=Ni.slice(0);return Ni[0]>Ni[2]&&(qi[0]=Ni[2],qi[2]=Ni[0]),Ni[1]>Ni[3]&&(qi[1]=Ni[3],qi[3]=Ni[1]),qi}static intersect(Ni,qi){const on=Math.max(Math.min(Ni[0],Ni[2]),Math.min(qi[0],qi[2])),bn=Math.min(Math.max(Ni[0],Ni[2]),Math.max(qi[0],qi[2]));if(on>bn)return null;const En=Math.max(Math.min(Ni[1],Ni[3]),Math.min(qi[1],qi[3])),vn=Math.min(Math.max(Ni[1],Ni[3]),Math.max(qi[1],qi[3]));return En>vn?null:[on,En,bn,vn]}static bezierBoundingBox(Ni,qi,on,bn,En,vn,mn,Pn){const In=[],Mn=[[],[]];let zn,Fn,Cn,Rn,er,Kn,Wn,Gn;for(let fr=0;fr<2;++fr){if(fr===0?(Fn=6*Ni-12*on+6*En,zn=-3*Ni+9*on-9*En+3*mn,Cn=3*on-3*Ni):(Fn=6*qi-12*bn+6*vn,zn=-3*qi+9*bn-9*vn+3*Pn,Cn=3*bn-3*qi),Math.abs(zn)<1e-12){if(Math.abs(Fn)<1e-12)continue;Rn=-Cn/Fn,0<Rn&&Rn<1&&In.push(Rn);continue}Wn=Fn*Fn-4*Cn*zn,Gn=Math.sqrt(Wn),!(Wn<0)&&(er=(-Fn+Gn)/(2*zn),0<er&&er<1&&In.push(er),Kn=(-Fn-Gn)/(2*zn),0<Kn&&Kn<1&&In.push(Kn))}let sr=In.length,rr;const ur=sr;for(;sr--;)Rn=In[sr],rr=1-Rn,Mn[0][sr]=rr*rr*rr*Ni+3*rr*rr*Rn*on+3*rr*Rn*Rn*En+Rn*Rn*Rn*mn,Mn[1][sr]=rr*rr*rr*qi+3*rr*rr*Rn*bn+3*rr*Rn*Rn*vn+Rn*Rn*Rn*Pn;return Mn[0][ur]=Ni,Mn[1][ur]=qi,Mn[0][ur+1]=mn,Mn[1][ur+1]=Pn,Mn[0].length=Mn[1].length=ur+2,[Math.min(...Mn[0]),Math.min(...Mn[1]),Math.max(...Mn[0]),Math.max(...Mn[1])]}}r.Util=$i;const tn=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,728,711,710,729,733,731,730,732,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8226,8224,8225,8230,8212,8211,402,8260,8249,8250,8722,8240,8222,8220,8221,8216,8217,8218,8482,64257,64258,321,338,352,376,381,305,322,339,353,382,0,8364];function en(Bi){if(Bi[0]>="\xEF"){let qi;if(Bi[0]==="\xFE"&&Bi[1]==="\xFF"?qi="utf-16be":Bi[0]==="\xFF"&&Bi[1]==="\xFE"?qi="utf-16le":Bi[0]==="\xEF"&&Bi[1]==="\xBB"&&Bi[2]==="\xBF"&&(qi="utf-8"),qi)try{const on=new TextDecoder(qi,{fatal:!0}),bn=ii(Bi);return on.decode(bn)}catch(on){fi(`stringToPDFString: "${on}".`)}}const Ni=[];for(let qi=0,on=Bi.length;qi<on;qi++){const bn=tn[Bi.charCodeAt(qi)];Ni.push(bn?String.fromCharCode(bn):Bi.charAt(qi))}return Ni.join("")}function zi(Bi){return Bi.replace(/([()\\\n\r])/g,Ni=>Ni===`
`?"\\n":Ni==="\r"?"\\r":`\\${Ni}`)}function Ji(Bi){return/^[\x00-\x7F]*$/.test(Bi)}function pn(Bi){const Ni=["\xFE\xFF"];for(let qi=0,on=Bi.length;qi<on;qi++){const bn=Bi.charCodeAt(qi);Ni.push(String.fromCharCode(bn>>8&255),String.fromCharCode(bn&255))}return Ni.join("")}function an(Bi){return decodeURIComponent(escape(Bi))}function kn(Bi){return unescape(encodeURIComponent(Bi))}function xn(Bi){return typeof Bi=="object"&&Bi!==null&&Bi.byteLength!==void 0}function Tn(Bi,Ni){if(Bi.length!==Ni.length)return!1;for(let qi=0,on=Bi.length;qi<on;qi++)if(Bi[qi]!==Ni[qi])return!1;return!0}function Bn(Bi=new Date){return[Bi.getUTCFullYear().toString(),(Bi.getUTCMonth()+1).toString().padStart(2,"0"),Bi.getUTCDate().toString().padStart(2,"0"),Bi.getUTCHours().toString().padStart(2,"0"),Bi.getUTCMinutes().toString().padStart(2,"0"),Bi.getUTCSeconds().toString().padStart(2,"0")].join("")}function $n(){const Bi=Object.create(null);let Ni=!1;return Object.defineProperty(Bi,"settled",{get(){return Ni}}),Bi.promise=new Promise(function(qi,on){Bi.resolve=function(bn){Ni=!0,qi(bn)},Bi.reject=function(bn){Ni=!0,on(bn)}}),Bi}},(__unused_webpack_module,exports,__w_pdfjs_require__)=>{var Ie,Me,Oe,Be,Ue,He,Ee,e,xe,Te,_e,kl,t,Ae;Object.defineProperty(exports,"__esModule",{value:!0}),exports.build=exports.RenderTask=exports.PDFWorkerUtil=exports.PDFWorker=exports.PDFPageProxy=exports.PDFDocumentProxy=exports.PDFDocumentLoadingTask=exports.PDFDataRangeTransport=exports.LoopbackPort=exports.DefaultStandardFontDataFactory=exports.DefaultCanvasFactory=exports.DefaultCMapReaderFactory=void 0,exports.getDocument=getDocument,exports.setPDFNetworkStreamFactory=setPDFNetworkStreamFactory,exports.version=void 0;var _util=__w_pdfjs_require__(1),_annotation_storage=__w_pdfjs_require__(3),_display_utils=__w_pdfjs_require__(6),_font_loader=__w_pdfjs_require__(9),_canvas=__w_pdfjs_require__(10),_worker_options=__w_pdfjs_require__(14),_is_node=__w_pdfjs_require__(12),_message_handler=__w_pdfjs_require__(15),_metadata=__w_pdfjs_require__(16),_optional_content_config=__w_pdfjs_require__(17),_transport_stream=__w_pdfjs_require__(18),_xfa_text=__w_pdfjs_require__(19);const DEFAULT_RANGE_CHUNK_SIZE=65536,RENDERING_CANCELLED_TIMEOUT=100;let DefaultCanvasFactory=_display_utils.DOMCanvasFactory;exports.DefaultCanvasFactory=DefaultCanvasFactory;let DefaultCMapReaderFactory=_display_utils.DOMCMapReaderFactory;exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory;let DefaultStandardFontDataFactory=_display_utils.DOMStandardFontDataFactory;if(exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory,_is_node.isNodeJS){const{NodeCanvasFactory:St,NodeCMapReaderFactory:Ce,NodeStandardFontDataFactory:ke}=__w_pdfjs_require__(20);exports.DefaultCanvasFactory=DefaultCanvasFactory=St,exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory=Ce,exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory=ke}let createPDFNetworkStream;function setPDFNetworkStreamFactory(St){createPDFNetworkStream=St}function getDocument(St){const Ce=new PDFDocumentLoadingTask;let ke;if(typeof St=="string"||St instanceof URL)ke={url:St};else if((0,_util.isArrayBuffer)(St))ke={data:St};else if(St instanceof PDFDataRangeTransport)ke={range:St};else{if(typeof St!="object")throw new Error("Invalid parameter in getDocument, need either string, URL, TypedArray, or parameter object.");if(!St.url&&!St.data&&!St.range)throw new Error("Invalid parameter object: need either .data, .range or .url");ke=St}const De=Object.create(null);let Re=null,je=null;for(const Ke in ke){const Je=ke[Ke];switch(Ke){case"url":if(typeof window<"u")try{De[Ke]=new URL(Je,window.location).href;continue}catch(hi){(0,_util.warn)(`Cannot create valid URL: "${hi}".`)}else if(typeof Je=="string"||Je instanceof URL){De[Ke]=Je.toString();continue}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.");case"range":Re=Je;continue;case"worker":je=Je;continue;case"data":if(_is_node.isNodeJS&&typeof Buffer<"u"&&Je instanceof Buffer)De[Ke]=new Uint8Array(Je);else{if(Je instanceof Uint8Array)break;if(typeof Je=="string")De[Ke]=(0,_util.stringToBytes)(Je);else if(typeof Je=="object"&&Je!==null&&!isNaN(Je.length))De[Ke]=new Uint8Array(Je);else if((0,_util.isArrayBuffer)(Je))De[Ke]=new Uint8Array(Je);else throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}continue}De[Ke]=Je}if(De.CMapReaderFactory=De.CMapReaderFactory||DefaultCMapReaderFactory,De.StandardFontDataFactory=De.StandardFontDataFactory||DefaultStandardFontDataFactory,De.ignoreErrors=De.stopAtErrors!==!0,De.fontExtraProperties=De.fontExtraProperties===!0,De.pdfBug=De.pdfBug===!0,De.enableXfa=De.enableXfa===!0,(!Number.isInteger(De.rangeChunkSize)||De.rangeChunkSize<1)&&(De.rangeChunkSize=DEFAULT_RANGE_CHUNK_SIZE),(typeof De.docBaseUrl!="string"||(0,_display_utils.isDataScheme)(De.docBaseUrl))&&(De.docBaseUrl=null),(!Number.isInteger(De.maxImageSize)||De.maxImageSize<-1)&&(De.maxImageSize=-1),typeof De.cMapUrl!="string"&&(De.cMapUrl=null),typeof De.standardFontDataUrl!="string"&&(De.standardFontDataUrl=null),typeof De.useWorkerFetch!="boolean"&&(De.useWorkerFetch=De.CMapReaderFactory===_display_utils.DOMCMapReaderFactory&&De.StandardFontDataFactory===_display_utils.DOMStandardFontDataFactory),typeof De.isEvalSupported!="boolean"&&(De.isEvalSupported=!0),typeof De.isOffscreenCanvasSupported!="boolean"&&(De.isOffscreenCanvasSupported=!_is_node.isNodeJS),typeof De.disableFontFace!="boolean"&&(De.disableFontFace=_is_node.isNodeJS),typeof De.useSystemFonts!="boolean"&&(De.useSystemFonts=!_is_node.isNodeJS&&!De.disableFontFace),(typeof De.ownerDocument!="object"||De.ownerDocument===null)&&(De.ownerDocument=globalThis.document),typeof De.disableRange!="boolean"&&(De.disableRange=!1),typeof De.disableStream!="boolean"&&(De.disableStream=!1),typeof De.disableAutoFetch!="boolean"&&(De.disableAutoFetch=!1),(0,_util.setVerbosityLevel)(De.verbosity),!je){const Ke={verbosity:De.verbosity,port:_worker_options.GlobalWorkerOptions.workerPort};je=Ke.port?PDFWorker.fromPort(Ke):new PDFWorker(Ke),Ce._worker=je}const We=Ce.docId;return je.promise.then(function(){if(Ce.destroyed)throw new Error("Loading aborted");const Ke=_fetchDocument(je,De,Re,We),Je=new Promise(function(hi){let oi;Re?oi=new _transport_stream.PDFDataTransportStream({length:De.length,initialData:De.initialData,progressiveDone:De.progressiveDone,contentDispositionFilename:De.contentDispositionFilename,disableRange:De.disableRange,disableStream:De.disableStream},Re):De.data||(oi=createPDFNetworkStream({url:De.url,length:De.length,httpHeaders:De.httpHeaders,withCredentials:De.withCredentials,rangeChunkSize:De.rangeChunkSize,disableRange:De.disableRange,disableStream:De.disableStream})),hi(oi)});return Promise.all([Ke,Je]).then(function([hi,oi]){if(Ce.destroyed)throw new Error("Loading aborted");const ti=new _message_handler.MessageHandler(We,hi,je.port),ai=new WorkerTransport(ti,Ce,oi,De);Ce._transport=ai,ti.send("Ready",null)})}).catch(Ce._capability.reject),Ce}async function _fetchDocument(St,Ce,ke,De){if(St.destroyed)throw new Error("Worker was destroyed");ke&&(Ce.length=ke.length,Ce.initialData=ke.initialData,Ce.progressiveDone=ke.progressiveDone,Ce.contentDispositionFilename=ke.contentDispositionFilename);const Re=await St.messageHandler.sendWithPromise("GetDocRequest",{docId:De,apiVersion:"3.0.279",data:Ce.data,password:Ce.password,disableAutoFetch:Ce.disableAutoFetch,rangeChunkSize:Ce.rangeChunkSize,length:Ce.length,docBaseUrl:Ce.docBaseUrl,enableXfa:Ce.enableXfa,evaluatorOptions:{maxImageSize:Ce.maxImageSize,disableFontFace:Ce.disableFontFace,ignoreErrors:Ce.ignoreErrors,isEvalSupported:Ce.isEvalSupported,isOffscreenCanvasSupported:Ce.isOffscreenCanvasSupported,fontExtraProperties:Ce.fontExtraProperties,useSystemFonts:Ce.useSystemFonts,cMapUrl:Ce.useWorkerFetch?Ce.cMapUrl:null,standardFontDataUrl:Ce.useWorkerFetch?Ce.standardFontDataUrl:null}});if(Ce.data&&(Ce.data=null),St.destroyed)throw new Error("Worker was destroyed");return Re}const r=class{constructor(){this._capability=(0,_util.createPromiseCapability)(),this._transport=null,this._worker=null,this.docId=`d${El(r,Ie)._++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null,this.onUnsupportedFeature=null}get promise(){return this._capability.promise}async destroy(){var Ce;this.destroyed=!0,await((Ce=this._transport)==null?void 0:Ce.destroy()),this._transport=null,this._worker&&(this._worker.destroy(),this._worker=null)}};let PDFDocumentLoadingTask=r;Ie=new WeakMap,rn(PDFDocumentLoadingTask,Ie,0),exports.PDFDocumentLoadingTask=PDFDocumentLoadingTask;class PDFDataRangeTransport{constructor(Ce,ke,De=!1,Re=null){this.length=Ce,this.initialData=ke,this.progressiveDone=De,this.contentDispositionFilename=Re,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=(0,_util.createPromiseCapability)()}addRangeListener(Ce){this._rangeListeners.push(Ce)}addProgressListener(Ce){this._progressListeners.push(Ce)}addProgressiveReadListener(Ce){this._progressiveReadListeners.push(Ce)}addProgressiveDoneListener(Ce){this._progressiveDoneListeners.push(Ce)}onDataRange(Ce,ke){for(const De of this._rangeListeners)De(Ce,ke)}onDataProgress(Ce,ke){this._readyCapability.promise.then(()=>{for(const De of this._progressListeners)De(Ce,ke)})}onDataProgressiveRead(Ce){this._readyCapability.promise.then(()=>{for(const ke of this._progressiveReadListeners)ke(Ce)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const Ce of this._progressiveDoneListeners)Ce()})}transportReady(){this._readyCapability.resolve()}requestDataRange(Ce,ke){(0,_util.unreachable)("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}exports.PDFDataRangeTransport=PDFDataRangeTransport;class PDFDocumentProxy{constructor(Ce,ke){this._pdfInfo=Ce,this._transport=ke}get annotationStorage(){return this._transport.annotationStorage}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get stats(){return this._transport.stats}get isPureXfa(){return!!this._transport._htmlForXfa}get allXfaHtml(){return this._transport._htmlForXfa}getPage(Ce){return this._transport.getPage(Ce)}getPageIndex(Ce){return this._transport.getPageIndex(Ce)}getDestinations(){return this._transport.getDestinations()}getDestination(Ce){return this._transport.getDestination(Ce)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJavaScript(){return this._transport.getJavaScript()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig(){return this._transport.getOptionalContentConfig()}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(Ce=!1){return this._transport.startCleanup(Ce||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}exports.PDFDocumentProxy=PDFDocumentProxy;class PDFPageProxy{constructor(Ce,ke,De,Re,je=!1){this._pageIndex=Ce,this._pageInfo=ke,this._ownerDocument=Re,this._transport=De,this._stats=je?new _display_utils.StatTimer:null,this._pdfBug=je,this.commonObjs=De.commonObjs,this.objs=new PDFObjects,this._bitmaps=new Set,this.cleanupAfterRender=!1,this.pendingCleanup=!1,this._intentStates=new Map,this._annotationPromises=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:Ce,rotation:ke=this.rotate,offsetX:De=0,offsetY:Re=0,dontFlip:je=!1}={}){return new _display_utils.PageViewport({viewBox:this.view,scale:Ce,rotation:ke,offsetX:De,offsetY:Re,dontFlip:je})}getAnnotations({intent:Ce="display"}={}){const ke=this._transport.getRenderingIntent(Ce);let De=this._annotationPromises.get(ke.cacheKey);return De||(De=this._transport.getAnnotations(this._pageIndex,ke.renderingIntent),this._annotationPromises.set(ke.cacheKey,De)),De}getJSActions(){return this._jsActionsPromise||(this._jsActionsPromise=this._transport.getPageJSActions(this._pageIndex))}async getXfa(){var Ce;return((Ce=this._transport._htmlForXfa)==null?void 0:Ce.children[this._pageIndex])||null}render({canvasContext:Ce,viewport:ke,intent:De="display",annotationMode:Re=_util.AnnotationMode.ENABLE,transform:je=null,canvasFactory:We=null,background:Ke=null,optionalContentConfigPromise:Je=null,annotationCanvasMap:hi=null,pageColors:oi=null,printAnnotationStorage:ti=null}){var ni,fi;(ni=this._stats)==null||ni.time("Overall");const ai=this._transport.getRenderingIntent(De,Re,ti);this.pendingCleanup=!1,Je||(Je=this._transport.getOptionalContentConfig());let yi=this._intentStates.get(ai.cacheKey);yi||(yi=Object.create(null),this._intentStates.set(ai.cacheKey,yi)),yi.streamReaderCancelTimeout&&(clearTimeout(yi.streamReaderCancelTimeout),yi.streamReaderCancelTimeout=null);const di=We||new DefaultCanvasFactory({ownerDocument:this._ownerDocument}),bi=!!(ai.renderingIntent&_util.RenderingIntentFlag.PRINT);yi.displayReadyCapability||(yi.displayReadyCapability=(0,_util.createPromiseCapability)(),yi.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(fi=this._stats)==null||fi.time("Page Request"),this._pumpOperatorList(ai));const vi=Si=>{var Xe,Ge;yi.renderTasks.delete(Pi),(this.cleanupAfterRender||bi)&&(this.pendingCleanup=!0),this._tryCleanup(),Si?(Pi.capability.reject(Si),this._abortOperatorList({intentState:yi,reason:Si instanceof Error?Si:new Error(Si)})):Pi.capability.resolve(),(Xe=this._stats)==null||Xe.timeEnd("Rendering"),(Ge=this._stats)==null||Ge.timeEnd("Overall")},Pi=new InternalRenderTask({callback:vi,params:{canvasContext:Ce,viewport:ke,transform:je,background:Ke},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:hi,operatorList:yi.operatorList,pageIndex:this._pageIndex,canvasFactory:di,useRequestAnimationFrame:!bi,pdfBug:this._pdfBug,pageColors:oi});(yi.renderTasks||(yi.renderTasks=new Set)).add(Pi);const xi=Pi.task;return Promise.all([yi.displayReadyCapability.promise,Je]).then(([Si,Xe])=>{var Ge;if(this.pendingCleanup){vi();return}(Ge=this._stats)==null||Ge.time("Rendering"),Pi.initializeGraphics({transparency:Si,optionalContentConfig:Xe}),Pi.operatorListChanged()}).catch(vi),xi}getOperatorList({intent:Ce="display",annotationMode:ke=_util.AnnotationMode.ENABLE,printAnnotationStorage:De=null}={}){var Je;function Re(){We.operatorList.lastChunk&&(We.opListReadCapability.resolve(We.operatorList),We.renderTasks.delete(Ke))}const je=this._transport.getRenderingIntent(Ce,ke,De,!0);let We=this._intentStates.get(je.cacheKey);We||(We=Object.create(null),this._intentStates.set(je.cacheKey,We));let Ke;return We.opListReadCapability||(Ke=Object.create(null),Ke.operatorListChanged=Re,We.opListReadCapability=(0,_util.createPromiseCapability)(),(We.renderTasks||(We.renderTasks=new Set)).add(Ke),We.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(Je=this._stats)==null||Je.time("Page Request"),this._pumpOperatorList(je)),We.opListReadCapability.promise}streamTextContent({disableCombineTextItems:Ce=!1,includeMarkedContent:ke=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,combineTextItems:Ce!==!0,includeMarkedContent:ke===!0},{highWaterMark:100,size(Re){return Re.items.length}})}getTextContent(Ce={}){if(this._transport._htmlForXfa)return this.getXfa().then(De=>_xfa_text.XfaText.textContent(De));const ke=this.streamTextContent(Ce);return new Promise(function(De,Re){function je(){We.read().then(function({value:Je,done:hi}){if(hi){De(Ke);return}Object.assign(Ke.styles,Je.styles),Ke.items.push(...Je.items),je()},Re)}const We=ke.getReader(),Ke={items:[],styles:Object.create(null)};je()})}getStructTree(){return this._structTreePromise||(this._structTreePromise=this._transport.getStructTree(this._pageIndex))}_destroy(){this.destroyed=!0;const Ce=[];for(const ke of this._intentStates.values())if(this._abortOperatorList({intentState:ke,reason:new Error("Page was destroyed."),force:!0}),!ke.opListReadCapability)for(const De of ke.renderTasks)Ce.push(De.completed),De.cancel();this.objs.clear();for(const ke of this._bitmaps)ke.close();return this._bitmaps.clear(),this._annotationPromises.clear(),this._jsActionsPromise=null,this._structTreePromise=null,this.pendingCleanup=!1,Promise.all(Ce)}cleanup(Ce=!1){return this.pendingCleanup=!0,this._tryCleanup(Ce)}_tryCleanup(Ce=!1){if(!this.pendingCleanup)return!1;for(const{renderTasks:ke,operatorList:De}of this._intentStates.values())if(ke.size>0||!De.lastChunk)return!1;this._intentStates.clear(),this.objs.clear(),this._annotationPromises.clear(),this._jsActionsPromise=null,this._structTreePromise=null,Ce&&this._stats&&(this._stats=new _display_utils.StatTimer);for(const ke of this._bitmaps)ke.close();return this._bitmaps.clear(),this.pendingCleanup=!1,!0}_startRenderPage(Ce,ke){var Re,je;const De=this._intentStates.get(ke);!De||((Re=this._stats)==null||Re.timeEnd("Page Request"),(je=De.displayReadyCapability)==null||je.resolve(Ce))}_renderPageChunk(Ce,ke){for(let De=0,Re=Ce.length;De<Re;De++)ke.operatorList.fnArray.push(Ce.fnArray[De]),ke.operatorList.argsArray.push(Ce.argsArray[De]);ke.operatorList.lastChunk=Ce.lastChunk,ke.operatorList.separateAnnots=Ce.separateAnnots;for(const De of ke.renderTasks)De.operatorListChanged();Ce.lastChunk&&this._tryCleanup()}_pumpOperatorList({renderingIntent:Ce,cacheKey:ke,annotationStorageMap:De}){const je=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:Ce,cacheKey:ke,annotationStorage:De}).getReader(),We=this._intentStates.get(ke);We.streamReader=je;const Ke=()=>{je.read().then(({value:Je,done:hi})=>{if(hi){We.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(Je,We),Ke())},Je=>{if(We.streamReader=null,!this._transport.destroyed){if(We.operatorList){We.operatorList.lastChunk=!0;for(const hi of We.renderTasks)hi.operatorListChanged();this._tryCleanup()}if(We.displayReadyCapability)We.displayReadyCapability.reject(Je);else if(We.opListReadCapability)We.opListReadCapability.reject(Je);else throw Je}})};Ke()}_abortOperatorList({intentState:Ce,reason:ke,force:De=!1}){if(!!Ce.streamReader){if(!De){if(Ce.renderTasks.size>0)return;if(ke instanceof _display_utils.RenderingCancelledException){Ce.streamReaderCancelTimeout=setTimeout(()=>{this._abortOperatorList({intentState:Ce,reason:ke,force:!0}),Ce.streamReaderCancelTimeout=null},RENDERING_CANCELLED_TIMEOUT);return}}if(Ce.streamReader.cancel(new _util.AbortException(ke.message)).catch(()=>{}),Ce.streamReader=null,!this._transport.destroyed){for(const[Re,je]of this._intentStates)if(je===Ce){this._intentStates.delete(Re);break}this.cleanup()}}}get stats(){return this._stats}}exports.PDFPageProxy=PDFPageProxy;class LoopbackPort{constructor(){rn(this,Me,[]);rn(this,Oe,Promise.resolve())}postMessage(Ce,ke){const De={data:structuredClone(Ce,ke)};Mi(this,Oe).then(()=>{for(const Re of Mi(this,Me))Re.call(this,De)})}addEventListener(Ce,ke){Mi(this,Me).push(ke)}removeEventListener(Ce,ke){const De=Mi(this,Me).indexOf(ke);Mi(this,Me).splice(De,1)}terminate(){Mi(this,Me).length=0}}Me=new WeakMap,Oe=new WeakMap,exports.LoopbackPort=LoopbackPort;const PDFWorkerUtil={isWorkerDisabled:!1,fallbackWorkerSrc:null,fakeWorkerId:0};exports.PDFWorkerUtil=PDFWorkerUtil;{if(_is_node.isNodeJS&&typeof commonjsRequire=="function")PDFWorkerUtil.isWorkerDisabled=!0,PDFWorkerUtil.fallbackWorkerSrc="./pdf.worker.js";else if(typeof document=="object"){const St=(Be=document==null?void 0:document.currentScript)==null?void 0:Be.src;St&&(PDFWorkerUtil.fallbackWorkerSrc=St.replace(/(\.(?:min\.)?js)(\?.*)?$/i,".worker$1$2"))}PDFWorkerUtil.isSameOrigin=function(St,Ce){let ke;try{if(ke=new URL(St),!ke.origin||ke.origin==="null")return!1}catch{return!1}const De=new URL(Ce,ke);return ke.origin===De.origin},PDFWorkerUtil.createCDNWrapper=function(St){const Ce=`importScripts("${St}");`;return URL.createObjectURL(new Blob([Ce]))}}const _PDFWorker=class{constructor({name:St=null,port:Ce=null,verbosity:ke=(0,_util.getVerbosityLevel)()}={}){if(Ce&&Mi(_PDFWorker,Ue).has(Ce))throw new Error("Cannot use more than one PDFWorker per port.");if(this.name=St,this.destroyed=!1,this.verbosity=ke,this._readyCapability=(0,_util.createPromiseCapability)(),this._port=null,this._webWorker=null,this._messageHandler=null,Ce){Mi(_PDFWorker,Ue).set(Ce,this),this._initializeFromPort(Ce);return}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(St){this._port=St,this._messageHandler=new _message_handler.MessageHandler("main","worker",St),this._messageHandler.on("ready",function(){}),this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})}_initialize(){if(!PDFWorkerUtil.isWorkerDisabled&&!_PDFWorker._mainThreadWorkerMessageHandler){let{workerSrc:St}=_PDFWorker;try{PDFWorkerUtil.isSameOrigin(window.location.href,St)||(St=PDFWorkerUtil.createCDNWrapper(new URL(St,window.location).href));const Ce=new Worker(St),ke=new _message_handler.MessageHandler("main","worker",Ce),De=()=>{Ce.removeEventListener("error",Re),ke.destroy(),Ce.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},Re=()=>{this._webWorker||De()};Ce.addEventListener("error",Re),ke.on("test",We=>{if(Ce.removeEventListener("error",Re),this.destroyed){De();return}We?(this._messageHandler=ke,this._port=Ce,this._webWorker=Ce,this._readyCapability.resolve(),ke.send("configure",{verbosity:this.verbosity})):(this._setupFakeWorker(),ke.destroy(),Ce.terminate())}),ke.on("ready",We=>{if(Ce.removeEventListener("error",Re),this.destroyed){De();return}try{je()}catch{this._setupFakeWorker()}});const je=()=>{const We=new Uint8Array;ke.send("test",We,[We.buffer])};je();return}catch{(0,_util.info)("The worker has been disabled.")}}this._setupFakeWorker()}_setupFakeWorker(){PDFWorkerUtil.isWorkerDisabled||((0,_util.warn)("Setting up fake worker."),PDFWorkerUtil.isWorkerDisabled=!0),_PDFWorker._setupFakeWorkerGlobal.then(St=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const Ce=new LoopbackPort;this._port=Ce;const ke=`fake${PDFWorkerUtil.fakeWorkerId++}`,De=new _message_handler.MessageHandler(ke+"_worker",ke,Ce);St.setup(De,Ce);const Re=new _message_handler.MessageHandler(ke,ke+"_worker",Ce);this._messageHandler=Re,this._readyCapability.resolve(),Re.send("configure",{verbosity:this.verbosity})}).catch(St=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${St.message}".`))})}destroy(){this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),Mi(_PDFWorker,Ue).delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}static fromPort(St){if(!(St!=null&&St.port))throw new Error("PDFWorker.fromPort - invalid method signature.");return Mi(this,Ue).has(St.port)?Mi(this,Ue).get(St.port):new _PDFWorker(St)}static get workerSrc(){if(_worker_options.GlobalWorkerOptions.workerSrc)return _worker_options.GlobalWorkerOptions.workerSrc;if(PDFWorkerUtil.fallbackWorkerSrc!==null)return _is_node.isNodeJS||(0,_display_utils.deprecated)('No "GlobalWorkerOptions.workerSrc" specified.'),PDFWorkerUtil.fallbackWorkerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _mainThreadWorkerMessageHandler(){var St;try{return((St=globalThis.pdfjsWorker)==null?void 0:St.WorkerMessageHandler)||null}catch{return null}}static get _setupFakeWorkerGlobal(){const loader=async()=>{const mainWorkerMessageHandler=this._mainThreadWorkerMessageHandler;if(mainWorkerMessageHandler)return mainWorkerMessageHandler;if(_is_node.isNodeJS&&typeof commonjsRequire=="function"){const worker=eval("require")(this.workerSrc);return worker.WorkerMessageHandler}return await(0,_display_utils.loadScript)(this.workerSrc),window.pdfjsWorker.WorkerMessageHandler};return(0,_util.shadow)(this,"_setupFakeWorkerGlobal",loader())}};let PDFWorker=_PDFWorker;Ue=new WeakMap,rn(PDFWorker,Ue,new WeakMap),exports.PDFWorker=PDFWorker;class WorkerTransport{constructor(Ce,ke,De,Re){rn(this,He,null);rn(this,Ee,new Map);rn(this,e,new Map);rn(this,xe,null);this.messageHandler=Ce,this.loadingTask=ke,this.commonObjs=new PDFObjects,this.fontLoader=new _font_loader.FontLoader({onUnsupportedFeature:this._onUnsupportedFeature.bind(this),ownerDocument:Re.ownerDocument,styleElement:Re.styleElement}),this._params=Re,Re.useWorkerFetch||(this.CMapReaderFactory=new Re.CMapReaderFactory({baseUrl:Re.cMapUrl,isCompressed:Re.cMapPacked}),this.StandardFontDataFactory=new Re.StandardFontDataFactory({baseUrl:Re.standardFontDataUrl})),this.destroyed=!1,this.destroyCapability=null,this._passwordCapability=null,this._networkStream=De,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=(0,_util.createPromiseCapability)(),this.setupMessageHandler()}get annotationStorage(){return(0,_util.shadow)(this,"annotationStorage",new _annotation_storage.AnnotationStorage)}get stats(){return Mi(this,He)}getRenderingIntent(Ce,ke=_util.AnnotationMode.ENABLE,De=null,Re=!1){let je=_util.RenderingIntentFlag.DISPLAY,We=null;switch(Ce){case"any":je=_util.RenderingIntentFlag.ANY;break;case"display":break;case"print":je=_util.RenderingIntentFlag.PRINT;break;default:(0,_util.warn)(`getRenderingIntent - invalid intent: ${Ce}`)}switch(ke){case _util.AnnotationMode.DISABLE:je+=_util.RenderingIntentFlag.ANNOTATIONS_DISABLE;break;case _util.AnnotationMode.ENABLE:break;case _util.AnnotationMode.ENABLE_FORMS:je+=_util.RenderingIntentFlag.ANNOTATIONS_FORMS;break;case _util.AnnotationMode.ENABLE_STORAGE:je+=_util.RenderingIntentFlag.ANNOTATIONS_STORAGE,We=(je&_util.RenderingIntentFlag.PRINT&&De instanceof _annotation_storage.PrintAnnotationStorage?De:this.annotationStorage).serializable;break;default:(0,_util.warn)(`getRenderingIntent - invalid annotationMode: ${ke}`)}return Re&&(je+=_util.RenderingIntentFlag.OPLIST),{renderingIntent:je,cacheKey:`${je}_${_annotation_storage.AnnotationStorage.getHash(We)}`,annotationStorageMap:We}}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=(0,_util.createPromiseCapability)(),this._passwordCapability&&this._passwordCapability.reject(new Error("Worker was destroyed during onPassword callback"));const Ce=[];for(const De of Mi(this,Ee).values())Ce.push(De._destroy());Mi(this,Ee).clear(),Mi(this,e).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const ke=this.messageHandler.sendWithPromise("Terminate",null);return Ce.push(ke),Promise.all(Ce).then(()=>{this.commonObjs.clear(),this.fontLoader.clear(),yn(this,xe,null),this._getFieldObjectsPromise=null,this._hasJSActionsPromise=null,this._networkStream&&this._networkStream.cancelAllRequests(new _util.AbortException("Worker was terminated.")),this.messageHandler&&(this.messageHandler.destroy(),this.messageHandler=null),this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:Ce,loadingTask:ke}=this;Ce.on("GetReader",(De,Re)=>{(0,_util.assert)(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=je=>{this._lastProgress={loaded:je.loaded,total:je.total}},Re.onPull=()=>{this._fullReader.read().then(function({value:je,done:We}){if(We){Re.close();return}(0,_util.assert)((0,_util.isArrayBuffer)(je),"GetReader - expected an ArrayBuffer."),Re.enqueue(new Uint8Array(je),1,[je])}).catch(je=>{Re.error(je)})},Re.onCancel=je=>{this._fullReader.cancel(je),Re.ready.catch(We=>{if(!this.destroyed)throw We})}}),Ce.on("ReaderHeadersReady",De=>{const Re=(0,_util.createPromiseCapability)(),je=this._fullReader;return je.headersReady.then(()=>{var We;(!je.isStreamingSupported||!je.isRangeSupported)&&(this._lastProgress&&((We=ke.onProgress)==null||We.call(ke,this._lastProgress)),je.onProgress=Ke=>{var Je;(Je=ke.onProgress)==null||Je.call(ke,{loaded:Ke.loaded,total:Ke.total})}),Re.resolve({isStreamingSupported:je.isStreamingSupported,isRangeSupported:je.isRangeSupported,contentLength:je.contentLength})},Re.reject),Re.promise}),Ce.on("GetRangeReader",(De,Re)=>{(0,_util.assert)(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const je=this._networkStream.getRangeReader(De.begin,De.end);if(!je){Re.close();return}Re.onPull=()=>{je.read().then(function({value:We,done:Ke}){if(Ke){Re.close();return}(0,_util.assert)((0,_util.isArrayBuffer)(We),"GetRangeReader - expected an ArrayBuffer."),Re.enqueue(new Uint8Array(We),1,[We])}).catch(We=>{Re.error(We)})},Re.onCancel=We=>{je.cancel(We),Re.ready.catch(Ke=>{if(!this.destroyed)throw Ke})}}),Ce.on("GetDoc",({pdfInfo:De})=>{this._numPages=De.numPages,this._htmlForXfa=De.htmlForXfa,delete De.htmlForXfa,ke._capability.resolve(new PDFDocumentProxy(De,this))}),Ce.on("DocException",function(De){let Re;switch(De.name){case"PasswordException":Re=new _util.PasswordException(De.message,De.code);break;case"InvalidPDFException":Re=new _util.InvalidPDFException(De.message);break;case"MissingPDFException":Re=new _util.MissingPDFException(De.message);break;case"UnexpectedResponseException":Re=new _util.UnexpectedResponseException(De.message,De.status);break;case"UnknownErrorException":Re=new _util.UnknownErrorException(De.message,De.details);break;default:(0,_util.unreachable)("DocException - expected a valid Error.")}ke._capability.reject(Re)}),Ce.on("PasswordRequest",De=>{if(this._passwordCapability=(0,_util.createPromiseCapability)(),ke.onPassword){const Re=je=>{je instanceof Error?this._passwordCapability.reject(je):this._passwordCapability.resolve({password:je})};try{ke.onPassword(Re,De.code)}catch(je){this._passwordCapability.reject(je)}}else this._passwordCapability.reject(new _util.PasswordException(De.message,De.code));return this._passwordCapability.promise}),Ce.on("DataLoaded",De=>{var Re;(Re=ke.onProgress)==null||Re.call(ke,{loaded:De.length,total:De.length}),this.downloadInfoCapability.resolve(De)}),Ce.on("StartRenderPage",De=>{if(this.destroyed)return;Mi(this,Ee).get(De.pageIndex)._startRenderPage(De.transparency,De.cacheKey)}),Ce.on("commonobj",([De,Re,je])=>{var We;if(!this.destroyed&&!this.commonObjs.has(De))switch(Re){case"Font":const Ke=this._params;if("error"in je){const oi=je.error;(0,_util.warn)(`Error during font loading: ${oi}`),this.commonObjs.resolve(De,oi);break}let Je=null;Ke.pdfBug&&((We=globalThis.FontInspector)==null?void 0:We.enabled)&&(Je={registerFont(oi,ti){globalThis.FontInspector.fontAdded(oi,ti)}});const hi=new _font_loader.FontFaceObject(je,{isEvalSupported:Ke.isEvalSupported,disableFontFace:Ke.disableFontFace,ignoreErrors:Ke.ignoreErrors,onUnsupportedFeature:this._onUnsupportedFeature.bind(this),fontRegistry:Je});this.fontLoader.bind(hi).catch(oi=>Ce.sendWithPromise("FontFallback",{id:De})).finally(()=>{!Ke.fontExtraProperties&&hi.data&&(hi.data=null),this.commonObjs.resolve(De,hi)});break;case"FontPath":case"Image":this.commonObjs.resolve(De,je);break;default:throw new Error(`Got unknown common object type ${Re}`)}}),Ce.on("obj",([De,Re,je,We])=>{var Je;if(this.destroyed)return;const Ke=Mi(this,Ee).get(Re);if(!Ke.objs.has(De))switch(je){case"Image":Ke.objs.resolve(De,We);const hi=8e6;if(We){let oi;if(We.bitmap){const{bitmap:ti,width:ai,height:yi}=We;oi=ai*yi*4,Ke._bitmaps.add(ti)}else oi=((Je=We.data)==null?void 0:Je.length)||0;oi>hi&&(Ke.cleanupAfterRender=!0)}break;case"Pattern":Ke.objs.resolve(De,We);break;default:throw new Error(`Got unknown object type ${je}`)}}),Ce.on("DocProgress",De=>{var Re;this.destroyed||(Re=ke.onProgress)==null||Re.call(ke,{loaded:De.loaded,total:De.total})}),Ce.on("DocStats",De=>{this.destroyed||yn(this,He,Object.freeze({streamTypes:Object.freeze(De.streamTypes),fontTypes:Object.freeze(De.fontTypes)}))}),Ce.on("UnsupportedFeature",this._onUnsupportedFeature.bind(this)),Ce.on("FetchBuiltInCMap",De=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.CMapReaderFactory?this.CMapReaderFactory.fetch(De):Promise.reject(new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter."))),Ce.on("FetchStandardFontData",De=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.StandardFontDataFactory?this.StandardFontDataFactory.fetch(De):Promise.reject(new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.")))}_onUnsupportedFeature({featureId:Ce}){var ke,De;this.destroyed||(De=(ke=this.loadingTask).onUnsupportedFeature)==null||De.call(ke,Ce)}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){var Ce,ke;return this.annotationStorage.size<=0&&(0,_util.warn)("saveDocument called while `annotationStorage` is empty, please use the getData-method instead."),this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:this.annotationStorage.serializable,filename:(ke=(Ce=this._fullReader)==null?void 0:Ce.filename)!=null?ke:null}).finally(()=>{this.annotationStorage.resetModified()})}getPage(Ce){if(!Number.isInteger(Ce)||Ce<=0||Ce>this._numPages)return Promise.reject(new Error("Invalid page request."));const ke=Ce-1,De=Mi(this,e).get(ke);if(De)return De;const Re=this.messageHandler.sendWithPromise("GetPage",{pageIndex:ke}).then(je=>{if(this.destroyed)throw new Error("Transport destroyed");const We=new PDFPageProxy(ke,je,this,this._params.ownerDocument,this._params.pdfBug);return Mi(this,Ee).set(ke,We),We});return Mi(this,e).set(ke,Re),Re}getPageIndex(Ce){return typeof Ce!="object"||Ce===null||!Number.isInteger(Ce.num)||Ce.num<0||!Number.isInteger(Ce.gen)||Ce.gen<0?Promise.reject(new Error("Invalid pageIndex request.")):this.messageHandler.sendWithPromise("GetPageIndex",{num:Ce.num,gen:Ce.gen})}getAnnotations(Ce,ke){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:Ce,intent:ke})}getFieldObjects(){return this._getFieldObjectsPromise||(this._getFieldObjectsPromise=this.messageHandler.sendWithPromise("GetFieldObjects",null))}hasJSActions(){return this._hasJSActionsPromise||(this._hasJSActionsPromise=this.messageHandler.sendWithPromise("HasJSActions",null))}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(Ce){return typeof Ce!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:Ce})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getJavaScript(){return this.messageHandler.sendWithPromise("GetJavaScript",null)}getDocJSActions(){return this.messageHandler.sendWithPromise("GetDocJSActions",null)}getPageJSActions(Ce){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:Ce})}getStructTree(Ce){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:Ce})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(){return this.messageHandler.sendWithPromise("GetOptionalContentConfig",null).then(Ce=>new _optional_content_config.OptionalContentConfig(Ce))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){return Mi(this,xe)||yn(this,xe,this.messageHandler.sendWithPromise("GetMetadata",null).then(Ce=>{var ke,De,Re,je;return{info:Ce[0],metadata:Ce[1]?new _metadata.Metadata(Ce[1]):null,contentDispositionFilename:(De=(ke=this._fullReader)==null?void 0:ke.filename)!=null?De:null,contentLength:(je=(Re=this._fullReader)==null?void 0:Re.contentLength)!=null?je:null}}))}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(Ce=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const ke of Mi(this,Ee).values())if(!ke.cleanup())throw new Error(`startCleanup: Page ${ke.pageNumber} is currently rendering.`);this.commonObjs.clear(),Ce||this.fontLoader.clear(),yn(this,xe,null),this._getFieldObjectsPromise=null,this._hasJSActionsPromise=null}}get loadingParams(){const Ce=this._params;return(0,_util.shadow)(this,"loadingParams",{disableAutoFetch:Ce.disableAutoFetch,enableXfa:Ce.enableXfa})}}He=new WeakMap,Ee=new WeakMap,e=new WeakMap,xe=new WeakMap;class PDFObjects{constructor(){rn(this,_e);rn(this,Te,Object.create(null))}get(Ce,ke=null){if(ke){const Re=fn(this,_e,kl).call(this,Ce);return Re.capability.promise.then(()=>ke(Re.data)),null}const De=Mi(this,Te)[Ce];if(!(De!=null&&De.capability.settled))throw new Error(`Requesting object that isn't resolved yet ${Ce}.`);return De.data}has(Ce){const ke=Mi(this,Te)[Ce];return(ke==null?void 0:ke.capability.settled)||!1}resolve(Ce,ke=null){const De=fn(this,_e,kl).call(this,Ce);De.data=ke,De.capability.resolve()}clear(){yn(this,Te,Object.create(null))}}Te=new WeakMap,_e=new WeakSet,kl=function(Ce){const ke=Mi(this,Te)[Ce];return ke||(Mi(this,Te)[Ce]={capability:(0,_util.createPromiseCapability)(),data:null})};class RenderTask{constructor(Ce){rn(this,t,null);yn(this,t,Ce),this.onContinue=null}get promise(){return Mi(this,t).capability.promise}cancel(){Mi(this,t).cancel()}get separateAnnots(){const{separateAnnots:Ce}=Mi(this,t).operatorList;if(!Ce)return!1;const{annotationCanvasMap:ke}=Mi(this,t);return Ce.form||Ce.canvas&&(ke==null?void 0:ke.size)>0}}t=new WeakMap,exports.RenderTask=RenderTask;const Pe=class{constructor({callback:Ce,params:ke,objs:De,commonObjs:Re,annotationCanvasMap:je,operatorList:We,pageIndex:Ke,canvasFactory:Je,useRequestAnimationFrame:hi=!1,pdfBug:oi=!1,pageColors:ti=null}){this.callback=Ce,this.params=ke,this.objs=De,this.commonObjs=Re,this.annotationCanvasMap=je,this.operatorListIdx=null,this.operatorList=We,this._pageIndex=Ke,this.canvasFactory=Je,this._pdfBug=oi,this.pageColors=ti,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=hi===!0&&typeof window<"u",this.cancelled=!1,this.capability=(0,_util.createPromiseCapability)(),this.task=new RenderTask(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=ke.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:Ce=!1,optionalContentConfig:ke}){var Ke,Je;if(this.cancelled)return;if(this._canvas){if(Mi(Pe,Ae).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");Mi(Pe,Ae).add(this._canvas)}this._pdfBug&&((Ke=globalThis.StepperManager)==null?void 0:Ke.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:De,viewport:Re,transform:je,background:We}=this.params;this.gfx=new _canvas.CanvasGraphics(De,this.commonObjs,this.objs,this.canvasFactory,ke,this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:je,viewport:Re,transparency:Ce,background:We}),this.operatorListIdx=0,this.graphicsReady=!0,(Je=this.graphicsReadyCallback)==null||Je.call(this)}cancel(Ce=null){var ke;this.running=!1,this.cancelled=!0,(ke=this.gfx)==null||ke.endDrawing(),this._canvas&&Mi(Pe,Ae).delete(this._canvas),this.callback(Ce||new _display_utils.RenderingCancelledException(`Rendering cancelled, page ${this._pageIndex+1}`,"canvas"))}operatorListChanged(){var Ce;if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}(Ce=this.stepper)==null||Ce.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?window.requestAnimationFrame(()=>{this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),this._canvas&&Mi(Pe,Ae).delete(this._canvas),this.callback())))}};let InternalRenderTask=Pe;Ae=new WeakMap,rn(InternalRenderTask,Ae,new WeakSet);const version="3.0.279";exports.version=version;const build="d0823066c";exports.build=build},(Ie,r,Me)=>{var e,Ph,Te;Object.defineProperty(r,"__esModule",{value:!0}),r.PrintAnnotationStorage=r.AnnotationStorage=void 0;var Oe=Me(1),Be=Me(4),Ue=Me(8);class He{constructor(){rn(this,e);this._storage=new Map,this._modified=!1,this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(Se,t){const Ae=this._storage.get(Se);return Ae===void 0?t:Object.assign(t,Ae)}getRawValue(Se){return this._storage.get(Se)}remove(Se){if(this._storage.delete(Se),this._storage.size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const t of this._storage.values())if(t instanceof Be.AnnotationEditor)return;this.onAnnotationEditor(null)}}setValue(Se,t){const Ae=this._storage.get(Se);let Pe=!1;if(Ae!==void 0)for(const[St,Ce]of Object.entries(t))Ae[St]!==Ce&&(Pe=!0,Ae[St]=Ce);else Pe=!0,this._storage.set(Se,t);Pe&&fn(this,e,Ph).call(this),t instanceof Be.AnnotationEditor&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(t.constructor._type)}has(Se){return this._storage.has(Se)}getAll(){return this._storage.size>0?(0,Oe.objectFromMap)(this._storage):null}get size(){return this._storage.size}resetModified(){this._modified&&(this._modified=!1,typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new Ee(this)}get serializable(){if(this._storage.size===0)return null;const Se=new Map;for(const[t,Ae]of this._storage){const Pe=Ae instanceof Be.AnnotationEditor?Ae.serialize():Ae;Pe&&Se.set(t,Pe)}return Se}static getHash(Se){if(!Se)return"";const t=new Ue.MurmurHash3_64;for(const[Ae,Pe]of Se)t.update(`${Ae}:${JSON.stringify(Pe)}`);return t.hexdigest()}}e=new WeakSet,Ph=function(){this._modified||(this._modified=!0,typeof this.onSetModified=="function"&&this.onSetModified())},r.AnnotationStorage=He;class Ee extends He{constructor(t){super();rn(this,Te,null);yn(this,Te,structuredClone(t.serializable))}get print(){(0,Oe.unreachable)("Should not call PrintAnnotationStorage.print")}get serializable(){return Mi(this,Te)}}Te=new WeakMap,r.PrintAnnotationStorage=Ee},(Ie,r,Me)=>{var He,Ee,e,xe,Te,_e;Object.defineProperty(r,"__esModule",{value:!0}),r.AnnotationEditor=void 0;var Oe=Me(5),Be=Me(1);const Se=class{constructor(Ae){rn(this,He,this.focusin.bind(this));rn(this,Ee,this.focusout.bind(this));rn(this,e,!1);rn(this,xe,!1);rn(this,Te,!1);rn(this,_e,Se._zIndex++);this.constructor===Se&&(0,Be.unreachable)("Cannot initialize AnnotationEditor."),this.parent=Ae.parent,this.id=Ae.id,this.width=this.height=null,this.pageIndex=Ae.parent.pageIndex,this.name=Ae.name,this.div=null;const[Pe,St]=this.parent.viewportBaseDimensions;this.x=Ae.x/Pe,this.y=Ae.y/St,this.rotation=this.parent.viewport.rotation,this.isAttachedToDOM=!1}static get _defaultLineColor(){return(0,Be.shadow)(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=Mi(this,_e)}focusin(Ae){Mi(this,e)?yn(this,e,!1):this.parent.setSelected(this)}focusout(Ae){if(!this.isAttachedToDOM)return;const Pe=Ae.relatedTarget;Pe!=null&&Pe.closest(`#${this.id}`)||(Ae.preventDefault(),this.parent.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.parent.addToAnnotationStorage(this)}dragstart(Ae){const Pe=this.parent.div.getBoundingClientRect();this.startX=Ae.clientX-Pe.x,this.startY=Ae.clientY-Pe.y,Ae.dataTransfer.setData("text/plain",this.id),Ae.dataTransfer.effectAllowed="move"}setAt(Ae,Pe,St,Ce){const[ke,De]=this.parent.viewportBaseDimensions;[St,Ce]=this.screenToPageTranslation(St,Ce),this.x=(Ae+St)/ke,this.y=(Pe+Ce)/De,this.div.style.left=`${100*this.x}%`,this.div.style.top=`${100*this.y}%`}translate(Ae,Pe){const[St,Ce]=this.parent.viewportBaseDimensions;[Ae,Pe]=this.screenToPageTranslation(Ae,Pe),this.x+=Ae/St,this.y+=Pe/Ce,this.div.style.left=`${100*this.x}%`,this.div.style.top=`${100*this.y}%`}screenToPageTranslation(Ae,Pe){const{rotation:St}=this.parent.viewport;switch(St){case 90:return[Pe,-Ae];case 180:return[-Ae,-Pe];case 270:return[-Pe,Ae];default:return[Ae,Pe]}}setDims(Ae,Pe){const[St,Ce]=this.parent.viewportBaseDimensions;this.div.style.width=`${100*Ae/St}%`,this.div.style.height=`${100*Pe/Ce}%`}fixDims(){const{style:Ae}=this.div,{height:Pe,width:St}=Ae,Ce=St.endsWith("%"),ke=Pe.endsWith("%");if(Ce&&ke)return;const[De,Re]=this.parent.viewportBaseDimensions;Ce||(Ae.width=`${100*parseFloat(St)/De}%`),ke||(Ae.height=`${100*parseFloat(Pe)/Re}%`)}getInitialTranslation(){return[0,0]}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.setAttribute("tabIndex",0),this.setInForeground(),this.div.addEventListener("focusin",Mi(this,He)),this.div.addEventListener("focusout",Mi(this,Ee));const[Ae,Pe]=this.getInitialTranslation();return this.translate(Ae,Pe),(0,Oe.bindEvents)(this,this.div,["dragstart","pointerdown"]),this.div}pointerdown(Ae){const Pe=Oe.KeyboardManager.platform.isMac;if(Ae.button!==0||Ae.ctrlKey&&Pe){Ae.preventDefault();return}Ae.ctrlKey&&!Pe||Ae.shiftKey||Ae.metaKey&&Pe?this.parent.toggleSelected(this):this.parent.setSelected(this),yn(this,e,!0)}getRect(Ae,Pe){const[St,Ce]=this.parent.viewportBaseDimensions,[ke,De]=this.parent.pageDimensions,Re=ke*Ae/St,je=De*Pe/Ce,We=this.x*ke,Ke=this.y*De,Je=this.width*ke,hi=this.height*De;switch(this.rotation){case 0:return[We+Re,De-Ke-je-hi,We+Re+Je,De-Ke-je];case 90:return[We+je,De-Ke+Re,We+je+hi,De-Ke+Re+Je];case 180:return[We-Re-Je,De-Ke+je,We-Re,De-Ke+je+hi];case 270:return[We-je-hi,De-Ke-Re-Je,We-je,De-Ke-Re];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(Ae,Pe){const[St,Ce,ke,De]=Ae,Re=ke-St,je=De-Ce;switch(this.rotation){case 0:return[St,Pe-De,Re,je];case 90:return[St,Pe-Ce,je,Re];case 180:return[ke,Pe-Ce,Re,je];case 270:return[ke,Pe-De,je,Re];default:throw new Error("Invalid rotation")}}onceAdded(){}isEmpty(){return!1}enableEditMode(){yn(this,Te,!0)}disableEditMode(){yn(this,Te,!1)}isInEditMode(){return Mi(this,Te)}shouldGetKeyboardEvents(){return!1}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}rebuild(){var Ae;(Ae=this.div)==null||Ae.addEventListener("focusin",Mi(this,He))}serialize(){(0,Be.unreachable)("An editor must be serializable")}static deserialize(Ae,Pe){const St=new this.prototype.constructor({parent:Pe,id:Pe.getNextId()});St.rotation=Ae.rotation;const[Ce,ke]=Pe.pageDimensions,[De,Re,je,We]=St.getRectInCurrentCoords(Ae.rect,ke);return St.x=De/Ce,St.y=Re/ke,St.width=je/Ce,St.height=We/ke,St}remove(){this.div.removeEventListener("focusin",Mi(this,He)),this.div.removeEventListener("focusout",Mi(this,Ee)),this.isEmpty()||this.commit(),this.parent.remove(this)}select(){var Ae;(Ae=this.div)==null||Ae.classList.add("selectedEditor")}unselect(){var Ae;(Ae=this.div)==null||Ae.classList.remove("selectedEditor")}updateParams(Ae,Pe){}disableEditing(){}enableEditing(){}get propertiesToUpdate(){return{}}get contentDiv(){return this.div}get isEditing(){return Mi(this,xe)}set isEditing(Ae){yn(this,xe,Ae),Ae?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null)}};let Ue=Se;He=new WeakMap,Ee=new WeakMap,e=new WeakMap,xe=new WeakMap,Te=new WeakMap,_e=new WeakMap,qn(Ue,"_colorManager",new Oe.ColorManager),qn(Ue,"_zIndex",1),r.AnnotationEditor=Ue},(Ie,r,Me)=>{var Se,t,Ae,Pe,St,Ce,Eh,je,We,Ke,Je,hi,oi,ti,ai,yi,di,bi,vi,Pi,xi,ni,fi,Si,Xe,Ge,ze,kh,ei,Ll,li,Lh,Ci,Oh,Oi,qr,Ze,za,Qe,Fh,gi,Mh,Ri,Ol,ki,Wa,Ii,Fl;Object.defineProperty(r,"__esModule",{value:!0}),r.KeyboardManager=r.CommandManager=r.ColorManager=r.AnnotationEditorUIManager=void 0,r.bindEvents=Ue,r.opacityToHex=He;var Oe=Me(1),Be=Me(6);function Ue(en,zi,Ji){for(const pn of Ji)zi.addEventListener(pn,en[pn].bind(en))}function He(en){return Math.round(Math.min(255,Math.max(1,255*en))).toString(16).padStart(2,"0")}class Ee{constructor(){rn(this,Se,0)}getId(){return`${Oe.AnnotationEditorPrefix}${El(this,Se)._++}`}}Se=new WeakMap;class e{constructor(zi=128){rn(this,t,[]);rn(this,Ae,!1);rn(this,Pe,void 0);rn(this,St,-1);yn(this,Pe,zi)}add({cmd:zi,undo:Ji,mustExec:pn,type:an=NaN,overwriteIfSameType:kn=!1,keepUndo:xn=!1}){if(pn&&zi(),Mi(this,Ae))return;const Tn={cmd:zi,undo:Ji,type:an};if(Mi(this,St)===-1){Mi(this,t).length>0&&(Mi(this,t).length=0),yn(this,St,0),Mi(this,t).push(Tn);return}if(kn&&Mi(this,t)[Mi(this,St)].type===an){xn&&(Tn.undo=Mi(this,t)[Mi(this,St)].undo),Mi(this,t)[Mi(this,St)]=Tn;return}const Bn=Mi(this,St)+1;Bn===Mi(this,Pe)?Mi(this,t).splice(0,1):(yn(this,St,Bn),Bn<Mi(this,t).length&&Mi(this,t).splice(Bn)),Mi(this,t).push(Tn)}undo(){Mi(this,St)!==-1&&(yn(this,Ae,!0),Mi(this,t)[Mi(this,St)].undo(),yn(this,Ae,!1),yn(this,St,Mi(this,St)-1))}redo(){Mi(this,St)<Mi(this,t).length-1&&(yn(this,St,Mi(this,St)+1),yn(this,Ae,!0),Mi(this,t)[Mi(this,St)].cmd(),yn(this,Ae,!1))}hasSomethingToUndo(){return Mi(this,St)!==-1}hasSomethingToRedo(){return Mi(this,St)<Mi(this,t).length-1}destroy(){yn(this,t,null)}}t=new WeakMap,Ae=new WeakMap,Pe=new WeakMap,St=new WeakMap,r.CommandManager=e;const De=class{constructor(zi){rn(this,Ce);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const Ji=De.platform.isMac;for(const[pn,an]of zi)for(const kn of pn){const xn=kn.startsWith("mac+");Ji&&xn?(this.callbacks.set(kn.slice(4),an),this.allKeys.add(kn.split("+").at(-1))):!Ji&&!xn&&(this.callbacks.set(kn,an),this.allKeys.add(kn.split("+").at(-1)))}}static get platform(){const zi=typeof navigator<"u"?navigator.platform:"";return(0,Oe.shadow)(this,"platform",{isWin:zi.includes("Win"),isMac:zi.includes("Mac")})}exec(zi,Ji){if(!this.allKeys.has(Ji.key))return;const pn=this.callbacks.get(fn(this,Ce,Eh).call(this,Ji));!pn||(pn.bind(zi)(),Ji.stopPropagation(),Ji.preventDefault())}};let xe=De;Ce=new WeakSet,Eh=function(zi){zi.altKey&&this.buffer.push("alt"),zi.ctrlKey&&this.buffer.push("ctrl"),zi.metaKey&&this.buffer.push("meta"),zi.shiftKey&&this.buffer.push("shift"),this.buffer.push(zi.key);const Ji=this.buffer.join("+");return this.buffer.length=0,Ji},r.KeyboardManager=xe;const Re=class{get _colors(){const zi=new Map([["CanvasText",null],["Canvas",null]]);return(0,Be.getColorValues)(zi),(0,Oe.shadow)(this,"_colors",zi)}convert(zi){const Ji=(0,Be.getRGB)(zi);if(!window.matchMedia("(forced-colors: active)").matches)return Ji;for(const[pn,an]of this._colors)if(an.every((kn,xn)=>kn===Ji[xn]))return Re._colorsMapping.get(pn);return Ji}getHexCode(zi){const Ji=this._colors.get(zi);return Ji?Oe.Util.makeHexColor(...Ji):zi}};let Te=Re;qn(Te,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]])),r.ColorManager=Te;const tn=class{constructor(zi,Ji){rn(this,ze);rn(this,ei);rn(this,li);rn(this,Ci);rn(this,Oi);rn(this,Ze);rn(this,Qe);rn(this,gi);rn(this,Ri);rn(this,ki);rn(this,Ii);rn(this,je,null);rn(this,We,new Map);rn(this,Ke,new Map);rn(this,Je,new e);rn(this,hi,0);rn(this,oi,null);rn(this,ti,null);rn(this,ai,new Ee);rn(this,yi,!1);rn(this,di,Oe.AnnotationEditorType.NONE);rn(this,bi,new Set);rn(this,vi,this.copy.bind(this));rn(this,Pi,this.cut.bind(this));rn(this,xi,this.paste.bind(this));rn(this,ni,this.keydown.bind(this));rn(this,fi,this.onEditingAction.bind(this));rn(this,Si,this.onPageChanging.bind(this));rn(this,Xe,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1});rn(this,Ge,null);yn(this,Ge,zi),yn(this,ti,Ji),Mi(this,ti)._on("editingaction",Mi(this,fi)),Mi(this,ti)._on("pagechanging",Mi(this,Si))}destroy(){fn(this,ei,Ll).call(this),Mi(this,ti)._off("editingaction",Mi(this,fi)),Mi(this,ti)._off("pagechanging",Mi(this,Si));for(const zi of Mi(this,Ke).values())zi.destroy();Mi(this,Ke).clear(),Mi(this,We).clear(),yn(this,je,null),Mi(this,bi).clear(),Mi(this,Je).destroy()}onPageChanging({pageNumber:zi}){yn(this,hi,zi-1)}focusMainContainer(){Mi(this,Ge).focus()}copy(zi){if(zi.preventDefault(),Mi(this,je)&&Mi(this,je).commitOrRemove(),!this.hasSelection)return;const Ji=[];for(const pn of Mi(this,bi))pn.isEmpty()||Ji.push(pn.serialize());Ji.length!==0&&zi.clipboardData.setData("application/pdfjs",JSON.stringify(Ji))}cut(zi){this.copy(zi),this.delete()}paste(zi){zi.preventDefault();let Ji=zi.clipboardData.getData("application/pdfjs");if(!Ji)return;try{Ji=JSON.parse(Ji)}catch(an){(0,Oe.warn)(`paste: "${an.message}".`);return}if(!Array.isArray(Ji))return;this.unselectAll();const pn=Mi(this,Ke).get(Mi(this,hi));try{const an=[];for(const Tn of Ji){const Bn=pn.deserialize(Tn);if(!Bn)return;an.push(Bn)}const kn=()=>{for(const Tn of an)fn(this,Ri,Ol).call(this,Tn);fn(this,Ii,Fl).call(this,an)},xn=()=>{for(const Tn of an)Tn.remove()};this.addCommands({cmd:kn,undo:xn,mustExec:!0})}catch(an){(0,Oe.warn)(`paste: "${an.message}".`)}}keydown(zi){var Ji;(Ji=this.getActive())!=null&&Ji.shouldGetKeyboardEvents()||tn._keyboardManager.exec(this,zi)}onEditingAction(zi){["undo","redo","delete","selectAll"].includes(zi.name)&&this[zi.name]()}setEditingState(zi){zi?(fn(this,ze,kh).call(this),fn(this,li,Lh).call(this),fn(this,Oi,qr).call(this,{isEditing:Mi(this,di)!==Oe.AnnotationEditorType.NONE,isEmpty:fn(this,ki,Wa).call(this),hasSomethingToUndo:Mi(this,Je).hasSomethingToUndo(),hasSomethingToRedo:Mi(this,Je).hasSomethingToRedo(),hasSelectedEditor:!1})):(fn(this,ei,Ll).call(this),fn(this,Ci,Oh).call(this),fn(this,Oi,qr).call(this,{isEditing:!1}))}registerEditorTypes(zi){if(!Mi(this,oi)){yn(this,oi,zi);for(const Ji of Mi(this,oi))fn(this,Ze,za).call(this,Ji.defaultPropertiesToUpdate)}}getId(){return Mi(this,ai).getId()}addLayer(zi){Mi(this,Ke).set(zi.pageIndex,zi),Mi(this,yi)?zi.enable():zi.disable()}removeLayer(zi){Mi(this,Ke).delete(zi.pageIndex)}updateMode(zi){if(yn(this,di,zi),zi===Oe.AnnotationEditorType.NONE)this.setEditingState(!1),fn(this,gi,Mh).call(this);else{this.setEditingState(!0),fn(this,Qe,Fh).call(this);for(const Ji of Mi(this,Ke).values())Ji.updateMode(zi)}}updateToolbar(zi){zi!==Mi(this,di)&&Mi(this,ti).dispatch("switchannotationeditormode",{source:this,mode:zi})}updateParams(zi,Ji){if(!!Mi(this,oi)){for(const pn of Mi(this,bi))pn.updateParams(zi,Ji);for(const pn of Mi(this,oi))pn.updateDefaultParams(zi,Ji)}}getEditors(zi){const Ji=[];for(const pn of Mi(this,We).values())pn.pageIndex===zi&&Ji.push(pn);return Ji}getEditor(zi){return Mi(this,We).get(zi)}addEditor(zi){Mi(this,We).set(zi.id,zi)}removeEditor(zi){Mi(this,We).delete(zi.id),this.unselect(zi)}setActiveEditor(zi){Mi(this,je)!==zi&&(yn(this,je,zi),zi&&fn(this,Ze,za).call(this,zi.propertiesToUpdate))}toggleSelected(zi){if(Mi(this,bi).has(zi)){Mi(this,bi).delete(zi),zi.unselect(),fn(this,Oi,qr).call(this,{hasSelectedEditor:this.hasSelection});return}Mi(this,bi).add(zi),zi.select(),fn(this,Ze,za).call(this,zi.propertiesToUpdate),fn(this,Oi,qr).call(this,{hasSelectedEditor:!0})}setSelected(zi){for(const Ji of Mi(this,bi))Ji!==zi&&Ji.unselect();Mi(this,bi).clear(),Mi(this,bi).add(zi),zi.select(),fn(this,Ze,za).call(this,zi.propertiesToUpdate),fn(this,Oi,qr).call(this,{hasSelectedEditor:!0})}isSelected(zi){return Mi(this,bi).has(zi)}unselect(zi){zi.unselect(),Mi(this,bi).delete(zi),fn(this,Oi,qr).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return Mi(this,bi).size!==0}undo(){Mi(this,Je).undo(),fn(this,Oi,qr).call(this,{hasSomethingToUndo:Mi(this,Je).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:fn(this,ki,Wa).call(this)})}redo(){Mi(this,Je).redo(),fn(this,Oi,qr).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:Mi(this,Je).hasSomethingToRedo(),isEmpty:fn(this,ki,Wa).call(this)})}addCommands(zi){Mi(this,Je).add(zi),fn(this,Oi,qr).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:fn(this,ki,Wa).call(this)})}delete(){if(this.commitOrRemove(),!this.hasSelection)return;const zi=[...Mi(this,bi)],Ji=()=>{for(const an of zi)an.remove()},pn=()=>{for(const an of zi)fn(this,Ri,Ol).call(this,an)};this.addCommands({cmd:Ji,undo:pn,mustExec:!0})}commitOrRemove(){var zi;(zi=Mi(this,je))==null||zi.commitOrRemove()}selectAll(){for(const zi of Mi(this,bi))zi.commit();fn(this,Ii,Fl).call(this,Mi(this,We).values())}unselectAll(){if(Mi(this,je)){Mi(this,je).commitOrRemove();return}if(Mi(this,bi).size!==0){for(const zi of Mi(this,bi))zi.unselect();Mi(this,bi).clear(),fn(this,Oi,qr).call(this,{hasSelectedEditor:!1})}}isActive(zi){return Mi(this,je)===zi}getActive(){return Mi(this,je)}getMode(){return Mi(this,di)}};let _e=tn;je=new WeakMap,We=new WeakMap,Ke=new WeakMap,Je=new WeakMap,hi=new WeakMap,oi=new WeakMap,ti=new WeakMap,ai=new WeakMap,yi=new WeakMap,di=new WeakMap,bi=new WeakMap,vi=new WeakMap,Pi=new WeakMap,xi=new WeakMap,ni=new WeakMap,fi=new WeakMap,Si=new WeakMap,Xe=new WeakMap,Ge=new WeakMap,ze=new WeakSet,kh=function(){Mi(this,Ge).addEventListener("keydown",Mi(this,ni))},ei=new WeakSet,Ll=function(){Mi(this,Ge).removeEventListener("keydown",Mi(this,ni))},li=new WeakSet,Lh=function(){document.addEventListener("copy",Mi(this,vi)),document.addEventListener("cut",Mi(this,Pi)),document.addEventListener("paste",Mi(this,xi))},Ci=new WeakSet,Oh=function(){document.removeEventListener("copy",Mi(this,vi)),document.removeEventListener("cut",Mi(this,Pi)),document.removeEventListener("paste",Mi(this,xi))},Oi=new WeakSet,qr=function(zi){Object.entries(zi).some(([pn,an])=>Mi(this,Xe)[pn]!==an)&&Mi(this,ti).dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(Mi(this,Xe),zi)})},Ze=new WeakSet,za=function(zi){Mi(this,ti).dispatch("annotationeditorparamschanged",{source:this,details:zi})},Qe=new WeakSet,Fh=function(){if(!Mi(this,yi)){yn(this,yi,!0);for(const zi of Mi(this,Ke).values())zi.enable()}},gi=new WeakSet,Mh=function(){if(this.unselectAll(),Mi(this,yi)){yn(this,yi,!1);for(const zi of Mi(this,Ke).values())zi.disable()}},Ri=new WeakSet,Ol=function(zi){const Ji=Mi(this,Ke).get(zi.pageIndex);Ji?Ji.addOrRebuild(zi):this.addEditor(zi)},ki=new WeakSet,Wa=function(){if(Mi(this,We).size===0)return!0;if(Mi(this,We).size===1)for(const zi of Mi(this,We).values())return zi.isEmpty();return!1},Ii=new WeakSet,Fl=function(zi){Mi(this,bi).clear();for(const Ji of zi)Ji.isEmpty()||(Mi(this,bi).add(Ji),Ji.select());fn(this,Oi,qr).call(this,{hasSelectedEditor:!0})},qn(_e,"_keyboardManager",new xe([[["ctrl+a","mac+meta+a"],tn.prototype.selectAll],[["ctrl+z","mac+meta+z"],tn.prototype.undo],[["ctrl+y","ctrl+shift+Z","mac+meta+shift+Z"],tn.prototype.redo],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete"],tn.prototype.delete],[["Escape","mac+Escape"],tn.prototype.unselectAll]])),r.AnnotationEditorUIManager=_e},(Ie,r,Me)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.StatTimer=r.RenderingCancelledException=r.PixelsPerInch=r.PageViewport=r.PDFDateString=r.DOMStandardFontDataFactory=r.DOMSVGFactory=r.DOMCanvasFactory=r.DOMCMapReaderFactory=r.AnnotationPrefix=void 0,r.deprecated=We,r.getColorValues=ti,r.getCurrentTransform=ai,r.getCurrentTransformInverse=yi,r.getFilenameFromUrl=Ce,r.getPdfFilenameFromUrl=ke,r.getRGB=oi,r.getXfaPageViewport=hi,r.isDataScheme=Pe,r.isPdfFile=St,r.isValidFetchUrl=Re,r.loadScript=je;var Oe=Me(7),Be=Me(1);const Ue="http://www.w3.org/2000/svg",He="pdfjs_internal_id_";r.AnnotationPrefix=He;const di=class{};let Ee=di;qn(Ee,"CSS",96),qn(Ee,"PDF",72),qn(Ee,"PDF_TO_CSS_UNITS",di.CSS/di.PDF),r.PixelsPerInch=Ee;class e extends Oe.BaseCanvasFactory{constructor({ownerDocument:vi=globalThis.document}={}){super(),this._document=vi}_createCanvas(vi,Pi){const xi=this._document.createElement("canvas");return xi.width=vi,xi.height=Pi,xi}}r.DOMCanvasFactory=e;async function xe(bi,vi=!1){if(Re(bi,document.baseURI)){const Pi=await fetch(bi);if(!Pi.ok)throw new Error(Pi.statusText);return vi?new Uint8Array(await Pi.arrayBuffer()):(0,Be.stringToBytes)(await Pi.text())}return new Promise((Pi,xi)=>{const ni=new XMLHttpRequest;ni.open("GET",bi,!0),vi&&(ni.responseType="arraybuffer"),ni.onreadystatechange=()=>{if(ni.readyState===XMLHttpRequest.DONE){if(ni.status===200||ni.status===0){let fi;if(vi&&ni.response?fi=new Uint8Array(ni.response):!vi&&ni.responseText&&(fi=(0,Be.stringToBytes)(ni.responseText)),fi){Pi(fi);return}}xi(new Error(ni.statusText))}},ni.send(null)})}class Te extends Oe.BaseCMapReaderFactory{_fetchData(vi,Pi){return xe(vi,this.isCompressed).then(xi=>({cMapData:xi,compressionType:Pi}))}}r.DOMCMapReaderFactory=Te;class _e extends Oe.BaseStandardFontDataFactory{_fetchData(vi){return xe(vi,!0)}}r.DOMStandardFontDataFactory=_e;class Se extends Oe.BaseSVGFactory{_createSVG(vi){return document.createElementNS(Ue,vi)}}r.DOMSVGFactory=Se;class t{constructor({viewBox:vi,scale:Pi,rotation:xi,offsetX:ni=0,offsetY:fi=0,dontFlip:Si=!1}){this.viewBox=vi,this.scale=Pi,this.rotation=xi,this.offsetX=ni,this.offsetY=fi;const Xe=(vi[2]+vi[0])/2,Ge=(vi[3]+vi[1])/2;let ze,Ve,ei,si;switch(xi%=360,xi<0&&(xi+=360),xi){case 180:ze=-1,Ve=0,ei=0,si=1;break;case 90:ze=0,Ve=1,ei=1,si=0;break;case 270:ze=0,Ve=-1,ei=-1,si=0;break;case 0:ze=1,Ve=0,ei=0,si=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}Si&&(ei=-ei,si=-si);let li,ci,Ci,Fi;ze===0?(li=Math.abs(Ge-vi[1])*Pi+ni,ci=Math.abs(Xe-vi[0])*Pi+fi,Ci=Math.abs(vi[3]-vi[1])*Pi,Fi=Math.abs(vi[2]-vi[0])*Pi):(li=Math.abs(Xe-vi[0])*Pi+ni,ci=Math.abs(Ge-vi[1])*Pi+fi,Ci=Math.abs(vi[2]-vi[0])*Pi,Fi=Math.abs(vi[3]-vi[1])*Pi),this.transform=[ze*Pi,Ve*Pi,ei*Pi,si*Pi,li-ze*Pi*Xe-ei*Pi*Ge,ci-Ve*Pi*Xe-si*Pi*Ge],this.width=Ci,this.height=Fi}clone({scale:vi=this.scale,rotation:Pi=this.rotation,offsetX:xi=this.offsetX,offsetY:ni=this.offsetY,dontFlip:fi=!1}={}){return new t({viewBox:this.viewBox.slice(),scale:vi,rotation:Pi,offsetX:xi,offsetY:ni,dontFlip:fi})}convertToViewportPoint(vi,Pi){return Be.Util.applyTransform([vi,Pi],this.transform)}convertToViewportRectangle(vi){const Pi=Be.Util.applyTransform([vi[0],vi[1]],this.transform),xi=Be.Util.applyTransform([vi[2],vi[3]],this.transform);return[Pi[0],Pi[1],xi[0],xi[1]]}convertToPdfPoint(vi,Pi){return Be.Util.applyInverseTransform([vi,Pi],this.transform)}}r.PageViewport=t;class Ae extends Be.BaseException{constructor(vi,Pi){super(vi,"RenderingCancelledException"),this.type=Pi}}r.RenderingCancelledException=Ae;function Pe(bi){const vi=bi.length;let Pi=0;for(;Pi<vi&&bi[Pi].trim()==="";)Pi++;return bi.substring(Pi,Pi+5).toLowerCase()==="data:"}function St(bi){return typeof bi=="string"&&/\.pdf$/i.test(bi)}function Ce(bi){const vi=bi.indexOf("#"),Pi=bi.indexOf("?"),xi=Math.min(vi>0?vi:bi.length,Pi>0?Pi:bi.length);return bi.substring(bi.lastIndexOf("/",xi)+1,xi)}function ke(bi,vi="document.pdf"){if(typeof bi!="string")return vi;if(Pe(bi))return(0,Be.warn)('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),vi;const Pi=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,xi=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,ni=Pi.exec(bi);let fi=xi.exec(ni[1])||xi.exec(ni[2])||xi.exec(ni[3]);if(fi&&(fi=fi[0],fi.includes("%")))try{fi=xi.exec(decodeURIComponent(fi))[0]}catch{}return fi||vi}class De{constructor(){this.started=Object.create(null),this.times=[]}time(vi){vi in this.started&&(0,Be.warn)(`Timer is already running for ${vi}`),this.started[vi]=Date.now()}timeEnd(vi){vi in this.started||(0,Be.warn)(`Timer has not been started for ${vi}`),this.times.push({name:vi,start:this.started[vi],end:Date.now()}),delete this.started[vi]}toString(){const vi=[];let Pi=0;for(const xi of this.times){const ni=xi.name;ni.length>Pi&&(Pi=ni.length)}for(const xi of this.times){const ni=xi.end-xi.start;vi.push(`${xi.name.padEnd(Pi)} ${ni}ms
`)}return vi.join("")}}r.StatTimer=De;function Re(bi,vi){try{const{protocol:Pi}=vi?new URL(bi,vi):new URL(bi);return Pi==="http:"||Pi==="https:"}catch{return!1}}function je(bi,vi=!1){return new Promise((Pi,xi)=>{const ni=document.createElement("script");ni.src=bi,ni.onload=function(fi){vi&&ni.remove(),Pi(fi)},ni.onerror=function(){xi(new Error(`Cannot load script at: ${ni.src}`))},(document.head||document.documentElement).append(ni)})}function We(bi){console.log("Deprecated API usage: "+bi)}let Ke;class Je{static toDateObject(vi){if(!vi||typeof vi!="string")return null;Ke||(Ke=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const Pi=Ke.exec(vi);if(!Pi)return null;const xi=parseInt(Pi[1],10);let ni=parseInt(Pi[2],10);ni=ni>=1&&ni<=12?ni-1:0;let fi=parseInt(Pi[3],10);fi=fi>=1&&fi<=31?fi:1;let Si=parseInt(Pi[4],10);Si=Si>=0&&Si<=23?Si:0;let Xe=parseInt(Pi[5],10);Xe=Xe>=0&&Xe<=59?Xe:0;let Ge=parseInt(Pi[6],10);Ge=Ge>=0&&Ge<=59?Ge:0;const ze=Pi[7]||"Z";let Ve=parseInt(Pi[8],10);Ve=Ve>=0&&Ve<=23?Ve:0;let ei=parseInt(Pi[9],10)||0;return ei=ei>=0&&ei<=59?ei:0,ze==="-"?(Si+=Ve,Xe+=ei):ze==="+"&&(Si-=Ve,Xe-=ei),new Date(Date.UTC(xi,ni,fi,Si,Xe,Ge))}}r.PDFDateString=Je;function hi(bi,{scale:vi=1,rotation:Pi=0}){const{width:xi,height:ni}=bi.attributes.style,fi=[0,0,parseInt(xi),parseInt(ni)];return new t({viewBox:fi,scale:vi,rotation:Pi})}function oi(bi){if(bi.startsWith("#")){const vi=parseInt(bi.slice(1),16);return[(vi&16711680)>>16,(vi&65280)>>8,vi&255]}return bi.startsWith("rgb(")?bi.slice(4,-1).split(",").map(vi=>parseInt(vi)):bi.startsWith("rgba(")?bi.slice(5,-1).split(",").map(vi=>parseInt(vi)).slice(0,3):((0,Be.warn)(`Not a valid color format: "${bi}"`),[0,0,0])}function ti(bi){const vi=document.createElement("span");vi.style.visibility="hidden",document.body.append(vi);for(const Pi of bi.keys()){vi.style.color=Pi;const xi=window.getComputedStyle(vi).color;bi.set(Pi,oi(xi))}vi.remove()}function ai(bi){const{a:vi,b:Pi,c:xi,d:ni,e:fi,f:Si}=bi.getTransform();return[vi,Pi,xi,ni,fi,Si]}function yi(bi){const{a:vi,b:Pi,c:xi,d:ni,e:fi,f:Si}=bi.getTransform().invertSelf();return[vi,Pi,xi,ni,fi,Si]}},(Ie,r,Me)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.BaseStandardFontDataFactory=r.BaseSVGFactory=r.BaseCanvasFactory=r.BaseCMapReaderFactory=void 0;var Oe=Me(1);class Be{constructor(){this.constructor===Be&&(0,Oe.unreachable)("Cannot initialize BaseCanvasFactory.")}create(xe,Te){if(xe<=0||Te<=0)throw new Error("Invalid canvas size");const _e=this._createCanvas(xe,Te);return{canvas:_e,context:_e.getContext("2d")}}reset(xe,Te,_e){if(!xe.canvas)throw new Error("Canvas is not specified");if(Te<=0||_e<=0)throw new Error("Invalid canvas size");xe.canvas.width=Te,xe.canvas.height=_e}destroy(xe){if(!xe.canvas)throw new Error("Canvas is not specified");xe.canvas.width=0,xe.canvas.height=0,xe.canvas=null,xe.context=null}_createCanvas(xe,Te){(0,Oe.unreachable)("Abstract method `_createCanvas` called.")}}r.BaseCanvasFactory=Be;class Ue{constructor({baseUrl:xe=null,isCompressed:Te=!1}){this.constructor===Ue&&(0,Oe.unreachable)("Cannot initialize BaseCMapReaderFactory."),this.baseUrl=xe,this.isCompressed=Te}async fetch({name:xe}){if(!this.baseUrl)throw new Error('The CMap "baseUrl" parameter must be specified, ensure that the "cMapUrl" and "cMapPacked" API parameters are provided.');if(!xe)throw new Error("CMap name must be specified.");const Te=this.baseUrl+xe+(this.isCompressed?".bcmap":""),_e=this.isCompressed?Oe.CMapCompressionType.BINARY:Oe.CMapCompressionType.NONE;return this._fetchData(Te,_e).catch(Se=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${Te}`)})}_fetchData(xe,Te){(0,Oe.unreachable)("Abstract method `_fetchData` called.")}}r.BaseCMapReaderFactory=Ue;class He{constructor({baseUrl:xe=null}){this.constructor===He&&(0,Oe.unreachable)("Cannot initialize BaseStandardFontDataFactory."),this.baseUrl=xe}async fetch({filename:xe}){if(!this.baseUrl)throw new Error('The standard font "baseUrl" parameter must be specified, ensure that the "standardFontDataUrl" API parameter is provided.');if(!xe)throw new Error("Font filename must be specified.");const Te=`${this.baseUrl}${xe}`;return this._fetchData(Te).catch(_e=>{throw new Error(`Unable to load font data at: ${Te}`)})}_fetchData(xe){(0,Oe.unreachable)("Abstract method `_fetchData` called.")}}r.BaseStandardFontDataFactory=He;class Ee{constructor(){this.constructor===Ee&&(0,Oe.unreachable)("Cannot initialize BaseSVGFactory.")}create(xe,Te,_e=!1){if(xe<=0||Te<=0)throw new Error("Invalid SVG dimensions");const Se=this._createSVG("svg:svg");return Se.setAttribute("version","1.1"),_e||(Se.setAttribute("width",`${xe}px`),Se.setAttribute("height",`${Te}px`)),Se.setAttribute("preserveAspectRatio","none"),Se.setAttribute("viewBox",`0 0 ${xe} ${Te}`),Se}createElement(xe){if(typeof xe!="string")throw new Error("Invalid SVG element type");return this._createSVG(xe)}_createSVG(xe){(0,Oe.unreachable)("Abstract method `_createSVG` called.")}}r.BaseSVGFactory=Ee},(Ie,r,Me)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.MurmurHash3_64=void 0;var Oe=Me(1);const Be=3285377520,Ue=4294901760,He=65535;class Ee{constructor(xe){this.h1=xe?xe&4294967295:Be,this.h2=xe?xe&4294967295:Be}update(xe){let Te,_e;if(typeof xe=="string"){Te=new Uint8Array(xe.length*2),_e=0;for(let Ke=0,Je=xe.length;Ke<Je;Ke++){const hi=xe.charCodeAt(Ke);hi<=255?Te[_e++]=hi:(Te[_e++]=hi>>>8,Te[_e++]=hi&255)}}else if((0,Oe.isArrayBuffer)(xe))Te=xe.slice(),_e=Te.byteLength;else throw new Error("Wrong data format in MurmurHash3_64_update. Input must be a string or array.");const Se=_e>>2,t=_e-Se*4,Ae=new Uint32Array(Te.buffer,0,Se);let Pe=0,St=0,Ce=this.h1,ke=this.h2;const De=3432918353,Re=461845907,je=De&He,We=Re&He;for(let Ke=0;Ke<Se;Ke++)Ke&1?(Pe=Ae[Ke],Pe=Pe*De&Ue|Pe*je&He,Pe=Pe<<15|Pe>>>17,Pe=Pe*Re&Ue|Pe*We&He,Ce^=Pe,Ce=Ce<<13|Ce>>>19,Ce=Ce*5+3864292196):(St=Ae[Ke],St=St*De&Ue|St*je&He,St=St<<15|St>>>17,St=St*Re&Ue|St*We&He,ke^=St,ke=ke<<13|ke>>>19,ke=ke*5+3864292196);switch(Pe=0,t){case 3:Pe^=Te[Se*4+2]<<16;case 2:Pe^=Te[Se*4+1]<<8;case 1:Pe^=Te[Se*4],Pe=Pe*De&Ue|Pe*je&He,Pe=Pe<<15|Pe>>>17,Pe=Pe*Re&Ue|Pe*We&He,Se&1?Ce^=Pe:ke^=Pe}this.h1=Ce,this.h2=ke}hexdigest(){let xe=this.h1,Te=this.h2;xe^=Te>>>1,xe=xe*3981806797&Ue|xe*36045&He,Te=Te*4283543511&Ue|((Te<<16|xe>>>16)*2950163797&Ue)>>>16,xe^=Te>>>1,xe=xe*444984403&Ue|xe*60499&He,Te=Te*3301882366&Ue|((Te<<16|xe>>>16)*3120437893&Ue)>>>16,xe^=Te>>>1;const _e=(xe>>>0).toString(16),Se=(Te>>>0).toString(16);return _e.padStart(8,"0")+Se.padStart(8,"0")}}r.MurmurHash3_64=Ee},(Ie,r,Me)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.FontLoader=r.FontFaceObject=void 0;var Oe=Me(1);class Be{constructor({onUnsupportedFeature:Ee,ownerDocument:e=globalThis.document,styleElement:xe=null}){this._onUnsupportedFeature=Ee,this._document=e,this.nativeFontFaces=[],this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(Ee){this.nativeFontFaces.push(Ee),this._document.fonts.add(Ee)}insertRule(Ee){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const e=this.styleElement.sheet;e.insertRule(Ee,e.cssRules.length)}clear(){for(const Ee of this.nativeFontFaces)this._document.fonts.delete(Ee);this.nativeFontFaces.length=0,this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async bind(Ee){if(Ee.attached||Ee.missingFile)return;if(Ee.attached=!0,this.isFontLoadingAPISupported){const xe=Ee.createNativeFontFace();if(xe){this.addNativeFontFace(xe);try{await xe.loaded}catch(Te){throw this._onUnsupportedFeature({featureId:Oe.UNSUPPORTED_FEATURES.errorFontLoadNative}),(0,Oe.warn)(`Failed to load font '${xe.family}': '${Te}'.`),Ee.disableFontFace=!0,Te}}return}const e=Ee.createFontFaceRule();if(e){if(this.insertRule(e),this.isSyncFontLoadingSupported)return;await new Promise(xe=>{const Te=this._queueLoadingCallback(xe);this._prepareFontLoadEvent(Ee,Te)})}}get isFontLoadingAPISupported(){var e;const Ee=!!((e=this._document)!=null&&e.fonts);return(0,Oe.shadow)(this,"isFontLoadingAPISupported",Ee)}get isSyncFontLoadingSupported(){let Ee=!1;if(typeof navigator>"u")Ee=!0;else{const e=/Mozilla\/5.0.*?rv:(\d+).*? Gecko/.exec(navigator.userAgent);(e==null?void 0:e[1])>=14&&(Ee=!0)}return(0,Oe.shadow)(this,"isSyncFontLoadingSupported",Ee)}_queueLoadingCallback(Ee){function e(){for((0,Oe.assert)(!Te.done,"completeRequest() cannot be called twice."),Te.done=!0;xe.length>0&&xe[0].done;){const _e=xe.shift();setTimeout(_e.callback,0)}}const{loadingRequests:xe}=this,Te={done:!1,complete:e,callback:Ee};return xe.push(Te),Te}get _loadTestFont(){const Ee=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return(0,Oe.shadow)(this,"_loadTestFont",Ee)}_prepareFontLoadEvent(Ee,e){function xe(oi,ti){return oi.charCodeAt(ti)<<24|oi.charCodeAt(ti+1)<<16|oi.charCodeAt(ti+2)<<8|oi.charCodeAt(ti+3)&255}function Te(oi,ti,ai,yi){const di=oi.substring(0,ti),bi=oi.substring(ti+ai);return di+yi+bi}let _e,Se;const t=this._document.createElement("canvas");t.width=1,t.height=1;const Ae=t.getContext("2d");let Pe=0;function St(oi,ti){if(++Pe>30){(0,Oe.warn)("Load test font never loaded."),ti();return}if(Ae.font="30px "+oi,Ae.fillText(".",0,20),Ae.getImageData(0,0,1,1).data[3]>0){ti();return}setTimeout(St.bind(null,oi,ti))}const Ce=`lt${Date.now()}${this.loadTestFontId++}`;let ke=this._loadTestFont;ke=Te(ke,976,Ce.length,Ce);const Re=16,je=1482184792;let We=xe(ke,Re);for(_e=0,Se=Ce.length-3;_e<Se;_e+=4)We=We-je+xe(Ce,_e)|0;_e<Ce.length&&(We=We-je+xe(Ce+"XXX",_e)|0),ke=Te(ke,Re,4,(0,Oe.string32)(We));const Ke=`url(data:font/opentype;base64,${btoa(ke)});`,Je=`@font-face {font-family:"${Ce}";src:${Ke}}`;this.insertRule(Je);const hi=this._document.createElement("div");hi.style.visibility="hidden",hi.style.width=hi.style.height="10px",hi.style.position="absolute",hi.style.top=hi.style.left="0px";for(const oi of[Ee.loadedName,Ce]){const ti=this._document.createElement("span");ti.textContent="Hi",ti.style.fontFamily=oi,hi.append(ti)}this._document.body.append(hi),St(Ce,()=>{hi.remove(),e.complete()})}}r.FontLoader=Be;class Ue{constructor(Ee,{isEvalSupported:e=!0,disableFontFace:xe=!1,ignoreErrors:Te=!1,onUnsupportedFeature:_e,fontRegistry:Se=null}){this.compiledGlyphs=Object.create(null);for(const t in Ee)this[t]=Ee[t];this.isEvalSupported=e!==!1,this.disableFontFace=xe===!0,this.ignoreErrors=Te===!0,this._onUnsupportedFeature=_e,this.fontRegistry=Se}createNativeFontFace(){var e;if(!this.data||this.disableFontFace)return null;let Ee;if(!this.cssFontInfo)Ee=new FontFace(this.loadedName,this.data,{});else{const xe={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(xe.style=`oblique ${this.cssFontInfo.italicAngle}deg`),Ee=new FontFace(this.cssFontInfo.fontFamily,this.data,xe)}return(e=this.fontRegistry)==null||e.registerFont(this),Ee}createFontFaceRule(){var Te;if(!this.data||this.disableFontFace)return null;const Ee=(0,Oe.bytesToString)(this.data),e=`url(data:${this.mimetype};base64,${btoa(Ee)});`;let xe;if(!this.cssFontInfo)xe=`@font-face {font-family:"${this.loadedName}";src:${e}}`;else{let _e=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(_e+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),xe=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${_e}src:${e}}`}return(Te=this.fontRegistry)==null||Te.registerFont(this,e),xe}getPathGenerator(Ee,e){if(this.compiledGlyphs[e]!==void 0)return this.compiledGlyphs[e];let xe;try{xe=Ee.get(this.loadedName+"_path_"+e)}catch(Te){if(!this.ignoreErrors)throw Te;return this._onUnsupportedFeature({featureId:Oe.UNSUPPORTED_FEATURES.errorFontGetPath}),(0,Oe.warn)(`getPathGenerator - ignoring character: "${Te}".`),this.compiledGlyphs[e]=function(_e,Se){}}if(this.isEvalSupported&&Oe.FeatureTest.isEvalSupported){const Te=[];for(const _e of xe){const Se=_e.args!==void 0?_e.args.join(","):"";Te.push("c.",_e.cmd,"(",Se,`);
`)}return this.compiledGlyphs[e]=new Function("c","size",Te.join(""))}return this.compiledGlyphs[e]=function(Te,_e){for(const Se of xe)Se.cmd==="scale"&&(Se.args=[_e,-_e]),Te[Se.cmd].apply(Te,Se.args)}}}r.FontFaceObject=Ue},(Ie,r,Me)=>{var ni,Ml;Object.defineProperty(r,"__esModule",{value:!0}),r.CanvasGraphics=void 0;var Oe=Me(1),Be=Me(6),Ue=Me(11),He=Me(13),Ee=Me(12);const e=16,xe=100,Te=4096,_e=15,Se=10,t=Ee.isNodeJS&&typeof Path2D>"u"?-1:1e3,Ae=16;function Pe(Xe,Ge){if(Xe._removeMirroring)throw new Error("Context is already forwarding operations.");Xe.__originalSave=Xe.save,Xe.__originalRestore=Xe.restore,Xe.__originalRotate=Xe.rotate,Xe.__originalScale=Xe.scale,Xe.__originalTranslate=Xe.translate,Xe.__originalTransform=Xe.transform,Xe.__originalSetTransform=Xe.setTransform,Xe.__originalResetTransform=Xe.resetTransform,Xe.__originalClip=Xe.clip,Xe.__originalMoveTo=Xe.moveTo,Xe.__originalLineTo=Xe.lineTo,Xe.__originalBezierCurveTo=Xe.bezierCurveTo,Xe.__originalRect=Xe.rect,Xe.__originalClosePath=Xe.closePath,Xe.__originalBeginPath=Xe.beginPath,Xe._removeMirroring=()=>{Xe.save=Xe.__originalSave,Xe.restore=Xe.__originalRestore,Xe.rotate=Xe.__originalRotate,Xe.scale=Xe.__originalScale,Xe.translate=Xe.__originalTranslate,Xe.transform=Xe.__originalTransform,Xe.setTransform=Xe.__originalSetTransform,Xe.resetTransform=Xe.__originalResetTransform,Xe.clip=Xe.__originalClip,Xe.moveTo=Xe.__originalMoveTo,Xe.lineTo=Xe.__originalLineTo,Xe.bezierCurveTo=Xe.__originalBezierCurveTo,Xe.rect=Xe.__originalRect,Xe.closePath=Xe.__originalClosePath,Xe.beginPath=Xe.__originalBeginPath,delete Xe._removeMirroring},Xe.save=function(){Ge.save(),this.__originalSave()},Xe.restore=function(){Ge.restore(),this.__originalRestore()},Xe.translate=function(Ve,ei){Ge.translate(Ve,ei),this.__originalTranslate(Ve,ei)},Xe.scale=function(Ve,ei){Ge.scale(Ve,ei),this.__originalScale(Ve,ei)},Xe.transform=function(Ve,ei,si,li,ci,Ci){Ge.transform(Ve,ei,si,li,ci,Ci),this.__originalTransform(Ve,ei,si,li,ci,Ci)},Xe.setTransform=function(Ve,ei,si,li,ci,Ci){Ge.setTransform(Ve,ei,si,li,ci,Ci),this.__originalSetTransform(Ve,ei,si,li,ci,Ci)},Xe.resetTransform=function(){Ge.resetTransform(),this.__originalResetTransform()},Xe.rotate=function(Ve){Ge.rotate(Ve),this.__originalRotate(Ve)},Xe.clip=function(Ve){Ge.clip(Ve),this.__originalClip(Ve)},Xe.moveTo=function(ze,Ve){Ge.moveTo(ze,Ve),this.__originalMoveTo(ze,Ve)},Xe.lineTo=function(ze,Ve){Ge.lineTo(ze,Ve),this.__originalLineTo(ze,Ve)},Xe.bezierCurveTo=function(ze,Ve,ei,si,li,ci){Ge.bezierCurveTo(ze,Ve,ei,si,li,ci),this.__originalBezierCurveTo(ze,Ve,ei,si,li,ci)},Xe.rect=function(ze,Ve,ei,si){Ge.rect(ze,Ve,ei,si),this.__originalRect(ze,Ve,ei,si)},Xe.closePath=function(){Ge.closePath(),this.__originalClosePath()},Xe.beginPath=function(){Ge.beginPath(),this.__originalBeginPath()}}class St{constructor(Ge){this.canvasFactory=Ge,this.cache=Object.create(null)}getCanvas(Ge,ze,Ve){let ei;return this.cache[Ge]!==void 0?(ei=this.cache[Ge],this.canvasFactory.reset(ei,ze,Ve)):(ei=this.canvasFactory.create(ze,Ve),this.cache[Ge]=ei),ei}delete(Ge){delete this.cache[Ge]}clear(){for(const Ge in this.cache){const ze=this.cache[Ge];this.canvasFactory.destroy(ze),delete this.cache[Ge]}}}function Ce(Xe,Ge,ze,Ve,ei,si,li,ci,Ci,Fi){const[Oi,Ti,Ze,ii,Qe,ui]=(0,Be.getCurrentTransform)(Xe);if(Ti===0&&Ze===0){const Ri=li*Oi+Qe,Ui=Math.round(Ri),ki=ci*ii+ui,Vi=Math.round(ki),Ii=(li+Ci)*Oi+Qe,$i=Math.abs(Math.round(Ii)-Ui)||1,tn=(ci+Fi)*ii+ui,en=Math.abs(Math.round(tn)-Vi)||1;return Xe.setTransform(Math.sign(Oi),0,0,Math.sign(ii),Ui,Vi),Xe.drawImage(Ge,ze,Ve,ei,si,0,0,$i,en),Xe.setTransform(Oi,Ti,Ze,ii,Qe,ui),[$i,en]}if(Oi===0&&ii===0){const Ri=ci*Ze+Qe,Ui=Math.round(Ri),ki=li*Ti+ui,Vi=Math.round(ki),Ii=(ci+Fi)*Ze+Qe,$i=Math.abs(Math.round(Ii)-Ui)||1,tn=(li+Ci)*Ti+ui,en=Math.abs(Math.round(tn)-Vi)||1;return Xe.setTransform(0,Math.sign(Ti),Math.sign(Ze),0,Ui,Vi),Xe.drawImage(Ge,ze,Ve,ei,si,0,0,en,$i),Xe.setTransform(Oi,Ti,Ze,ii,Qe,ui),[en,$i]}Xe.drawImage(Ge,ze,Ve,ei,si,li,ci,Ci,Fi);const gi=Math.hypot(Oi,Ti),_i=Math.hypot(Ze,ii);return[gi*Ci,_i*Fi]}function ke(Xe){const{width:Ge,height:ze}=Xe;if(Ge>t||ze>t)return null;const Ve=1e3,ei=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),si=Ge+1;let li=new Uint8Array(si*(ze+1)),ci,Ci,Fi;const Oi=Ge+7&-8;let Ti=new Uint8Array(Oi*ze),Ze=0;for(const _i of Xe.data){let Ri=128;for(;Ri>0;)Ti[Ze++]=_i&Ri?0:255,Ri>>=1}let ii=0;for(Ze=0,Ti[Ze]!==0&&(li[0]=1,++ii),Ci=1;Ci<Ge;Ci++)Ti[Ze]!==Ti[Ze+1]&&(li[Ci]=Ti[Ze]?2:1,++ii),Ze++;for(Ti[Ze]!==0&&(li[Ci]=2,++ii),ci=1;ci<ze;ci++){Ze=ci*Oi,Fi=ci*si,Ti[Ze-Oi]!==Ti[Ze]&&(li[Fi]=Ti[Ze]?1:8,++ii);let _i=(Ti[Ze]?4:0)+(Ti[Ze-Oi]?8:0);for(Ci=1;Ci<Ge;Ci++)_i=(_i>>2)+(Ti[Ze+1]?4:0)+(Ti[Ze-Oi+1]?8:0),ei[_i]&&(li[Fi+Ci]=ei[_i],++ii),Ze++;if(Ti[Ze-Oi]!==Ti[Ze]&&(li[Fi+Ci]=Ti[Ze]?2:4,++ii),ii>Ve)return null}for(Ze=Oi*(ze-1),Fi=ci*si,Ti[Ze]!==0&&(li[Fi]=8,++ii),Ci=1;Ci<Ge;Ci++)Ti[Ze]!==Ti[Ze+1]&&(li[Fi+Ci]=Ti[Ze]?4:8,++ii),Ze++;if(Ti[Ze]!==0&&(li[Fi+Ci]=4,++ii),ii>Ve)return null;const Qe=new Int32Array([0,si,-1,0,-si,0,0,0,1]),ui=new Path2D;for(ci=0;ii&&ci<=ze;ci++){let _i=ci*si;const Ri=_i+Ge;for(;_i<Ri&&!li[_i];)_i++;if(_i===Ri)continue;ui.moveTo(_i%si,ci);const Ui=_i;let ki=li[_i];do{const Vi=Qe[ki];do _i+=Vi;while(!li[_i]);const Ii=li[_i];Ii!==5&&Ii!==10?(ki=Ii,li[_i]=0):(ki=Ii&51*ki>>4,li[_i]&=ki>>2|ki<<2),ui.lineTo(_i%si,_i/si|0),li[_i]||--ii}while(Ui!==_i);--ci}return Ti=null,li=null,function(_i){_i.save(),_i.scale(1/Ge,-1/ze),_i.translate(0,-ze),_i.fill(ui),_i.beginPath(),_i.restore()}}class De{constructor(Ge,ze){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=Oe.IDENTITY_MATRIX,this.textMatrixScale=1,this.fontMatrix=Oe.FONT_IDENTITY_MATRIX,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=Oe.TextRenderingMode.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps=null,this.startNewPathAndClipBox([0,0,Ge,ze])}clone(){const Ge=Object.create(this);return Ge.clipBox=this.clipBox.slice(),Ge}setCurrentPoint(Ge,ze){this.x=Ge,this.y=ze}updatePathMinMax(Ge,ze,Ve){[ze,Ve]=Oe.Util.applyTransform([ze,Ve],Ge),this.minX=Math.min(this.minX,ze),this.minY=Math.min(this.minY,Ve),this.maxX=Math.max(this.maxX,ze),this.maxY=Math.max(this.maxY,Ve)}updateRectMinMax(Ge,ze){const Ve=Oe.Util.applyTransform(ze,Ge),ei=Oe.Util.applyTransform(ze.slice(2),Ge);this.minX=Math.min(this.minX,Ve[0],ei[0]),this.minY=Math.min(this.minY,Ve[1],ei[1]),this.maxX=Math.max(this.maxX,Ve[0],ei[0]),this.maxY=Math.max(this.maxY,Ve[1],ei[1])}updateScalingPathMinMax(Ge,ze){Oe.Util.scaleMinMax(Ge,ze),this.minX=Math.min(this.minX,ze[0]),this.maxX=Math.max(this.maxX,ze[1]),this.minY=Math.min(this.minY,ze[2]),this.maxY=Math.max(this.maxY,ze[3])}updateCurvePathMinMax(Ge,ze,Ve,ei,si,li,ci,Ci,Fi,Oi){const Ti=Oe.Util.bezierBoundingBox(ze,Ve,ei,si,li,ci,Ci,Fi);if(Oi){Oi[0]=Math.min(Oi[0],Ti[0],Ti[2]),Oi[1]=Math.max(Oi[1],Ti[0],Ti[2]),Oi[2]=Math.min(Oi[2],Ti[1],Ti[3]),Oi[3]=Math.max(Oi[3],Ti[1],Ti[3]);return}this.updateRectMinMax(Ge,Ti)}getPathBoundingBox(Ge=Ue.PathType.FILL,ze=null){const Ve=[this.minX,this.minY,this.maxX,this.maxY];if(Ge===Ue.PathType.STROKE){ze||(0,Oe.unreachable)("Stroke bounding box must include transform.");const ei=Oe.Util.singularValueDecompose2dScale(ze),si=ei[0]*this.lineWidth/2,li=ei[1]*this.lineWidth/2;Ve[0]-=si,Ve[1]-=li,Ve[2]+=si,Ve[3]+=li}return Ve}updateClipFromPath(){const Ge=Oe.Util.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(Ge||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(Ge){this.clipBox=Ge,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(Ge=Ue.PathType.FILL,ze=null){return Oe.Util.intersect(this.clipBox,this.getPathBoundingBox(Ge,ze))}}function Re(Xe,Ge,ze=null){if(typeof ImageData<"u"&&Ge instanceof ImageData){Xe.putImageData(Ge,0,0);return}const Ve=Ge.height,ei=Ge.width,si=Ve%Ae,li=(Ve-si)/Ae,ci=si===0?li:li+1,Ci=Xe.createImageData(ei,Ae);let Fi=0,Oi;const Ti=Ge.data,Ze=Ci.data;let ii,Qe,ui,gi,_i,Ri,Ui,ki;if(ze)switch(ze.length){case 1:_i=ze[0],Ri=ze[0],Ui=ze[0],ki=ze[0];break;case 4:_i=ze[0],Ri=ze[1],Ui=ze[2],ki=ze[3];break}if(Ge.kind===Oe.ImageKind.GRAYSCALE_1BPP){const Vi=Ti.byteLength,Ii=new Uint32Array(Ze.buffer,0,Ze.byteLength>>2),$i=Ii.length,tn=ei+7>>3;let en=4294967295,zi=Oe.FeatureTest.isLittleEndian?4278190080:255;for(ki&&ki[0]===255&&ki[255]===0&&([en,zi]=[zi,en]),ii=0;ii<ci;ii++){for(ui=ii<li?Ae:si,Oi=0,Qe=0;Qe<ui;Qe++){const Ji=Vi-Fi;let pn=0;const an=Ji>tn?ei:Ji*8-7,kn=an&-8;let xn=0,Tn=0;for(;pn<kn;pn+=8)Tn=Ti[Fi++],Ii[Oi++]=Tn&128?en:zi,Ii[Oi++]=Tn&64?en:zi,Ii[Oi++]=Tn&32?en:zi,Ii[Oi++]=Tn&16?en:zi,Ii[Oi++]=Tn&8?en:zi,Ii[Oi++]=Tn&4?en:zi,Ii[Oi++]=Tn&2?en:zi,Ii[Oi++]=Tn&1?en:zi;for(;pn<an;pn++)xn===0&&(Tn=Ti[Fi++],xn=128),Ii[Oi++]=Tn&xn?en:zi,xn>>=1}for(;Oi<$i;)Ii[Oi++]=0;Xe.putImageData(Ci,0,ii*Ae)}}else if(Ge.kind===Oe.ImageKind.RGBA_32BPP){const Vi=!!(_i||Ri||Ui);for(Qe=0,gi=ei*Ae*4,ii=0;ii<li;ii++){if(Ze.set(Ti.subarray(Fi,Fi+gi)),Fi+=gi,Vi)for(let Ii=0;Ii<gi;Ii+=4)_i&&(Ze[Ii+0]=_i[Ze[Ii+0]]),Ri&&(Ze[Ii+1]=Ri[Ze[Ii+1]]),Ui&&(Ze[Ii+2]=Ui[Ze[Ii+2]]);Xe.putImageData(Ci,0,Qe),Qe+=Ae}if(ii<ci){if(gi=ei*si*4,Ze.set(Ti.subarray(Fi,Fi+gi)),Vi)for(let Ii=0;Ii<gi;Ii+=4)_i&&(Ze[Ii+0]=_i[Ze[Ii+0]]),Ri&&(Ze[Ii+1]=Ri[Ze[Ii+1]]),Ui&&(Ze[Ii+2]=Ui[Ze[Ii+2]]);Xe.putImageData(Ci,0,Qe)}}else if(Ge.kind===Oe.ImageKind.RGB_24BPP){const Vi=!!(_i||Ri||Ui);for(ui=Ae,gi=ei*ui,ii=0;ii<ci;ii++){for(ii>=li&&(ui=si,gi=ei*ui),Oi=0,Qe=gi;Qe--;)Ze[Oi++]=Ti[Fi++],Ze[Oi++]=Ti[Fi++],Ze[Oi++]=Ti[Fi++],Ze[Oi++]=255;if(Vi)for(let Ii=0;Ii<Oi;Ii+=4)_i&&(Ze[Ii+0]=_i[Ze[Ii+0]]),Ri&&(Ze[Ii+1]=Ri[Ze[Ii+1]]),Ui&&(Ze[Ii+2]=Ui[Ze[Ii+2]]);Xe.putImageData(Ci,0,ii*Ae)}}else throw new Error(`bad image kind: ${Ge.kind}`)}function je(Xe,Ge){if(Ge.bitmap){Xe.drawImage(Ge.bitmap,0,0);return}const ze=Ge.height,Ve=Ge.width,ei=ze%Ae,si=(ze-ei)/Ae,li=ei===0?si:si+1,ci=Xe.createImageData(Ve,Ae);let Ci=0;const Fi=Ge.data,Oi=ci.data;for(let Ti=0;Ti<li;Ti++){const Ze=Ti<si?Ae:ei;({srcPos:Ci}=(0,He.applyMaskImageData)({src:Fi,srcPos:Ci,dest:Oi,width:Ve,height:Ze})),Xe.putImageData(ci,0,Ti*Ae)}}function We(Xe,Ge){const ze=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font"];for(const Ve of ze)Xe[Ve]!==void 0&&(Ge[Ve]=Xe[Ve]);Xe.setLineDash!==void 0&&(Ge.setLineDash(Xe.getLineDash()),Ge.lineDashOffset=Xe.lineDashOffset)}function Ke(Xe,Ge){Xe.strokeStyle=Xe.fillStyle=Ge||"#000000",Xe.fillRule="nonzero",Xe.globalAlpha=1,Xe.lineWidth=1,Xe.lineCap="butt",Xe.lineJoin="miter",Xe.miterLimit=10,Xe.globalCompositeOperation="source-over",Xe.font="10px sans-serif",Xe.setLineDash!==void 0&&(Xe.setLineDash([]),Xe.lineDashOffset=0)}function Je(Xe,Ge,ze,Ve){const ei=Xe.length;for(let si=3;si<ei;si+=4){const li=Xe[si];if(li===0)Xe[si-3]=Ge,Xe[si-2]=ze,Xe[si-1]=Ve;else if(li<255){const ci=255-li;Xe[si-3]=Xe[si-3]*li+Ge*ci>>8,Xe[si-2]=Xe[si-2]*li+ze*ci>>8,Xe[si-1]=Xe[si-1]*li+Ve*ci>>8}}}function hi(Xe,Ge,ze){const Ve=Xe.length,ei=1/255;for(let si=3;si<Ve;si+=4){const li=ze?ze[Xe[si]]:Xe[si];Ge[si]=Ge[si]*li*ei|0}}function oi(Xe,Ge,ze){const Ve=Xe.length;for(let ei=3;ei<Ve;ei+=4){const si=Xe[ei-3]*77+Xe[ei-2]*152+Xe[ei-1]*28;Ge[ei]=ze?Ge[ei]*ze[si>>8]>>8:Ge[ei]*si>>16}}function ti(Xe,Ge,ze,Ve,ei,si,li,ci,Ci,Fi,Oi){const Ti=!!si,Ze=Ti?si[0]:0,ii=Ti?si[1]:0,Qe=Ti?si[2]:0;let ui;ei==="Luminosity"?ui=oi:ui=hi;const _i=Math.min(Ve,Math.ceil(1048576/ze));for(let Ri=0;Ri<Ve;Ri+=_i){const Ui=Math.min(_i,Ve-Ri),ki=Xe.getImageData(ci-Fi,Ri+(Ci-Oi),ze,Ui),Vi=Ge.getImageData(ci,Ri+Ci,ze,Ui);Ti&&Je(ki.data,Ze,ii,Qe),ui(ki.data,Vi.data,li),Ge.putImageData(Vi,ci,Ri+Ci)}}function ai(Xe,Ge,ze,Ve){const ei=Ve[0],si=Ve[1],li=Ve[2]-ei,ci=Ve[3]-si;li===0||ci===0||(ti(Ge.context,ze,li,ci,Ge.subtype,Ge.backdrop,Ge.transferMap,ei,si,Ge.offsetX,Ge.offsetY),Xe.save(),Xe.globalAlpha=1,Xe.globalCompositeOperation="source-over",Xe.setTransform(1,0,0,1,0,0),Xe.drawImage(ze.canvas,0,0),Xe.restore())}function yi(Xe,Ge){const ze=Oe.Util.singularValueDecompose2dScale(Xe);ze[0]=Math.fround(ze[0]),ze[1]=Math.fround(ze[1]);const Ve=Math.fround((globalThis.devicePixelRatio||1)*Be.PixelsPerInch.PDF_TO_CSS_UNITS);return Ge!==void 0?Ge:ze[0]<=Ve||ze[1]<=Ve}const di=["butt","round","square"],bi=["miter","round","bevel"],vi={},Pi={},Si=class{constructor(Ge,ze,Ve,ei,si,li,ci){rn(this,ni);this.ctx=Ge,this.current=new De(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=ze,this.objs=Ve,this.canvasFactory=ei,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=[],this.optionalContentConfig=si,this.cachedCanvases=new St(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=li,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.backgroundColor=(ci==null?void 0:ci.background)||null,this.foregroundColor=(ci==null?void 0:ci.foreground)||null,this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(Ge,ze=null){return typeof Ge=="string"?Ge.startsWith("g_")?this.commonObjs.get(Ge):this.objs.get(Ge):ze}beginDrawing({transform:Ge,viewport:ze,transparency:Ve=!1,background:ei=null}){const si=this.ctx.canvas.width,li=this.ctx.canvas.height,ci=ei||"#ffffff";if(this.ctx.save(),this.foregroundColor&&this.backgroundColor){this.ctx.fillStyle=this.foregroundColor;const Ci=this.foregroundColor=this.ctx.fillStyle;this.ctx.fillStyle=this.backgroundColor;const Fi=this.backgroundColor=this.ctx.fillStyle;let Oi=!0,Ti=ci;if(this.ctx.fillStyle=ci,Ti=this.ctx.fillStyle,Oi=typeof Ti=="string"&&/^#[0-9A-Fa-f]{6}$/.test(Ti),Ci==="#000000"&&Fi==="#ffffff"||Ci===Fi||!Oi)this.foregroundColor=this.backgroundColor=null;else{const[Ze,ii,Qe]=(0,Be.getRGB)(Ti),ui=_i=>(_i/=255,_i<=.03928?_i/12.92:((_i+.055)/1.055)**2.4),gi=Math.round(.2126*ui(Ze)+.7152*ui(ii)+.0722*ui(Qe));this.selectColor=(_i,Ri,Ui)=>{const ki=.2126*ui(_i)+.7152*ui(Ri)+.0722*ui(Ui);return Math.round(ki)===gi?Fi:Ci}}}if(this.ctx.fillStyle=this.backgroundColor||ci,this.ctx.fillRect(0,0,si,li),this.ctx.restore(),Ve){const Ci=this.cachedCanvases.getCanvas("transparent",si,li);this.compositeCtx=this.ctx,this.transparentCanvas=Ci.canvas,this.ctx=Ci.context,this.ctx.save(),this.ctx.transform(...(0,Be.getCurrentTransform)(this.compositeCtx))}this.ctx.save(),Ke(this.ctx,this.foregroundColor),Ge&&(this.ctx.transform(...Ge),this.outputScaleX=Ge[0],this.outputScaleY=Ge[0]),this.ctx.transform(...ze.transform),this.viewportScale=ze.scale,this.baseTransform=(0,Be.getCurrentTransform)(this.ctx)}executeOperatorList(Ge,ze,Ve,ei){const si=Ge.argsArray,li=Ge.fnArray;let ci=ze||0;const Ci=si.length;if(Ci===ci)return ci;const Fi=Ci-ci>Se&&typeof Ve=="function",Oi=Fi?Date.now()+_e:0;let Ti=0;const Ze=this.commonObjs,ii=this.objs;let Qe;for(;;){if(ei!==void 0&&ci===ei.nextBreakPoint)return ei.breakIt(ci,Ve),ci;if(Qe=li[ci],Qe!==Oe.OPS.dependency)this[Qe].apply(this,si[ci]);else for(const ui of si[ci]){const gi=ui.startsWith("g_")?Ze:ii;if(!gi.has(ui))return gi.get(ui,Ve),ci}if(ci++,ci===Ci)return ci;if(Fi&&++Ti>Se){if(Date.now()>Oi)return Ve(),ci;Ti=0}}}endDrawing(){fn(this,ni,Ml).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const Ge of this._cachedBitmapsMap.values()){for(const ze of Ge.values())typeof HTMLCanvasElement<"u"&&ze instanceof HTMLCanvasElement&&(ze.width=ze.height=0);Ge.clear()}this._cachedBitmapsMap.clear()}_scaleImage(Ge,ze){const Ve=Ge.width,ei=Ge.height;let si=Math.max(Math.hypot(ze[0],ze[1]),1),li=Math.max(Math.hypot(ze[2],ze[3]),1),ci=Ve,Ci=ei,Fi="prescale1",Oi,Ti;for(;si>2&&ci>1||li>2&&Ci>1;){let Ze=ci,ii=Ci;si>2&&ci>1&&(Ze=Math.ceil(ci/2),si/=ci/Ze),li>2&&Ci>1&&(ii=Math.ceil(Ci/2),li/=Ci/ii),Oi=this.cachedCanvases.getCanvas(Fi,Ze,ii),Ti=Oi.context,Ti.clearRect(0,0,Ze,ii),Ti.drawImage(Ge,0,0,ci,Ci,0,0,Ze,ii),Ge=Oi.canvas,ci=Ze,Ci=ii,Fi=Fi==="prescale1"?"prescale2":"prescale1"}return{img:Ge,paintWidth:ci,paintHeight:Ci}}_createMaskCanvas(Ge){const ze=this.ctx,{width:Ve,height:ei}=Ge,si=this.current.fillColor,li=this.current.patternFill,ci=(0,Be.getCurrentTransform)(ze);let Ci,Fi,Oi,Ti;if((Ge.bitmap||Ge.data)&&Ge.count>1){const $i=Ge.bitmap||Ge.data.buffer;Fi=JSON.stringify(li?ci:[ci.slice(0,4),si]),Ci=this._cachedBitmapsMap.get($i),Ci||(Ci=new Map,this._cachedBitmapsMap.set($i,Ci));const tn=Ci.get(Fi);if(tn&&!li){const en=Math.round(Math.min(ci[0],ci[2])+ci[4]),zi=Math.round(Math.min(ci[1],ci[3])+ci[5]);return{canvas:tn,offsetX:en,offsetY:zi}}Oi=tn}Oi||(Ti=this.cachedCanvases.getCanvas("maskCanvas",Ve,ei),je(Ti.context,Ge));let Ze=Oe.Util.transform(ci,[1/Ve,0,0,-1/ei,0,0]);Ze=Oe.Util.transform(Ze,[1,0,0,1,0,-ei]);const ii=Oe.Util.applyTransform([0,0],Ze),Qe=Oe.Util.applyTransform([Ve,ei],Ze),ui=Oe.Util.normalizeRect([ii[0],ii[1],Qe[0],Qe[1]]),gi=Math.round(ui[2]-ui[0])||1,_i=Math.round(ui[3]-ui[1])||1,Ri=this.cachedCanvases.getCanvas("fillCanvas",gi,_i),Ui=Ri.context,ki=Math.min(ii[0],Qe[0]),Vi=Math.min(ii[1],Qe[1]);Ui.translate(-ki,-Vi),Ui.transform(...Ze),Oi||(Oi=this._scaleImage(Ti.canvas,(0,Be.getCurrentTransformInverse)(Ui)),Oi=Oi.img,Ci&&li&&Ci.set(Fi,Oi)),Ui.imageSmoothingEnabled=yi((0,Be.getCurrentTransform)(Ui),Ge.interpolate),Ce(Ui,Oi,0,0,Oi.width,Oi.height,0,0,Ve,ei),Ui.globalCompositeOperation="source-in";const Ii=Oe.Util.transform((0,Be.getCurrentTransformInverse)(Ui),[1,0,0,1,-ki,-Vi]);return Ui.fillStyle=li?si.getPattern(ze,this,Ii,Ue.PathType.FILL):si,Ui.fillRect(0,0,Ve,ei),Ci&&!li&&(this.cachedCanvases.delete("fillCanvas"),Ci.set(Fi,Ri.canvas)),{canvas:Ri.canvas,offsetX:Math.round(ki),offsetY:Math.round(Vi)}}setLineWidth(Ge){Ge!==this.current.lineWidth&&(this._cachedScaleForStroking=null),this.current.lineWidth=Ge,this.ctx.lineWidth=Ge}setLineCap(Ge){this.ctx.lineCap=di[Ge]}setLineJoin(Ge){this.ctx.lineJoin=bi[Ge]}setMiterLimit(Ge){this.ctx.miterLimit=Ge}setDash(Ge,ze){const Ve=this.ctx;Ve.setLineDash!==void 0&&(Ve.setLineDash(Ge),Ve.lineDashOffset=ze)}setRenderingIntent(Ge){}setFlatness(Ge){}setGState(Ge){for(const[ze,Ve]of Ge)switch(ze){case"LW":this.setLineWidth(Ve);break;case"LC":this.setLineCap(Ve);break;case"LJ":this.setLineJoin(Ve);break;case"ML":this.setMiterLimit(Ve);break;case"D":this.setDash(Ve[0],Ve[1]);break;case"RI":this.setRenderingIntent(Ve);break;case"FL":this.setFlatness(Ve);break;case"Font":this.setFont(Ve[0],Ve[1]);break;case"CA":this.current.strokeAlpha=Ve;break;case"ca":this.current.fillAlpha=Ve,this.ctx.globalAlpha=Ve;break;case"BM":this.ctx.globalCompositeOperation=Ve;break;case"SMask":this.current.activeSMask=Ve?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.current.transferMaps=Ve}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const Ge=this.inSMaskMode;this.current.activeSMask&&!Ge?this.beginSMaskMode():!this.current.activeSMask&&Ge&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const Ge=this.ctx.canvas.width,ze=this.ctx.canvas.height,Ve="smaskGroupAt"+this.groupLevel,ei=this.cachedCanvases.getCanvas(Ve,Ge,ze);this.suspendedCtx=this.ctx,this.ctx=ei.context;const si=this.ctx;si.setTransform(...(0,Be.getCurrentTransform)(this.suspendedCtx)),We(this.suspendedCtx,si),Pe(si,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),We(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(Ge){if(!this.current.activeSMask)return;Ge?(Ge[0]=Math.floor(Ge[0]),Ge[1]=Math.floor(Ge[1]),Ge[2]=Math.ceil(Ge[2]),Ge[3]=Math.ceil(Ge[3])):Ge=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const ze=this.current.activeSMask,Ve=this.suspendedCtx;ai(Ve,ze,this.ctx,Ge),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}save(){this.inSMaskMode?(We(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const Ge=this.current;this.stateStack.push(Ge),this.current=Ge.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),We(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null)}transform(Ge,ze,Ve,ei,si,li){this.ctx.transform(Ge,ze,Ve,ei,si,li),this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null}constructPath(Ge,ze,Ve){const ei=this.ctx,si=this.current;let li=si.x,ci=si.y,Ci,Fi;const Oi=(0,Be.getCurrentTransform)(ei),Ti=Oi[0]===0&&Oi[3]===0||Oi[1]===0&&Oi[2]===0,Ze=Ti?Ve.slice(0):null;for(let ii=0,Qe=0,ui=Ge.length;ii<ui;ii++)switch(Ge[ii]|0){case Oe.OPS.rectangle:li=ze[Qe++],ci=ze[Qe++];const gi=ze[Qe++],_i=ze[Qe++],Ri=li+gi,Ui=ci+_i;ei.moveTo(li,ci),gi===0||_i===0?ei.lineTo(Ri,Ui):(ei.lineTo(Ri,ci),ei.lineTo(Ri,Ui),ei.lineTo(li,Ui)),Ti||si.updateRectMinMax(Oi,[li,ci,Ri,Ui]),ei.closePath();break;case Oe.OPS.moveTo:li=ze[Qe++],ci=ze[Qe++],ei.moveTo(li,ci),Ti||si.updatePathMinMax(Oi,li,ci);break;case Oe.OPS.lineTo:li=ze[Qe++],ci=ze[Qe++],ei.lineTo(li,ci),Ti||si.updatePathMinMax(Oi,li,ci);break;case Oe.OPS.curveTo:Ci=li,Fi=ci,li=ze[Qe+4],ci=ze[Qe+5],ei.bezierCurveTo(ze[Qe],ze[Qe+1],ze[Qe+2],ze[Qe+3],li,ci),si.updateCurvePathMinMax(Oi,Ci,Fi,ze[Qe],ze[Qe+1],ze[Qe+2],ze[Qe+3],li,ci,Ze),Qe+=6;break;case Oe.OPS.curveTo2:Ci=li,Fi=ci,ei.bezierCurveTo(li,ci,ze[Qe],ze[Qe+1],ze[Qe+2],ze[Qe+3]),si.updateCurvePathMinMax(Oi,Ci,Fi,li,ci,ze[Qe],ze[Qe+1],ze[Qe+2],ze[Qe+3],Ze),li=ze[Qe+2],ci=ze[Qe+3],Qe+=4;break;case Oe.OPS.curveTo3:Ci=li,Fi=ci,li=ze[Qe+2],ci=ze[Qe+3],ei.bezierCurveTo(ze[Qe],ze[Qe+1],li,ci,li,ci),si.updateCurvePathMinMax(Oi,Ci,Fi,ze[Qe],ze[Qe+1],li,ci,li,ci,Ze),Qe+=4;break;case Oe.OPS.closePath:ei.closePath();break}Ti&&si.updateScalingPathMinMax(Oi,Ze),si.setCurrentPoint(li,ci)}closePath(){this.ctx.closePath()}stroke(Ge){Ge=typeof Ge<"u"?Ge:!0;const ze=this.ctx,Ve=this.current.strokeColor;ze.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof Ve=="object"&&(Ve==null?void 0:Ve.getPattern)?(ze.save(),ze.strokeStyle=Ve.getPattern(ze,this,(0,Be.getCurrentTransformInverse)(ze),Ue.PathType.STROKE),this.rescaleAndStroke(!1),ze.restore()):this.rescaleAndStroke(!0)),Ge&&this.consumePath(this.current.getClippedPathBoundingBox()),ze.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(Ge){Ge=typeof Ge<"u"?Ge:!0;const ze=this.ctx,Ve=this.current.fillColor,ei=this.current.patternFill;let si=!1;ei&&(ze.save(),ze.fillStyle=Ve.getPattern(ze,this,(0,Be.getCurrentTransformInverse)(ze),Ue.PathType.FILL),si=!0);const li=this.current.getClippedPathBoundingBox();this.contentVisible&&li!==null&&(this.pendingEOFill?(ze.fill("evenodd"),this.pendingEOFill=!1):ze.fill()),si&&ze.restore(),Ge&&this.consumePath(li)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=vi}eoClip(){this.pendingClip=Pi}beginText(){this.current.textMatrix=Oe.IDENTITY_MATRIX,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const Ge=this.pendingTextPaths,ze=this.ctx;if(Ge===void 0){ze.beginPath();return}ze.save(),ze.beginPath();for(const Ve of Ge)ze.setTransform(...Ve.transform),ze.translate(Ve.x,Ve.y),Ve.addToPath(ze,Ve.fontSize);ze.restore(),ze.clip(),ze.beginPath(),delete this.pendingTextPaths}setCharSpacing(Ge){this.current.charSpacing=Ge}setWordSpacing(Ge){this.current.wordSpacing=Ge}setHScale(Ge){this.current.textHScale=Ge/100}setLeading(Ge){this.current.leading=-Ge}setFont(Ge,ze){const Ve=this.commonObjs.get(Ge),ei=this.current;if(!Ve)throw new Error(`Can't find font for ${Ge}`);if(ei.fontMatrix=Ve.fontMatrix||Oe.FONT_IDENTITY_MATRIX,(ei.fontMatrix[0]===0||ei.fontMatrix[3]===0)&&(0,Oe.warn)("Invalid font matrix for font "+Ge),ze<0?(ze=-ze,ei.fontDirection=-1):ei.fontDirection=1,this.current.font=Ve,this.current.fontSize=ze,Ve.isType3Font)return;const si=Ve.loadedName||"sans-serif";let li="normal";Ve.black?li="900":Ve.bold&&(li="bold");const ci=Ve.italic?"italic":"normal",Ci=`"${si}", ${Ve.fallbackName}`;let Fi=ze;ze<e?Fi=e:ze>xe&&(Fi=xe),this.current.fontSizeScale=ze/Fi,this.ctx.font=`${ci} ${li} ${Fi}px ${Ci}`}setTextRenderingMode(Ge){this.current.textRenderingMode=Ge}setTextRise(Ge){this.current.textRise=Ge}moveText(Ge,ze){this.current.x=this.current.lineX+=Ge,this.current.y=this.current.lineY+=ze}setLeadingMoveText(Ge,ze){this.setLeading(-ze),this.moveText(Ge,ze)}setTextMatrix(Ge,ze,Ve,ei,si,li){this.current.textMatrix=[Ge,ze,Ve,ei,si,li],this.current.textMatrixScale=Math.hypot(Ge,ze),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(Ge,ze,Ve,ei){const si=this.ctx,li=this.current,ci=li.font,Ci=li.textRenderingMode,Fi=li.fontSize/li.fontSizeScale,Oi=Ci&Oe.TextRenderingMode.FILL_STROKE_MASK,Ti=!!(Ci&Oe.TextRenderingMode.ADD_TO_PATH_FLAG),Ze=li.patternFill&&!ci.missingFile;let ii;(ci.disableFontFace||Ti||Ze)&&(ii=ci.getPathGenerator(this.commonObjs,Ge)),ci.disableFontFace||Ze?(si.save(),si.translate(ze,Ve),si.beginPath(),ii(si,Fi),ei&&si.setTransform(...ei),(Oi===Oe.TextRenderingMode.FILL||Oi===Oe.TextRenderingMode.FILL_STROKE)&&si.fill(),(Oi===Oe.TextRenderingMode.STROKE||Oi===Oe.TextRenderingMode.FILL_STROKE)&&si.stroke(),si.restore()):((Oi===Oe.TextRenderingMode.FILL||Oi===Oe.TextRenderingMode.FILL_STROKE)&&si.fillText(Ge,ze,Ve),(Oi===Oe.TextRenderingMode.STROKE||Oi===Oe.TextRenderingMode.FILL_STROKE)&&si.strokeText(Ge,ze,Ve)),Ti&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:(0,Be.getCurrentTransform)(si),x:ze,y:Ve,fontSize:Fi,addToPath:ii})}get isFontSubpixelAAEnabled(){const{context:Ge}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);Ge.scale(1.5,1),Ge.fillText("I",0,10);const ze=Ge.getImageData(0,0,10,10).data;let Ve=!1;for(let ei=3;ei<ze.length;ei+=4)if(ze[ei]>0&&ze[ei]<255){Ve=!0;break}return(0,Oe.shadow)(this,"isFontSubpixelAAEnabled",Ve)}showText(Ge){const ze=this.current,Ve=ze.font;if(Ve.isType3Font)return this.showType3Text(Ge);const ei=ze.fontSize;if(ei===0)return;const si=this.ctx,li=ze.fontSizeScale,ci=ze.charSpacing,Ci=ze.wordSpacing,Fi=ze.fontDirection,Oi=ze.textHScale*Fi,Ti=Ge.length,Ze=Ve.vertical,ii=Ze?1:-1,Qe=Ve.defaultVMetrics,ui=ei*ze.fontMatrix[0],gi=ze.textRenderingMode===Oe.TextRenderingMode.FILL&&!Ve.disableFontFace&&!ze.patternFill;si.save(),si.transform(...ze.textMatrix),si.translate(ze.x,ze.y+ze.textRise),Fi>0?si.scale(Oi,-1):si.scale(Oi,1);let _i;if(ze.patternFill){si.save();const Ii=ze.fillColor.getPattern(si,this,(0,Be.getCurrentTransformInverse)(si),Ue.PathType.FILL);_i=(0,Be.getCurrentTransform)(si),si.restore(),si.fillStyle=Ii}let Ri=ze.lineWidth;const Ui=ze.textMatrixScale;if(Ui===0||Ri===0){const Ii=ze.textRenderingMode&Oe.TextRenderingMode.FILL_STROKE_MASK;(Ii===Oe.TextRenderingMode.STROKE||Ii===Oe.TextRenderingMode.FILL_STROKE)&&(Ri=this.getSinglePixelWidth())}else Ri/=Ui;li!==1&&(si.scale(li,li),Ri/=li),si.lineWidth=Ri;let ki=0,Vi;for(Vi=0;Vi<Ti;++Vi){const Ii=Ge[Vi];if(typeof Ii=="number"){ki+=ii*Ii*ei/1e3;continue}let $i=!1;const tn=(Ii.isSpace?Ci:0)+ci,en=Ii.fontChar,zi=Ii.accent;let Ji,pn,an=Ii.width;if(Ze){const xn=Ii.vmetric||Qe,Tn=-(Ii.vmetric?xn[1]:an*.5)*ui,Bn=xn[2]*ui;an=xn?-xn[0]:an,Ji=Tn/li,pn=(ki+Bn)/li}else Ji=ki/li,pn=0;if(Ve.remeasure&&an>0){const xn=si.measureText(en).width*1e3/ei*li;if(an<xn&&this.isFontSubpixelAAEnabled){const Tn=an/xn;$i=!0,si.save(),si.scale(Tn,1),Ji/=Tn}else an!==xn&&(Ji+=(an-xn)/2e3*ei/li)}if(this.contentVisible&&(Ii.isInFont||Ve.missingFile)){if(gi&&!zi)si.fillText(en,Ji,pn);else if(this.paintChar(en,Ji,pn,_i),zi){const xn=Ji+ei*zi.offset.x/li,Tn=pn-ei*zi.offset.y/li;this.paintChar(zi.fontChar,xn,Tn,_i)}}let kn;Ze?kn=an*ui-tn*Fi:kn=an*ui+tn*Fi,ki+=kn,$i&&si.restore()}Ze?ze.y-=ki:ze.x+=ki*Oi,si.restore(),this.compose()}showType3Text(Ge){const ze=this.ctx,Ve=this.current,ei=Ve.font,si=Ve.fontSize,li=Ve.fontDirection,ci=ei.vertical?1:-1,Ci=Ve.charSpacing,Fi=Ve.wordSpacing,Oi=Ve.textHScale*li,Ti=Ve.fontMatrix||Oe.FONT_IDENTITY_MATRIX,Ze=Ge.length,ii=Ve.textRenderingMode===Oe.TextRenderingMode.INVISIBLE;let Qe,ui,gi,_i;if(!(ii||si===0)){for(this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null,ze.save(),ze.transform(...Ve.textMatrix),ze.translate(Ve.x,Ve.y),ze.scale(Oi,li),Qe=0;Qe<Ze;++Qe){if(ui=Ge[Qe],typeof ui=="number"){_i=ci*ui*si/1e3,this.ctx.translate(_i,0),Ve.x+=_i*Oi;continue}const Ri=(ui.isSpace?Fi:0)+Ci,Ui=ei.charProcOperatorList[ui.operatorListId];if(!Ui){(0,Oe.warn)(`Type3 character "${ui.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=ui,this.save(),ze.scale(si,si),ze.transform(...Ti),this.executeOperatorList(Ui),this.restore()),gi=Oe.Util.applyTransform([ui.width,0],Ti)[0]*si+Ri,ze.translate(gi,0),Ve.x+=gi*Oi}ze.restore(),this.processingType3=null}}setCharWidth(Ge,ze){}setCharWidthAndBounds(Ge,ze,Ve,ei,si,li){this.ctx.rect(Ve,ei,si-Ve,li-ei),this.ctx.clip(),this.endPath()}getColorN_Pattern(Ge){let ze;if(Ge[0]==="TilingPattern"){const Ve=Ge[1],ei=this.baseTransform||(0,Be.getCurrentTransform)(this.ctx),si={createCanvasGraphics:li=>new Si(li,this.commonObjs,this.objs,this.canvasFactory)};ze=new Ue.TilingPattern(Ge,Ve,this.ctx,si,ei)}else ze=this._getPattern(Ge[1],Ge[2]);return ze}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments)}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(Ge,ze,Ve){var si;const ei=((si=this.selectColor)==null?void 0:si.call(this,Ge,ze,Ve))||Oe.Util.makeHexColor(Ge,ze,Ve);this.ctx.strokeStyle=ei,this.current.strokeColor=ei}setFillRGBColor(Ge,ze,Ve){var si;const ei=((si=this.selectColor)==null?void 0:si.call(this,Ge,ze,Ve))||Oe.Util.makeHexColor(Ge,ze,Ve);this.ctx.fillStyle=ei,this.current.fillColor=ei,this.current.patternFill=!1}_getPattern(Ge,ze=null){let Ve;return this.cachedPatterns.has(Ge)?Ve=this.cachedPatterns.get(Ge):(Ve=(0,Ue.getShadingPattern)(this.objs.get(Ge)),this.cachedPatterns.set(Ge,Ve)),ze&&(Ve.matrix=ze),Ve}shadingFill(Ge){if(!this.contentVisible)return;const ze=this.ctx;this.save();const Ve=this._getPattern(Ge);ze.fillStyle=Ve.getPattern(ze,this,(0,Be.getCurrentTransformInverse)(ze),Ue.PathType.SHADING);const ei=(0,Be.getCurrentTransformInverse)(ze);if(ei){const si=ze.canvas,li=si.width,ci=si.height,Ci=Oe.Util.applyTransform([0,0],ei),Fi=Oe.Util.applyTransform([0,ci],ei),Oi=Oe.Util.applyTransform([li,0],ei),Ti=Oe.Util.applyTransform([li,ci],ei),Ze=Math.min(Ci[0],Fi[0],Oi[0],Ti[0]),ii=Math.min(Ci[1],Fi[1],Oi[1],Ti[1]),Qe=Math.max(Ci[0],Fi[0],Oi[0],Ti[0]),ui=Math.max(Ci[1],Fi[1],Oi[1],Ti[1]);this.ctx.fillRect(Ze,ii,Qe-Ze,ui-ii)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){(0,Oe.unreachable)("Should not call beginInlineImage")}beginImageData(){(0,Oe.unreachable)("Should not call beginImageData")}paintFormXObjectBegin(Ge,ze){if(!!this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),Array.isArray(Ge)&&Ge.length===6&&this.transform(...Ge),this.baseTransform=(0,Be.getCurrentTransform)(this.ctx),ze)){const Ve=ze[2]-ze[0],ei=ze[3]-ze[1];this.ctx.rect(ze[0],ze[1],Ve,ei),this.current.updateRectMinMax((0,Be.getCurrentTransform)(this.ctx),ze),this.clip(),this.endPath()}}paintFormXObjectEnd(){!this.contentVisible||(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(Ge){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const ze=this.ctx;Ge.isolated||(0,Oe.info)("TODO: Support non-isolated groups."),Ge.knockout&&(0,Oe.warn)("Knockout groups not supported.");const Ve=(0,Be.getCurrentTransform)(ze);if(Ge.matrix&&ze.transform(...Ge.matrix),!Ge.bbox)throw new Error("Bounding box is required.");let ei=Oe.Util.getAxialAlignedBoundingBox(Ge.bbox,(0,Be.getCurrentTransform)(ze));const si=[0,0,ze.canvas.width,ze.canvas.height];ei=Oe.Util.intersect(ei,si)||[0,0,0,0];const li=Math.floor(ei[0]),ci=Math.floor(ei[1]);let Ci=Math.max(Math.ceil(ei[2])-li,1),Fi=Math.max(Math.ceil(ei[3])-ci,1),Oi=1,Ti=1;Ci>Te&&(Oi=Ci/Te,Ci=Te),Fi>Te&&(Ti=Fi/Te,Fi=Te),this.current.startNewPathAndClipBox([0,0,Ci,Fi]);let Ze="groupAt"+this.groupLevel;Ge.smask&&(Ze+="_smask_"+this.smaskCounter++%2);const ii=this.cachedCanvases.getCanvas(Ze,Ci,Fi),Qe=ii.context;Qe.scale(1/Oi,1/Ti),Qe.translate(-li,-ci),Qe.transform(...Ve),Ge.smask?this.smaskStack.push({canvas:ii.canvas,context:Qe,offsetX:li,offsetY:ci,scaleX:Oi,scaleY:Ti,subtype:Ge.smask.subtype,backdrop:Ge.smask.backdrop,transferMap:Ge.smask.transferMap||null,startTransformInverse:null}):(ze.setTransform(1,0,0,1,0,0),ze.translate(li,ci),ze.scale(Oi,Ti),ze.save()),We(ze,Qe),this.ctx=Qe,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(ze),this.groupLevel++}endGroup(Ge){if(!this.contentVisible)return;this.groupLevel--;const ze=this.ctx,Ve=this.groupStack.pop();if(this.ctx=Ve,this.ctx.imageSmoothingEnabled=!1,Ge.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const ei=(0,Be.getCurrentTransform)(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...ei);const si=Oe.Util.getAxialAlignedBoundingBox([0,0,ze.canvas.width,ze.canvas.height],ei);this.ctx.drawImage(ze.canvas,0,0),this.ctx.restore(),this.compose(si)}}beginAnnotation(Ge,ze,Ve,ei,si){if(fn(this,ni,Ml).call(this),Ke(this.ctx,this.foregroundColor),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),Array.isArray(ze)&&ze.length===4){const li=ze[2]-ze[0],ci=ze[3]-ze[1];if(si&&this.annotationCanvasMap){Ve=Ve.slice(),Ve[4]-=ze[0],Ve[5]-=ze[1],ze=ze.slice(),ze[0]=ze[1]=0,ze[2]=li,ze[3]=ci;const[Ci,Fi]=Oe.Util.singularValueDecompose2dScale((0,Be.getCurrentTransform)(this.ctx)),{viewportScale:Oi}=this,Ti=Math.ceil(li*this.outputScaleX*Oi),Ze=Math.ceil(ci*this.outputScaleY*Oi);this.annotationCanvas=this.canvasFactory.create(Ti,Ze);const{canvas:ii,context:Qe}=this.annotationCanvas;this.annotationCanvasMap.set(Ge,ii),this.annotationCanvas.savedCtx=this.ctx,this.ctx=Qe,this.ctx.setTransform(Ci,0,0,-Fi,0,ci*Fi),Ke(this.ctx,this.foregroundColor)}else Ke(this.ctx,this.foregroundColor),this.ctx.rect(ze[0],ze[1],li,ci),this.ctx.clip(),this.endPath()}this.current=new De(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...Ve),this.transform(...ei)}endAnnotation(){this.annotationCanvas&&(this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(Ge){if(!this.contentVisible)return;const ze=Ge.count;Ge=this.getObject(Ge.data,Ge),Ge.count=ze;const Ve=this.ctx,ei=this.processingType3;if(ei&&(ei.compiled===void 0&&(ei.compiled=ke(Ge)),ei.compiled)){ei.compiled(Ve);return}const si=this._createMaskCanvas(Ge),li=si.canvas;Ve.save(),Ve.setTransform(1,0,0,1,0,0),Ve.drawImage(li,si.offsetX,si.offsetY),Ve.restore(),this.compose()}paintImageMaskXObjectRepeat(Ge,ze,Ve=0,ei=0,si,li){if(!this.contentVisible)return;Ge=this.getObject(Ge.data,Ge);const ci=this.ctx;ci.save();const Ci=(0,Be.getCurrentTransform)(ci);ci.transform(ze,Ve,ei,si,0,0);const Fi=this._createMaskCanvas(Ge);ci.setTransform(1,0,0,1,0,0);for(let Oi=0,Ti=li.length;Oi<Ti;Oi+=2){const Ze=Oe.Util.transform(Ci,[ze,Ve,ei,si,li[Oi],li[Oi+1]]),[ii,Qe]=Oe.Util.applyTransform([0,0],Ze);ci.drawImage(Fi.canvas,ii,Qe)}ci.restore(),this.compose()}paintImageMaskXObjectGroup(Ge){if(!this.contentVisible)return;const ze=this.ctx,Ve=this.current.fillColor,ei=this.current.patternFill;for(const si of Ge){const{data:li,width:ci,height:Ci,transform:Fi}=si,Oi=this.cachedCanvases.getCanvas("maskCanvas",ci,Ci),Ti=Oi.context;Ti.save();const Ze=this.getObject(li,si);je(Ti,Ze),Ti.globalCompositeOperation="source-in",Ti.fillStyle=ei?Ve.getPattern(Ti,this,(0,Be.getCurrentTransformInverse)(ze),Ue.PathType.FILL):Ve,Ti.fillRect(0,0,ci,Ci),Ti.restore(),ze.save(),ze.transform(...Fi),ze.scale(1,-1),Ce(ze,Oi.canvas,0,0,ci,Ci,0,-1,1,1),ze.restore()}this.compose()}paintImageXObject(Ge){if(!this.contentVisible)return;const ze=this.getObject(Ge);if(!ze){(0,Oe.warn)("Dependent image isn't ready yet");return}this.paintInlineImageXObject(ze)}paintImageXObjectRepeat(Ge,ze,Ve,ei){if(!this.contentVisible)return;const si=this.getObject(Ge);if(!si){(0,Oe.warn)("Dependent image isn't ready yet");return}const li=si.width,ci=si.height,Ci=[];for(let Fi=0,Oi=ei.length;Fi<Oi;Fi+=2)Ci.push({transform:[ze,0,0,Ve,ei[Fi],ei[Fi+1]],x:0,y:0,w:li,h:ci});this.paintInlineImageXObjectGroup(si,Ci)}paintInlineImageXObject(Ge){if(!this.contentVisible)return;const ze=Ge.width,Ve=Ge.height,ei=this.ctx;this.save(),ei.scale(1/ze,-1/Ve);let si;if(typeof HTMLElement=="function"&&Ge instanceof HTMLElement||!Ge.data)si=Ge;else{const ci=this.cachedCanvases.getCanvas("inlineImage",ze,Ve),Ci=ci.context;Re(Ci,Ge,this.current.transferMaps),si=ci.canvas}const li=this._scaleImage(si,(0,Be.getCurrentTransformInverse)(ei));ei.imageSmoothingEnabled=yi((0,Be.getCurrentTransform)(ei),Ge.interpolate),Ce(ei,li.img,0,0,li.paintWidth,li.paintHeight,0,-Ve,ze,Ve),this.compose(),this.restore()}paintInlineImageXObjectGroup(Ge,ze){if(!this.contentVisible)return;const Ve=this.ctx,ei=Ge.width,si=Ge.height,li=this.cachedCanvases.getCanvas("inlineImage",ei,si),ci=li.context;Re(ci,Ge,this.current.transferMaps);for(const Ci of ze)Ve.save(),Ve.transform(...Ci.transform),Ve.scale(1,-1),Ce(Ve,li.canvas,Ci.x,Ci.y,Ci.w,Ci.h,0,-1,1,1),Ve.restore();this.compose()}paintSolidColorImageMask(){!this.contentVisible||(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(Ge){}markPointProps(Ge,ze){}beginMarkedContent(Ge){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(Ge,ze){Ge==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(ze)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(Ge){const ze=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(Ge);const Ve=this.ctx;this.pendingClip&&(ze||(this.pendingClip===Pi?Ve.clip("evenodd"):Ve.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),Ve.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const Ge=(0,Be.getCurrentTransform)(this.ctx);if(Ge[1]===0&&Ge[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(Ge[0]),Math.abs(Ge[3]));else{const ze=Math.abs(Ge[0]*Ge[3]-Ge[2]*Ge[1]),Ve=Math.hypot(Ge[0],Ge[2]),ei=Math.hypot(Ge[1],Ge[3]);this._cachedGetSinglePixelWidth=Math.max(Ve,ei)/ze}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(!this._cachedScaleForStroking){const{lineWidth:Ge}=this.current,ze=(0,Be.getCurrentTransform)(this.ctx);let Ve,ei;if(ze[1]===0&&ze[2]===0){const si=Math.abs(ze[0]),li=Math.abs(ze[3]);if(Ge===0)Ve=1/si,ei=1/li;else{const ci=si*Ge,Ci=li*Ge;Ve=ci<1?1/ci:1,ei=Ci<1?1/Ci:1}}else{const si=Math.abs(ze[0]*ze[3]-ze[2]*ze[1]),li=Math.hypot(ze[0],ze[1]),ci=Math.hypot(ze[2],ze[3]);if(Ge===0)Ve=ci/si,ei=li/si;else{const Ci=Ge*si;Ve=ci>Ci?ci/Ci:1,ei=li>Ci?li/Ci:1}}this._cachedScaleForStroking=[Ve,ei]}return this._cachedScaleForStroking}rescaleAndStroke(Ge){const{ctx:ze}=this,{lineWidth:Ve}=this.current,[ei,si]=this.getScaleForStroking();if(ze.lineWidth=Ve||1,ei===1&&si===1){ze.stroke();return}let li,ci,Ci;Ge&&(li=(0,Be.getCurrentTransform)(ze),ci=ze.getLineDash().slice(),Ci=ze.lineDashOffset),ze.scale(ei,si);const Fi=Math.max(ei,si);ze.setLineDash(ze.getLineDash().map(Oi=>Oi/Fi)),ze.lineDashOffset/=Fi,ze.stroke(),Ge&&(ze.setTransform(...li),ze.setLineDash(ci),ze.lineDashOffset=Ci)}isContentVisible(){for(let Ge=this.markedContentStack.length-1;Ge>=0;Ge--)if(!this.markedContentStack[Ge].visible)return!1;return!0}};let xi=Si;ni=new WeakSet,Ml=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},r.CanvasGraphics=xi;for(const Xe in Oe.OPS)xi.prototype[Xe]!==void 0&&(xi.prototype[Oe.OPS[Xe]]=xi.prototype[Xe])},(Ie,r,Me)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.TilingPattern=r.PathType=void 0,r.getShadingPattern=Ae;var Oe=Me(1),Be=Me(6),Ue=Me(12);const He={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};r.PathType=He;function Ee(Ce,ke){if(!ke||Ue.isNodeJS)return;const De=ke[2]-ke[0],Re=ke[3]-ke[1],je=new Path2D;je.rect(ke[0],ke[1],De,Re),Ce.clip(je)}class e{constructor(){this.constructor===e&&(0,Oe.unreachable)("Cannot initialize BaseShadingPattern.")}getPattern(){(0,Oe.unreachable)("Abstract method `getPattern` called.")}}class xe extends e{constructor(ke){super(),this._type=ke[1],this._bbox=ke[2],this._colorStops=ke[3],this._p0=ke[4],this._p1=ke[5],this._r0=ke[6],this._r1=ke[7],this.matrix=null}_createGradient(ke){let De;this._type==="axial"?De=ke.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(De=ke.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const Re of this._colorStops)De.addColorStop(Re[0],Re[1]);return De}getPattern(ke,De,Re,je){let We;if(je===He.STROKE||je===He.FILL){const Ke=De.current.getClippedPathBoundingBox(je,(0,Be.getCurrentTransform)(ke))||[0,0,0,0],Je=Math.ceil(Ke[2]-Ke[0])||1,hi=Math.ceil(Ke[3]-Ke[1])||1,oi=De.cachedCanvases.getCanvas("pattern",Je,hi,!0),ti=oi.context;ti.clearRect(0,0,ti.canvas.width,ti.canvas.height),ti.beginPath(),ti.rect(0,0,ti.canvas.width,ti.canvas.height),ti.translate(-Ke[0],-Ke[1]),Re=Oe.Util.transform(Re,[1,0,0,1,Ke[0],Ke[1]]),ti.transform(...De.baseTransform),this.matrix&&ti.transform(...this.matrix),Ee(ti,this._bbox),ti.fillStyle=this._createGradient(ti),ti.fill(),We=ke.createPattern(oi.canvas,"no-repeat");const ai=new DOMMatrix(Re);We.setTransform(ai)}else Ee(ke,this._bbox),We=this._createGradient(ke);return We}}function Te(Ce,ke,De,Re,je,We,Ke,Je){const hi=ke.coords,oi=ke.colors,ti=Ce.data,ai=Ce.width*4;let yi;hi[De+1]>hi[Re+1]&&(yi=De,De=Re,Re=yi,yi=We,We=Ke,Ke=yi),hi[Re+1]>hi[je+1]&&(yi=Re,Re=je,je=yi,yi=Ke,Ke=Je,Je=yi),hi[De+1]>hi[Re+1]&&(yi=De,De=Re,Re=yi,yi=We,We=Ke,Ke=yi);const di=(hi[De]+ke.offsetX)*ke.scaleX,bi=(hi[De+1]+ke.offsetY)*ke.scaleY,vi=(hi[Re]+ke.offsetX)*ke.scaleX,Pi=(hi[Re+1]+ke.offsetY)*ke.scaleY,xi=(hi[je]+ke.offsetX)*ke.scaleX,ni=(hi[je+1]+ke.offsetY)*ke.scaleY;if(bi>=ni)return;const fi=oi[We],Si=oi[We+1],Xe=oi[We+2],Ge=oi[Ke],ze=oi[Ke+1],Ve=oi[Ke+2],ei=oi[Je],si=oi[Je+1],li=oi[Je+2],ci=Math.round(bi),Ci=Math.round(ni);let Fi,Oi,Ti,Ze,ii,Qe,ui,gi;for(let _i=ci;_i<=Ci;_i++){if(_i<Pi){let Ii;_i<bi?Ii=0:Ii=(bi-_i)/(bi-Pi),Fi=di-(di-vi)*Ii,Oi=fi-(fi-Ge)*Ii,Ti=Si-(Si-ze)*Ii,Ze=Xe-(Xe-Ve)*Ii}else{let Ii;_i>ni?Ii=1:Pi===ni?Ii=0:Ii=(Pi-_i)/(Pi-ni),Fi=vi-(vi-xi)*Ii,Oi=Ge-(Ge-ei)*Ii,Ti=ze-(ze-si)*Ii,Ze=Ve-(Ve-li)*Ii}let Ri;_i<bi?Ri=0:_i>ni?Ri=1:Ri=(bi-_i)/(bi-ni),ii=di-(di-xi)*Ri,Qe=fi-(fi-ei)*Ri,ui=Si-(Si-si)*Ri,gi=Xe-(Xe-li)*Ri;const Ui=Math.round(Math.min(Fi,ii)),ki=Math.round(Math.max(Fi,ii));let Vi=ai*_i+Ui*4;for(let Ii=Ui;Ii<=ki;Ii++)Ri=(Fi-Ii)/(Fi-ii),Ri<0?Ri=0:Ri>1&&(Ri=1),ti[Vi++]=Oi-(Oi-Qe)*Ri|0,ti[Vi++]=Ti-(Ti-ui)*Ri|0,ti[Vi++]=Ze-(Ze-gi)*Ri|0,ti[Vi++]=255}}function _e(Ce,ke,De){const Re=ke.coords,je=ke.colors;let We,Ke;switch(ke.type){case"lattice":const Je=ke.verticesPerRow,hi=Math.floor(Re.length/Je)-1,oi=Je-1;for(We=0;We<hi;We++){let ti=We*Je;for(let ai=0;ai<oi;ai++,ti++)Te(Ce,De,Re[ti],Re[ti+1],Re[ti+Je],je[ti],je[ti+1],je[ti+Je]),Te(Ce,De,Re[ti+Je+1],Re[ti+1],Re[ti+Je],je[ti+Je+1],je[ti+1],je[ti+Je])}break;case"triangles":for(We=0,Ke=Re.length;We<Ke;We+=3)Te(Ce,De,Re[We],Re[We+1],Re[We+2],je[We],je[We+1],je[We+2]);break;default:throw new Error("illegal figure")}}class Se extends e{constructor(ke){super(),this._coords=ke[2],this._colors=ke[3],this._figures=ke[4],this._bounds=ke[5],this._bbox=ke[7],this._background=ke[8],this.matrix=null}_createMeshCanvas(ke,De,Re){const Je=Math.floor(this._bounds[0]),hi=Math.floor(this._bounds[1]),oi=Math.ceil(this._bounds[2])-Je,ti=Math.ceil(this._bounds[3])-hi,ai=Math.min(Math.ceil(Math.abs(oi*ke[0]*1.1)),3e3),yi=Math.min(Math.ceil(Math.abs(ti*ke[1]*1.1)),3e3),di=oi/ai,bi=ti/yi,vi={coords:this._coords,colors:this._colors,offsetX:-Je,offsetY:-hi,scaleX:1/di,scaleY:1/bi},Pi=ai+2*2,xi=yi+2*2,ni=Re.getCanvas("mesh",Pi,xi,!1),fi=ni.context,Si=fi.createImageData(ai,yi);if(De){const Ge=Si.data;for(let ze=0,Ve=Ge.length;ze<Ve;ze+=4)Ge[ze]=De[0],Ge[ze+1]=De[1],Ge[ze+2]=De[2],Ge[ze+3]=255}for(const Ge of this._figures)_e(Si,Ge,vi);return fi.putImageData(Si,2,2),{canvas:ni.canvas,offsetX:Je-2*di,offsetY:hi-2*bi,scaleX:di,scaleY:bi}}getPattern(ke,De,Re,je){Ee(ke,this._bbox);let We;if(je===He.SHADING)We=Oe.Util.singularValueDecompose2dScale((0,Be.getCurrentTransform)(ke));else if(We=Oe.Util.singularValueDecompose2dScale(De.baseTransform),this.matrix){const Je=Oe.Util.singularValueDecompose2dScale(this.matrix);We=[We[0]*Je[0],We[1]*Je[1]]}const Ke=this._createMeshCanvas(We,je===He.SHADING?null:this._background,De.cachedCanvases);return je!==He.SHADING&&(ke.setTransform(...De.baseTransform),this.matrix&&ke.transform(...this.matrix)),ke.translate(Ke.offsetX,Ke.offsetY),ke.scale(Ke.scaleX,Ke.scaleY),ke.createPattern(Ke.canvas,"no-repeat")}}class t extends e{getPattern(){return"hotpink"}}function Ae(Ce){switch(Ce[0]){case"RadialAxial":return new xe(Ce);case"Mesh":return new Se(Ce);case"Dummy":return new t}throw new Error(`Unknown IR type: ${Ce[0]}`)}const Pe={COLORED:1,UNCOLORED:2};class St{static get MAX_PATTERN_SIZE(){return(0,Oe.shadow)(this,"MAX_PATTERN_SIZE",3e3)}constructor(ke,De,Re,je,We){this.operatorList=ke[2],this.matrix=ke[3]||[1,0,0,1,0,0],this.bbox=ke[4],this.xstep=ke[5],this.ystep=ke[6],this.paintType=ke[7],this.tilingType=ke[8],this.color=De,this.ctx=Re,this.canvasGraphicsFactory=je,this.baseTransform=We}createPatternCanvas(ke){const De=this.operatorList,Re=this.bbox,je=this.xstep,We=this.ystep,Ke=this.paintType,Je=this.tilingType,hi=this.color,oi=this.canvasGraphicsFactory;(0,Oe.info)("TilingType: "+Je);const ti=Re[0],ai=Re[1],yi=Re[2],di=Re[3],bi=Oe.Util.singularValueDecompose2dScale(this.matrix),vi=Oe.Util.singularValueDecompose2dScale(this.baseTransform),Pi=[bi[0]*vi[0],bi[1]*vi[1]],xi=this.getSizeAndScale(je,this.ctx.canvas.width,Pi[0]),ni=this.getSizeAndScale(We,this.ctx.canvas.height,Pi[1]),fi=ke.cachedCanvases.getCanvas("pattern",xi.size,ni.size,!0),Si=fi.context,Xe=oi.createCanvasGraphics(Si);Xe.groupLevel=ke.groupLevel,this.setFillAndStrokeStyleToContext(Xe,Ke,hi);let Ge=ti,ze=ai,Ve=yi,ei=di;return ti<0&&(Ge=0,Ve+=Math.abs(ti)),ai<0&&(ze=0,ei+=Math.abs(ai)),Si.translate(-(xi.scale*Ge),-(ni.scale*ze)),Xe.transform(xi.scale,0,0,ni.scale,0,0),Si.save(),this.clipBbox(Xe,Ge,ze,Ve,ei),Xe.baseTransform=(0,Be.getCurrentTransform)(Xe.ctx),Xe.executeOperatorList(De),Xe.endDrawing(),{canvas:fi.canvas,scaleX:xi.scale,scaleY:ni.scale,offsetX:Ge,offsetY:ze}}getSizeAndScale(ke,De,Re){ke=Math.abs(ke);const je=Math.max(St.MAX_PATTERN_SIZE,De);let We=Math.ceil(ke*Re);return We>=je?We=je:Re=We/ke,{scale:Re,size:We}}clipBbox(ke,De,Re,je,We){const Ke=je-De,Je=We-Re;ke.ctx.rect(De,Re,Ke,Je),ke.current.updateRectMinMax((0,Be.getCurrentTransform)(ke.ctx),[De,Re,je,We]),ke.clip(),ke.endPath()}setFillAndStrokeStyleToContext(ke,De,Re){const je=ke.ctx,We=ke.current;switch(De){case Pe.COLORED:const Ke=this.ctx;je.fillStyle=Ke.fillStyle,je.strokeStyle=Ke.strokeStyle,We.fillColor=Ke.fillStyle,We.strokeColor=Ke.strokeStyle;break;case Pe.UNCOLORED:const Je=Oe.Util.makeHexColor(Re[0],Re[1],Re[2]);je.fillStyle=Je,je.strokeStyle=Je,We.fillColor=Je,We.strokeColor=Je;break;default:throw new Oe.FormatError(`Unsupported paint type: ${De}`)}}getPattern(ke,De,Re,je){let We=Re;je!==He.SHADING&&(We=Oe.Util.transform(We,De.baseTransform),this.matrix&&(We=Oe.Util.transform(We,this.matrix)));const Ke=this.createPatternCanvas(De);let Je=new DOMMatrix(We);Je=Je.translate(Ke.offsetX,Ke.offsetY),Je=Je.scale(1/Ke.scaleX,1/Ke.scaleY);const hi=ke.createPattern(Ke.canvas,"repeat");return hi.setTransform(Je),hi}}r.TilingPattern=St},(Ie,r)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.isNodeJS=void 0;const Me=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser");r.isNodeJS=Me},(Ie,r,Me)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.applyMaskImageData=Be;var Oe=Me(1);function Be({src:Ue,srcPos:He=0,dest:Ee,destPos:e=0,width:xe,height:Te,inverseDecode:_e=!1}){const Se=Oe.FeatureTest.isLittleEndian?4278190080:255,[t,Ae]=_e?[0,Se]:[Se,0],Pe=xe>>3,St=xe&7,Ce=Ue.length;Ee=new Uint32Array(Ee.buffer);for(let ke=0;ke<Te;ke++){for(const Re=He+Pe;He<Re;He++){const je=He<Ce?Ue[He]:255;Ee[e++]=je&128?Ae:t,Ee[e++]=je&64?Ae:t,Ee[e++]=je&32?Ae:t,Ee[e++]=je&16?Ae:t,Ee[e++]=je&8?Ae:t,Ee[e++]=je&4?Ae:t,Ee[e++]=je&2?Ae:t,Ee[e++]=je&1?Ae:t}if(St===0)continue;const De=He<Ce?Ue[He++]:255;for(let Re=0;Re<St;Re++)Ee[e++]=De&1<<7-Re?Ae:t}return{srcPos:He,destPos:e}}},(Ie,r)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.GlobalWorkerOptions=void 0;const Me=Object.create(null);r.GlobalWorkerOptions=Me,Me.workerPort=Me.workerPort===void 0?null:Me.workerPort,Me.workerSrc=Me.workerSrc===void 0?"":Me.workerSrc},(Ie,r,Me)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.MessageHandler=void 0;var Oe=Me(1);const Be={UNKNOWN:0,DATA:1,ERROR:2},Ue={UNKNOWN:0,CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function He(e){switch(e instanceof Error||typeof e=="object"&&e!==null||(0,Oe.unreachable)('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),e.name){case"AbortException":return new Oe.AbortException(e.message);case"MissingPDFException":return new Oe.MissingPDFException(e.message);case"PasswordException":return new Oe.PasswordException(e.message,e.code);case"UnexpectedResponseException":return new Oe.UnexpectedResponseException(e.message,e.status);case"UnknownErrorException":return new Oe.UnknownErrorException(e.message,e.details);default:return new Oe.UnknownErrorException(e.message,e.toString())}}class Ee{constructor(xe,Te,_e){this.sourceName=xe,this.targetName=Te,this.comObj=_e,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),this._onComObjOnMessage=Se=>{const t=Se.data;if(t.targetName!==this.sourceName)return;if(t.stream){this._processStreamMessage(t);return}if(t.callback){const Pe=t.callbackId,St=this.callbackCapabilities[Pe];if(!St)throw new Error(`Cannot resolve callback ${Pe}`);if(delete this.callbackCapabilities[Pe],t.callback===Be.DATA)St.resolve(t.data);else if(t.callback===Be.ERROR)St.reject(He(t.reason));else throw new Error("Unexpected callback case");return}const Ae=this.actionHandler[t.action];if(!Ae)throw new Error(`Unknown action from worker: ${t.action}`);if(t.callbackId){const Pe=this.sourceName,St=t.sourceName;new Promise(function(Ce){Ce(Ae(t.data))}).then(function(Ce){_e.postMessage({sourceName:Pe,targetName:St,callback:Be.DATA,callbackId:t.callbackId,data:Ce})},function(Ce){_e.postMessage({sourceName:Pe,targetName:St,callback:Be.ERROR,callbackId:t.callbackId,reason:He(Ce)})});return}if(t.streamId){this._createStreamSink(t);return}Ae(t.data)},_e.addEventListener("message",this._onComObjOnMessage)}on(xe,Te){const _e=this.actionHandler;if(_e[xe])throw new Error(`There is already an actionName called "${xe}"`);_e[xe]=Te}send(xe,Te,_e){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:xe,data:Te},_e)}sendWithPromise(xe,Te,_e){const Se=this.callbackId++,t=(0,Oe.createPromiseCapability)();this.callbackCapabilities[Se]=t;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:xe,callbackId:Se,data:Te},_e)}catch(Ae){t.reject(Ae)}return t.promise}sendWithStream(xe,Te,_e,Se){const t=this.streamId++,Ae=this.sourceName,Pe=this.targetName,St=this.comObj;return new ReadableStream({start:Ce=>{const ke=(0,Oe.createPromiseCapability)();return this.streamControllers[t]={controller:Ce,startCall:ke,pullCall:null,cancelCall:null,isClosed:!1},St.postMessage({sourceName:Ae,targetName:Pe,action:xe,streamId:t,data:Te,desiredSize:Ce.desiredSize},Se),ke.promise},pull:Ce=>{const ke=(0,Oe.createPromiseCapability)();return this.streamControllers[t].pullCall=ke,St.postMessage({sourceName:Ae,targetName:Pe,stream:Ue.PULL,streamId:t,desiredSize:Ce.desiredSize}),ke.promise},cancel:Ce=>{(0,Oe.assert)(Ce instanceof Error,"cancel must have a valid reason");const ke=(0,Oe.createPromiseCapability)();return this.streamControllers[t].cancelCall=ke,this.streamControllers[t].isClosed=!0,St.postMessage({sourceName:Ae,targetName:Pe,stream:Ue.CANCEL,streamId:t,reason:He(Ce)}),ke.promise}},_e)}_createStreamSink(xe){const Te=xe.streamId,_e=this.sourceName,Se=xe.sourceName,t=this.comObj,Ae=this,Pe=this.actionHandler[xe.action],St={enqueue(Ce,ke=1,De){if(this.isCancelled)return;const Re=this.desiredSize;this.desiredSize-=ke,Re>0&&this.desiredSize<=0&&(this.sinkCapability=(0,Oe.createPromiseCapability)(),this.ready=this.sinkCapability.promise),t.postMessage({sourceName:_e,targetName:Se,stream:Ue.ENQUEUE,streamId:Te,chunk:Ce},De)},close(){this.isCancelled||(this.isCancelled=!0,t.postMessage({sourceName:_e,targetName:Se,stream:Ue.CLOSE,streamId:Te}),delete Ae.streamSinks[Te])},error(Ce){(0,Oe.assert)(Ce instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,t.postMessage({sourceName:_e,targetName:Se,stream:Ue.ERROR,streamId:Te,reason:He(Ce)}))},sinkCapability:(0,Oe.createPromiseCapability)(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:xe.desiredSize,ready:null};St.sinkCapability.resolve(),St.ready=St.sinkCapability.promise,this.streamSinks[Te]=St,new Promise(function(Ce){Ce(Pe(xe.data,St))}).then(function(){t.postMessage({sourceName:_e,targetName:Se,stream:Ue.START_COMPLETE,streamId:Te,success:!0})},function(Ce){t.postMessage({sourceName:_e,targetName:Se,stream:Ue.START_COMPLETE,streamId:Te,reason:He(Ce)})})}_processStreamMessage(xe){const Te=xe.streamId,_e=this.sourceName,Se=xe.sourceName,t=this.comObj,Ae=this.streamControllers[Te],Pe=this.streamSinks[Te];switch(xe.stream){case Ue.START_COMPLETE:xe.success?Ae.startCall.resolve():Ae.startCall.reject(He(xe.reason));break;case Ue.PULL_COMPLETE:xe.success?Ae.pullCall.resolve():Ae.pullCall.reject(He(xe.reason));break;case Ue.PULL:if(!Pe){t.postMessage({sourceName:_e,targetName:Se,stream:Ue.PULL_COMPLETE,streamId:Te,success:!0});break}Pe.desiredSize<=0&&xe.desiredSize>0&&Pe.sinkCapability.resolve(),Pe.desiredSize=xe.desiredSize,new Promise(function(St){St(Pe.onPull&&Pe.onPull())}).then(function(){t.postMessage({sourceName:_e,targetName:Se,stream:Ue.PULL_COMPLETE,streamId:Te,success:!0})},function(St){t.postMessage({sourceName:_e,targetName:Se,stream:Ue.PULL_COMPLETE,streamId:Te,reason:He(St)})});break;case Ue.ENQUEUE:if((0,Oe.assert)(Ae,"enqueue should have stream controller"),Ae.isClosed)break;Ae.controller.enqueue(xe.chunk);break;case Ue.CLOSE:if((0,Oe.assert)(Ae,"close should have stream controller"),Ae.isClosed)break;Ae.isClosed=!0,Ae.controller.close(),this._deleteStreamController(Ae,Te);break;case Ue.ERROR:(0,Oe.assert)(Ae,"error should have stream controller"),Ae.controller.error(He(xe.reason)),this._deleteStreamController(Ae,Te);break;case Ue.CANCEL_COMPLETE:xe.success?Ae.cancelCall.resolve():Ae.cancelCall.reject(He(xe.reason)),this._deleteStreamController(Ae,Te);break;case Ue.CANCEL:if(!Pe)break;new Promise(function(St){St(Pe.onCancel&&Pe.onCancel(He(xe.reason)))}).then(function(){t.postMessage({sourceName:_e,targetName:Se,stream:Ue.CANCEL_COMPLETE,streamId:Te,success:!0})},function(St){t.postMessage({sourceName:_e,targetName:Se,stream:Ue.CANCEL_COMPLETE,streamId:Te,reason:He(St)})}),Pe.sinkCapability.reject(He(xe.reason)),Pe.isCancelled=!0,delete this.streamSinks[Te];break;default:throw new Error("Unexpected stream case")}}async _deleteStreamController(xe,Te){await Promise.allSettled([xe.startCall&&xe.startCall.promise,xe.pullCall&&xe.pullCall.promise,xe.cancelCall&&xe.cancelCall.promise]),delete this.streamControllers[Te]}destroy(){this.comObj.removeEventListener("message",this._onComObjOnMessage)}}r.MessageHandler=Ee},(Ie,r,Me)=>{var Ue,He;Object.defineProperty(r,"__esModule",{value:!0}),r.Metadata=void 0;var Oe=Me(1);class Be{constructor({parsedData:e,rawData:xe}){rn(this,Ue,void 0);rn(this,He,void 0);yn(this,Ue,e),yn(this,He,xe)}getRaw(){return Mi(this,He)}get(e){var xe;return(xe=Mi(this,Ue).get(e))!=null?xe:null}getAll(){return(0,Oe.objectFromMap)(Mi(this,Ue))}has(e){return Mi(this,Ue).has(e)}}Ue=new WeakMap,He=new WeakMap,r.Metadata=Be},(Ie,r,Me)=>{var e,xe,Te,_e,Se,t,Nl;Object.defineProperty(r,"__esModule",{value:!0}),r.OptionalContentConfig=void 0;var Oe=Me(1),Be=Me(8);const Ue=Symbol("INTERNAL");class He{constructor(St,Ce){rn(this,e,!0);this.name=St,this.intent=Ce}get visible(){return Mi(this,e)}_setVisible(St,Ce){St!==Ue&&(0,Oe.unreachable)("Internal method `_setVisible` called."),yn(this,e,Ce)}}e=new WeakMap;class Ee{constructor(St){rn(this,t);rn(this,xe,null);rn(this,Te,new Map);rn(this,_e,null);rn(this,Se,null);if(this.name=null,this.creator=null,St!==null){this.name=St.name,this.creator=St.creator,yn(this,Se,St.order);for(const Ce of St.groups)Mi(this,Te).set(Ce.id,new He(Ce.name,Ce.intent));if(St.baseState==="OFF")for(const Ce of Mi(this,Te).values())Ce._setVisible(Ue,!1);for(const Ce of St.on)Mi(this,Te).get(Ce)._setVisible(Ue,!0);for(const Ce of St.off)Mi(this,Te).get(Ce)._setVisible(Ue,!1);yn(this,_e,this.getHash())}}isVisible(St){if(Mi(this,Te).size===0)return!0;if(!St)return(0,Oe.warn)("Optional content group not defined."),!0;if(St.type==="OCG")return Mi(this,Te).has(St.id)?Mi(this,Te).get(St.id).visible:((0,Oe.warn)(`Optional content group not found: ${St.id}`),!0);if(St.type==="OCMD"){if(St.expression)return fn(this,t,Nl).call(this,St.expression);if(!St.policy||St.policy==="AnyOn"){for(const Ce of St.ids){if(!Mi(this,Te).has(Ce))return(0,Oe.warn)(`Optional content group not found: ${Ce}`),!0;if(Mi(this,Te).get(Ce).visible)return!0}return!1}else if(St.policy==="AllOn"){for(const Ce of St.ids){if(!Mi(this,Te).has(Ce))return(0,Oe.warn)(`Optional content group not found: ${Ce}`),!0;if(!Mi(this,Te).get(Ce).visible)return!1}return!0}else if(St.policy==="AnyOff"){for(const Ce of St.ids){if(!Mi(this,Te).has(Ce))return(0,Oe.warn)(`Optional content group not found: ${Ce}`),!0;if(!Mi(this,Te).get(Ce).visible)return!0}return!1}else if(St.policy==="AllOff"){for(const Ce of St.ids){if(!Mi(this,Te).has(Ce))return(0,Oe.warn)(`Optional content group not found: ${Ce}`),!0;if(Mi(this,Te).get(Ce).visible)return!1}return!0}return(0,Oe.warn)(`Unknown optional content policy ${St.policy}.`),!0}return(0,Oe.warn)(`Unknown group type ${St.type}.`),!0}setVisibility(St,Ce=!0){if(!Mi(this,Te).has(St)){(0,Oe.warn)(`Optional content group not found: ${St}`);return}Mi(this,Te).get(St)._setVisible(Ue,!!Ce),yn(this,xe,null)}get hasInitialVisibility(){return this.getHash()===Mi(this,_e)}getOrder(){return Mi(this,Te).size?Mi(this,Se)?Mi(this,Se).slice():[...Mi(this,Te).keys()]:null}getGroups(){return Mi(this,Te).size>0?(0,Oe.objectFromMap)(Mi(this,Te)):null}getGroup(St){return Mi(this,Te).get(St)||null}getHash(){if(Mi(this,xe)!==null)return Mi(this,xe);const St=new Be.MurmurHash3_64;for(const[Ce,ke]of Mi(this,Te))St.update(`${Ce}:${ke.visible}`);return yn(this,xe,St.hexdigest())}}xe=new WeakMap,Te=new WeakMap,_e=new WeakMap,Se=new WeakMap,t=new WeakSet,Nl=function(St){const Ce=St.length;if(Ce<2)return!0;const ke=St[0];for(let De=1;De<Ce;De++){const Re=St[De];let je;if(Array.isArray(Re))je=fn(this,t,Nl).call(this,Re);else if(Mi(this,Te).has(Re))je=Mi(this,Te).get(Re).visible;else return(0,Oe.warn)(`Optional content group not found: ${Re}`),!0;switch(ke){case"And":if(!je)return!1;break;case"Or":if(je)return!0;break;case"Not":return!je;default:return!0}}return ke==="And"},r.OptionalContentConfig=Ee},(Ie,r,Me)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.PDFDataTransportStream=void 0;var Oe=Me(1),Be=Me(6);class Ue{constructor(xe,Te){(0,Oe.assert)(Te,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.'),this._queuedChunks=[],this._progressiveDone=xe.progressiveDone||!1,this._contentDispositionFilename=xe.contentDispositionFilename||null;const _e=xe.initialData;if((_e==null?void 0:_e.length)>0){const Se=new Uint8Array(_e).buffer;this._queuedChunks.push(Se)}this._pdfDataRangeTransport=Te,this._isStreamingSupported=!xe.disableStream,this._isRangeSupported=!xe.disableRange,this._contentLength=xe.length,this._fullRequestReader=null,this._rangeReaders=[],this._pdfDataRangeTransport.addRangeListener((Se,t)=>{this._onReceiveData({begin:Se,chunk:t})}),this._pdfDataRangeTransport.addProgressListener((Se,t)=>{this._onProgress({loaded:Se,total:t})}),this._pdfDataRangeTransport.addProgressiveReadListener(Se=>{this._onReceiveData({chunk:Se})}),this._pdfDataRangeTransport.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),this._pdfDataRangeTransport.transportReady()}_onReceiveData(xe){const Te=new Uint8Array(xe.chunk).buffer;if(xe.begin===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(Te):this._queuedChunks.push(Te);else{const _e=this._rangeReaders.some(function(Se){return Se._begin!==xe.begin?!1:(Se._enqueue(Te),!0)});(0,Oe.assert)(_e,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var xe,Te;return(Te=(xe=this._fullRequestReader)==null?void 0:xe._loaded)!=null?Te:0}_onProgress(xe){var Te,_e,Se,t;xe.total===void 0?(_e=(Te=this._rangeReaders[0])==null?void 0:Te.onProgress)==null||_e.call(Te,{loaded:xe.loaded}):(t=(Se=this._fullRequestReader)==null?void 0:Se.onProgress)==null||t.call(Se,{loaded:xe.loaded,total:xe.total})}_onProgressiveDone(){var xe;(xe=this._fullRequestReader)==null||xe.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(xe){const Te=this._rangeReaders.indexOf(xe);Te>=0&&this._rangeReaders.splice(Te,1)}getFullReader(){(0,Oe.assert)(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const xe=this._queuedChunks;return this._queuedChunks=null,new He(this,xe,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(xe,Te){if(Te<=this._progressiveDataLength)return null;const _e=new Ee(this,xe,Te);return this._pdfDataRangeTransport.requestDataRange(xe,Te),this._rangeReaders.push(_e),_e}cancelAllRequests(xe){var Te;(Te=this._fullRequestReader)==null||Te.cancel(xe);for(const _e of this._rangeReaders.slice(0))_e.cancel(xe);this._pdfDataRangeTransport.abort()}}r.PDFDataTransportStream=Ue;class He{constructor(xe,Te,_e=!1,Se=null){this._stream=xe,this._done=_e||!1,this._filename=(0,Be.isPdfFile)(Se)?Se:null,this._queuedChunks=Te||[],this._loaded=0;for(const t of this._queuedChunks)this._loaded+=t.byteLength;this._requests=[],this._headersReady=Promise.resolve(),xe._fullRequestReader=this,this.onProgress=null}_enqueue(xe){this._done||(this._requests.length>0?this._requests.shift().resolve({value:xe,done:!1}):this._queuedChunks.push(xe),this._loaded+=xe.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const xe=(0,Oe.createPromiseCapability)();return this._requests.push(xe),xe.promise}cancel(xe){this._done=!0;for(const Te of this._requests)Te.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class Ee{constructor(xe,Te,_e){this._stream=xe,this._begin=Te,this._end=_e,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(xe){if(!this._done){if(this._requests.length===0)this._queuedChunk=xe;else{this._requests.shift().resolve({value:xe,done:!1});for(const _e of this._requests)_e.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const Te=this._queuedChunk;return this._queuedChunk=null,{value:Te,done:!1}}if(this._done)return{value:void 0,done:!0};const xe=(0,Oe.createPromiseCapability)();return this._requests.push(xe),xe.promise}cancel(xe){this._done=!0;for(const Te of this._requests)Te.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}},(Ie,r)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.XfaText=void 0;class Me{static textContent(Be){const Ue=[],He={items:Ue,styles:Object.create(null)};function Ee(e){var _e;if(!e)return;let xe=null;const Te=e.name;if(Te==="#text")xe=e.value;else if(Me.shouldBuildText(Te))(_e=e==null?void 0:e.attributes)!=null&&_e.textContent?xe=e.attributes.textContent:e.value&&(xe=e.value);else return;if(xe!==null&&Ue.push({str:xe}),!!e.children)for(const Se of e.children)Ee(Se)}return Ee(Be),He}static shouldBuildText(Be){return!(Be==="textarea"||Be==="input"||Be==="option"||Be==="select")}}r.XfaText=Me},(Ie,r,Me)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.NodeStandardFontDataFactory=r.NodeCanvasFactory=r.NodeCMapReaderFactory=void 0;var Oe=Me(7);const Be=function(e){return new Promise((xe,Te)=>{require$$5.readFile(e,(Se,t)=>{if(Se||!t){Te(new Error(Se));return}xe(new Uint8Array(t))})})};class Ue extends Oe.BaseCanvasFactory{_createCanvas(xe,Te){return require$$5.createCanvas(xe,Te)}}r.NodeCanvasFactory=Ue;class He extends Oe.BaseCMapReaderFactory{_fetchData(xe,Te){return Be(xe).then(_e=>({cMapData:_e,compressionType:Te}))}}r.NodeCMapReaderFactory=He;class Ee extends Oe.BaseStandardFontDataFactory{_fetchData(xe){return Be(xe)}}r.NodeStandardFontDataFactory=Ee},(Ie,r,Me)=>{var e,xe,Te,_e,Se,t,Ae,Pe,St,Dl,ke,Nh,Re,Il,We,Dh;Object.defineProperty(r,"__esModule",{value:!0}),r.AnnotationEditorLayer=void 0;var Oe=Me(5),Be=Me(1),Ue=Me(22),He=Me(23);const Je=class{constructor(oi){rn(this,St);rn(this,ke);rn(this,Re);rn(this,We);rn(this,e,void 0);rn(this,xe,!1);rn(this,Te,this.pointerup.bind(this));rn(this,_e,this.pointerdown.bind(this));rn(this,Se,new Map);rn(this,t,!1);rn(this,Ae,!1);rn(this,Pe,void 0);Je._initialized||(Je._initialized=!0,Ue.FreeTextEditor.initialize(oi.l10n),He.InkEditor.initialize(oi.l10n)),oi.uiManager.registerEditorTypes([Ue.FreeTextEditor,He.InkEditor]),yn(this,Pe,oi.uiManager),this.annotationStorage=oi.annotationStorage,this.pageIndex=oi.pageIndex,this.div=oi.div,yn(this,e,oi.accessibilityManager),Mi(this,Pe).addLayer(this)}updateToolbar(oi){Mi(this,Pe).updateToolbar(oi)}updateMode(oi=Mi(this,Pe).getMode()){fn(this,We,Dh).call(this),oi===Be.AnnotationEditorType.INK?(this.addInkEditorIfNeeded(!1),this.disableClick()):this.enableClick(),Mi(this,Pe).unselectAll(),this.div.classList.toggle("freeTextEditing",oi===Be.AnnotationEditorType.FREETEXT),this.div.classList.toggle("inkEditing",oi===Be.AnnotationEditorType.INK)}addInkEditorIfNeeded(oi){if(!oi&&Mi(this,Pe).getMode()!==Be.AnnotationEditorType.INK)return;if(!oi){for(const ai of Mi(this,Se).values())if(ai.isEmpty()){ai.setInBackground();return}}fn(this,Re,Il).call(this,{offsetX:0,offsetY:0}).setInBackground()}setEditingState(oi){Mi(this,Pe).setEditingState(oi)}addCommands(oi){Mi(this,Pe).addCommands(oi)}enable(){this.div.style.pointerEvents="auto";for(const oi of Mi(this,Se).values())oi.enableEditing()}disable(){this.div.style.pointerEvents="none";for(const oi of Mi(this,Se).values())oi.disableEditing()}setActiveEditor(oi){Mi(this,Pe).getActive()!==oi&&Mi(this,Pe).setActiveEditor(oi)}enableClick(){this.div.addEventListener("pointerdown",Mi(this,_e)),this.div.addEventListener("pointerup",Mi(this,Te))}disableClick(){this.div.removeEventListener("pointerdown",Mi(this,_e)),this.div.removeEventListener("pointerup",Mi(this,Te))}attach(oi){Mi(this,Se).set(oi.id,oi)}detach(oi){var ti;Mi(this,Se).delete(oi.id),(ti=Mi(this,e))==null||ti.removePointerInTextLayer(oi.contentDiv)}remove(oi){Mi(this,Pe).removeEditor(oi),this.detach(oi),this.annotationStorage.remove(oi.id),oi.div.style.display="none",setTimeout(()=>{oi.div.style.display="",oi.div.remove(),oi.isAttachedToDOM=!1,document.activeElement===document.body&&Mi(this,Pe).focusMainContainer()},0),Mi(this,Ae)||this.addInkEditorIfNeeded(!1)}add(oi){if(fn(this,St,Dl).call(this,oi),Mi(this,Pe).addEditor(oi),this.attach(oi),!oi.isAttachedToDOM){const ti=oi.render();this.div.append(ti),oi.isAttachedToDOM=!0}this.moveEditorInDOM(oi),oi.onceAdded(),this.addToAnnotationStorage(oi)}moveEditorInDOM(oi){var ti;(ti=Mi(this,e))==null||ti.moveElementInDOM(this.div,oi.div,oi.contentDiv,!0)}addToAnnotationStorage(oi){!oi.isEmpty()&&!this.annotationStorage.has(oi.id)&&this.annotationStorage.setValue(oi.id,oi)}addOrRebuild(oi){oi.needsToBeRebuilt()?oi.rebuild():this.add(oi)}addANewEditor(oi){const ti=()=>{this.addOrRebuild(oi)},ai=()=>{oi.remove()};this.addCommands({cmd:ti,undo:ai,mustExec:!0})}addUndoableEditor(oi){const ti=()=>{this.addOrRebuild(oi)},ai=()=>{oi.remove()};this.addCommands({cmd:ti,undo:ai,mustExec:!1})}getNextId(){return Mi(this,Pe).getId()}deserialize(oi){switch(oi.annotationType){case Be.AnnotationEditorType.FREETEXT:return Ue.FreeTextEditor.deserialize(oi,this);case Be.AnnotationEditorType.INK:return He.InkEditor.deserialize(oi,this)}return null}setSelected(oi){Mi(this,Pe).setSelected(oi)}toggleSelected(oi){Mi(this,Pe).toggleSelected(oi)}isSelected(oi){return Mi(this,Pe).isSelected(oi)}unselect(oi){Mi(this,Pe).unselect(oi)}pointerup(oi){const ti=Oe.KeyboardManager.platform.isMac;if(!(oi.button!==0||oi.ctrlKey&&ti)&&oi.target===this.div&&!!Mi(this,t)){if(yn(this,t,!1),!Mi(this,xe)){yn(this,xe,!0);return}fn(this,Re,Il).call(this,oi)}}pointerdown(oi){const ti=Oe.KeyboardManager.platform.isMac;if(oi.button!==0||oi.ctrlKey&&ti||oi.target!==this.div)return;yn(this,t,!0);const ai=Mi(this,Pe).getActive();yn(this,xe,!ai||ai.isEmpty())}drop(oi){const ti=oi.dataTransfer.getData("text/plain"),ai=Mi(this,Pe).getEditor(ti);if(!ai)return;oi.preventDefault(),oi.dataTransfer.dropEffect="move",fn(this,St,Dl).call(this,ai);const yi=this.div.getBoundingClientRect(),di=oi.clientX-yi.x,bi=oi.clientY-yi.y;ai.translate(di-ai.startX,bi-ai.startY),this.moveEditorInDOM(ai),ai.div.focus()}dragover(oi){oi.preventDefault()}destroy(){var oi,ti;((oi=Mi(this,Pe).getActive())==null?void 0:oi.parent)===this&&Mi(this,Pe).setActiveEditor(null);for(const ai of Mi(this,Se).values())(ti=Mi(this,e))==null||ti.removePointerInTextLayer(ai.contentDiv),ai.isAttachedToDOM=!1,ai.div.remove(),ai.parent=null;this.div=null,Mi(this,Se).clear(),Mi(this,Pe).removeLayer(this)}render(oi){this.viewport=oi.viewport,(0,Oe.bindEvents)(this,this.div,["dragover","drop"]),this.setDimensions();for(const ti of Mi(this,Pe).getEditors(this.pageIndex))this.add(ti);this.updateMode()}update(oi){Mi(this,Pe).commitOrRemove(),this.viewport=oi.viewport,this.setDimensions(),this.updateMode()}get scaleFactor(){return this.viewport.scale}get pageDimensions(){const[oi,ti,ai,yi]=this.viewport.viewBox,di=ai-oi,bi=yi-ti;return[di,bi]}get viewportBaseDimensions(){const{width:oi,height:ti,rotation:ai}=this.viewport;return ai%180===0?[oi,ti]:[ti,oi]}setDimensions(){const{width:oi,height:ti,rotation:ai}=this.viewport,yi=ai%180!==0,di=Math.floor(oi)+"px",bi=Math.floor(ti)+"px";this.div.style.width=yi?bi:di,this.div.style.height=yi?di:bi,this.div.setAttribute("data-main-rotation",ai)}};let Ee=Je;e=new WeakMap,xe=new WeakMap,Te=new WeakMap,_e=new WeakMap,Se=new WeakMap,t=new WeakMap,Ae=new WeakMap,Pe=new WeakMap,St=new WeakSet,Dl=function(oi){var ti;oi.parent!==this&&(this.attach(oi),oi.pageIndex=this.pageIndex,(ti=oi.parent)==null||ti.detach(oi),oi.parent=this,oi.div&&oi.isAttachedToDOM&&(oi.div.remove(),this.div.append(oi.div)))},ke=new WeakSet,Nh=function(oi){switch(Mi(this,Pe).getMode()){case Be.AnnotationEditorType.FREETEXT:return new Ue.FreeTextEditor(oi);case Be.AnnotationEditorType.INK:return new He.InkEditor(oi)}return null},Re=new WeakSet,Il=function(oi){const ti=this.getNextId(),ai=fn(this,ke,Nh).call(this,{parent:this,id:ti,x:oi.offsetX,y:oi.offsetY});return ai&&this.add(ai),ai},We=new WeakSet,Dh=function(){yn(this,Ae,!0);for(const oi of Mi(this,Se).values())oi.isEmpty()&&oi.remove();yn(this,Ae,!1)},qn(Ee,"_initialized",!1),r.AnnotationEditorLayer=Ee},(Ie,r,Me)=>{var Ee,e,xe,Te,_e,Se,t,Ae,Pe,St,Ih,ke,Rh,Re,jh,We,Rl;Object.defineProperty(r,"__esModule",{value:!0}),r.FreeTextEditor=void 0;var Oe=Me(1),Be=Me(5),Ue=Me(4);const Je=class extends Ue.AnnotationEditor{constructor(ti){super({...ti,name:"freeTextEditor"});rn(this,St);rn(this,ke);rn(this,Re);rn(this,We);rn(this,Ee,this.editorDivBlur.bind(this));rn(this,e,this.editorDivFocus.bind(this));rn(this,xe,this.editorDivInput.bind(this));rn(this,Te,this.editorDivKeydown.bind(this));rn(this,_e,void 0);rn(this,Se,"");rn(this,t,`${this.id}-editor`);rn(this,Ae,!1);rn(this,Pe,void 0);yn(this,_e,ti.color||Je._defaultColor||Ue.AnnotationEditor._defaultLineColor),yn(this,Pe,ti.fontSize||Je._defaultFontSize)}static initialize(ti){this._l10nPromise=new Map(["free_text2_default_content","editor_free_text2_aria_label"].map(yi=>[yi,ti.get(yi)]));const ai=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(ai.getPropertyValue("--freetext-padding"))}static updateDefaultParams(ti,ai){switch(ti){case Oe.AnnotationEditorParamsType.FREETEXT_SIZE:Je._defaultFontSize=ai;break;case Oe.AnnotationEditorParamsType.FREETEXT_COLOR:Je._defaultColor=ai;break}}updateParams(ti,ai){switch(ti){case Oe.AnnotationEditorParamsType.FREETEXT_SIZE:fn(this,St,Ih).call(this,ai);break;case Oe.AnnotationEditorParamsType.FREETEXT_COLOR:fn(this,ke,Rh).call(this,ai);break}}static get defaultPropertiesToUpdate(){return[[Oe.AnnotationEditorParamsType.FREETEXT_SIZE,Je._defaultFontSize],[Oe.AnnotationEditorParamsType.FREETEXT_COLOR,Je._defaultColor||Ue.AnnotationEditor._defaultLineColor]]}get propertiesToUpdate(){return[[Oe.AnnotationEditorParamsType.FREETEXT_SIZE,Mi(this,Pe)],[Oe.AnnotationEditorParamsType.FREETEXT_COLOR,Mi(this,_e)]]}getInitialTranslation(){return[-Je._internalPadding*this.parent.scaleFactor,-(Je._internalPadding+Mi(this,Pe))*this.parent.scaleFactor]}rebuild(){super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this))}enableEditMode(){this.isInEditMode()||(this.parent.setEditingState(!1),this.parent.updateToolbar(Oe.AnnotationEditorType.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this.div.draggable=!1,this.div.removeAttribute("aria-activedescendant"),this.editorDiv.addEventListener("keydown",Mi(this,Te)),this.editorDiv.addEventListener("focus",Mi(this,e)),this.editorDiv.addEventListener("blur",Mi(this,Ee)),this.editorDiv.addEventListener("input",Mi(this,xe)))}disableEditMode(){!this.isInEditMode()||(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",Mi(this,t)),this.div.draggable=!0,this.editorDiv.removeEventListener("keydown",Mi(this,Te)),this.editorDiv.removeEventListener("focus",Mi(this,e)),this.editorDiv.removeEventListener("blur",Mi(this,Ee)),this.editorDiv.removeEventListener("input",Mi(this,xe)),this.div.focus(),this.isEditing=!1,this.parent.div.classList.add("freeTextEditing"))}focusin(ti){super.focusin(ti),ti.target!==this.editorDiv&&this.editorDiv.focus()}onceAdded(){this.width||(this.enableEditMode(),this.editorDiv.focus())}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent.setEditingState(!0),this.parent.div.classList.add("freeTextEditing"),super.remove()}commit(){super.commit(),Mi(this,Ae)||(yn(this,Ae,!0),this.parent.addUndoableEditor(this)),this.disableEditMode(),yn(this,Se,fn(this,Re,jh).call(this).trimEnd()),fn(this,We,Rl).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}dblclick(ti){this.enableEditMode(),this.editorDiv.focus()}keydown(ti){ti.target===this.div&&ti.key==="Enter"&&(this.enableEditMode(),this.editorDiv.focus())}editorDivKeydown(ti){Je._keyboardManager.exec(this,ti)}editorDivFocus(ti){this.isEditing=!0}editorDivBlur(ti){this.isEditing=!1}editorDivInput(ti){this.parent.div.classList.toggle("freeTextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let ti,ai;this.width&&(ti=this.x,ai=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",Mi(this,t)),this.enableEditing(),Je._l10nPromise.get("editor_free_text2_aria_label").then(di=>{var bi;return(bi=this.editorDiv)==null?void 0:bi.setAttribute("aria-label",di)}),Je._l10nPromise.get("free_text2_default_content").then(di=>{var bi;return(bi=this.editorDiv)==null?void 0:bi.setAttribute("default-content",di)}),this.editorDiv.contentEditable=!0;const{style:yi}=this.editorDiv;if(yi.fontSize=`calc(${Mi(this,Pe)}px * var(--scale-factor))`,yi.color=Mi(this,_e),this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),(0,Be.bindEvents)(this,this.div,["dblclick","keydown"]),this.width){const[di,bi]=this.parent.viewportBaseDimensions;this.setAt(ti*di,ai*bi,this.width*di,this.height*bi);for(const vi of Mi(this,Se).split(`
`)){const Pi=document.createElement("div");Pi.append(vi?document.createTextNode(vi):document.createElement("br")),this.editorDiv.append(Pi)}this.div.draggable=!0,this.editorDiv.contentEditable=!1}else this.div.draggable=!1,this.editorDiv.contentEditable=!0;return this.div}get contentDiv(){return this.editorDiv}static deserialize(ti,ai){const yi=super.deserialize(ti,ai);return yn(yi,Pe,ti.fontSize),yn(yi,_e,Oe.Util.makeHexColor(...ti.color)),yn(yi,Se,ti.value),yi}serialize(){if(this.isEmpty())return null;const ti=Je._internalPadding*this.parent.scaleFactor,ai=this.getRect(ti,ti),yi=Ue.AnnotationEditor._colorManager.convert(getComputedStyle(this.editorDiv).color);return{annotationType:Oe.AnnotationEditorType.FREETEXT,color:yi,fontSize:Mi(this,Pe),value:Mi(this,Se),pageIndex:this.parent.pageIndex,rect:ai,rotation:this.rotation}}};let He=Je;Ee=new WeakMap,e=new WeakMap,xe=new WeakMap,Te=new WeakMap,_e=new WeakMap,Se=new WeakMap,t=new WeakMap,Ae=new WeakMap,Pe=new WeakMap,St=new WeakSet,Ih=function(ti){const ai=di=>{this.editorDiv.style.fontSize=`calc(${di}px * var(--scale-factor))`,this.translate(0,-(di-Mi(this,Pe))*this.parent.scaleFactor),yn(this,Pe,di),fn(this,We,Rl).call(this)},yi=Mi(this,Pe);this.parent.addCommands({cmd:()=>{ai(ti)},undo:()=>{ai(yi)},mustExec:!0,type:Oe.AnnotationEditorParamsType.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},ke=new WeakSet,Rh=function(ti){const ai=Mi(this,_e);this.parent.addCommands({cmd:()=>{yn(this,_e,ti),this.editorDiv.style.color=ti},undo:()=>{yn(this,_e,ai),this.editorDiv.style.color=ai},mustExec:!0,type:Oe.AnnotationEditorParamsType.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},Re=new WeakSet,jh=function(){const ti=this.editorDiv.getElementsByTagName("div");if(ti.length===0)return this.editorDiv.innerText;const ai=[];for(const yi of ti){const di=yi.firstChild;(di==null?void 0:di.nodeName)==="#text"?ai.push(di.data):ai.push("")}return ai.join(`
`)},We=new WeakSet,Rl=function(){const[ti,ai]=this.parent.viewportBaseDimensions,yi=this.div.getBoundingClientRect();this.width=yi.width/ti,this.height=yi.height/ai},qn(He,"_freeTextDefaultContent",""),qn(He,"_l10nPromise"),qn(He,"_internalPadding",0),qn(He,"_defaultColor",null),qn(He,"_defaultFontSize",10),qn(He,"_keyboardManager",new Be.KeyboardManager([[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],Je.prototype.commitOrRemove]])),qn(He,"_type","freetext"),r.FreeTextEditor=He},(Ie,r,Me)=>{var Te,_e,Se,t,Ae,Pe,St,Ce,ke,De,Re,je,We,Ke,Je,Bh,oi,Uh,ai,qh,di,zh,vi,jl,xi,Wh,fi,Hh,Xe,Xh,ze,is,ei,Bl,li,Fo,Ci,Mo,Oi,ca,Ze,Ul,Qe,No,gi,ql,Ri,Vh,ki,Gh,Ii,Yh,tn,zl,zi,Do,pn,ua,kn,Wl;Object.defineProperty(r,"__esModule",{value:!0}),r.InkEditor=void 0,Object.defineProperty(r,"fitCurve",{enumerable:!0,get:function(){return Ue.fitCurve}});var Oe=Me(1),Be=Me(4),Ue=Me(24),He=Me(5);const Ee=16,e=100,Tn=class extends Be.AnnotationEditor{constructor(Bi){super({...Bi,name:"inkEditor"});rn(this,Je);rn(this,oi);rn(this,ai);rn(this,di);rn(this,vi);rn(this,xi);rn(this,fi);rn(this,Xe);rn(this,ze);rn(this,ei);rn(this,li);rn(this,Ci);rn(this,Oi);rn(this,Ze);rn(this,Qe);rn(this,Ri);rn(this,ki);rn(this,Ii);rn(this,tn);rn(this,zi);rn(this,pn);rn(this,kn);rn(this,Te,0);rn(this,_e,0);rn(this,Se,0);rn(this,t,this.canvasPointermove.bind(this));rn(this,Ae,this.canvasPointerleave.bind(this));rn(this,Pe,this.canvasPointerup.bind(this));rn(this,St,this.canvasPointerdown.bind(this));rn(this,Ce,!1);rn(this,ke,!1);rn(this,De,null);rn(this,Re,null);rn(this,je,0);rn(this,We,0);rn(this,Ke,null);this.color=Bi.color||null,this.thickness=Bi.thickness||null,this.opacity=Bi.opacity||null,this.paths=[],this.bezierPath2D=[],this.currentPath=[],this.scaleFactor=1,this.translationX=this.translationY=0,this.x=0,this.y=0}static initialize(Bi){this._l10nPromise=new Map(["editor_ink_canvas_aria_label","editor_ink2_aria_label"].map(Ni=>[Ni,Bi.get(Ni)]))}static updateDefaultParams(Bi,Ni){switch(Bi){case Oe.AnnotationEditorParamsType.INK_THICKNESS:Tn._defaultThickness=Ni;break;case Oe.AnnotationEditorParamsType.INK_COLOR:Tn._defaultColor=Ni;break;case Oe.AnnotationEditorParamsType.INK_OPACITY:Tn._defaultOpacity=Ni/100;break}}updateParams(Bi,Ni){switch(Bi){case Oe.AnnotationEditorParamsType.INK_THICKNESS:fn(this,Je,Bh).call(this,Ni);break;case Oe.AnnotationEditorParamsType.INK_COLOR:fn(this,oi,Uh).call(this,Ni);break;case Oe.AnnotationEditorParamsType.INK_OPACITY:fn(this,ai,qh).call(this,Ni);break}}static get defaultPropertiesToUpdate(){return[[Oe.AnnotationEditorParamsType.INK_THICKNESS,Tn._defaultThickness],[Oe.AnnotationEditorParamsType.INK_COLOR,Tn._defaultColor||Be.AnnotationEditor._defaultLineColor],[Oe.AnnotationEditorParamsType.INK_OPACITY,Math.round(Tn._defaultOpacity*100)]]}get propertiesToUpdate(){var Bi;return[[Oe.AnnotationEditorParamsType.INK_THICKNESS,this.thickness||Tn._defaultThickness],[Oe.AnnotationEditorParamsType.INK_COLOR,this.color||Tn._defaultColor||Be.AnnotationEditor._defaultLineColor],[Oe.AnnotationEditorParamsType.INK_OPACITY,Math.round(100*((Bi=this.opacity)!=null?Bi:Tn._defaultOpacity))]]}rebuild(){super.rebuild(),this.div!==null&&(this.canvas||(fn(this,li,Fo).call(this),fn(this,Ci,Mo).call(this)),this.isAttachedToDOM||(this.parent.add(this),fn(this,Oi,ca).call(this)),fn(this,pn,ua).call(this))}remove(){this.canvas!==null&&(this.isEmpty()||this.commit(),this.canvas.width=this.canvas.height=0,this.canvas.remove(),this.canvas=null,Mi(this,Re).disconnect(),yn(this,Re,null),super.remove())}enableEditMode(){Mi(this,Ce)||this.canvas===null||(super.enableEditMode(),this.div.draggable=!1,this.canvas.addEventListener("pointerdown",Mi(this,St)),this.canvas.addEventListener("pointerup",Mi(this,Pe)))}disableEditMode(){!this.isInEditMode()||this.canvas===null||(super.disableEditMode(),this.div.draggable=!this.isEmpty(),this.div.classList.remove("editing"),this.canvas.removeEventListener("pointerdown",Mi(this,St)),this.canvas.removeEventListener("pointerup",Mi(this,Pe)))}onceAdded(){this.div.draggable=!this.isEmpty()}isEmpty(){return this.paths.length===0||this.paths.length===1&&this.paths[0].length===0}commit(){Mi(this,Ce)||(super.commit(),this.isEditing=!1,this.disableEditMode(),this.setInForeground(),yn(this,Ce,!0),this.div.classList.add("disabled"),fn(this,pn,ua).call(this,!0),this.parent.addInkEditorIfNeeded(!0),this.parent.moveEditorInDOM(this),this.div.focus())}focusin(Bi){super.focusin(Bi),this.enableEditMode()}canvasPointerdown(Bi){Bi.button!==0||!this.isInEditMode()||Mi(this,Ce)||(this.setInForeground(),Bi.type!=="mouse"&&this.div.focus(),Bi.stopPropagation(),this.canvas.addEventListener("pointerleave",Mi(this,Ae)),this.canvas.addEventListener("pointermove",Mi(this,t)),fn(this,xi,Wh).call(this,Bi.offsetX,Bi.offsetY))}canvasPointermove(Bi){Bi.stopPropagation(),fn(this,fi,Hh).call(this,Bi.offsetX,Bi.offsetY)}canvasPointerup(Bi){Bi.button===0&&this.isInEditMode()&&this.currentPath.length!==0&&(Bi.stopPropagation(),fn(this,ei,Bl).call(this,Bi),this.setInBackground())}canvasPointerleave(Bi){fn(this,ei,Bl).call(this,Bi),this.setInBackground()}render(){if(this.div)return this.div;let Bi,Ni;this.width&&(Bi=this.x,Ni=this.y),super.render(),Tn._l10nPromise.get("editor_ink2_aria_label").then(vn=>{var mn;return(mn=this.div)==null?void 0:mn.setAttribute("aria-label",vn)});const[qi,on,bn,En]=fn(this,di,zh).call(this);if(this.setAt(qi,on,0,0),this.setDims(bn,En),fn(this,li,Fo).call(this),this.width){const[vn,mn]=this.parent.viewportBaseDimensions;this.setAt(Bi*vn,Ni*mn,this.width*vn,this.height*mn),yn(this,ke,!0),fn(this,Oi,ca).call(this),this.setDims(this.width*vn,this.height*mn),fn(this,ze,is).call(this),fn(this,kn,Wl).call(this),this.div.classList.add("disabled")}else this.div.classList.add("editing"),this.enableEditMode();return fn(this,Ci,Mo).call(this),this.div}setDimensions(Bi,Ni){const qi=Math.round(Bi),on=Math.round(Ni);if(Mi(this,je)===qi&&Mi(this,We)===on)return;yn(this,je,qi),yn(this,We,on),this.canvas.style.visibility="hidden",Mi(this,Te)&&Math.abs(Mi(this,Te)-Bi/Ni)>.01&&(Ni=Math.ceil(Bi/Mi(this,Te)),this.setDims(Bi,Ni));const[bn,En]=this.parent.viewportBaseDimensions;this.width=Bi/bn,this.height=Ni/En,Mi(this,Ce)&&fn(this,Ze,Ul).call(this,Bi,Ni),fn(this,Oi,ca).call(this),fn(this,ze,is).call(this),this.canvas.style.visibility="visible"}static deserialize(Bi,Ni){var Mn,zn;const qi=super.deserialize(Bi,Ni);qi.thickness=Bi.thickness,qi.color=Oe.Util.makeHexColor(...Bi.color),qi.opacity=Bi.opacity;const[on,bn]=Ni.pageDimensions,En=qi.width*on,vn=qi.height*bn,mn=Ni.scaleFactor,Pn=Bi.thickness/2;yn(qi,Te,En/vn),yn(qi,Ce,!0),yn(qi,je,Math.round(En)),yn(qi,We,Math.round(vn));for(const{bezier:Fn}of Bi.paths){const Cn=[];qi.paths.push(Cn);let Rn=mn*(Fn[0]-Pn),er=mn*(vn-Fn[1]-Pn);for(let Wn=2,Gn=Fn.length;Wn<Gn;Wn+=6){const sr=mn*(Fn[Wn]-Pn),rr=mn*(vn-Fn[Wn+1]-Pn),ur=mn*(Fn[Wn+2]-Pn),fr=mn*(vn-Fn[Wn+3]-Pn),_r=mn*(Fn[Wn+4]-Pn),Cr=mn*(vn-Fn[Wn+5]-Pn);Cn.push([[Rn,er],[sr,rr],[ur,fr],[_r,Cr]]),Rn=_r,er=Cr}const Kn=fn(this,gi,ql).call(this,Cn);qi.bezierPath2D.push(Kn)}const In=fn(Mn=qi,tn,zl).call(Mn);return yn(qi,Se,Math.max(Ee,In[2]-In[0])),yn(qi,_e,Math.max(Ee,In[3]-In[1])),fn(zn=qi,Ze,Ul).call(zn,En,vn),qi}serialize(){if(this.isEmpty())return null;const Bi=this.getRect(0,0),Ni=this.rotation%180===0?Bi[3]-Bi[1]:Bi[2]-Bi[0],qi=Be.AnnotationEditor._colorManager.convert(this.ctx.strokeStyle);return{annotationType:Oe.AnnotationEditorType.INK,color:qi,thickness:this.thickness,opacity:this.opacity,paths:fn(this,Ri,Vh).call(this,this.scaleFactor/this.parent.scaleFactor,this.translationX,this.translationY,Ni),pageIndex:this.parent.pageIndex,rect:Bi,rotation:this.rotation}}};let xe=Tn;Te=new WeakMap,_e=new WeakMap,Se=new WeakMap,t=new WeakMap,Ae=new WeakMap,Pe=new WeakMap,St=new WeakMap,Ce=new WeakMap,ke=new WeakMap,De=new WeakMap,Re=new WeakMap,je=new WeakMap,We=new WeakMap,Ke=new WeakMap,Je=new WeakSet,Bh=function(Bi){const Ni=this.thickness;this.parent.addCommands({cmd:()=>{this.thickness=Bi,fn(this,pn,ua).call(this)},undo:()=>{this.thickness=Ni,fn(this,pn,ua).call(this)},mustExec:!0,type:Oe.AnnotationEditorParamsType.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0})},oi=new WeakSet,Uh=function(Bi){const Ni=this.color;this.parent.addCommands({cmd:()=>{this.color=Bi,fn(this,ze,is).call(this)},undo:()=>{this.color=Ni,fn(this,ze,is).call(this)},mustExec:!0,type:Oe.AnnotationEditorParamsType.INK_COLOR,overwriteIfSameType:!0,keepUndo:!0})},ai=new WeakSet,qh=function(Bi){Bi/=100;const Ni=this.opacity;this.parent.addCommands({cmd:()=>{this.opacity=Bi,fn(this,ze,is).call(this)},undo:()=>{this.opacity=Ni,fn(this,ze,is).call(this)},mustExec:!0,type:Oe.AnnotationEditorParamsType.INK_OPACITY,overwriteIfSameType:!0,keepUndo:!0})},di=new WeakSet,zh=function(){const{width:Bi,height:Ni,rotation:qi}=this.parent.viewport;switch(qi){case 90:return[0,Bi,Bi,Ni];case 180:return[Bi,Ni,Bi,Ni];case 270:return[Ni,0,Bi,Ni];default:return[0,0,Bi,Ni]}},vi=new WeakSet,jl=function(){this.ctx.lineWidth=this.thickness*this.parent.scaleFactor/this.scaleFactor,this.ctx.lineCap="round",this.ctx.lineJoin="round",this.ctx.miterLimit=10,this.ctx.strokeStyle=`${this.color}${(0,He.opacityToHex)(this.opacity)}`},xi=new WeakSet,Wh=function(Bi,Ni){var qi;this.isEditing=!0,Mi(this,ke)||(yn(this,ke,!0),fn(this,Oi,ca).call(this),this.thickness||(this.thickness=Tn._defaultThickness),this.color||(this.color=Tn._defaultColor||Be.AnnotationEditor._defaultLineColor),(qi=this.opacity)!=null||(this.opacity=Tn._defaultOpacity)),this.currentPath.push([Bi,Ni]),yn(this,De,null),fn(this,vi,jl).call(this),this.ctx.beginPath(),this.ctx.moveTo(Bi,Ni),yn(this,Ke,()=>{!Mi(this,Ke)||(Mi(this,De)&&(this.isEmpty()?(this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height)):fn(this,ze,is).call(this),this.ctx.lineTo(...Mi(this,De)),yn(this,De,null),this.ctx.stroke()),window.requestAnimationFrame(Mi(this,Ke)))}),window.requestAnimationFrame(Mi(this,Ke))},fi=new WeakSet,Hh=function(Bi,Ni){const[qi,on]=this.currentPath.at(-1);Bi===qi&&Ni===on||(this.currentPath.push([Bi,Ni]),yn(this,De,[Bi,Ni]))},Xe=new WeakSet,Xh=function(Bi,Ni){var Pn;this.ctx.closePath(),yn(this,Ke,null),Bi=Math.min(Math.max(Bi,0),this.canvas.width),Ni=Math.min(Math.max(Ni,0),this.canvas.height);const[qi,on]=this.currentPath.at(-1);(Bi!==qi||Ni!==on)&&this.currentPath.push([Bi,Ni]);let bn;if(this.currentPath.length!==1)bn=(0,Ue.fitCurve)(this.currentPath,30,null);else{const In=[Bi,Ni];bn=[[In,In.slice(),In.slice(),In]]}const En=fn(Pn=Tn,gi,ql).call(Pn,bn);this.currentPath.length=0;const vn=()=>{this.paths.push(bn),this.bezierPath2D.push(En),this.rebuild()},mn=()=>{this.paths.pop(),this.bezierPath2D.pop(),this.paths.length===0?this.remove():(this.canvas||(fn(this,li,Fo).call(this),fn(this,Ci,Mo).call(this)),fn(this,pn,ua).call(this))};this.parent.addCommands({cmd:vn,undo:mn,mustExec:!0})},ze=new WeakSet,is=function(){if(this.isEmpty()){fn(this,Qe,No).call(this);return}fn(this,vi,jl).call(this);const{canvas:Bi,ctx:Ni}=this;Ni.setTransform(1,0,0,1,0,0),Ni.clearRect(0,0,Bi.width,Bi.height),fn(this,Qe,No).call(this);for(const qi of this.bezierPath2D)Ni.stroke(qi)},ei=new WeakSet,Bl=function(Bi){fn(this,Xe,Xh).call(this,Bi.offsetX,Bi.offsetY),this.canvas.removeEventListener("pointerleave",Mi(this,Ae)),this.canvas.removeEventListener("pointermove",Mi(this,t)),this.parent.addToAnnotationStorage(this)},li=new WeakSet,Fo=function(){this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=0,this.canvas.className="inkEditorCanvas",Tn._l10nPromise.get("editor_ink_canvas_aria_label").then(Bi=>{var Ni;return(Ni=this.canvas)==null?void 0:Ni.setAttribute("aria-label",Bi)}),this.div.append(this.canvas),this.ctx=this.canvas.getContext("2d")},Ci=new WeakSet,Mo=function(){let Bi=null;yn(this,Re,new ResizeObserver(Ni=>{const qi=Ni[0].contentRect;qi.width&&qi.height&&(Bi!==null&&clearTimeout(Bi),Bi=setTimeout(()=>{this.fixDims(),Bi=null},e),this.setDimensions(qi.width,qi.height))})),Mi(this,Re).observe(this.div)},Oi=new WeakSet,ca=function(){if(!Mi(this,ke))return;const[Bi,Ni]=this.parent.viewportBaseDimensions;this.canvas.width=Math.ceil(this.width*Bi),this.canvas.height=Math.ceil(this.height*Ni),fn(this,Qe,No).call(this)},Ze=new WeakSet,Ul=function(Bi,Ni){const qi=fn(this,zi,Do).call(this),on=(Bi-qi)/Mi(this,Se),bn=(Ni-qi)/Mi(this,_e);this.scaleFactor=Math.min(on,bn)},Qe=new WeakSet,No=function(){const Bi=fn(this,zi,Do).call(this)/2;this.ctx.setTransform(this.scaleFactor,0,0,this.scaleFactor,this.translationX*this.scaleFactor+Bi,this.translationY*this.scaleFactor+Bi)},gi=new WeakSet,ql=function(Bi){const Ni=new Path2D;for(let qi=0,on=Bi.length;qi<on;qi++){const[bn,En,vn,mn]=Bi[qi];qi===0&&Ni.moveTo(...bn),Ni.bezierCurveTo(En[0],En[1],vn[0],vn[1],mn[0],mn[1])}return Ni},Ri=new WeakSet,Vh=function(Bi,Ni,qi,on){const En=[],vn=this.thickness/2;let mn,Pn;for(const In of this.paths){mn=[],Pn=[];for(let Mn=0,zn=In.length;Mn<zn;Mn++){const[Fn,Cn,Rn,er]=In[Mn],Kn=Bi*(Fn[0]+Ni)+vn,Wn=on-Bi*(Fn[1]+qi)-vn,Gn=Bi*(Cn[0]+Ni)+vn,sr=on-Bi*(Cn[1]+qi)-vn,rr=Bi*(Rn[0]+Ni)+vn,ur=on-Bi*(Rn[1]+qi)-vn,fr=Bi*(er[0]+Ni)+vn,_r=on-Bi*(er[1]+qi)-vn;Mn===0&&(mn.push(Kn,Wn),Pn.push(Kn,Wn)),mn.push(Gn,sr,rr,ur,fr,_r),fn(this,ki,Gh).call(this,Kn,Wn,Gn,sr,rr,ur,fr,_r,4,Pn)}En.push({bezier:mn,points:Pn})}return En},ki=new WeakSet,Gh=function(Bi,Ni,qi,on,bn,En,vn,mn,Pn,In){if(fn(this,Ii,Yh).call(this,Bi,Ni,qi,on,bn,En,vn,mn)){In.push(vn,mn);return}for(let Mn=1;Mn<Pn-1;Mn++){const zn=Mn/Pn,Fn=1-zn;let Cn=zn*Bi+Fn*qi,Rn=zn*Ni+Fn*on,er=zn*qi+Fn*bn,Kn=zn*on+Fn*En;const Wn=zn*bn+Fn*vn,Gn=zn*En+Fn*mn;Cn=zn*Cn+Fn*er,Rn=zn*Rn+Fn*Kn,er=zn*er+Fn*Wn,Kn=zn*Kn+Fn*Gn,Cn=zn*Cn+Fn*er,Rn=zn*Rn+Fn*Kn,In.push(Cn,Rn)}In.push(vn,mn)},Ii=new WeakSet,Yh=function(Bi,Ni,qi,on,bn,En,vn,mn){const In=(3*qi-2*Bi-vn)**2,Mn=(3*on-2*Ni-mn)**2,zn=(3*bn-Bi-2*vn)**2,Fn=(3*En-Ni-2*mn)**2;return Math.max(In,zn)+Math.max(Mn,Fn)<=10},tn=new WeakSet,zl=function(){let Bi=1/0,Ni=-1/0,qi=1/0,on=-1/0;for(const bn of this.paths)for(const[En,vn,mn,Pn]of bn){const In=Oe.Util.bezierBoundingBox(...En,...vn,...mn,...Pn);Bi=Math.min(Bi,In[0]),qi=Math.min(qi,In[1]),Ni=Math.max(Ni,In[2]),on=Math.max(on,In[3])}return[Bi,qi,Ni,on]},zi=new WeakSet,Do=function(){return Mi(this,Ce)?Math.ceil(this.thickness*this.parent.scaleFactor):0},pn=new WeakSet,ua=function(Bi=!1){if(this.isEmpty())return;if(!Mi(this,Ce)){fn(this,ze,is).call(this);return}const Ni=fn(this,tn,zl).call(this),qi=fn(this,zi,Do).call(this);yn(this,Se,Math.max(Ee,Ni[2]-Ni[0])),yn(this,_e,Math.max(Ee,Ni[3]-Ni[1]));const on=Math.ceil(qi+Mi(this,Se)*this.scaleFactor),bn=Math.ceil(qi+Mi(this,_e)*this.scaleFactor),[En,vn]=this.parent.viewportBaseDimensions;this.width=on/En,this.height=bn/vn,yn(this,Te,on/bn),fn(this,kn,Wl).call(this);const mn=this.translationX,Pn=this.translationY;this.translationX=-Ni[0],this.translationY=-Ni[1],fn(this,Oi,ca).call(this),fn(this,ze,is).call(this),yn(this,je,on),yn(this,We,bn),this.setDims(on,bn);const In=Bi?qi/this.scaleFactor/2:0;this.translate(mn-this.translationX-In,Pn-this.translationY-In)},kn=new WeakSet,Wl=function(){const{style:Bi}=this.div;Mi(this,Te)>=1?(Bi.minHeight=`${Ee}px`,Bi.minWidth=`${Math.round(Mi(this,Te)*Ee)}px`):(Bi.minWidth=`${Ee}px`,Bi.minHeight=`${Math.round(Ee/Mi(this,Te))}px`)},rn(xe,gi),qn(xe,"_defaultColor",null),qn(xe,"_defaultOpacity",1),qn(xe,"_defaultThickness",1),qn(xe,"_l10nPromise"),qn(xe,"_type","ink"),r.InkEditor=xe},(Ie,r,Me)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.fitCurve=void 0;const Oe=Me(25);r.fitCurve=Oe},Ie=>{function r(Ae,Pe,St){if(!Array.isArray(Ae))throw new TypeError("First argument should be an array");if(Ae.forEach(Re=>{if(!Array.isArray(Re)||Re.some(je=>typeof je!="number")||Re.length!==Ae[0].length)throw Error("Each point should be an array of numbers. Each point should have the same amount of numbers.")}),Ae=Ae.filter((Re,je)=>je===0||!Re.every((We,Ke)=>We===Ae[je-1][Ke])),Ae.length<2)return[];const Ce=Ae.length,ke=_e(Ae[1],Ae[0]),De=_e(Ae[Ce-2],Ae[Ce-1]);return Me(Ae,ke,De,Pe,St)}function Me(Ae,Pe,St,Ce,ke){var Re,je,We,Ke,Je,hi,oi,ti,ai,yi,di,bi,vi;if(Ae.length===2)return bi=Se.vectorLen(Se.subtract(Ae[0],Ae[1]))/3,Re=[Ae[0],Se.addArrays(Ae[0],Se.mulItems(Pe,bi)),Se.addArrays(Ae[1],Se.mulItems(St,bi)),Ae[1]],[Re];if(je=Ee(Ae),[Re,Ke,hi]=Oe(Ae,je,je,Pe,St,ke),Ke===0||Ke<Ce)return[Re];if(Ke<Ce*Ce)for(We=je,Je=Ke,oi=hi,vi=0;vi<20;vi++){if(We=Ue(Re,Ae,We),[Re,Ke,hi]=Oe(Ae,je,We,Pe,St,ke),Ke<Ce)return[Re];if(hi===oi){let Pi=Ke/Je;if(Pi>.9999&&Pi<1.0001)break}Je=Ke,oi=hi}return di=[],ti=Se.subtract(Ae[hi-1],Ae[hi+1]),ti.every(Pi=>Pi===0)&&(ti=Se.subtract(Ae[hi-1],Ae[hi]),[ti[0],ti[1]]=[-ti[1],ti[0]]),ai=Se.normalize(ti),yi=Se.mulItems(ai,-1),di=di.concat(Me(Ae.slice(0,hi+1),Pe,ai,Ce,ke)),di=di.concat(Me(Ae.slice(hi),yi,St,Ce,ke)),di}function Oe(Ae,Pe,St,Ce,ke,De){var Re,je,We;return Re=Be(Ae,St,Ce,ke),[je,We]=e(Ae,Re,Pe),De&&De({bez:Re,points:Ae,params:Pe,maxErr:je,maxPoint:We}),[Re,je,We]}function Be(Ae,Pe,St,Ce){var ke,De,Re,je,We,Ke,Je,hi,oi,ti,ai,yi,di,bi,vi,Pi,xi,ni=Ae[0],fi=Ae[Ae.length-1];for(ke=[ni,null,null,fi],De=Se.zeros_Xx2x2(Pe.length),di=0,bi=Pe.length;di<bi;di++)Pi=Pe[di],xi=1-Pi,Re=De[di],Re[0]=Se.mulItems(St,3*Pi*(xi*xi)),Re[1]=Se.mulItems(Ce,3*xi*(Pi*Pi));for(je=[[0,0],[0,0]],We=[0,0],di=0,bi=Ae.length;di<bi;di++)Pi=Pe[di],Re=De[di],je[0][0]+=Se.dot(Re[0],Re[0]),je[0][1]+=Se.dot(Re[0],Re[1]),je[1][0]+=Se.dot(Re[0],Re[1]),je[1][1]+=Se.dot(Re[1],Re[1]),vi=Se.subtract(Ae[di],t.q([ni,ni,fi,fi],Pi)),We[0]+=Se.dot(Re[0],vi),We[1]+=Se.dot(Re[1],vi);return Ke=je[0][0]*je[1][1]-je[1][0]*je[0][1],Je=je[0][0]*We[1]-je[1][0]*We[0],hi=We[0]*je[1][1]-We[1]*je[0][1],oi=Ke===0?0:hi/Ke,ti=Ke===0?0:Je/Ke,yi=Se.vectorLen(Se.subtract(ni,fi)),ai=1e-6*yi,oi<ai||ti<ai?(ke[1]=Se.addArrays(ni,Se.mulItems(St,yi/3)),ke[2]=Se.addArrays(fi,Se.mulItems(Ce,yi/3))):(ke[1]=Se.addArrays(ni,Se.mulItems(St,oi)),ke[2]=Se.addArrays(fi,Se.mulItems(Ce,ti))),ke}function Ue(Ae,Pe,St){return St.map((Ce,ke)=>He(Ae,Pe[ke],Ce))}function He(Ae,Pe,St){var Ce=Se.subtract(t.q(Ae,St),Pe),ke=t.qprime(Ae,St),De=Se.mulMatrix(Ce,ke),Re=Se.sum(Se.squareItems(ke))+2*Se.mulMatrix(Ce,t.qprimeprime(Ae,St));return Re===0?St:St-De/Re}function Ee(Ae){var Pe=[],St,Ce,ke;return Ae.forEach((De,Re)=>{St=Re?Ce+Se.vectorLen(Se.subtract(De,ke)):0,Pe.push(St),Ce=St,ke=De}),Pe=Pe.map(De=>De/Ce),Pe}function e(Ae,Pe,St){var Ce,ke,De,Re,je,We,Ke,Je;ke=0,De=Math.floor(Ae.length/2);const hi=xe(Pe,10);for(je=0,We=Ae.length;je<We;je++)Ke=Ae[je],Je=Te(Pe,St[je],hi,10),Re=Se.subtract(t.q(Pe,Je),Ke),Ce=Re[0]*Re[0]+Re[1]*Re[1],Ce>ke&&(ke=Ce,De=je);return[ke,De]}var xe=function(Ae,Pe){for(var St,Ce=[0],ke=Ae[0],De=0,Re=1;Re<=Pe;Re++)St=t.q(Ae,Re/Pe),De+=Se.vectorLen(Se.subtract(St,ke)),Ce.push(De),ke=St;return Ce=Ce.map(je=>je/De),Ce};function Te(Ae,Pe,St,Ce){if(Pe<0)return 0;if(Pe>1)return 1;for(var ke,De,Re,je,We,Ke=1;Ke<=Ce;Ke++)if(Pe<=St[Ke]){je=(Ke-1)/Ce,Re=Ke/Ce,De=St[Ke-1],ke=St[Ke],We=(Pe-De)/(ke-De)*(Re-je)+je;break}return We}function _e(Ae,Pe){return Se.normalize(Se.subtract(Ae,Pe))}class Se{static zeros_Xx2x2(Pe){for(var St=[];Pe--;)St.push([0,0]);return St}static mulItems(Pe,St){return Pe.map(Ce=>Ce*St)}static mulMatrix(Pe,St){return Pe.reduce((Ce,ke,De)=>Ce+ke*St[De],0)}static subtract(Pe,St){return Pe.map((Ce,ke)=>Ce-St[ke])}static addArrays(Pe,St){return Pe.map((Ce,ke)=>Ce+St[ke])}static addItems(Pe,St){return Pe.map(Ce=>Ce+St)}static sum(Pe){return Pe.reduce((St,Ce)=>St+Ce)}static dot(Pe,St){return Se.mulMatrix(Pe,St)}static vectorLen(Pe){return Math.hypot(...Pe)}static divItems(Pe,St){return Pe.map(Ce=>Ce/St)}static squareItems(Pe){return Pe.map(St=>St*St)}static normalize(Pe){return this.divItems(Pe,this.vectorLen(Pe))}}class t{static q(Pe,St){var Ce=1-St,ke=Se.mulItems(Pe[0],Ce*Ce*Ce),De=Se.mulItems(Pe[1],3*Ce*Ce*St),Re=Se.mulItems(Pe[2],3*Ce*St*St),je=Se.mulItems(Pe[3],St*St*St);return Se.addArrays(Se.addArrays(ke,De),Se.addArrays(Re,je))}static qprime(Pe,St){var Ce=1-St,ke=Se.mulItems(Se.subtract(Pe[1],Pe[0]),3*Ce*Ce),De=Se.mulItems(Se.subtract(Pe[2],Pe[1]),6*Ce*St),Re=Se.mulItems(Se.subtract(Pe[3],Pe[2]),3*St*St);return Se.addArrays(Se.addArrays(ke,De),Re)}static qprimeprime(Pe,St){return Se.addArrays(Se.mulItems(Se.addArrays(Se.subtract(Pe[2],Se.mulItems(Pe[1],2)),Pe[0]),6*(1-St)),Se.mulItems(Se.addArrays(Se.subtract(Pe[3],Se.mulItems(Pe[2],2)),Pe[1]),6*St))}}Ie.exports=r,Ie.exports.fitCubic=Me,Ie.exports.createTangent=_e},(Ie,r,Me)=>{var Ge,Kh,ei,Hl,li,Xl,Ci,Vl;Object.defineProperty(r,"__esModule",{value:!0}),r.AnnotationLayer=void 0;var Oe=Me(1),Be=Me(6),Ue=Me(3),He=Me(27),Ee=Me(28);const e=1e3,xe=9,Te=new WeakSet;function _e(Ti){return{width:Ti[2]-Ti[0],height:Ti[3]-Ti[1]}}class Se{static create(Ze){switch(Ze.data.annotationType){case Oe.AnnotationType.LINK:return new Ae(Ze);case Oe.AnnotationType.TEXT:return new Pe(Ze);case Oe.AnnotationType.WIDGET:switch(Ze.data.fieldType){case"Tx":return new Ce(Ze);case"Btn":return Ze.data.radioButton?new De(Ze):Ze.data.checkBox?new ke(Ze):new Re(Ze);case"Ch":return new je(Ze)}return new St(Ze);case Oe.AnnotationType.POPUP:return new We(Ze);case Oe.AnnotationType.FREETEXT:return new Je(Ze);case Oe.AnnotationType.LINE:return new hi(Ze);case Oe.AnnotationType.SQUARE:return new oi(Ze);case Oe.AnnotationType.CIRCLE:return new ti(Ze);case Oe.AnnotationType.POLYLINE:return new ai(Ze);case Oe.AnnotationType.CARET:return new di(Ze);case Oe.AnnotationType.INK:return new bi(Ze);case Oe.AnnotationType.POLYGON:return new yi(Ze);case Oe.AnnotationType.HIGHLIGHT:return new vi(Ze);case Oe.AnnotationType.UNDERLINE:return new Pi(Ze);case Oe.AnnotationType.SQUIGGLY:return new xi(Ze);case Oe.AnnotationType.STRIKEOUT:return new ni(Ze);case Oe.AnnotationType.STAMP:return new fi(Ze);case Oe.AnnotationType.FILEATTACHMENT:return new Si(Ze);default:return new t(Ze)}}}class t{constructor(Ze,{isRenderable:ii=!1,ignoreBorder:Qe=!1,createQuadrilaterals:ui=!1}={}){this.isRenderable=ii,this.data=Ze.data,this.layer=Ze.layer,this.page=Ze.page,this.viewport=Ze.viewport,this.linkService=Ze.linkService,this.downloadManager=Ze.downloadManager,this.imageResourcesPath=Ze.imageResourcesPath,this.renderForms=Ze.renderForms,this.svgFactory=Ze.svgFactory,this.annotationStorage=Ze.annotationStorage,this.enableScripting=Ze.enableScripting,this.hasJSActions=Ze.hasJSActions,this._fieldObjects=Ze.fieldObjects,this._mouseState=Ze.mouseState,ii&&(this.container=this._createContainer(Qe)),ui&&(this.quadrilaterals=this._createQuadrilaterals(Qe))}_createContainer(Ze=!1){const ii=this.data,Qe=this.page,ui=this.viewport,gi=document.createElement("section"),{width:_i,height:Ri}=_e(ii.rect),[Ui,ki,Vi,Ii]=ui.viewBox,$i=Vi-Ui,tn=Ii-ki;gi.setAttribute("data-annotation-id",ii.id);const en=Oe.Util.normalizeRect([ii.rect[0],Qe.view[3]-ii.rect[1]+Qe.view[1],ii.rect[2],Qe.view[3]-ii.rect[3]+Qe.view[1]]);if(!Ze&&ii.borderStyle.width>0){gi.style.borderWidth=`${ii.borderStyle.width}px`;const Ji=ii.borderStyle.horizontalCornerRadius,pn=ii.borderStyle.verticalCornerRadius;if(Ji>0||pn>0){const kn=`calc(${Ji}px * var(--scale-factor)) / calc(${pn}px * var(--scale-factor))`;gi.style.borderRadius=kn}else if(this instanceof De){const kn=`calc(${_i}px * var(--scale-factor)) / calc(${Ri}px * var(--scale-factor))`;gi.style.borderRadius=kn}switch(ii.borderStyle.style){case Oe.AnnotationBorderStyleType.SOLID:gi.style.borderStyle="solid";break;case Oe.AnnotationBorderStyleType.DASHED:gi.style.borderStyle="dashed";break;case Oe.AnnotationBorderStyleType.BEVELED:(0,Oe.warn)("Unimplemented border style: beveled");break;case Oe.AnnotationBorderStyleType.INSET:(0,Oe.warn)("Unimplemented border style: inset");break;case Oe.AnnotationBorderStyleType.UNDERLINE:gi.style.borderBottomStyle="solid";break}const an=ii.borderColor||null;an?gi.style.borderColor=Oe.Util.makeHexColor(an[0]|0,an[1]|0,an[2]|0):gi.style.borderWidth=0}gi.style.left=`${100*(en[0]-Ui)/$i}%`,gi.style.top=`${100*(en[1]-ki)/tn}%`;const{rotation:zi}=ii;return ii.hasOwnCanvas||zi===0?(gi.style.width=`${100*_i/$i}%`,gi.style.height=`${100*Ri/tn}%`):this.setRotation(zi,gi),gi}setRotation(Ze,ii=this.container){const[Qe,ui,gi,_i]=this.viewport.viewBox,Ri=gi-Qe,Ui=_i-ui,{width:ki,height:Vi}=_e(this.data.rect);let Ii,$i;Ze%180===0?(Ii=100*ki/Ri,$i=100*Vi/Ui):(Ii=100*Vi/Ri,$i=100*ki/Ui),ii.style.width=`${Ii}%`,ii.style.height=`${$i}%`,ii.setAttribute("data-main-rotation",(360-Ze)%360)}get _commonActions(){const Ze=(ii,Qe,ui)=>{const gi=ui.detail[ii];ui.target.style[Qe]=He.ColorConverters[`${gi[0]}_HTML`](gi.slice(1))};return(0,Oe.shadow)(this,"_commonActions",{display:ii=>{const Qe=ii.detail.display%2===1;this.container.style.visibility=Qe?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{hidden:Qe,print:ii.detail.display===0||ii.detail.display===3})},print:ii=>{this.annotationStorage.setValue(this.data.id,{print:ii.detail.print})},hidden:ii=>{this.container.style.visibility=ii.detail.hidden?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{hidden:ii.detail.hidden})},focus:ii=>{setTimeout(()=>ii.target.focus({preventScroll:!1}),0)},userName:ii=>{ii.target.title=ii.detail.userName},readonly:ii=>{ii.detail.readonly?ii.target.setAttribute("readonly",""):ii.target.removeAttribute("readonly")},required:ii=>{this._setRequired(ii.target,ii.detail.required)},bgColor:ii=>{Ze("bgColor","backgroundColor",ii)},fillColor:ii=>{Ze("fillColor","backgroundColor",ii)},fgColor:ii=>{Ze("fgColor","color",ii)},textColor:ii=>{Ze("textColor","color",ii)},borderColor:ii=>{Ze("borderColor","borderColor",ii)},strokeColor:ii=>{Ze("strokeColor","borderColor",ii)},rotation:ii=>{const Qe=ii.detail.rotation;this.setRotation(Qe),this.annotationStorage.setValue(this.data.id,{rotation:Qe})}})}_dispatchEventFromSandbox(Ze,ii){const Qe=this._commonActions;for(const ui of Object.keys(ii.detail)){const gi=Ze[ui]||Qe[ui];gi==null||gi(ii)}}_setDefaultPropertiesFromJS(Ze){if(!this.enableScripting)return;const ii=this.annotationStorage.getRawValue(this.data.id);if(!ii)return;const Qe=this._commonActions;for(const[ui,gi]of Object.entries(ii)){const _i=Qe[ui];if(_i){const Ri={detail:{[ui]:gi},target:Ze};_i(Ri),delete ii[ui]}}}_createQuadrilaterals(Ze=!1){if(!this.data.quadPoints)return null;const ii=[],Qe=this.data.rect;for(const ui of this.data.quadPoints)this.data.rect=[ui[2].x,ui[2].y,ui[1].x,ui[1].y],ii.push(this._createContainer(Ze));return this.data.rect=Qe,ii}_createPopup(Ze,ii){let Qe=this.container;this.quadrilaterals&&(Ze=Ze||this.quadrilaterals,Qe=this.quadrilaterals[0]),Ze||(Ze=document.createElement("div"),Ze.className="popupTriggerArea",Qe.append(Ze));const gi=new Ke({container:Qe,trigger:Ze,color:ii.color,titleObj:ii.titleObj,modificationDate:ii.modificationDate,contentsObj:ii.contentsObj,richText:ii.richText,hideWrapper:!0}).render();gi.style.left="100%",Qe.append(gi)}_renderQuadrilaterals(Ze){for(const ii of this.quadrilaterals)ii.className=Ze;return this.quadrilaterals}render(){(0,Oe.unreachable)("Abstract method `AnnotationElement.render` called")}_getElementsByName(Ze,ii=null){const Qe=[];if(this._fieldObjects){const ui=this._fieldObjects[Ze];if(ui)for(const{page:gi,id:_i,exportValues:Ri}of ui){if(gi===-1||_i===ii)continue;const Ui=typeof Ri=="string"?Ri:null,ki=document.querySelector(`[data-element-id="${_i}"]`);if(ki&&!Te.has(ki)){(0,Oe.warn)(`_getElementsByName - element not allowed: ${_i}`);continue}Qe.push({id:_i,exportValue:Ui,domElement:ki})}return Qe}for(const ui of document.getElementsByName(Ze)){const{exportValue:gi}=ui,_i=ui.getAttribute("data-element-id");_i!==ii&&(!Te.has(ui)||Qe.push({id:_i,exportValue:gi,domElement:ui}))}return Qe}static get platform(){const Ze=typeof navigator<"u"?navigator.platform:"";return(0,Oe.shadow)(this,"platform",{isWin:Ze.includes("Win"),isMac:Ze.includes("Mac")})}}class Ae extends t{constructor(ii,Qe=null){super(ii,{isRenderable:!0,ignoreBorder:!!(Qe!=null&&Qe.ignoreBorder),createQuadrilaterals:!0});rn(this,Ge);this.isTooltipOnly=ii.data.isTooltipOnly}render(){const{data:ii,linkService:Qe}=this,ui=document.createElement("a");ui.setAttribute("data-element-id",ii.id);let gi=!1;return ii.url?(Qe.addLinkAttributes(ui,ii.url,ii.newWindow),gi=!0):ii.action?(this._bindNamedAction(ui,ii.action),gi=!0):ii.attachment?(this._bindAttachment(ui,ii.attachment),gi=!0):ii.setOCGState?(fn(this,Ge,Kh).call(this,ui,ii.setOCGState),gi=!0):ii.dest?(this._bindLink(ui,ii.dest),gi=!0):(ii.actions&&(ii.actions.Action||ii.actions["Mouse Up"]||ii.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(ui,ii),gi=!0),ii.resetForm?(this._bindResetFormAction(ui,ii.resetForm),gi=!0):this.isTooltipOnly&&!gi&&(this._bindLink(ui,""),gi=!0)),this.quadrilaterals?this._renderQuadrilaterals("linkAnnotation").map((_i,Ri)=>{const Ui=Ri===0?ui:ui.cloneNode();return _i.append(Ui),_i}):(this.container.className="linkAnnotation",gi&&this.container.append(ui),this.container)}_bindLink(ii,Qe){ii.href=this.linkService.getDestinationHash(Qe),ii.onclick=()=>(Qe&&this.linkService.goToDestination(Qe),!1),(Qe||Qe==="")&&(ii.className="internalLink")}_bindNamedAction(ii,Qe){ii.href=this.linkService.getAnchorUrl(""),ii.onclick=()=>(this.linkService.executeNamedAction(Qe),!1),ii.className="internalLink"}_bindAttachment(ii,Qe){ii.href=this.linkService.getAnchorUrl(""),ii.onclick=()=>{var ui;return(ui=this.downloadManager)==null||ui.openOrDownloadData(this.container,Qe.content,Qe.filename),!1},ii.className="internalLink"}_bindJSAction(ii,Qe){ii.href=this.linkService.getAnchorUrl("");const ui=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const gi of Object.keys(Qe.actions)){const _i=ui.get(gi);!_i||(ii[_i]=()=>{var Ri;return(Ri=this.linkService.eventBus)==null||Ri.dispatch("dispatcheventinsandbox",{source:this,detail:{id:Qe.id,name:gi}}),!1})}ii.onclick||(ii.onclick=()=>!1),ii.className="internalLink"}_bindResetFormAction(ii,Qe){const ui=ii.onclick;if(ui||(ii.href=this.linkService.getAnchorUrl("")),ii.className="internalLink",!this._fieldObjects){(0,Oe.warn)('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),ui||(ii.onclick=()=>!1);return}ii.onclick=()=>{var Ii;ui==null||ui();const{fields:gi,refs:_i,include:Ri}=Qe,Ui=[];if(gi.length!==0||_i.length!==0){const $i=new Set(_i);for(const tn of gi){const en=this._fieldObjects[tn]||[];for(const{id:zi}of en)$i.add(zi)}for(const tn of Object.values(this._fieldObjects))for(const en of tn)$i.has(en.id)===Ri&&Ui.push(en)}else for(const $i of Object.values(this._fieldObjects))Ui.push(...$i);const ki=this.annotationStorage,Vi=[];for(const $i of Ui){const{id:tn}=$i;switch(Vi.push(tn),$i.type){case"text":{const zi=$i.defaultValue||"";ki.setValue(tn,{value:zi});break}case"checkbox":case"radiobutton":{const zi=$i.defaultValue===$i.exportValues;ki.setValue(tn,{value:zi});break}case"combobox":case"listbox":{const zi=$i.defaultValue||"";ki.setValue(tn,{value:zi});break}default:continue}const en=document.querySelector(`[data-element-id="${tn}"]`);if(en){if(!Te.has(en)){(0,Oe.warn)(`_bindResetFormAction - element not allowed: ${tn}`);continue}}else continue;en.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((Ii=this.linkService.eventBus)==null||Ii.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:Vi,name:"ResetForm"}})),!1}}}Ge=new WeakSet,Kh=function(ii,Qe){ii.href=this.linkService.getAnchorUrl(""),ii.onclick=()=>(this.linkService.executeSetOCGState(Qe),!1),ii.className="internalLink"};class Pe extends t{constructor(Ze){var Qe,ui,gi;const ii=!!(Ze.data.hasPopup||((Qe=Ze.data.titleObj)==null?void 0:Qe.str)||((ui=Ze.data.contentsObj)==null?void 0:ui.str)||((gi=Ze.data.richText)==null?void 0:gi.str));super(Ze,{isRenderable:ii})}render(){this.container.className="textAnnotation";const Ze=document.createElement("img");return Ze.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",Ze.alt="[{{type}} Annotation]",Ze.dataset.l10nId="text_annotation_type",Ze.dataset.l10nArgs=JSON.stringify({type:this.data.name}),this.data.hasPopup||this._createPopup(Ze,this.data),this.container.append(Ze),this.container}}class St extends t{render(){return this.data.alternativeText&&(this.container.title=this.data.alternativeText),this.container}_getKeyModifier(Ze){const{isWin:ii,isMac:Qe}=t.platform;return ii&&Ze.ctrlKey||Qe&&Ze.metaKey}_setEventListener(Ze,ii,Qe,ui){ii.includes("mouse")?Ze.addEventListener(ii,gi=>{var _i;(_i=this.linkService.eventBus)==null||_i.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:Qe,value:ui(gi),shift:gi.shiftKey,modifier:this._getKeyModifier(gi)}})}):Ze.addEventListener(ii,gi=>{var _i;(_i=this.linkService.eventBus)==null||_i.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:Qe,value:ui(gi)}})})}_setEventListeners(Ze,ii,Qe){var ui;for(const[gi,_i]of ii)(_i==="Action"||((ui=this.data.actions)==null?void 0:ui[_i]))&&this._setEventListener(Ze,gi,_i,Qe)}_setBackgroundColor(Ze){const ii=this.data.backgroundColor||null;Ze.style.backgroundColor=ii===null?"transparent":Oe.Util.makeHexColor(ii[0],ii[1],ii[2])}_setTextStyle(Ze){const ii=["left","center","right"],{fontColor:Qe}=this.data.defaultAppearanceData,ui=this.data.defaultAppearanceData.fontSize||xe,gi=Ze.style;let _i;const Ri=2,Ui=ki=>Math.round(10*ki)/10;if(this.data.multiLine){const ki=Math.abs(this.data.rect[3]-this.data.rect[1]-Ri),Vi=Math.round(ki/(Oe.LINE_FACTOR*ui))||1,Ii=ki/Vi;_i=Math.min(ui,Ui(Ii/Oe.LINE_FACTOR))}else{const ki=Math.abs(this.data.rect[3]-this.data.rect[1]-Ri);_i=Math.min(ui,Ui(ki/Oe.LINE_FACTOR))}gi.fontSize=`calc(${_i}px * var(--scale-factor))`,gi.color=Oe.Util.makeHexColor(Qe[0],Qe[1],Qe[2]),this.data.textAlignment!==null&&(gi.textAlign=ii[this.data.textAlignment])}_setRequired(Ze,ii){ii?Ze.setAttribute("required",!0):Ze.removeAttribute("required"),Ze.setAttribute("aria-required",ii)}}class Ce extends St{constructor(Ze){const ii=Ze.renderForms||!Ze.data.hasAppearance&&!!Ze.data.fieldValue;super(Ze,{isRenderable:ii})}setPropertyOnSiblings(Ze,ii,Qe,ui){const gi=this.annotationStorage;for(const _i of this._getElementsByName(Ze.name,Ze.id))_i.domElement&&(_i.domElement[ii]=Qe),gi.setValue(_i.id,{[ui]:Qe})}render(){var ui;const Ze=this.annotationStorage,ii=this.data.id;this.container.className="textWidgetAnnotation";let Qe=null;if(this.renderForms){const gi=Ze.getValue(ii,{value:this.data.fieldValue});let _i=gi.formattedValue||gi.value||"";const Ri=Ze.getValue(ii,{charLimit:this.data.maxLen}).charLimit;Ri&&_i.length>Ri&&(_i=_i.slice(0,Ri));const Ui={userValue:_i,formattedValue:null,valueOnFocus:""};this.data.multiLine?(Qe=document.createElement("textarea"),Qe.textContent=_i,this.data.doNotScroll&&(Qe.style.overflowY="hidden")):(Qe=document.createElement("input"),Qe.type="text",Qe.setAttribute("value",_i),this.data.doNotScroll&&(Qe.style.overflowX="hidden")),Te.add(Qe),Qe.setAttribute("data-element-id",ii),Qe.disabled=this.data.readOnly,Qe.name=this.data.fieldName,Qe.tabIndex=e,this._setRequired(Qe,this.data.required),Ri&&(Qe.maxLength=Ri),Qe.addEventListener("input",Vi=>{Ze.setValue(ii,{value:Vi.target.value}),this.setPropertyOnSiblings(Qe,"value",Vi.target.value,"value")}),Qe.addEventListener("resetform",Vi=>{var $i;const Ii=($i=this.data.defaultFieldValue)!=null?$i:"";Qe.value=Ui.userValue=Ii,Ui.formattedValue=null});let ki=Vi=>{const{formattedValue:Ii}=Ui;Ii!=null&&(Vi.target.value=Ii),Vi.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){Qe.addEventListener("focus",Ii=>{Ui.userValue&&(Ii.target.value=Ui.userValue),Ui.valueOnFocus=Ii.target.value}),Qe.addEventListener("updatefromsandbox",Ii=>{const $i={value(tn){var en;Ui.userValue=(en=tn.detail.value)!=null?en:"",Ze.setValue(ii,{value:Ui.userValue.toString()}),tn.target.value=Ui.userValue},formattedValue(tn){const{formattedValue:en}=tn.detail;Ui.formattedValue=en,en!=null&&tn.target!==document.activeElement&&(tn.target.value=en),Ze.setValue(ii,{formattedValue:en})},selRange(tn){tn.target.setSelectionRange(...tn.detail.selRange)},charLimit:tn=>{var pn;const{charLimit:en}=tn.detail,{target:zi}=tn;if(en===0){zi.removeAttribute("maxLength");return}zi.setAttribute("maxLength",en);let Ji=Ui.userValue;!Ji||Ji.length<=en||(Ji=Ji.slice(0,en),zi.value=Ui.userValue=Ji,Ze.setValue(ii,{value:Ji}),(pn=this.linkService.eventBus)==null||pn.dispatch("dispatcheventinsandbox",{source:this,detail:{id:ii,name:"Keystroke",value:Ji,willCommit:!0,commitKey:1,selStart:zi.selectionStart,selEnd:zi.selectionEnd}}))}};this._dispatchEventFromSandbox($i,Ii)}),Qe.addEventListener("keydown",Ii=>{var en;let $i=-1;if(Ii.key==="Escape"?$i=0:Ii.key==="Enter"&&!this.data.multiLine?$i=2:Ii.key==="Tab"&&($i=3),$i===-1)return;const{value:tn}=Ii.target;Ui.valueOnFocus!==tn&&(Ui.userValue=tn,(en=this.linkService.eventBus)==null||en.dispatch("dispatcheventinsandbox",{source:this,detail:{id:ii,name:"Keystroke",value:tn,willCommit:!0,commitKey:$i,selStart:Ii.target.selectionStart,selEnd:Ii.target.selectionEnd}}))});const Vi=ki;ki=null,Qe.addEventListener("blur",Ii=>{var tn;const{value:$i}=Ii.target;Ui.userValue=$i,this._mouseState.isDown&&Ui.valueOnFocus!==$i&&((tn=this.linkService.eventBus)==null||tn.dispatch("dispatcheventinsandbox",{source:this,detail:{id:ii,name:"Keystroke",value:$i,willCommit:!0,commitKey:1,selStart:Ii.target.selectionStart,selEnd:Ii.target.selectionEnd}})),Vi(Ii)}),(ui=this.data.actions)!=null&&ui.Keystroke&&Qe.addEventListener("beforeinput",Ii=>{var kn;const{data:$i,target:tn}=Ii,{value:en,selectionStart:zi,selectionEnd:Ji}=tn;let pn=zi,an=Ji;switch(Ii.inputType){case"deleteWordBackward":{const xn=en.substring(0,zi).match(/\w*[^\w]*$/);xn&&(pn-=xn[0].length);break}case"deleteWordForward":{const xn=en.substring(zi).match(/^[^\w]*\w*/);xn&&(an+=xn[0].length);break}case"deleteContentBackward":zi===Ji&&(pn-=1);break;case"deleteContentForward":zi===Ji&&(an+=1);break}Ii.preventDefault(),(kn=this.linkService.eventBus)==null||kn.dispatch("dispatcheventinsandbox",{source:this,detail:{id:ii,name:"Keystroke",value:en,change:$i||"",willCommit:!1,selStart:pn,selEnd:an}})}),this._setEventListeners(Qe,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],Ii=>Ii.target.value)}if(ki&&Qe.addEventListener("blur",ki),this.data.comb){const Ii=(this.data.rect[2]-this.data.rect[0])/Ri;Qe.classList.add("comb"),Qe.style.letterSpacing=`calc(${Ii}px * var(--scale-factor) - 1ch)`}}else Qe=document.createElement("div"),Qe.textContent=this.data.fieldValue,Qe.style.verticalAlign="middle",Qe.style.display="table-cell";return this._setTextStyle(Qe),this._setBackgroundColor(Qe),this._setDefaultPropertiesFromJS(Qe),this.container.append(Qe),this.container}}class ke extends St{constructor(Ze){super(Ze,{isRenderable:Ze.renderForms})}render(){const Ze=this.annotationStorage,ii=this.data,Qe=ii.id;let ui=Ze.getValue(Qe,{value:ii.exportValue===ii.fieldValue}).value;typeof ui=="string"&&(ui=ui!=="Off",Ze.setValue(Qe,{value:ui})),this.container.className="buttonWidgetAnnotation checkBox";const gi=document.createElement("input");return Te.add(gi),gi.setAttribute("data-element-id",Qe),gi.disabled=ii.readOnly,this._setRequired(gi,this.data.required),gi.type="checkbox",gi.name=ii.fieldName,ui&&gi.setAttribute("checked",!0),gi.setAttribute("exportValue",ii.exportValue),gi.tabIndex=e,gi.addEventListener("change",_i=>{const{name:Ri,checked:Ui}=_i.target;for(const ki of this._getElementsByName(Ri,Qe)){const Vi=Ui&&ki.exportValue===ii.exportValue;ki.domElement&&(ki.domElement.checked=Vi),Ze.setValue(ki.id,{value:Vi})}Ze.setValue(Qe,{value:Ui})}),gi.addEventListener("resetform",_i=>{const Ri=ii.defaultFieldValue||"Off";_i.target.checked=Ri===ii.exportValue}),this.enableScripting&&this.hasJSActions&&(gi.addEventListener("updatefromsandbox",_i=>{const Ri={value(Ui){Ui.target.checked=Ui.detail.value!=="Off",Ze.setValue(Qe,{value:Ui.target.checked})}};this._dispatchEventFromSandbox(Ri,_i)}),this._setEventListeners(gi,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],_i=>_i.target.checked)),this._setBackgroundColor(gi),this._setDefaultPropertiesFromJS(gi),this.container.append(gi),this.container}}class De extends St{constructor(Ze){super(Ze,{isRenderable:Ze.renderForms})}render(){this.container.className="buttonWidgetAnnotation radioButton";const Ze=this.annotationStorage,ii=this.data,Qe=ii.id;let ui=Ze.getValue(Qe,{value:ii.fieldValue===ii.buttonValue}).value;typeof ui=="string"&&(ui=ui!==ii.buttonValue,Ze.setValue(Qe,{value:ui}));const gi=document.createElement("input");if(Te.add(gi),gi.setAttribute("data-element-id",Qe),gi.disabled=ii.readOnly,this._setRequired(gi,this.data.required),gi.type="radio",gi.name=ii.fieldName,ui&&gi.setAttribute("checked",!0),gi.tabIndex=e,gi.addEventListener("change",_i=>{const{name:Ri,checked:Ui}=_i.target;for(const ki of this._getElementsByName(Ri,Qe))Ze.setValue(ki.id,{value:!1});Ze.setValue(Qe,{value:Ui})}),gi.addEventListener("resetform",_i=>{const Ri=ii.defaultFieldValue;_i.target.checked=Ri!=null&&Ri===ii.buttonValue}),this.enableScripting&&this.hasJSActions){const _i=ii.buttonValue;gi.addEventListener("updatefromsandbox",Ri=>{const Ui={value:ki=>{const Vi=_i===ki.detail.value;for(const Ii of this._getElementsByName(ki.target.name)){const $i=Vi&&Ii.id===Qe;Ii.domElement&&(Ii.domElement.checked=$i),Ze.setValue(Ii.id,{value:$i})}}};this._dispatchEventFromSandbox(Ui,Ri)}),this._setEventListeners(gi,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],Ri=>Ri.target.checked)}return this._setBackgroundColor(gi),this._setDefaultPropertiesFromJS(gi),this.container.append(gi),this.container}}class Re extends Ae{constructor(Ze){super(Ze,{ignoreBorder:Ze.data.hasAppearance})}render(){const Ze=super.render();Ze.className="buttonWidgetAnnotation pushButton",this.data.alternativeText&&(Ze.title=this.data.alternativeText);const ii=Ze.lastChild;return this.enableScripting&&this.hasJSActions&&ii&&(this._setDefaultPropertiesFromJS(ii),ii.addEventListener("updatefromsandbox",Qe=>{this._dispatchEventFromSandbox({},Qe)})),Ze}}class je extends St{constructor(Ze){super(Ze,{isRenderable:Ze.renderForms})}render(){this.container.className="choiceWidgetAnnotation";const Ze=this.annotationStorage,ii=this.data.id,Qe=Ze.getValue(ii,{value:this.data.fieldValue}),ui=document.createElement("select");Te.add(ui),ui.setAttribute("data-element-id",ii),ui.disabled=this.data.readOnly,this._setRequired(ui,this.data.required),ui.name=this.data.fieldName,ui.tabIndex=e;let gi=this.data.combo&&this.data.options.length>0;this.data.combo||(ui.size=this.data.options.length,this.data.multiSelect&&(ui.multiple=!0)),ui.addEventListener("resetform",ki=>{const Vi=this.data.defaultFieldValue;for(const Ii of ui.options)Ii.selected=Ii.value===Vi});for(const ki of this.data.options){const Vi=document.createElement("option");Vi.textContent=ki.displayValue,Vi.value=ki.exportValue,Qe.value.includes(ki.exportValue)&&(Vi.setAttribute("selected",!0),gi=!1),ui.append(Vi)}let _i=null;if(gi){const ki=document.createElement("option");ki.value=" ",ki.setAttribute("hidden",!0),ki.setAttribute("selected",!0),ui.prepend(ki),_i=()=>{ki.remove(),ui.removeEventListener("input",_i),_i=null},ui.addEventListener("input",_i)}const Ri=(ki,Vi)=>{const Ii=Vi?"value":"textContent",$i=ki.target.options;return ki.target.multiple?Array.prototype.filter.call($i,tn=>tn.selected).map(tn=>tn[Ii]):$i.selectedIndex===-1?null:$i[$i.selectedIndex][Ii]},Ui=ki=>{const Vi=ki.target.options;return Array.prototype.map.call(Vi,Ii=>({displayValue:Ii.textContent,exportValue:Ii.value}))};return this.enableScripting&&this.hasJSActions?(ui.addEventListener("updatefromsandbox",ki=>{const Vi={value(Ii){_i==null||_i();const $i=Ii.detail.value,tn=new Set(Array.isArray($i)?$i:[$i]);for(const en of ui.options)en.selected=tn.has(en.value);Ze.setValue(ii,{value:Ri(Ii,!0)})},multipleSelection(Ii){ui.multiple=!0},remove(Ii){const $i=ui.options,tn=Ii.detail.remove;$i[tn].selected=!1,ui.remove(tn),$i.length>0&&Array.prototype.findIndex.call($i,zi=>zi.selected)===-1&&($i[0].selected=!0),Ze.setValue(ii,{value:Ri(Ii,!0),items:Ui(Ii)})},clear(Ii){for(;ui.length!==0;)ui.remove(0);Ze.setValue(ii,{value:null,items:[]})},insert(Ii){const{index:$i,displayValue:tn,exportValue:en}=Ii.detail.insert,zi=ui.children[$i],Ji=document.createElement("option");Ji.textContent=tn,Ji.value=en,zi?zi.before(Ji):ui.append(Ji),Ze.setValue(ii,{value:Ri(Ii,!0),items:Ui(Ii)})},items(Ii){const{items:$i}=Ii.detail;for(;ui.length!==0;)ui.remove(0);for(const tn of $i){const{displayValue:en,exportValue:zi}=tn,Ji=document.createElement("option");Ji.textContent=en,Ji.value=zi,ui.append(Ji)}ui.options.length>0&&(ui.options[0].selected=!0),Ze.setValue(ii,{value:Ri(Ii,!0),items:Ui(Ii)})},indices(Ii){const $i=new Set(Ii.detail.indices);for(const tn of Ii.target.options)tn.selected=$i.has(tn.index);Ze.setValue(ii,{value:Ri(Ii,!0)})},editable(Ii){Ii.target.disabled=!Ii.detail.editable}};this._dispatchEventFromSandbox(Vi,ki)}),ui.addEventListener("input",ki=>{var $i;const Vi=Ri(ki,!0),Ii=Ri(ki,!1);Ze.setValue(ii,{value:Vi}),($i=this.linkService.eventBus)==null||$i.dispatch("dispatcheventinsandbox",{source:this,detail:{id:ii,name:"Keystroke",value:Ii,changeEx:Vi,willCommit:!0,commitKey:1,keyDown:!1}})}),this._setEventListeners(ui,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"]],ki=>ki.target.checked)):ui.addEventListener("input",function(ki){Ze.setValue(ii,{value:Ri(ki,!0)})}),this.data.combo&&this._setTextStyle(ui),this._setBackgroundColor(ui),this._setDefaultPropertiesFromJS(ui),this.container.append(ui),this.container}}const Ve=class extends t{constructor(Ze){var ui,gi,_i;const{data:ii}=Ze,Qe=!Ve.IGNORE_TYPES.has(ii.parentType)&&!!(((ui=ii.titleObj)==null?void 0:ui.str)||((gi=ii.contentsObj)==null?void 0:gi.str)||((_i=ii.richText)==null?void 0:_i.str));super(Ze,{isRenderable:Qe})}render(){this.container.className="popupAnnotation";const Ze=this.layer.querySelectorAll(`[data-annotation-id="${this.data.parentId}"]`);if(Ze.length===0)return this.container;const ii=new Ke({container:this.container,trigger:Array.from(Ze),color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText}),Qe=this.page,ui=Oe.Util.normalizeRect([this.data.parentRect[0],Qe.view[3]-this.data.parentRect[1]+Qe.view[1],this.data.parentRect[2],Qe.view[3]-this.data.parentRect[3]+Qe.view[1]]),gi=ui[0]+this.data.parentRect[2]-this.data.parentRect[0],_i=ui[1],[Ri,Ui,ki,Vi]=this.viewport.viewBox,Ii=ki-Ri,$i=Vi-Ui;return this.container.style.left=`${100*(gi-Ri)/Ii}%`,this.container.style.top=`${100*(_i-Ui)/$i}%`,this.container.append(ii.render()),this.container}};let We=Ve;qn(We,"IGNORE_TYPES",new Set(["Line","Square","Circle","PolyLine","Polygon","Ink"]));class Ke{constructor(Ze){this.container=Ze.container,this.trigger=Ze.trigger,this.color=Ze.color,this.titleObj=Ze.titleObj,this.modificationDate=Ze.modificationDate,this.contentsObj=Ze.contentsObj,this.richText=Ze.richText,this.hideWrapper=Ze.hideWrapper||!1,this.pinned=!1}render(){var Ri,Ui;const ii=document.createElement("div");ii.className="popupWrapper",this.hideElement=this.hideWrapper?ii:this.container,this.hideElement.hidden=!0;const Qe=document.createElement("div");Qe.className="popup";const ui=this.color;if(ui){const ki=.7*(255-ui[0])+ui[0],Vi=.7*(255-ui[1])+ui[1],Ii=.7*(255-ui[2])+ui[2];Qe.style.backgroundColor=Oe.Util.makeHexColor(ki|0,Vi|0,Ii|0)}const gi=document.createElement("h1");gi.dir=this.titleObj.dir,gi.textContent=this.titleObj.str,Qe.append(gi);const _i=Be.PDFDateString.toDateObject(this.modificationDate);if(_i){const ki=document.createElement("span");ki.className="popupDate",ki.textContent="{{date}}, {{time}}",ki.dataset.l10nId="annotation_date_string",ki.dataset.l10nArgs=JSON.stringify({date:_i.toLocaleDateString(),time:_i.toLocaleTimeString()}),Qe.append(ki)}if(((Ri=this.richText)==null?void 0:Ri.str)&&(!((Ui=this.contentsObj)!=null&&Ui.str)||this.contentsObj.str===this.richText.str))Ee.XfaLayer.render({xfaHtml:this.richText.html,intent:"richText",div:Qe}),Qe.lastChild.className="richText popupContent";else{const ki=this._formatContents(this.contentsObj);Qe.append(ki)}Array.isArray(this.trigger)||(this.trigger=[this.trigger]);for(const ki of this.trigger)ki.addEventListener("click",this._toggle.bind(this)),ki.addEventListener("mouseover",this._show.bind(this,!1)),ki.addEventListener("mouseout",this._hide.bind(this,!1));return Qe.addEventListener("click",this._hide.bind(this,!0)),ii.append(Qe),ii}_formatContents({str:Ze,dir:ii}){const Qe=document.createElement("p");Qe.className="popupContent",Qe.dir=ii;const ui=Ze.split(/(?:\r\n?|\n)/);for(let gi=0,_i=ui.length;gi<_i;++gi){const Ri=ui[gi];Qe.append(document.createTextNode(Ri)),gi<_i-1&&Qe.append(document.createElement("br"))}return Qe}_toggle(){this.pinned?this._hide(!0):this._show(!0)}_show(Ze=!1){Ze&&(this.pinned=!0),this.hideElement.hidden&&(this.hideElement.hidden=!1,this.container.style.zIndex=parseInt(this.container.style.zIndex)+1e3)}_hide(Ze=!0){Ze&&(this.pinned=!1),!this.hideElement.hidden&&!this.pinned&&(this.hideElement.hidden=!0,this.container.style.zIndex=parseInt(this.container.style.zIndex)-1e3)}}class Je extends t{constructor(Ze){var Qe,ui,gi;const ii=!!(Ze.data.hasPopup||((Qe=Ze.data.titleObj)==null?void 0:Qe.str)||((ui=Ze.data.contentsObj)==null?void 0:ui.str)||((gi=Ze.data.richText)==null?void 0:gi.str));super(Ze,{isRenderable:ii,ignoreBorder:!0}),this.textContent=Ze.data.textContent}render(){if(this.container.className="freeTextAnnotation",this.textContent){const Ze=document.createElement("div");Ze.className="annotationTextContent",Ze.setAttribute("role","comment");for(const ii of this.textContent){const Qe=document.createElement("span");Qe.textContent=ii,Ze.append(Qe)}this.container.append(Ze)}return this.data.hasPopup||this._createPopup(null,this.data),this.container}}class hi extends t{constructor(Ze){var Qe,ui,gi;const ii=!!(Ze.data.hasPopup||((Qe=Ze.data.titleObj)==null?void 0:Qe.str)||((ui=Ze.data.contentsObj)==null?void 0:ui.str)||((gi=Ze.data.richText)==null?void 0:gi.str));super(Ze,{isRenderable:ii,ignoreBorder:!0})}render(){this.container.className="lineAnnotation";const Ze=this.data,{width:ii,height:Qe}=_e(Ze.rect),ui=this.svgFactory.create(ii,Qe,!0),gi=this.svgFactory.createElement("svg:line");return gi.setAttribute("x1",Ze.rect[2]-Ze.lineCoordinates[0]),gi.setAttribute("y1",Ze.rect[3]-Ze.lineCoordinates[1]),gi.setAttribute("x2",Ze.rect[2]-Ze.lineCoordinates[2]),gi.setAttribute("y2",Ze.rect[3]-Ze.lineCoordinates[3]),gi.setAttribute("stroke-width",Ze.borderStyle.width||1),gi.setAttribute("stroke","transparent"),gi.setAttribute("fill","transparent"),ui.append(gi),this.container.append(ui),this._createPopup(gi,Ze),this.container}}class oi extends t{constructor(Ze){var Qe,ui,gi;const ii=!!(Ze.data.hasPopup||((Qe=Ze.data.titleObj)==null?void 0:Qe.str)||((ui=Ze.data.contentsObj)==null?void 0:ui.str)||((gi=Ze.data.richText)==null?void 0:gi.str));super(Ze,{isRenderable:ii,ignoreBorder:!0})}render(){this.container.className="squareAnnotation";const Ze=this.data,{width:ii,height:Qe}=_e(Ze.rect),ui=this.svgFactory.create(ii,Qe,!0),gi=Ze.borderStyle.width,_i=this.svgFactory.createElement("svg:rect");return _i.setAttribute("x",gi/2),_i.setAttribute("y",gi/2),_i.setAttribute("width",ii-gi),_i.setAttribute("height",Qe-gi),_i.setAttribute("stroke-width",gi||1),_i.setAttribute("stroke","transparent"),_i.setAttribute("fill","transparent"),ui.append(_i),this.container.append(ui),this._createPopup(_i,Ze),this.container}}class ti extends t{constructor(Ze){var Qe,ui,gi;const ii=!!(Ze.data.hasPopup||((Qe=Ze.data.titleObj)==null?void 0:Qe.str)||((ui=Ze.data.contentsObj)==null?void 0:ui.str)||((gi=Ze.data.richText)==null?void 0:gi.str));super(Ze,{isRenderable:ii,ignoreBorder:!0})}render(){this.container.className="circleAnnotation";const Ze=this.data,{width:ii,height:Qe}=_e(Ze.rect),ui=this.svgFactory.create(ii,Qe,!0),gi=Ze.borderStyle.width,_i=this.svgFactory.createElement("svg:ellipse");return _i.setAttribute("cx",ii/2),_i.setAttribute("cy",Qe/2),_i.setAttribute("rx",ii/2-gi/2),_i.setAttribute("ry",Qe/2-gi/2),_i.setAttribute("stroke-width",gi||1),_i.setAttribute("stroke","transparent"),_i.setAttribute("fill","transparent"),ui.append(_i),this.container.append(ui),this._createPopup(_i,Ze),this.container}}class ai extends t{constructor(Ze){var Qe,ui,gi;const ii=!!(Ze.data.hasPopup||((Qe=Ze.data.titleObj)==null?void 0:Qe.str)||((ui=Ze.data.contentsObj)==null?void 0:ui.str)||((gi=Ze.data.richText)==null?void 0:gi.str));super(Ze,{isRenderable:ii,ignoreBorder:!0}),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.className=this.containerClassName;const Ze=this.data,{width:ii,height:Qe}=_e(Ze.rect),ui=this.svgFactory.create(ii,Qe,!0);let gi=[];for(const Ri of Ze.vertices){const Ui=Ri.x-Ze.rect[0],ki=Ze.rect[3]-Ri.y;gi.push(Ui+","+ki)}gi=gi.join(" ");const _i=this.svgFactory.createElement(this.svgElementName);return _i.setAttribute("points",gi),_i.setAttribute("stroke-width",Ze.borderStyle.width||1),_i.setAttribute("stroke","transparent"),_i.setAttribute("fill","transparent"),ui.append(_i),this.container.append(ui),this._createPopup(_i,Ze),this.container}}class yi extends ai{constructor(Ze){super(Ze),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class di extends t{constructor(Ze){var Qe,ui,gi;const ii=!!(Ze.data.hasPopup||((Qe=Ze.data.titleObj)==null?void 0:Qe.str)||((ui=Ze.data.contentsObj)==null?void 0:ui.str)||((gi=Ze.data.richText)==null?void 0:gi.str));super(Ze,{isRenderable:ii,ignoreBorder:!0})}render(){return this.container.className="caretAnnotation",this.data.hasPopup||this._createPopup(null,this.data),this.container}}class bi extends t{constructor(Ze){var Qe,ui,gi;const ii=!!(Ze.data.hasPopup||((Qe=Ze.data.titleObj)==null?void 0:Qe.str)||((ui=Ze.data.contentsObj)==null?void 0:ui.str)||((gi=Ze.data.richText)==null?void 0:gi.str));super(Ze,{isRenderable:ii,ignoreBorder:!0}),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline"}render(){this.container.className=this.containerClassName;const Ze=this.data,{width:ii,height:Qe}=_e(Ze.rect),ui=this.svgFactory.create(ii,Qe,!0);for(const gi of Ze.inkLists){let _i=[];for(const Ui of gi){const ki=Ui.x-Ze.rect[0],Vi=Ze.rect[3]-Ui.y;_i.push(`${ki},${Vi}`)}_i=_i.join(" ");const Ri=this.svgFactory.createElement(this.svgElementName);Ri.setAttribute("points",_i),Ri.setAttribute("stroke-width",Ze.borderStyle.width||1),Ri.setAttribute("stroke","transparent"),Ri.setAttribute("fill","transparent"),this._createPopup(Ri,Ze),ui.append(Ri)}return this.container.append(ui),this.container}}class vi extends t{constructor(Ze){var Qe,ui,gi;const ii=!!(Ze.data.hasPopup||((Qe=Ze.data.titleObj)==null?void 0:Qe.str)||((ui=Ze.data.contentsObj)==null?void 0:ui.str)||((gi=Ze.data.richText)==null?void 0:gi.str));super(Ze,{isRenderable:ii,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("highlightAnnotation"):(this.container.className="highlightAnnotation",this.container)}}class Pi extends t{constructor(Ze){var Qe,ui,gi;const ii=!!(Ze.data.hasPopup||((Qe=Ze.data.titleObj)==null?void 0:Qe.str)||((ui=Ze.data.contentsObj)==null?void 0:ui.str)||((gi=Ze.data.richText)==null?void 0:gi.str));super(Ze,{isRenderable:ii,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("underlineAnnotation"):(this.container.className="underlineAnnotation",this.container)}}class xi extends t{constructor(Ze){var Qe,ui,gi;const ii=!!(Ze.data.hasPopup||((Qe=Ze.data.titleObj)==null?void 0:Qe.str)||((ui=Ze.data.contentsObj)==null?void 0:ui.str)||((gi=Ze.data.richText)==null?void 0:gi.str));super(Ze,{isRenderable:ii,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("squigglyAnnotation"):(this.container.className="squigglyAnnotation",this.container)}}class ni extends t{constructor(Ze){var Qe,ui,gi;const ii=!!(Ze.data.hasPopup||((Qe=Ze.data.titleObj)==null?void 0:Qe.str)||((ui=Ze.data.contentsObj)==null?void 0:ui.str)||((gi=Ze.data.richText)==null?void 0:gi.str));super(Ze,{isRenderable:ii,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("strikeoutAnnotation"):(this.container.className="strikeoutAnnotation",this.container)}}class fi extends t{constructor(Ze){var Qe,ui,gi;const ii=!!(Ze.data.hasPopup||((Qe=Ze.data.titleObj)==null?void 0:Qe.str)||((ui=Ze.data.contentsObj)==null?void 0:ui.str)||((gi=Ze.data.richText)==null?void 0:gi.str));super(Ze,{isRenderable:ii,ignoreBorder:!0})}render(){return this.container.className="stampAnnotation",this.data.hasPopup||this._createPopup(null,this.data),this.container}}class Si extends t{constructor(Ze){var ui;super(Ze,{isRenderable:!0});const{filename:ii,content:Qe}=this.data.file;this.filename=(0,Be.getFilenameFromUrl)(ii),this.content=Qe,(ui=this.linkService.eventBus)==null||ui.dispatch("fileattachmentannotation",{source:this,filename:ii,content:Qe})}render(){var ii,Qe;this.container.className="fileAttachmentAnnotation";const Ze=document.createElement("div");return Ze.className="popupTriggerArea",Ze.addEventListener("dblclick",this._download.bind(this)),!this.data.hasPopup&&(((ii=this.data.titleObj)==null?void 0:ii.str)||((Qe=this.data.contentsObj)==null?void 0:Qe.str)||this.data.richText)&&this._createPopup(Ze,this.data),this.container.append(Ze),this.container}_download(){var Ze;(Ze=this.downloadManager)==null||Ze.openOrDownloadData(this.container,this.content,this.filename)}}const Oi=class{static render(Ze){var Ri,Ui;const{annotations:ii,div:Qe,viewport:ui,accessibilityManager:gi}=Ze;fn(this,li,Xl).call(this,Qe,ui);let _i=0;for(const ki of ii){if(ki.annotationType!==Oe.AnnotationType.POPUP){const{width:Ii,height:$i}=_e(ki.rect);if(Ii<=0||$i<=0)continue}const Vi=Se.create({data:ki,layer:Qe,page:Ze.page,viewport:ui,linkService:Ze.linkService,downloadManager:Ze.downloadManager,imageResourcesPath:Ze.imageResourcesPath||"",renderForms:Ze.renderForms!==!1,svgFactory:new Be.DOMSVGFactory,annotationStorage:Ze.annotationStorage||new Ue.AnnotationStorage,enableScripting:Ze.enableScripting,hasJSActions:Ze.hasJSActions,fieldObjects:Ze.fieldObjects,mouseState:Ze.mouseState||{isDown:!1}});if(Vi.isRenderable){const Ii=Vi.render();if(ki.hidden&&(Ii.style.visibility="hidden"),Array.isArray(Ii))for(const $i of Ii)$i.style.zIndex=_i++,fn(Ri=Oi,ei,Hl).call(Ri,$i,ki.id,Qe,gi);else Ii.style.zIndex=_i++,Vi instanceof We?Qe.prepend(Ii):fn(Ui=Oi,ei,Hl).call(Ui,Ii,ki.id,Qe,gi)}}fn(this,Ci,Vl).call(this,Qe,Ze.annotationCanvasMap)}static update(Ze){const{annotationCanvasMap:ii,div:Qe,viewport:ui}=Ze;fn(this,li,Xl).call(this,Qe,ui),fn(this,Ci,Vl).call(this,Qe,ii),Qe.hidden=!1}};let Xe=Oi;ei=new WeakSet,Hl=function(Ze,ii,Qe,ui){const gi=Ze.firstChild||Ze;gi.id=`${Be.AnnotationPrefix}${ii}`,Qe.append(Ze),ui==null||ui.moveElementInDOM(Qe,Ze,gi,!1)},li=new WeakSet,Xl=function(Ze,{width:ii,height:Qe,rotation:ui}){const{style:gi}=Ze,_i=ui%180!==0,Ri=Math.floor(ii)+"px",Ui=Math.floor(Qe)+"px";gi.width=_i?Ui:Ri,gi.height=_i?Ri:Ui,Ze.setAttribute("data-main-rotation",ui)},Ci=new WeakSet,Vl=function(Ze,ii){if(!!ii){for(const[Qe,ui]of ii){const gi=Ze.querySelector(`[data-annotation-id="${Qe}"]`);if(!gi)continue;const{firstChild:_i}=gi;_i?_i.nodeName==="CANVAS"?_i.replaceWith(ui):_i.before(ui):gi.append(ui)}ii.clear()}},rn(Xe,ei),rn(Xe,li),rn(Xe,Ci),r.AnnotationLayer=Xe},(Ie,r)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.ColorConverters=void 0;function Me(Be){return Math.floor(Math.max(0,Math.min(1,Be))*255).toString(16).padStart(2,"0")}class Oe{static CMYK_G([Ue,He,Ee,e]){return["G",1-Math.min(1,.3*Ue+.59*Ee+.11*He+e)]}static G_CMYK([Ue]){return["CMYK",0,0,0,1-Ue]}static G_RGB([Ue]){return["RGB",Ue,Ue,Ue]}static G_HTML([Ue]){const He=Me(Ue);return`#${He}${He}${He}`}static RGB_G([Ue,He,Ee]){return["G",.3*Ue+.59*He+.11*Ee]}static RGB_HTML([Ue,He,Ee]){const e=Me(Ue),xe=Me(He),Te=Me(Ee);return`#${e}${xe}${Te}`}static T_HTML(){return"#00000000"}static CMYK_RGB([Ue,He,Ee,e]){return["RGB",1-Math.min(1,Ue+e),1-Math.min(1,Ee+e),1-Math.min(1,He+e)]}static CMYK_HTML(Ue){const He=this.CMYK_RGB(Ue).slice(1);return this.RGB_HTML(He)}static RGB_CMYK([Ue,He,Ee]){const e=1-Ue,xe=1-He,Te=1-Ee,_e=Math.min(e,xe,Te);return["CMYK",e,xe,Te,_e]}}r.ColorConverters=Oe},(Ie,r,Me)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.XfaLayer=void 0;var Oe=Me(19);class Be{static setupStorage(He,Ee,e,xe,Te){const _e=xe.getValue(Ee,{value:null});switch(e.name){case"textarea":if(_e.value!==null&&(He.textContent=_e.value),Te==="print")break;He.addEventListener("input",Se=>{xe.setValue(Ee,{value:Se.target.value})});break;case"input":if(e.attributes.type==="radio"||e.attributes.type==="checkbox"){if(_e.value===e.attributes.xfaOn?He.setAttribute("checked",!0):_e.value===e.attributes.xfaOff&&He.removeAttribute("checked"),Te==="print")break;He.addEventListener("change",Se=>{xe.setValue(Ee,{value:Se.target.checked?Se.target.getAttribute("xfaOn"):Se.target.getAttribute("xfaOff")})})}else{if(_e.value!==null&&He.setAttribute("value",_e.value),Te==="print")break;He.addEventListener("input",Se=>{xe.setValue(Ee,{value:Se.target.value})})}break;case"select":if(_e.value!==null)for(const Se of e.children)Se.attributes.value===_e.value&&(Se.attributes.selected=!0);He.addEventListener("input",Se=>{const t=Se.target.options,Ae=t.selectedIndex===-1?"":t[t.selectedIndex].value;xe.setValue(Ee,{value:Ae})});break}}static setAttributes({html:He,element:Ee,storage:e=null,intent:xe,linkService:Te}){const{attributes:_e}=Ee,Se=He instanceof HTMLAnchorElement;_e.type==="radio"&&(_e.name=`${_e.name}-${xe}`);for(const[t,Ae]of Object.entries(_e))if(Ae!=null)switch(t){case"class":Ae.length&&He.setAttribute(t,Ae.join(" "));break;case"dataId":break;case"id":He.setAttribute("data-element-id",Ae);break;case"style":Object.assign(He.style,Ae);break;case"textContent":He.textContent=Ae;break;default:(!Se||t!=="href"&&t!=="newWindow")&&He.setAttribute(t,Ae)}Se&&Te.addLinkAttributes(He,_e.href,_e.newWindow),e&&_e.dataId&&this.setupStorage(He,_e.dataId,Ee,e)}static render(He){var Pe;const Ee=He.annotationStorage,e=He.linkService,xe=He.xfaHtml,Te=He.intent||"display",_e=document.createElement(xe.name);xe.attributes&&this.setAttributes({html:_e,element:xe,intent:Te,linkService:e});const Se=[[xe,-1,_e]],t=He.div;if(t.append(_e),He.viewport){const St=`matrix(${He.viewport.transform.join(",")})`;t.style.transform=St}Te!=="richText"&&t.setAttribute("class","xfaLayer xfaFont");const Ae=[];for(;Se.length>0;){const[St,Ce,ke]=Se.at(-1);if(Ce+1===St.children.length){Se.pop();continue}const De=St.children[++Se.at(-1)[1]];if(De===null)continue;const{name:Re}=De;if(Re==="#text"){const We=document.createTextNode(De.value);Ae.push(We),ke.append(We);continue}let je;if((Pe=De==null?void 0:De.attributes)!=null&&Pe.xmlns?je=document.createElementNS(De.attributes.xmlns,Re):je=document.createElement(Re),ke.append(je),De.attributes&&this.setAttributes({html:je,element:De,storage:Ee,intent:Te,linkService:e}),De.children&&De.children.length>0)Se.push([De,-1,je]);else if(De.value){const We=document.createTextNode(De.value);Oe.XfaText.shouldBuildText(Re)&&Ae.push(We),je.append(We)}}for(const St of t.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))St.setAttribute("readOnly",!0);return{textDivs:Ae}}static update(He){const Ee=`matrix(${He.viewport.transform.join(",")})`;He.div.style.transform=Ee,He.div.hidden=!1}}r.XfaLayer=Be},(Ie,r,Me)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.TextLayerRenderTask=void 0,r.renderTextLayer=Se;var Oe=Me(1);const Be=1e5,Ue=30,He=.8,Ee=new Map;function e(t,Ae){const Pe=Ee.get(t);if(Pe)return Pe;Ae.save(),Ae.font=`${Ue}px ${t}`;const St=Ae.measureText("");let Ce=St.fontBoundingBoxAscent,ke=Math.abs(St.fontBoundingBoxDescent);if(Ce){Ae.restore();const Re=Ce/(Ce+ke);return Ee.set(t,Re),Re}Ae.strokeStyle="red",Ae.clearRect(0,0,Ue,Ue),Ae.strokeText("g",0,0);let De=Ae.getImageData(0,0,Ue,Ue).data;ke=0;for(let Re=De.length-1-3;Re>=0;Re-=4)if(De[Re]>0){ke=Math.ceil(Re/4/Ue);break}Ae.clearRect(0,0,Ue,Ue),Ae.strokeText("A",0,Ue),De=Ae.getImageData(0,0,Ue,Ue).data,Ce=0;for(let Re=0,je=De.length;Re<je;Re+=4)if(De[Re]>0){Ce=Ue-Math.floor(Re/4/Ue);break}if(Ae.restore(),Ce){const Re=Ce/(Ce+ke);return Ee.set(t,Re),Re}return Ee.set(t,He),He}function xe(t,Ae,Pe,St){const Ce=document.createElement("span"),ke={angle:0,canvasWidth:0,hasText:Ae.str!=="",hasEOL:Ae.hasEOL,fontSize:0};t._textDivs.push(Ce);const De=Oe.Util.transform(t._viewport.transform,Ae.transform);let Re=Math.atan2(De[1],De[0]);const je=Pe[Ae.fontName];je.vertical&&(Re+=Math.PI/2);const We=Math.hypot(De[2],De[3]),Ke=We*e(je.fontFamily,St);let Je,hi;Re===0?(Je=De[4],hi=De[5]-Ke):(Je=De[4]+Ke*Math.sin(Re),hi=De[5]-Ke*Math.cos(Re)),Ce.style.left=`${Je}px`,Ce.style.top=`${hi}px`,Ce.style.fontSize=`${We}px`,Ce.style.fontFamily=je.fontFamily,ke.fontSize=We,Ce.setAttribute("role","presentation"),Ce.textContent=Ae.str,Ce.dir=Ae.dir,t._fontInspectorEnabled&&(Ce.dataset.fontName=Ae.fontName),Re!==0&&(ke.angle=Re*(180/Math.PI));let oi=!1;if(Ae.str.length>1)oi=!0;else if(Ae.str!==" "&&Ae.transform[0]!==Ae.transform[3]){const ti=Math.abs(Ae.transform[0]),ai=Math.abs(Ae.transform[3]);ti!==ai&&Math.max(ti,ai)/Math.min(ti,ai)>1.5&&(oi=!0)}oi&&(je.vertical?ke.canvasWidth=Ae.height*t._viewport.scale:ke.canvasWidth=Ae.width*t._viewport.scale),t._textDivProperties.set(Ce,ke),t._textContentStream&&t._layoutText(Ce)}function Te(t){if(t._canceled)return;const Ae=t._textDivs,Pe=t._capability;if(Ae.length>Be){t._renderingDone=!0,Pe.resolve();return}if(!t._textContentStream)for(const Ce of Ae)t._layoutText(Ce);t._renderingDone=!0,Pe.resolve()}class _e{constructor({textContent:Ae,textContentStream:Pe,container:St,viewport:Ce,textDivs:ke,textContentItemsStr:De}){var Re;this._textContent=Ae,this._textContentStream=Pe,this._container=St,this._document=St.ownerDocument,this._viewport=Ce,this._textDivs=ke||[],this._textContentItemsStr=De||[],this._fontInspectorEnabled=!!((Re=globalThis.FontInspector)!=null&&Re.enabled),this._reader=null,this._layoutTextLastFontSize=null,this._layoutTextLastFontFamily=null,this._layoutTextCtx=null,this._textDivProperties=new WeakMap,this._renderingDone=!1,this._canceled=!1,this._capability=(0,Oe.createPromiseCapability)(),this._renderTimer=null,this._bounds=[],this._devicePixelRatio=globalThis.devicePixelRatio||1,this._capability.promise.finally(()=>{this._textDivProperties=null,this._layoutTextCtx&&(this._layoutTextCtx.canvas.width=0,this._layoutTextCtx.canvas.height=0,this._layoutTextCtx=null)}).catch(()=>{})}get promise(){return this._capability.promise}cancel(){this._canceled=!0,this._reader&&(this._reader.cancel(new Oe.AbortException("TextLayer task cancelled.")).catch(()=>{}),this._reader=null),this._renderTimer!==null&&(clearTimeout(this._renderTimer),this._renderTimer=null),this._capability.reject(new Error("TextLayer task cancelled."))}_processItems(Ae,Pe){for(const St of Ae){if(St.str===void 0){if(St.type==="beginMarkedContentProps"||St.type==="beginMarkedContent"){const Ce=this._container;this._container=document.createElement("span"),this._container.classList.add("markedContent"),St.id!==null&&this._container.setAttribute("id",`${St.id}`),Ce.append(this._container)}else St.type==="endMarkedContent"&&(this._container=this._container.parentNode);continue}this._textContentItemsStr.push(St.str),xe(this,St,Pe,this._layoutTextCtx)}}_layoutText(Ae){const Pe=this._textDivProperties.get(Ae);let St="";if(Pe.canvasWidth!==0&&Pe.hasText){const{fontFamily:Ce}=Ae.style,{fontSize:ke}=Pe;(ke!==this._layoutTextLastFontSize||Ce!==this._layoutTextLastFontFamily)&&(this._layoutTextCtx.font=`${ke*this._devicePixelRatio}px ${Ce}`,this._layoutTextLastFontSize=ke,this._layoutTextLastFontFamily=Ce);const{width:De}=this._layoutTextCtx.measureText(Ae.textContent);De>0&&(St=`scaleX(${this._devicePixelRatio*Pe.canvasWidth/De})`)}if(Pe.angle!==0&&(St=`rotate(${Pe.angle}deg) ${St}`),St.length>0&&(Ae.style.transform=St),Pe.hasText&&this._container.append(Ae),Pe.hasEOL){const Ce=document.createElement("br");Ce.setAttribute("role","presentation"),this._container.append(Ce)}}_render(Ae=0){const Pe=(0,Oe.createPromiseCapability)();let St=Object.create(null);const Ce=this._document.createElement("canvas");if(Ce.height=Ce.width=Ue,this._layoutTextCtx=Ce.getContext("2d",{alpha:!1}),this._textContent){const ke=this._textContent.items,De=this._textContent.styles;this._processItems(ke,De),Pe.resolve()}else if(this._textContentStream){const ke=()=>{this._reader.read().then(({value:De,done:Re})=>{if(Re){Pe.resolve();return}Object.assign(St,De.styles),this._processItems(De.items,St),ke()},Pe.reject)};this._reader=this._textContentStream.getReader(),ke()}else throw new Error('Neither "textContent" nor "textContentStream" parameters specified.');Pe.promise.then(()=>{St=null,Ae?this._renderTimer=setTimeout(()=>{Te(this),this._renderTimer=null},Ae):Te(this)},this._capability.reject)}}r.TextLayerRenderTask=_e;function Se(t){const Ae=new _e({textContent:t.textContent,textContentStream:t.textContentStream,container:t.container,viewport:t.viewport,textDivs:t.textDivs,textContentItemsStr:t.textContentItemsStr});return Ae._render(t.timeout),Ae}},(Ie,r,Me)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.SVGGraphics=void 0;var Oe=Me(6),Be=Me(1),Ue=Me(12);let He=class{constructor(){(0,Be.unreachable)("Not implemented: SVGGraphics")}};r.SVGGraphics=He;{let Pe=function(je){let We=[];const Ke=[];for(const Je of je){if(Je.fn==="save"){We.push({fnId:92,fn:"group",items:[]}),Ke.push(We),We=We.at(-1).items;continue}Je.fn==="restore"?We=Ke.pop():We.push(Je)}return We},St=function(je){if(Number.isInteger(je))return je.toString();const We=je.toFixed(10);let Ke=We.length-1;if(We[Ke]!=="0")return We;do Ke--;while(We[Ke]==="0");return We.substring(0,We[Ke]==="."?Ke:Ke+1)},Ce=function(je){if(je[4]===0&&je[5]===0){if(je[1]===0&&je[2]===0)return je[0]===1&&je[3]===1?"":`scale(${St(je[0])} ${St(je[3])})`;if(je[0]===je[3]&&je[1]===-je[2]){const We=Math.acos(je[0])*180/Math.PI;return`rotate(${St(We)})`}}else if(je[0]===1&&je[1]===0&&je[2]===0&&je[3]===1)return`translate(${St(je[4])} ${St(je[5])})`;return`matrix(${St(je[0])} ${St(je[1])} ${St(je[2])} ${St(je[3])} ${St(je[4])} ${St(je[5])})`};const Ee={fontStyle:"normal",fontWeight:"normal",fillColor:"#000000"},e="http://www.w3.org/XML/1998/namespace",xe="http://www.w3.org/1999/xlink",Te=["butt","round","square"],_e=["miter","round","bevel"],Se=function(je,We="",Ke=!1){if(URL.createObjectURL&&typeof Blob<"u"&&!Ke)return URL.createObjectURL(new Blob([je],{type:We}));const Je="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let hi=`data:${We};base64,`;for(let oi=0,ti=je.length;oi<ti;oi+=3){const ai=je[oi]&255,yi=je[oi+1]&255,di=je[oi+2]&255,bi=ai>>2,vi=(ai&3)<<4|yi>>4,Pi=oi+1<ti?(yi&15)<<2|di>>6:64,xi=oi+2<ti?di&63:64;hi+=Je[bi]+Je[vi]+Je[Pi]+Je[xi]}return hi},t=function(){const je=new Uint8Array([137,80,78,71,13,10,26,10]),We=12,Ke=new Int32Array(256);for(let di=0;di<256;di++){let bi=di;for(let vi=0;vi<8;vi++)bi&1?bi=3988292384^bi>>1&2147483647:bi=bi>>1&2147483647;Ke[di]=bi}function Je(di,bi,vi){let Pi=-1;for(let xi=bi;xi<vi;xi++){const ni=(Pi^di[xi])&255,fi=Ke[ni];Pi=Pi>>>8^fi}return Pi^-1}function hi(di,bi,vi,Pi){let xi=Pi;const ni=bi.length;vi[xi]=ni>>24&255,vi[xi+1]=ni>>16&255,vi[xi+2]=ni>>8&255,vi[xi+3]=ni&255,xi+=4,vi[xi]=di.charCodeAt(0)&255,vi[xi+1]=di.charCodeAt(1)&255,vi[xi+2]=di.charCodeAt(2)&255,vi[xi+3]=di.charCodeAt(3)&255,xi+=4,vi.set(bi,xi),xi+=bi.length;const fi=Je(vi,Pi+4,xi);vi[xi]=fi>>24&255,vi[xi+1]=fi>>16&255,vi[xi+2]=fi>>8&255,vi[xi+3]=fi&255}function oi(di,bi,vi){let Pi=1,xi=0;for(let ni=bi;ni<vi;++ni)Pi=(Pi+(di[ni]&255))%65521,xi=(xi+Pi)%65521;return xi<<16|Pi}function ti(di){if(!Ue.isNodeJS)return ai(di);try{let bi;parseInt(process.versions.node)>=8?bi=di:bi=Buffer.from(di);const vi=require$$5.deflateSync(bi,{level:9});return vi instanceof Uint8Array?vi:new Uint8Array(vi)}catch(bi){(0,Be.warn)("Not compressing PNG because zlib.deflateSync is unavailable: "+bi)}return ai(di)}function ai(di){let bi=di.length;const vi=65535,Pi=Math.ceil(bi/vi),xi=new Uint8Array(2+bi+Pi*5+4);let ni=0;xi[ni++]=120,xi[ni++]=156;let fi=0;for(;bi>vi;)xi[ni++]=0,xi[ni++]=255,xi[ni++]=255,xi[ni++]=0,xi[ni++]=0,xi.set(di.subarray(fi,fi+vi),ni),ni+=vi,fi+=vi,bi-=vi;xi[ni++]=1,xi[ni++]=bi&255,xi[ni++]=bi>>8&255,xi[ni++]=~bi&65535&255,xi[ni++]=(~bi&65535)>>8&255,xi.set(di.subarray(fi),ni),ni+=di.length-fi;const Si=oi(di,0,di.length);return xi[ni++]=Si>>24&255,xi[ni++]=Si>>16&255,xi[ni++]=Si>>8&255,xi[ni++]=Si&255,xi}function yi(di,bi,vi,Pi){const xi=di.width,ni=di.height;let fi,Si,Xe;const Ge=di.data;switch(bi){case Be.ImageKind.GRAYSCALE_1BPP:Si=0,fi=1,Xe=xi+7>>3;break;case Be.ImageKind.RGB_24BPP:Si=2,fi=8,Xe=xi*3;break;case Be.ImageKind.RGBA_32BPP:Si=6,fi=8,Xe=xi*4;break;default:throw new Error("invalid format")}const ze=new Uint8Array((1+Xe)*ni);let Ve=0,ei=0;for(let Oi=0;Oi<ni;++Oi)ze[Ve++]=0,ze.set(Ge.subarray(ei,ei+Xe),Ve),ei+=Xe,Ve+=Xe;if(bi===Be.ImageKind.GRAYSCALE_1BPP&&Pi){Ve=0;for(let Oi=0;Oi<ni;Oi++){Ve++;for(let Ti=0;Ti<Xe;Ti++)ze[Ve++]^=255}}const si=new Uint8Array([xi>>24&255,xi>>16&255,xi>>8&255,xi&255,ni>>24&255,ni>>16&255,ni>>8&255,ni&255,fi,Si,0,0,0]),li=ti(ze),ci=je.length+We*3+si.length+li.length,Ci=new Uint8Array(ci);let Fi=0;return Ci.set(je,Fi),Fi+=je.length,hi("IHDR",si,Ci,Fi),Fi+=We+si.length,hi("IDATA",li,Ci,Fi),Fi+=We+li.length,hi("IEND",new Uint8Array(0),Ci,Fi),Se(Ci,"image/png",vi)}return function(bi,vi,Pi){const xi=bi.kind===void 0?Be.ImageKind.GRAYSCALE_1BPP:bi.kind;return yi(bi,xi,vi,Pi)}}();class Ae{constructor(){this.fontSizeScale=1,this.fontWeight=Ee.fontWeight,this.fontSize=0,this.textMatrix=Be.IDENTITY_MATRIX,this.fontMatrix=Be.FONT_IDENTITY_MATRIX,this.leading=0,this.textRenderingMode=Be.TextRenderingMode.FILL,this.textMatrixScale=1,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRise=0,this.fillColor=Ee.fillColor,this.strokeColor="#000000",this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.lineJoin="",this.lineCap="",this.miterLimit=0,this.dashArray=[],this.dashPhase=0,this.dependencies=[],this.activeClipUrl=null,this.clipGroup=null,this.maskId=""}clone(){return Object.create(this)}setCurrentPoint(We,Ke){this.x=We,this.y=Ke}}let ke=0,De=0,Re=0;r.SVGGraphics=He=class{constructor(je,We,Ke=!1){(0,Oe.deprecated)("The SVG back-end is no longer maintained and *may* be removed in the future."),this.svgFactory=new Oe.DOMSVGFactory,this.current=new Ae,this.transformMatrix=Be.IDENTITY_MATRIX,this.transformStack=[],this.extraStack=[],this.commonObjs=je,this.objs=We,this.pendingClip=null,this.pendingEOFill=!1,this.embedFonts=!1,this.embeddedFonts=Object.create(null),this.cssStyle=null,this.forceDataSchema=!!Ke,this._operatorIdMapping=[];for(const Je in Be.OPS)this._operatorIdMapping[Be.OPS[Je]]=Je}getObject(je,We=null){return typeof je=="string"?je.startsWith("g_")?this.commonObjs.get(je):this.objs.get(je):We}save(){this.transformStack.push(this.transformMatrix);const je=this.current;this.extraStack.push(je),this.current=je.clone()}restore(){this.transformMatrix=this.transformStack.pop(),this.current=this.extraStack.pop(),this.pendingClip=null,this.tgrp=null}group(je){this.save(),this.executeOpTree(je),this.restore()}loadDependencies(je){const We=je.fnArray,Ke=je.argsArray;for(let Je=0,hi=We.length;Je<hi;Je++)if(We[Je]===Be.OPS.dependency)for(const oi of Ke[Je]){const ti=oi.startsWith("g_")?this.commonObjs:this.objs,ai=new Promise(yi=>{ti.get(oi,yi)});this.current.dependencies.push(ai)}return Promise.all(this.current.dependencies)}transform(je,We,Ke,Je,hi,oi){const ti=[je,We,Ke,Je,hi,oi];this.transformMatrix=Be.Util.transform(this.transformMatrix,ti),this.tgrp=null}getSVG(je,We){this.viewport=We;const Ke=this._initialize(We);return this.loadDependencies(je).then(()=>(this.transformMatrix=Be.IDENTITY_MATRIX,this.executeOpTree(this.convertOpList(je)),Ke))}convertOpList(je){const We=this._operatorIdMapping,Ke=je.argsArray,Je=je.fnArray,hi=[];for(let oi=0,ti=Je.length;oi<ti;oi++){const ai=Je[oi];hi.push({fnId:ai,fn:We[ai],args:Ke[oi]})}return Pe(hi)}executeOpTree(je){for(const We of je){const Ke=We.fn,Je=We.fnId,hi=We.args;switch(Je|0){case Be.OPS.beginText:this.beginText();break;case Be.OPS.dependency:break;case Be.OPS.setLeading:this.setLeading(hi);break;case Be.OPS.setLeadingMoveText:this.setLeadingMoveText(hi[0],hi[1]);break;case Be.OPS.setFont:this.setFont(hi);break;case Be.OPS.showText:this.showText(hi[0]);break;case Be.OPS.showSpacedText:this.showText(hi[0]);break;case Be.OPS.endText:this.endText();break;case Be.OPS.moveText:this.moveText(hi[0],hi[1]);break;case Be.OPS.setCharSpacing:this.setCharSpacing(hi[0]);break;case Be.OPS.setWordSpacing:this.setWordSpacing(hi[0]);break;case Be.OPS.setHScale:this.setHScale(hi[0]);break;case Be.OPS.setTextMatrix:this.setTextMatrix(hi[0],hi[1],hi[2],hi[3],hi[4],hi[5]);break;case Be.OPS.setTextRise:this.setTextRise(hi[0]);break;case Be.OPS.setTextRenderingMode:this.setTextRenderingMode(hi[0]);break;case Be.OPS.setLineWidth:this.setLineWidth(hi[0]);break;case Be.OPS.setLineJoin:this.setLineJoin(hi[0]);break;case Be.OPS.setLineCap:this.setLineCap(hi[0]);break;case Be.OPS.setMiterLimit:this.setMiterLimit(hi[0]);break;case Be.OPS.setFillRGBColor:this.setFillRGBColor(hi[0],hi[1],hi[2]);break;case Be.OPS.setStrokeRGBColor:this.setStrokeRGBColor(hi[0],hi[1],hi[2]);break;case Be.OPS.setStrokeColorN:this.setStrokeColorN(hi);break;case Be.OPS.setFillColorN:this.setFillColorN(hi);break;case Be.OPS.shadingFill:this.shadingFill(hi[0]);break;case Be.OPS.setDash:this.setDash(hi[0],hi[1]);break;case Be.OPS.setRenderingIntent:this.setRenderingIntent(hi[0]);break;case Be.OPS.setFlatness:this.setFlatness(hi[0]);break;case Be.OPS.setGState:this.setGState(hi[0]);break;case Be.OPS.fill:this.fill();break;case Be.OPS.eoFill:this.eoFill();break;case Be.OPS.stroke:this.stroke();break;case Be.OPS.fillStroke:this.fillStroke();break;case Be.OPS.eoFillStroke:this.eoFillStroke();break;case Be.OPS.clip:this.clip("nonzero");break;case Be.OPS.eoClip:this.clip("evenodd");break;case Be.OPS.paintSolidColorImageMask:this.paintSolidColorImageMask();break;case Be.OPS.paintImageXObject:this.paintImageXObject(hi[0]);break;case Be.OPS.paintInlineImageXObject:this.paintInlineImageXObject(hi[0]);break;case Be.OPS.paintImageMaskXObject:this.paintImageMaskXObject(hi[0]);break;case Be.OPS.paintFormXObjectBegin:this.paintFormXObjectBegin(hi[0],hi[1]);break;case Be.OPS.paintFormXObjectEnd:this.paintFormXObjectEnd();break;case Be.OPS.closePath:this.closePath();break;case Be.OPS.closeStroke:this.closeStroke();break;case Be.OPS.closeFillStroke:this.closeFillStroke();break;case Be.OPS.closeEOFillStroke:this.closeEOFillStroke();break;case Be.OPS.nextLine:this.nextLine();break;case Be.OPS.transform:this.transform(hi[0],hi[1],hi[2],hi[3],hi[4],hi[5]);break;case Be.OPS.constructPath:this.constructPath(hi[0],hi[1]);break;case Be.OPS.endPath:this.endPath();break;case 92:this.group(We.items);break;default:(0,Be.warn)(`Unimplemented operator ${Ke}`);break}}}setWordSpacing(je){this.current.wordSpacing=je}setCharSpacing(je){this.current.charSpacing=je}nextLine(){this.moveText(0,this.current.leading)}setTextMatrix(je,We,Ke,Je,hi,oi){const ti=this.current;ti.textMatrix=ti.lineMatrix=[je,We,Ke,Je,hi,oi],ti.textMatrixScale=Math.hypot(je,We),ti.x=ti.lineX=0,ti.y=ti.lineY=0,ti.xcoords=[],ti.ycoords=[],ti.tspan=this.svgFactory.createElement("svg:tspan"),ti.tspan.setAttributeNS(null,"font-family",ti.fontFamily),ti.tspan.setAttributeNS(null,"font-size",`${St(ti.fontSize)}px`),ti.tspan.setAttributeNS(null,"y",St(-ti.y)),ti.txtElement=this.svgFactory.createElement("svg:text"),ti.txtElement.append(ti.tspan)}beginText(){const je=this.current;je.x=je.lineX=0,je.y=je.lineY=0,je.textMatrix=Be.IDENTITY_MATRIX,je.lineMatrix=Be.IDENTITY_MATRIX,je.textMatrixScale=1,je.tspan=this.svgFactory.createElement("svg:tspan"),je.txtElement=this.svgFactory.createElement("svg:text"),je.txtgrp=this.svgFactory.createElement("svg:g"),je.xcoords=[],je.ycoords=[]}moveText(je,We){const Ke=this.current;Ke.x=Ke.lineX+=je,Ke.y=Ke.lineY+=We,Ke.xcoords=[],Ke.ycoords=[],Ke.tspan=this.svgFactory.createElement("svg:tspan"),Ke.tspan.setAttributeNS(null,"font-family",Ke.fontFamily),Ke.tspan.setAttributeNS(null,"font-size",`${St(Ke.fontSize)}px`),Ke.tspan.setAttributeNS(null,"y",St(-Ke.y))}showText(je){const We=this.current,Ke=We.font,Je=We.fontSize;if(Je===0)return;const hi=We.fontSizeScale,oi=We.charSpacing,ti=We.wordSpacing,ai=We.fontDirection,yi=We.textHScale*ai,di=Ke.vertical,bi=di?1:-1,vi=Ke.defaultVMetrics,Pi=Je*We.fontMatrix[0];let xi=0;for(const Si of je){if(Si===null){xi+=ai*ti;continue}else if(typeof Si=="number"){xi+=bi*Si*Je/1e3;continue}const Xe=(Si.isSpace?ti:0)+oi,Ge=Si.fontChar;let ze,Ve,ei=Si.width;if(di){let li;const ci=Si.vmetric||vi;li=Si.vmetric?ci[1]:ei*.5,li=-li*Pi;const Ci=ci[2]*Pi;ei=ci?-ci[0]:ei,ze=li/hi,Ve=(xi+Ci)/hi}else ze=xi/hi,Ve=0;(Si.isInFont||Ke.missingFile)&&(We.xcoords.push(We.x+ze),di&&We.ycoords.push(-We.y+Ve),We.tspan.textContent+=Ge);let si;di?si=ei*Pi-Xe*ai:si=ei*Pi+Xe*ai,xi+=si}We.tspan.setAttributeNS(null,"x",We.xcoords.map(St).join(" ")),di?We.tspan.setAttributeNS(null,"y",We.ycoords.map(St).join(" ")):We.tspan.setAttributeNS(null,"y",St(-We.y)),di?We.y-=xi:We.x+=xi*yi,We.tspan.setAttributeNS(null,"font-family",We.fontFamily),We.tspan.setAttributeNS(null,"font-size",`${St(We.fontSize)}px`),We.fontStyle!==Ee.fontStyle&&We.tspan.setAttributeNS(null,"font-style",We.fontStyle),We.fontWeight!==Ee.fontWeight&&We.tspan.setAttributeNS(null,"font-weight",We.fontWeight);const ni=We.textRenderingMode&Be.TextRenderingMode.FILL_STROKE_MASK;if(ni===Be.TextRenderingMode.FILL||ni===Be.TextRenderingMode.FILL_STROKE?(We.fillColor!==Ee.fillColor&&We.tspan.setAttributeNS(null,"fill",We.fillColor),We.fillAlpha<1&&We.tspan.setAttributeNS(null,"fill-opacity",We.fillAlpha)):We.textRenderingMode===Be.TextRenderingMode.ADD_TO_PATH?We.tspan.setAttributeNS(null,"fill","transparent"):We.tspan.setAttributeNS(null,"fill","none"),ni===Be.TextRenderingMode.STROKE||ni===Be.TextRenderingMode.FILL_STROKE){const Si=1/(We.textMatrixScale||1);this._setStrokeAttributes(We.tspan,Si)}let fi=We.textMatrix;We.textRise!==0&&(fi=fi.slice(),fi[5]+=We.textRise),We.txtElement.setAttributeNS(null,"transform",`${Ce(fi)} scale(${St(yi)}, -1)`),We.txtElement.setAttributeNS(e,"xml:space","preserve"),We.txtElement.append(We.tspan),We.txtgrp.append(We.txtElement),this._ensureTransformGroup().append(We.txtElement)}setLeadingMoveText(je,We){this.setLeading(-We),this.moveText(je,We)}addFontStyle(je){if(!je.data)throw new Error('addFontStyle: No font data available, ensure that the "fontExtraProperties" API parameter is set.');this.cssStyle||(this.cssStyle=this.svgFactory.createElement("svg:style"),this.cssStyle.setAttributeNS(null,"type","text/css"),this.defs.append(this.cssStyle));const We=Se(je.data,je.mimetype,this.forceDataSchema);this.cssStyle.textContent+=`@font-face { font-family: "${je.loadedName}"; src: url(${We}); }
`}setFont(je){const We=this.current,Ke=this.commonObjs.get(je[0]);let Je=je[1];We.font=Ke,this.embedFonts&&!Ke.missingFile&&!this.embeddedFonts[Ke.loadedName]&&(this.addFontStyle(Ke),this.embeddedFonts[Ke.loadedName]=Ke),We.fontMatrix=Ke.fontMatrix||Be.FONT_IDENTITY_MATRIX;let hi="normal";Ke.black?hi="900":Ke.bold&&(hi="bold");const oi=Ke.italic?"italic":"normal";Je<0?(Je=-Je,We.fontDirection=-1):We.fontDirection=1,We.fontSize=Je,We.fontFamily=Ke.loadedName,We.fontWeight=hi,We.fontStyle=oi,We.tspan=this.svgFactory.createElement("svg:tspan"),We.tspan.setAttributeNS(null,"y",St(-We.y)),We.xcoords=[],We.ycoords=[]}endText(){var We;const je=this.current;je.textRenderingMode&Be.TextRenderingMode.ADD_TO_PATH_FLAG&&((We=je.txtElement)==null?void 0:We.hasChildNodes())&&(je.element=je.txtElement,this.clip("nonzero"),this.endPath())}setLineWidth(je){je>0&&(this.current.lineWidth=je)}setLineCap(je){this.current.lineCap=Te[je]}setLineJoin(je){this.current.lineJoin=_e[je]}setMiterLimit(je){this.current.miterLimit=je}setStrokeAlpha(je){this.current.strokeAlpha=je}setStrokeRGBColor(je,We,Ke){this.current.strokeColor=Be.Util.makeHexColor(je,We,Ke)}setFillAlpha(je){this.current.fillAlpha=je}setFillRGBColor(je,We,Ke){this.current.fillColor=Be.Util.makeHexColor(je,We,Ke),this.current.tspan=this.svgFactory.createElement("svg:tspan"),this.current.xcoords=[],this.current.ycoords=[]}setStrokeColorN(je){this.current.strokeColor=this._makeColorN_Pattern(je)}setFillColorN(je){this.current.fillColor=this._makeColorN_Pattern(je)}shadingFill(je){const We=this.viewport.width,Ke=this.viewport.height,Je=Be.Util.inverseTransform(this.transformMatrix),hi=Be.Util.applyTransform([0,0],Je),oi=Be.Util.applyTransform([0,Ke],Je),ti=Be.Util.applyTransform([We,0],Je),ai=Be.Util.applyTransform([We,Ke],Je),yi=Math.min(hi[0],oi[0],ti[0],ai[0]),di=Math.min(hi[1],oi[1],ti[1],ai[1]),bi=Math.max(hi[0],oi[0],ti[0],ai[0]),vi=Math.max(hi[1],oi[1],ti[1],ai[1]),Pi=this.svgFactory.createElement("svg:rect");Pi.setAttributeNS(null,"x",yi),Pi.setAttributeNS(null,"y",di),Pi.setAttributeNS(null,"width",bi-yi),Pi.setAttributeNS(null,"height",vi-di),Pi.setAttributeNS(null,"fill",this._makeShadingPattern(je)),this.current.fillAlpha<1&&Pi.setAttributeNS(null,"fill-opacity",this.current.fillAlpha),this._ensureTransformGroup().append(Pi)}_makeColorN_Pattern(je){return je[0]==="TilingPattern"?this._makeTilingPattern(je):this._makeShadingPattern(je)}_makeTilingPattern(je){const We=je[1],Ke=je[2],Je=je[3]||Be.IDENTITY_MATRIX,[hi,oi,ti,ai]=je[4],yi=je[5],di=je[6],bi=je[7],vi=`shading${Re++}`,[Pi,xi,ni,fi]=Be.Util.normalizeRect([...Be.Util.applyTransform([hi,oi],Je),...Be.Util.applyTransform([ti,ai],Je)]),[Si,Xe]=Be.Util.singularValueDecompose2dScale(Je),Ge=yi*Si,ze=di*Xe,Ve=this.svgFactory.createElement("svg:pattern");Ve.setAttributeNS(null,"id",vi),Ve.setAttributeNS(null,"patternUnits","userSpaceOnUse"),Ve.setAttributeNS(null,"width",Ge),Ve.setAttributeNS(null,"height",ze),Ve.setAttributeNS(null,"x",`${Pi}`),Ve.setAttributeNS(null,"y",`${xi}`);const ei=this.svg,si=this.transformMatrix,li=this.current.fillColor,ci=this.current.strokeColor,Ci=this.svgFactory.create(ni-Pi,fi-xi);if(this.svg=Ci,this.transformMatrix=Je,bi===2){const Fi=Be.Util.makeHexColor(...We);this.current.fillColor=Fi,this.current.strokeColor=Fi}return this.executeOpTree(this.convertOpList(Ke)),this.svg=ei,this.transformMatrix=si,this.current.fillColor=li,this.current.strokeColor=ci,Ve.append(Ci.childNodes[0]),this.defs.append(Ve),`url(#${vi})`}_makeShadingPattern(je){switch(typeof je=="string"&&(je=this.objs.get(je)),je[0]){case"RadialAxial":const We=`shading${Re++}`,Ke=je[3];let Je;switch(je[1]){case"axial":const hi=je[4],oi=je[5];Je=this.svgFactory.createElement("svg:linearGradient"),Je.setAttributeNS(null,"id",We),Je.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),Je.setAttributeNS(null,"x1",hi[0]),Je.setAttributeNS(null,"y1",hi[1]),Je.setAttributeNS(null,"x2",oi[0]),Je.setAttributeNS(null,"y2",oi[1]);break;case"radial":const ti=je[4],ai=je[5],yi=je[6],di=je[7];Je=this.svgFactory.createElement("svg:radialGradient"),Je.setAttributeNS(null,"id",We),Je.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),Je.setAttributeNS(null,"cx",ai[0]),Je.setAttributeNS(null,"cy",ai[1]),Je.setAttributeNS(null,"r",di),Je.setAttributeNS(null,"fx",ti[0]),Je.setAttributeNS(null,"fy",ti[1]),Je.setAttributeNS(null,"fr",yi);break;default:throw new Error(`Unknown RadialAxial type: ${je[1]}`)}for(const hi of Ke){const oi=this.svgFactory.createElement("svg:stop");oi.setAttributeNS(null,"offset",hi[0]),oi.setAttributeNS(null,"stop-color",hi[1]),Je.append(oi)}return this.defs.append(Je),`url(#${We})`;case"Mesh":return(0,Be.warn)("Unimplemented pattern Mesh"),null;case"Dummy":return"hotpink";default:throw new Error(`Unknown IR type: ${je[0]}`)}}setDash(je,We){this.current.dashArray=je,this.current.dashPhase=We}constructPath(je,We){const Ke=this.current;let Je=Ke.x,hi=Ke.y,oi=[],ti=0;for(const ai of je)switch(ai|0){case Be.OPS.rectangle:Je=We[ti++],hi=We[ti++];const yi=We[ti++],di=We[ti++],bi=Je+yi,vi=hi+di;oi.push("M",St(Je),St(hi),"L",St(bi),St(hi),"L",St(bi),St(vi),"L",St(Je),St(vi),"Z");break;case Be.OPS.moveTo:Je=We[ti++],hi=We[ti++],oi.push("M",St(Je),St(hi));break;case Be.OPS.lineTo:Je=We[ti++],hi=We[ti++],oi.push("L",St(Je),St(hi));break;case Be.OPS.curveTo:Je=We[ti+4],hi=We[ti+5],oi.push("C",St(We[ti]),St(We[ti+1]),St(We[ti+2]),St(We[ti+3]),St(Je),St(hi)),ti+=6;break;case Be.OPS.curveTo2:oi.push("C",St(Je),St(hi),St(We[ti]),St(We[ti+1]),St(We[ti+2]),St(We[ti+3])),Je=We[ti+2],hi=We[ti+3],ti+=4;break;case Be.OPS.curveTo3:Je=We[ti+2],hi=We[ti+3],oi.push("C",St(We[ti]),St(We[ti+1]),St(Je),St(hi),St(Je),St(hi)),ti+=4;break;case Be.OPS.closePath:oi.push("Z");break}oi=oi.join(" "),Ke.path&&je.length>0&&je[0]!==Be.OPS.rectangle&&je[0]!==Be.OPS.moveTo?oi=Ke.path.getAttributeNS(null,"d")+oi:(Ke.path=this.svgFactory.createElement("svg:path"),this._ensureTransformGroup().append(Ke.path)),Ke.path.setAttributeNS(null,"d",oi),Ke.path.setAttributeNS(null,"fill","none"),Ke.element=Ke.path,Ke.setCurrentPoint(Je,hi)}endPath(){const je=this.current;if(je.path=null,!this.pendingClip)return;if(!je.element){this.pendingClip=null;return}const We=`clippath${ke++}`,Ke=this.svgFactory.createElement("svg:clipPath");Ke.setAttributeNS(null,"id",We),Ke.setAttributeNS(null,"transform",Ce(this.transformMatrix));const Je=je.element.cloneNode(!0);if(this.pendingClip==="evenodd"?Je.setAttributeNS(null,"clip-rule","evenodd"):Je.setAttributeNS(null,"clip-rule","nonzero"),this.pendingClip=null,Ke.append(Je),this.defs.append(Ke),je.activeClipUrl){je.clipGroup=null;for(const hi of this.extraStack)hi.clipGroup=null;Ke.setAttributeNS(null,"clip-path",je.activeClipUrl)}je.activeClipUrl=`url(#${We})`,this.tgrp=null}clip(je){this.pendingClip=je}closePath(){const je=this.current;if(je.path){const We=`${je.path.getAttributeNS(null,"d")}Z`;je.path.setAttributeNS(null,"d",We)}}setLeading(je){this.current.leading=-je}setTextRise(je){this.current.textRise=je}setTextRenderingMode(je){this.current.textRenderingMode=je}setHScale(je){this.current.textHScale=je/100}setRenderingIntent(je){}setFlatness(je){}setGState(je){for(const[We,Ke]of je)switch(We){case"LW":this.setLineWidth(Ke);break;case"LC":this.setLineCap(Ke);break;case"LJ":this.setLineJoin(Ke);break;case"ML":this.setMiterLimit(Ke);break;case"D":this.setDash(Ke[0],Ke[1]);break;case"RI":this.setRenderingIntent(Ke);break;case"FL":this.setFlatness(Ke);break;case"Font":this.setFont(Ke);break;case"CA":this.setStrokeAlpha(Ke);break;case"ca":this.setFillAlpha(Ke);break;default:(0,Be.warn)(`Unimplemented graphic state operator ${We}`);break}}fill(){const je=this.current;je.element&&(je.element.setAttributeNS(null,"fill",je.fillColor),je.element.setAttributeNS(null,"fill-opacity",je.fillAlpha),this.endPath())}stroke(){const je=this.current;je.element&&(this._setStrokeAttributes(je.element),je.element.setAttributeNS(null,"fill","none"),this.endPath())}_setStrokeAttributes(je,We=1){const Ke=this.current;let Je=Ke.dashArray;We!==1&&Je.length>0&&(Je=Je.map(function(hi){return We*hi})),je.setAttributeNS(null,"stroke",Ke.strokeColor),je.setAttributeNS(null,"stroke-opacity",Ke.strokeAlpha),je.setAttributeNS(null,"stroke-miterlimit",St(Ke.miterLimit)),je.setAttributeNS(null,"stroke-linecap",Ke.lineCap),je.setAttributeNS(null,"stroke-linejoin",Ke.lineJoin),je.setAttributeNS(null,"stroke-width",St(We*Ke.lineWidth)+"px"),je.setAttributeNS(null,"stroke-dasharray",Je.map(St).join(" ")),je.setAttributeNS(null,"stroke-dashoffset",St(We*Ke.dashPhase)+"px")}eoFill(){var je;(je=this.current.element)==null||je.setAttributeNS(null,"fill-rule","evenodd"),this.fill()}fillStroke(){this.stroke(),this.fill()}eoFillStroke(){var je;(je=this.current.element)==null||je.setAttributeNS(null,"fill-rule","evenodd"),this.fillStroke()}closeStroke(){this.closePath(),this.stroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.closePath(),this.eoFillStroke()}paintSolidColorImageMask(){const je=this.svgFactory.createElement("svg:rect");je.setAttributeNS(null,"x","0"),je.setAttributeNS(null,"y","0"),je.setAttributeNS(null,"width","1px"),je.setAttributeNS(null,"height","1px"),je.setAttributeNS(null,"fill",this.current.fillColor),this._ensureTransformGroup().append(je)}paintImageXObject(je){const We=this.getObject(je);if(!We){(0,Be.warn)(`Dependent image with object ID ${je} is not ready yet`);return}this.paintInlineImageXObject(We)}paintInlineImageXObject(je,We){const Ke=je.width,Je=je.height,hi=t(je,this.forceDataSchema,!!We),oi=this.svgFactory.createElement("svg:rect");oi.setAttributeNS(null,"x","0"),oi.setAttributeNS(null,"y","0"),oi.setAttributeNS(null,"width",St(Ke)),oi.setAttributeNS(null,"height",St(Je)),this.current.element=oi,this.clip("nonzero");const ti=this.svgFactory.createElement("svg:image");ti.setAttributeNS(xe,"xlink:href",hi),ti.setAttributeNS(null,"x","0"),ti.setAttributeNS(null,"y",St(-Je)),ti.setAttributeNS(null,"width",St(Ke)+"px"),ti.setAttributeNS(null,"height",St(Je)+"px"),ti.setAttributeNS(null,"transform",`scale(${St(1/Ke)} ${St(-1/Je)})`),We?We.append(ti):this._ensureTransformGroup().append(ti)}paintImageMaskXObject(je){const We=this.getObject(je.data,je);if(We.bitmap){(0,Be.warn)("paintImageMaskXObject: ImageBitmap support is not implemented, ensure that the `isOffscreenCanvasSupported` API parameter is disabled.");return}const Ke=this.current,Je=We.width,hi=We.height,oi=Ke.fillColor;Ke.maskId=`mask${De++}`;const ti=this.svgFactory.createElement("svg:mask");ti.setAttributeNS(null,"id",Ke.maskId);const ai=this.svgFactory.createElement("svg:rect");ai.setAttributeNS(null,"x","0"),ai.setAttributeNS(null,"y","0"),ai.setAttributeNS(null,"width",St(Je)),ai.setAttributeNS(null,"height",St(hi)),ai.setAttributeNS(null,"fill",oi),ai.setAttributeNS(null,"mask",`url(#${Ke.maskId})`),this.defs.append(ti),this._ensureTransformGroup().append(ai),this.paintInlineImageXObject(We,ti)}paintFormXObjectBegin(je,We){if(Array.isArray(je)&&je.length===6&&this.transform(je[0],je[1],je[2],je[3],je[4],je[5]),We){const Ke=We[2]-We[0],Je=We[3]-We[1],hi=this.svgFactory.createElement("svg:rect");hi.setAttributeNS(null,"x",We[0]),hi.setAttributeNS(null,"y",We[1]),hi.setAttributeNS(null,"width",St(Ke)),hi.setAttributeNS(null,"height",St(Je)),this.current.element=hi,this.clip("nonzero"),this.endPath()}}paintFormXObjectEnd(){}_initialize(je){const We=this.svgFactory.create(je.width,je.height),Ke=this.svgFactory.createElement("svg:defs");We.append(Ke),this.defs=Ke;const Je=this.svgFactory.createElement("svg:g");return Je.setAttributeNS(null,"transform",Ce(je.transform)),We.append(Je),this.svg=Je,We}_ensureClipGroup(){if(!this.current.clipGroup){const je=this.svgFactory.createElement("svg:g");je.setAttributeNS(null,"clip-path",this.current.activeClipUrl),this.svg.append(je),this.current.clipGroup=je}return this.current.clipGroup}_ensureTransformGroup(){return this.tgrp||(this.tgrp=this.svgFactory.createElement("svg:g"),this.tgrp.setAttributeNS(null,"transform",Ce(this.transformMatrix)),this.current.activeClipUrl?this._ensureClipGroup().append(this.tgrp):this.svg.append(this.tgrp)),this.tgrp}}}},(Ie,r,Me)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.PDFNodeStream=void 0;var Oe=Me(1),Be=Me(32);const Ue=require$$5,He=require$$5,Ee=require$$5,e=require$$5,xe=/^file:\/\/\/[a-zA-Z]:\//;function Te(De){const Re=e.parse(De);return Re.protocol==="file:"||Re.host?Re:/^[a-z]:[/\\]/i.test(De)?e.parse(`file:///${De}`):(Re.host||(Re.protocol="file:"),Re)}class _e{constructor(Re){this.source=Re,this.url=Te(Re.url),this.isHttp=this.url.protocol==="http:"||this.url.protocol==="https:",this.isFsUrl=this.url.protocol==="file:",this.httpHeaders=this.isHttp&&Re.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var Re,je;return(je=(Re=this._fullRequestReader)==null?void 0:Re._loaded)!=null?je:0}getFullReader(){return(0,Oe.assert)(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=this.isFsUrl?new Ce(this):new Pe(this),this._fullRequestReader}getRangeReader(Re,je){if(je<=this._progressiveDataLength)return null;const We=this.isFsUrl?new ke(this,Re,je):new St(this,Re,je);return this._rangeRequestReaders.push(We),We}cancelAllRequests(Re){var je;(je=this._fullRequestReader)==null||je.cancel(Re);for(const We of this._rangeRequestReaders.slice(0))We.cancel(Re)}}r.PDFNodeStream=_e;class Se{constructor(Re){this._url=Re.url,this._done=!1,this._storedError=null,this.onProgress=null;const je=Re.source;this._contentLength=je.length,this._loaded=0,this._filename=null,this._disableRange=je.disableRange||!1,this._rangeChunkSize=je.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!je.disableStream,this._isRangeSupported=!je.disableRange,this._readableStream=null,this._readCapability=(0,Oe.createPromiseCapability)(),this._headersCapability=(0,Oe.createPromiseCapability)()}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var We;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const Re=this._readableStream.read();return Re===null?(this._readCapability=(0,Oe.createPromiseCapability)(),this.read()):(this._loaded+=Re.length,(We=this.onProgress)==null||We.call(this,{loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(Re).buffer,done:!1})}cancel(Re){if(!this._readableStream){this._error(Re);return}this._readableStream.destroy(Re)}_error(Re){this._storedError=Re,this._readCapability.resolve()}_setReadableStream(Re){this._readableStream=Re,Re.on("readable",()=>{this._readCapability.resolve()}),Re.on("end",()=>{Re.destroy(),this._done=!0,this._readCapability.resolve()}),Re.on("error",je=>{this._error(je)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new Oe.AbortException("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class t{constructor(Re){this._url=Re.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=(0,Oe.createPromiseCapability)();const je=Re.source;this._isStreamingSupported=!je.disableStream}get isStreamingSupported(){return this._isStreamingSupported}async read(){var We;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const Re=this._readableStream.read();return Re===null?(this._readCapability=(0,Oe.createPromiseCapability)(),this.read()):(this._loaded+=Re.length,(We=this.onProgress)==null||We.call(this,{loaded:this._loaded}),{value:new Uint8Array(Re).buffer,done:!1})}cancel(Re){if(!this._readableStream){this._error(Re);return}this._readableStream.destroy(Re)}_error(Re){this._storedError=Re,this._readCapability.resolve()}_setReadableStream(Re){this._readableStream=Re,Re.on("readable",()=>{this._readCapability.resolve()}),Re.on("end",()=>{Re.destroy(),this._done=!0,this._readCapability.resolve()}),Re.on("error",je=>{this._error(je)}),this._storedError&&this._readableStream.destroy(this._storedError)}}function Ae(De,Re){return{protocol:De.protocol,auth:De.auth,host:De.hostname,port:De.port,path:De.path,method:"GET",headers:Re}}class Pe extends Se{constructor(Re){super(Re);const je=We=>{if(We.statusCode===404){const oi=new Oe.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=oi,this._headersCapability.reject(oi);return}this._headersCapability.resolve(),this._setReadableStream(We);const Ke=oi=>this._readableStream.headers[oi.toLowerCase()],{allowRangeRequests:Je,suggestedLength:hi}=(0,Be.validateRangeRequestCapabilities)({getResponseHeader:Ke,isHttp:Re.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=Je,this._contentLength=hi||this._contentLength,this._filename=(0,Be.extractFilenameFromHeader)(Ke)};this._request=null,this._url.protocol==="http:"?this._request=He.request(Ae(this._url,Re.httpHeaders),je):this._request=Ee.request(Ae(this._url,Re.httpHeaders),je),this._request.on("error",We=>{this._storedError=We,this._headersCapability.reject(We)}),this._request.end()}}class St extends t{constructor(Re,je,We){super(Re),this._httpHeaders={};for(const Je in Re.httpHeaders){const hi=Re.httpHeaders[Je];typeof hi>"u"||(this._httpHeaders[Je]=hi)}this._httpHeaders.Range=`bytes=${je}-${We-1}`;const Ke=Je=>{if(Je.statusCode===404){const hi=new Oe.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=hi;return}this._setReadableStream(Je)};this._request=null,this._url.protocol==="http:"?this._request=He.request(Ae(this._url,this._httpHeaders),Ke):this._request=Ee.request(Ae(this._url,this._httpHeaders),Ke),this._request.on("error",Je=>{this._storedError=Je}),this._request.end()}}class Ce extends Se{constructor(Re){super(Re);let je=decodeURIComponent(this._url.path);xe.test(this._url.href)&&(je=je.replace(/^\//,"")),Ue.lstat(je,(We,Ke)=>{if(We){We.code==="ENOENT"&&(We=new Oe.MissingPDFException(`Missing PDF "${je}".`)),this._storedError=We,this._headersCapability.reject(We);return}this._contentLength=Ke.size,this._setReadableStream(Ue.createReadStream(je)),this._headersCapability.resolve()})}}class ke extends t{constructor(Re,je,We){super(Re);let Ke=decodeURIComponent(this._url.path);xe.test(this._url.href)&&(Ke=Ke.replace(/^\//,"")),this._setReadableStream(Ue.createReadStream(Ke,{start:je,end:We-1}))}}},(Ie,r,Me)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.createResponseStatusError=e,r.extractFilenameFromHeader=Ee,r.validateRangeRequestCapabilities=He,r.validateResponseStatus=xe;var Oe=Me(1),Be=Me(33),Ue=Me(6);function He({getResponseHeader:Te,isHttp:_e,rangeChunkSize:Se,disableRange:t}){const Ae={allowRangeRequests:!1,suggestedLength:void 0},Pe=parseInt(Te("Content-Length"),10);return!Number.isInteger(Pe)||(Ae.suggestedLength=Pe,Pe<=2*Se)||t||!_e||Te("Accept-Ranges")!=="bytes"||(Te("Content-Encoding")||"identity")!=="identity"||(Ae.allowRangeRequests=!0),Ae}function Ee(Te){const _e=Te("Content-Disposition");if(_e){let Se=(0,Be.getFilenameFromContentDispositionHeader)(_e);if(Se.includes("%"))try{Se=decodeURIComponent(Se)}catch{}if((0,Ue.isPdfFile)(Se))return Se}return null}function e(Te,_e){return Te===404||Te===0&&_e.startsWith("file:")?new Oe.MissingPDFException('Missing PDF "'+_e+'".'):new Oe.UnexpectedResponseException(`Unexpected server response (${Te}) while retrieving PDF "${_e}".`,Te)}function xe(Te){return Te===200||Te===206}},(Ie,r,Me)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.getFilenameFromContentDispositionHeader=Be;var Oe=Me(1);function Be(Ue){let He=!0,Ee=e("filename\\*","i").exec(Ue);if(Ee){Ee=Ee[1];let Pe=Se(Ee);return Pe=unescape(Pe),Pe=t(Pe),Pe=Ae(Pe),Te(Pe)}if(Ee=_e(Ue),Ee){const Pe=Ae(Ee);return Te(Pe)}if(Ee=e("filename","i").exec(Ue),Ee){Ee=Ee[1];let Pe=Se(Ee);return Pe=Ae(Pe),Te(Pe)}function e(Pe,St){return new RegExp("(?:^|;)\\s*"+Pe+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',St)}function xe(Pe,St){if(Pe){if(!/^[\x00-\xFF]+$/.test(St))return St;try{const Ce=new TextDecoder(Pe,{fatal:!0}),ke=(0,Oe.stringToBytes)(St);St=Ce.decode(ke),He=!1}catch{}}return St}function Te(Pe){return He&&/[\x80-\xff]/.test(Pe)&&(Pe=xe("utf-8",Pe),He&&(Pe=xe("iso-8859-1",Pe))),Pe}function _e(Pe){const St=[];let Ce;const ke=e("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(Ce=ke.exec(Pe))!==null;){let[,Re,je,We]=Ce;if(Re=parseInt(Re,10),Re in St){if(Re===0)break;continue}St[Re]=[je,We]}const De=[];for(let Re=0;Re<St.length&&Re in St;++Re){let[je,We]=St[Re];We=Se(We),je&&(We=unescape(We),Re===0&&(We=t(We))),De.push(We)}return De.join("")}function Se(Pe){if(Pe.startsWith('"')){const St=Pe.slice(1).split('\\"');for(let Ce=0;Ce<St.length;++Ce){const ke=St[Ce].indexOf('"');ke!==-1&&(St[Ce]=St[Ce].slice(0,ke),St.length=Ce+1),St[Ce]=St[Ce].replace(/\\(.)/g,"$1")}Pe=St.join('"')}return Pe}function t(Pe){const St=Pe.indexOf("'");if(St===-1)return Pe;const Ce=Pe.slice(0,St),De=Pe.slice(St+1).replace(/^[^']*'/,"");return xe(Ce,De)}function Ae(Pe){return!Pe.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(Pe)?Pe:Pe.replace(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(St,Ce,ke,De){if(ke==="q"||ke==="Q")return De=De.replace(/_/g," "),De=De.replace(/=([0-9a-fA-F]{2})/g,function(Re,je){return String.fromCharCode(parseInt(je,16))}),xe(Ce,De);try{De=atob(De)}catch{}return xe(Ce,De)})}return""}},(Ie,r,Me)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.PDFNetworkStream=void 0;var Oe=Me(1),Be=Me(32);const Ue=200,He=206;function Ee(Se){const t=Se.response;return typeof t!="string"?t:(0,Oe.stringToBytes)(t).buffer}class e{constructor(t,Ae={}){this.url=t,this.isHttp=/^https?:/i.test(t),this.httpHeaders=this.isHttp&&Ae.httpHeaders||Object.create(null),this.withCredentials=Ae.withCredentials||!1,this.getXhr=Ae.getXhr||function(){return new XMLHttpRequest},this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(t,Ae,Pe){const St={begin:t,end:Ae};for(const Ce in Pe)St[Ce]=Pe[Ce];return this.request(St)}requestFull(t){return this.request(t)}request(t){const Ae=this.getXhr(),Pe=this.currXhrId++,St=this.pendingRequests[Pe]={xhr:Ae};Ae.open("GET",this.url),Ae.withCredentials=this.withCredentials;for(const Ce in this.httpHeaders){const ke=this.httpHeaders[Ce];typeof ke>"u"||Ae.setRequestHeader(Ce,ke)}return this.isHttp&&"begin"in t&&"end"in t?(Ae.setRequestHeader("Range",`bytes=${t.begin}-${t.end-1}`),St.expectedStatus=He):St.expectedStatus=Ue,Ae.responseType="arraybuffer",t.onError&&(Ae.onerror=function(Ce){t.onError(Ae.status)}),Ae.onreadystatechange=this.onStateChange.bind(this,Pe),Ae.onprogress=this.onProgress.bind(this,Pe),St.onHeadersReceived=t.onHeadersReceived,St.onDone=t.onDone,St.onError=t.onError,St.onProgress=t.onProgress,Ae.send(null),Pe}onProgress(t,Ae){var St;const Pe=this.pendingRequests[t];!Pe||(St=Pe.onProgress)==null||St.call(Pe,Ae)}onStateChange(t,Ae){var Re,je,We;const Pe=this.pendingRequests[t];if(!Pe)return;const St=Pe.xhr;if(St.readyState>=2&&Pe.onHeadersReceived&&(Pe.onHeadersReceived(),delete Pe.onHeadersReceived),St.readyState!==4||!(t in this.pendingRequests))return;if(delete this.pendingRequests[t],St.status===0&&this.isHttp){(Re=Pe.onError)==null||Re.call(Pe,St.status);return}const Ce=St.status||Ue;if(!(Ce===Ue&&Pe.expectedStatus===He)&&Ce!==Pe.expectedStatus){(je=Pe.onError)==null||je.call(Pe,St.status);return}const De=Ee(St);if(Ce===He){const Ke=St.getResponseHeader("Content-Range"),Je=/bytes (\d+)-(\d+)\/(\d+)/.exec(Ke);Pe.onDone({begin:parseInt(Je[1],10),chunk:De})}else De?Pe.onDone({begin:0,chunk:De}):(We=Pe.onError)==null||We.call(Pe,St.status)}getRequestXhr(t){return this.pendingRequests[t].xhr}isPendingRequest(t){return t in this.pendingRequests}abortRequest(t){const Ae=this.pendingRequests[t].xhr;delete this.pendingRequests[t],Ae.abort()}}class xe{constructor(t){this._source=t,this._manager=new e(t.url,{httpHeaders:t.httpHeaders,withCredentials:t.withCredentials}),this._rangeChunkSize=t.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(t){const Ae=this._rangeRequestReaders.indexOf(t);Ae>=0&&this._rangeRequestReaders.splice(Ae,1)}getFullReader(){return(0,Oe.assert)(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new Te(this._manager,this._source),this._fullRequestReader}getRangeReader(t,Ae){const Pe=new _e(this._manager,t,Ae);return Pe.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(Pe),Pe}cancelAllRequests(t){var Ae;(Ae=this._fullRequestReader)==null||Ae.cancel(t);for(const Pe of this._rangeRequestReaders.slice(0))Pe.cancel(t)}}r.PDFNetworkStream=xe;class Te{constructor(t,Ae){this._manager=t;const Pe={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=Ae.url,this._fullRequestId=t.requestFull(Pe),this._headersReceivedCapability=(0,Oe.createPromiseCapability)(),this._disableRange=Ae.disableRange||!1,this._contentLength=Ae.length,this._rangeChunkSize=Ae.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const t=this._fullRequestId,Ae=this._manager.getRequestXhr(t),Pe=ke=>Ae.getResponseHeader(ke),{allowRangeRequests:St,suggestedLength:Ce}=(0,Be.validateRangeRequestCapabilities)({getResponseHeader:Pe,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});St&&(this._isRangeSupported=!0),this._contentLength=Ce||this._contentLength,this._filename=(0,Be.extractFilenameFromHeader)(Pe),this._isRangeSupported&&this._manager.abortRequest(t),this._headersReceivedCapability.resolve()}_onDone(t){if(t&&(this._requests.length>0?this._requests.shift().resolve({value:t.chunk,done:!1}):this._cachedChunks.push(t.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const Ae of this._requests)Ae.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(t){this._storedError=(0,Be.createResponseStatusError)(t,this._url),this._headersReceivedCapability.reject(this._storedError);for(const Ae of this._requests)Ae.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(t){var Ae;(Ae=this.onProgress)==null||Ae.call(this,{loaded:t.loaded,total:t.lengthComputable?t.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersReceivedCapability.promise}async read(){if(this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const t=(0,Oe.createPromiseCapability)();return this._requests.push(t),t.promise}cancel(t){this._done=!0,this._headersReceivedCapability.reject(t);for(const Ae of this._requests)Ae.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class _e{constructor(t,Ae,Pe){this._manager=t;const St={onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=t.url,this._requestId=t.requestRange(Ae,Pe,St),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_close(){var t;(t=this.onClosed)==null||t.call(this,this)}_onDone(t){const Ae=t.chunk;this._requests.length>0?this._requests.shift().resolve({value:Ae,done:!1}):this._queuedChunk=Ae,this._done=!0;for(const Pe of this._requests)Pe.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(t){this._storedError=(0,Be.createResponseStatusError)(t,this._url);for(const Ae of this._requests)Ae.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(t){var Ae;this.isStreamingSupported||(Ae=this.onProgress)==null||Ae.call(this,{loaded:t.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const Ae=this._queuedChunk;return this._queuedChunk=null,{value:Ae,done:!1}}if(this._done)return{value:void 0,done:!0};const t=(0,Oe.createPromiseCapability)();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const Ae of this._requests)Ae.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}},(Ie,r,Me)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.PDFFetchStream=void 0;var Oe=Me(1),Be=Me(32);function Ue(Te,_e,Se){return{method:"GET",headers:Te,signal:Se.signal,mode:"cors",credentials:_e?"include":"same-origin",redirect:"follow"}}function He(Te){const _e=new Headers;for(const Se in Te){const t=Te[Se];typeof t>"u"||_e.append(Se,t)}return _e}class Ee{constructor(_e){this.source=_e,this.isHttp=/^https?:/i.test(_e.url),this.httpHeaders=this.isHttp&&_e.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var _e,Se;return(Se=(_e=this._fullRequestReader)==null?void 0:_e._loaded)!=null?Se:0}getFullReader(){return(0,Oe.assert)(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new e(this),this._fullRequestReader}getRangeReader(_e,Se){if(Se<=this._progressiveDataLength)return null;const t=new xe(this,_e,Se);return this._rangeRequestReaders.push(t),t}cancelAllRequests(_e){var Se;(Se=this._fullRequestReader)==null||Se.cancel(_e);for(const t of this._rangeRequestReaders.slice(0))t.cancel(_e)}}r.PDFFetchStream=Ee;class e{constructor(_e){this._stream=_e,this._reader=null,this._loaded=0,this._filename=null;const Se=_e.source;this._withCredentials=Se.withCredentials||!1,this._contentLength=Se.length,this._headersCapability=(0,Oe.createPromiseCapability)(),this._disableRange=Se.disableRange||!1,this._rangeChunkSize=Se.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!Se.disableStream,this._isRangeSupported=!Se.disableRange,this._headers=He(this._stream.httpHeaders);const t=Se.url;fetch(t,Ue(this._headers,this._withCredentials,this._abortController)).then(Ae=>{if(!(0,Be.validateResponseStatus)(Ae.status))throw(0,Be.createResponseStatusError)(Ae.status,t);this._reader=Ae.body.getReader(),this._headersCapability.resolve();const Pe=ke=>Ae.headers.get(ke),{allowRangeRequests:St,suggestedLength:Ce}=(0,Be.validateRangeRequestCapabilities)({getResponseHeader:Pe,isHttp:this._stream.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=St,this._contentLength=Ce||this._contentLength,this._filename=(0,Be.extractFilenameFromHeader)(Pe),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new Oe.AbortException("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var Ae;await this._headersCapability.promise;const{value:_e,done:Se}=await this._reader.read();return Se?{value:_e,done:Se}:(this._loaded+=_e.byteLength,(Ae=this.onProgress)==null||Ae.call(this,{loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(_e).buffer,done:!1})}cancel(_e){var Se;(Se=this._reader)==null||Se.cancel(_e),this._abortController.abort()}}class xe{constructor(_e,Se,t){this._stream=_e,this._reader=null,this._loaded=0;const Ae=_e.source;this._withCredentials=Ae.withCredentials||!1,this._readCapability=(0,Oe.createPromiseCapability)(),this._isStreamingSupported=!Ae.disableStream,this._abortController=new AbortController,this._headers=He(this._stream.httpHeaders),this._headers.append("Range",`bytes=${Se}-${t-1}`);const Pe=Ae.url;fetch(Pe,Ue(this._headers,this._withCredentials,this._abortController)).then(St=>{if(!(0,Be.validateResponseStatus)(St.status))throw(0,Be.createResponseStatusError)(St.status,Pe);this._readCapability.resolve(),this._reader=St.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){var Ae;await this._readCapability.promise;const{value:_e,done:Se}=await this._reader.read();return Se?{value:_e,done:Se}:(this._loaded+=_e.byteLength,(Ae=this.onProgress)==null||Ae.call(this,{loaded:this._loaded}),{value:new Uint8Array(_e).buffer,done:!1})}cancel(_e){var Se;(Se=this._reader)==null||Se.cancel(_e),this._abortController.abort()}}}],__webpack_module_cache__={};function __w_pdfjs_require__(Ie){var r=__webpack_module_cache__[Ie];if(r!==void 0)return r.exports;var Me=__webpack_module_cache__[Ie]={exports:{}};return __webpack_modules__[Ie](Me,Me.exports,__w_pdfjs_require__),Me.exports}var __webpack_exports__={};return(()=>{var Ie=__webpack_exports__;Object.defineProperty(Ie,"__esModule",{value:!0}),Object.defineProperty(Ie,"AnnotationEditorLayer",{enumerable:!0,get:function(){return Be.AnnotationEditorLayer}}),Object.defineProperty(Ie,"AnnotationEditorParamsType",{enumerable:!0,get:function(){return r.AnnotationEditorParamsType}}),Object.defineProperty(Ie,"AnnotationEditorType",{enumerable:!0,get:function(){return r.AnnotationEditorType}}),Object.defineProperty(Ie,"AnnotationEditorUIManager",{enumerable:!0,get:function(){return Ue.AnnotationEditorUIManager}}),Object.defineProperty(Ie,"AnnotationLayer",{enumerable:!0,get:function(){return He.AnnotationLayer}}),Object.defineProperty(Ie,"AnnotationMode",{enumerable:!0,get:function(){return r.AnnotationMode}}),Object.defineProperty(Ie,"CMapCompressionType",{enumerable:!0,get:function(){return r.CMapCompressionType}}),Object.defineProperty(Ie,"GlobalWorkerOptions",{enumerable:!0,get:function(){return Ee.GlobalWorkerOptions}}),Object.defineProperty(Ie,"InvalidPDFException",{enumerable:!0,get:function(){return r.InvalidPDFException}}),Object.defineProperty(Ie,"MissingPDFException",{enumerable:!0,get:function(){return r.MissingPDFException}}),Object.defineProperty(Ie,"OPS",{enumerable:!0,get:function(){return r.OPS}}),Object.defineProperty(Ie,"PDFDataRangeTransport",{enumerable:!0,get:function(){return Me.PDFDataRangeTransport}}),Object.defineProperty(Ie,"PDFDateString",{enumerable:!0,get:function(){return Oe.PDFDateString}}),Object.defineProperty(Ie,"PDFWorker",{enumerable:!0,get:function(){return Me.PDFWorker}}),Object.defineProperty(Ie,"PasswordResponses",{enumerable:!0,get:function(){return r.PasswordResponses}}),Object.defineProperty(Ie,"PermissionFlag",{enumerable:!0,get:function(){return r.PermissionFlag}}),Object.defineProperty(Ie,"PixelsPerInch",{enumerable:!0,get:function(){return Oe.PixelsPerInch}}),Object.defineProperty(Ie,"RenderingCancelledException",{enumerable:!0,get:function(){return Oe.RenderingCancelledException}}),Object.defineProperty(Ie,"SVGGraphics",{enumerable:!0,get:function(){return Te.SVGGraphics}}),Object.defineProperty(Ie,"UNSUPPORTED_FEATURES",{enumerable:!0,get:function(){return r.UNSUPPORTED_FEATURES}}),Object.defineProperty(Ie,"UnexpectedResponseException",{enumerable:!0,get:function(){return r.UnexpectedResponseException}}),Object.defineProperty(Ie,"Util",{enumerable:!0,get:function(){return r.Util}}),Object.defineProperty(Ie,"VerbosityLevel",{enumerable:!0,get:function(){return r.VerbosityLevel}}),Object.defineProperty(Ie,"XfaLayer",{enumerable:!0,get:function(){return _e.XfaLayer}}),Object.defineProperty(Ie,"build",{enumerable:!0,get:function(){return Me.build}}),Object.defineProperty(Ie,"createPromiseCapability",{enumerable:!0,get:function(){return r.createPromiseCapability}}),Object.defineProperty(Ie,"createValidAbsoluteUrl",{enumerable:!0,get:function(){return r.createValidAbsoluteUrl}}),Object.defineProperty(Ie,"getDocument",{enumerable:!0,get:function(){return Me.getDocument}}),Object.defineProperty(Ie,"getFilenameFromUrl",{enumerable:!0,get:function(){return Oe.getFilenameFromUrl}}),Object.defineProperty(Ie,"getPdfFilenameFromUrl",{enumerable:!0,get:function(){return Oe.getPdfFilenameFromUrl}}),Object.defineProperty(Ie,"getXfaPageViewport",{enumerable:!0,get:function(){return Oe.getXfaPageViewport}}),Object.defineProperty(Ie,"isPdfFile",{enumerable:!0,get:function(){return Oe.isPdfFile}}),Object.defineProperty(Ie,"loadScript",{enumerable:!0,get:function(){return Oe.loadScript}}),Object.defineProperty(Ie,"renderTextLayer",{enumerable:!0,get:function(){return xe.renderTextLayer}}),Object.defineProperty(Ie,"shadow",{enumerable:!0,get:function(){return r.shadow}}),Object.defineProperty(Ie,"version",{enumerable:!0,get:function(){return Me.version}});var r=__w_pdfjs_require__(1),Me=__w_pdfjs_require__(2),Oe=__w_pdfjs_require__(6),Be=__w_pdfjs_require__(21),Ue=__w_pdfjs_require__(5),He=__w_pdfjs_require__(26),Ee=__w_pdfjs_require__(14),e=__w_pdfjs_require__(12),xe=__w_pdfjs_require__(29),Te=__w_pdfjs_require__(30),_e=__w_pdfjs_require__(28);if(e.isNodeJS){const{PDFNodeStream:Se}=__w_pdfjs_require__(31);(0,Me.setPDFNetworkStreamFactory)(t=>new Se(t))}else{const{PDFNetworkStream:Se}=__w_pdfjs_require__(34),{PDFFetchStream:t}=__w_pdfjs_require__(35);(0,Me.setPDFNetworkStreamFactory)(Ae=>(0,Oe.isValidFetchUrl)(Ae.url)?new t(Ae):new Se(Ae))}})(),__webpack_exports__})())})(pdf);function _typeof(Ie){return _typeof=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},_typeof(Ie)}var u8=Uint8Array,u16=Uint16Array,u32=Uint32Array,fleb=new u8([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),fdeb=new u8([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),clim=new u8([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),freb=function(Ie,r){for(var Me=new u16(31),Oe=0;Oe<31;++Oe)Me[Oe]=r+=1<<Ie[Oe-1];for(var Be=new u32(Me[30]),Oe=1;Oe<30;++Oe)for(var Ue=Me[Oe];Ue<Me[Oe+1];++Ue)Be[Ue]=Ue-Me[Oe]<<5|Oe;return[Me,Be]},_a=freb(fleb,2),fl=_a[0],revfl=_a[1];fl[28]=258,revfl[258]=28;var _b=freb(fdeb,0),fd=_b[0],revfd=_b[1],rev=new u16(32768);for(var i$1=0;i$1<32768;++i$1){var x$1=(i$1&43690)>>>1|(i$1&21845)<<1;x$1=(x$1&52428)>>>2|(x$1&13107)<<2,x$1=(x$1&61680)>>>4|(x$1&3855)<<4,rev[i$1]=((x$1&65280)>>>8|(x$1&255)<<8)>>>1}var hMap=function(Ie,r,Me){for(var Oe=Ie.length,Be=0,Ue=new u16(r);Be<Oe;++Be)++Ue[Ie[Be]-1];var He=new u16(r);for(Be=0;Be<r;++Be)He[Be]=He[Be-1]+Ue[Be-1]<<1;var Ee;if(Me){Ee=new u16(1<<r);var e=15-r;for(Be=0;Be<Oe;++Be)if(Ie[Be])for(var xe=Be<<4|Ie[Be],Te=r-Ie[Be],_e=He[Ie[Be]-1]++<<Te,Se=_e|(1<<Te)-1;_e<=Se;++_e)Ee[rev[_e]>>>e]=xe}else for(Ee=new u16(Oe),Be=0;Be<Oe;++Be)Ee[Be]=rev[He[Ie[Be]-1]++]>>>15-Ie[Be];return Ee},flt=new u8(288);for(var i$1=0;i$1<144;++i$1)flt[i$1]=8;for(var i$1=144;i$1<256;++i$1)flt[i$1]=9;for(var i$1=256;i$1<280;++i$1)flt[i$1]=7;for(var i$1=280;i$1<288;++i$1)flt[i$1]=8;var fdt=new u8(32);for(var i$1=0;i$1<32;++i$1)fdt[i$1]=5;var flm=hMap(flt,9,0),flrm=hMap(flt,9,1),fdm=hMap(fdt,5,0),fdrm=hMap(fdt,5,1),max=function(Ie){for(var r=Ie[0],Me=1;Me<Ie.length;++Me)Ie[Me]>r&&(r=Ie[Me]);return r},bits=function(Ie,r,Me){var Oe=r/8>>0;return(Ie[Oe]|Ie[Oe+1]<<8)>>>(r&7)&Me},bits16=function(Ie,r){var Me=r/8>>0;return(Ie[Me]|Ie[Me+1]<<8|Ie[Me+2]<<16)>>>(r&7)},shft=function(Ie){return(Ie/8>>0)+(Ie&7&&1)},slc=function(Ie,r,Me){(r==null||r<0)&&(r=0),(Me==null||Me>Ie.length)&&(Me=Ie.length);var Oe=new(Ie instanceof u16?u16:Ie instanceof u32?u32:u8)(Me-r);return Oe.set(Ie.subarray(r,Me)),Oe},inflt=function(Ie,r,Me){var Oe=Ie.length,Be=!r||Me,Ue=!Me||Me.i;Me||(Me={}),r||(r=new u8(Oe*3));var He=function(ei){var si=r.length;if(ei>si){var li=new u8(Math.max(si*2,ei));li.set(r),r=li}},Ee=Me.f||0,e=Me.p||0,xe=Me.b||0,Te=Me.l,_e=Me.d,Se=Me.m,t=Me.n,Ae=Oe*8;do{if(!Te){Me.f=Ee=bits(Ie,e,1);var Pe=bits(Ie,e+1,3);if(e+=3,Pe)if(Pe==1)Te=flrm,_e=fdrm,Se=9,t=5;else if(Pe==2){var De=bits(Ie,e,31)+257,Re=bits(Ie,e+10,15)+4,je=De+bits(Ie,e+5,31)+1;e+=14;for(var We=new u8(je),Ke=new u8(19),Je=0;Je<Re;++Je)Ke[clim[Je]]=bits(Ie,e+Je*3,7);e+=Re*3;var hi=max(Ke),oi=(1<<hi)-1;if(!Ue&&e+je*(hi+7)>Ae)break;for(var ti=hMap(Ke,hi,1),Je=0;Je<je;){var ai=ti[bits(Ie,e,oi)];e+=ai&15;var St=ai>>>4;if(St<16)We[Je++]=St;else{var yi=0,di=0;for(St==16?(di=3+bits(Ie,e,3),e+=2,yi=We[Je-1]):St==17?(di=3+bits(Ie,e,7),e+=3):St==18&&(di=11+bits(Ie,e,127),e+=7);di--;)We[Je++]=yi}}var bi=We.subarray(0,De),vi=We.subarray(De);Se=max(bi),t=max(vi),Te=hMap(bi,Se,1),_e=hMap(vi,t,1)}else throw"invalid block type";else{var St=shft(e)+4,Ce=Ie[St-4]|Ie[St-3]<<8,ke=St+Ce;if(ke>Oe){if(Ue)throw"unexpected EOF";break}Be&&He(xe+Ce),r.set(Ie.subarray(St,ke),xe),Me.b=xe+=Ce,Me.p=e=ke*8;continue}if(e>Ae)throw"unexpected EOF"}Be&&He(xe+131072);for(var Pi=(1<<Se)-1,xi=(1<<t)-1,ni=Se+t+18;Ue||e+ni<Ae;){var yi=Te[bits16(Ie,e)&Pi],fi=yi>>>4;if(e+=yi&15,e>Ae)throw"unexpected EOF";if(!yi)throw"invalid length/literal";if(fi<256)r[xe++]=fi;else if(fi==256){Te=null;break}else{var Si=fi-254;if(fi>264){var Je=fi-257,Xe=fleb[Je];Si=bits(Ie,e,(1<<Xe)-1)+fl[Je],e+=Xe}var Ge=_e[bits16(Ie,e)&xi],ze=Ge>>>4;if(!Ge)throw"invalid distance";e+=Ge&15;var vi=fd[ze];if(ze>3){var Xe=fdeb[ze];vi+=bits16(Ie,e)&(1<<Xe)-1,e+=Xe}if(e>Ae)throw"unexpected EOF";Be&&He(xe+131072);for(var Ve=xe+Si;xe<Ve;xe+=4)r[xe]=r[xe-vi],r[xe+1]=r[xe+1-vi],r[xe+2]=r[xe+2-vi],r[xe+3]=r[xe+3-vi];xe=Ve}}Me.l=Te,Me.p=e,Me.b=xe,Te&&(Ee=1,Me.m=Se,Me.d=_e,Me.n=t)}while(!Ee);return xe==r.length?r:slc(r,0,xe)},wbits=function(Ie,r,Me){Me<<=r&7;var Oe=r/8>>0;Ie[Oe]|=Me,Ie[Oe+1]|=Me>>>8},wbits16=function(Ie,r,Me){Me<<=r&7;var Oe=r/8>>0;Ie[Oe]|=Me,Ie[Oe+1]|=Me>>>8,Ie[Oe+2]|=Me>>>16},hTree=function(Ie,r){for(var Me=[],Oe=0;Oe<Ie.length;++Oe)Ie[Oe]&&Me.push({s:Oe,f:Ie[Oe]});var Be=Me.length,Ue=Me.slice();if(!Be)return[new u8(0),0];if(Be==1){var He=new u8(Me[0].s+1);return He[Me[0].s]=1,[He,1]}Me.sort(function(je,We){return je.f-We.f}),Me.push({s:-1,f:25001});var Ee=Me[0],e=Me[1],xe=0,Te=1,_e=2;for(Me[0]={s:-1,f:Ee.f+e.f,l:Ee,r:e};Te!=Be-1;)Ee=Me[Me[xe].f<Me[_e].f?xe++:_e++],e=Me[xe!=Te&&Me[xe].f<Me[_e].f?xe++:_e++],Me[Te++]={s:-1,f:Ee.f+e.f,l:Ee,r:e};for(var Se=Ue[0].s,Oe=1;Oe<Be;++Oe)Ue[Oe].s>Se&&(Se=Ue[Oe].s);var t=new u16(Se+1),Ae=ln(Me[Te-1],t,0);if(Ae>r){var Oe=0,Pe=0,St=Ae-r,Ce=1<<St;for(Ue.sort(function(We,Ke){return t[Ke.s]-t[We.s]||We.f-Ke.f});Oe<Be;++Oe){var ke=Ue[Oe].s;if(t[ke]>r)Pe+=Ce-(1<<Ae-t[ke]),t[ke]=r;else break}for(Pe>>>=St;Pe>0;){var De=Ue[Oe].s;t[De]<r?Pe-=1<<r-t[De]++-1:++Oe}for(;Oe>=0&&Pe;--Oe){var Re=Ue[Oe].s;t[Re]==r&&(--t[Re],++Pe)}Ae=r}return[new u8(t),Ae]},ln=function(Ie,r,Me){return Ie.s==-1?Math.max(ln(Ie.l,r,Me+1),ln(Ie.r,r,Me+1)):r[Ie.s]=Me},lc=function(Ie){for(var r=Ie.length;r&&!Ie[--r];);for(var Me=new u16(++r),Oe=0,Be=Ie[0],Ue=1,He=function(e){Me[Oe++]=e},Ee=1;Ee<=r;++Ee)if(Ie[Ee]==Be&&Ee!=r)++Ue;else{if(!Be&&Ue>2){for(;Ue>138;Ue-=138)He(32754);Ue>2&&(He(Ue>10?Ue-11<<5|28690:Ue-3<<5|12305),Ue=0)}else if(Ue>3){for(He(Be),--Ue;Ue>6;Ue-=6)He(8304);Ue>2&&(He(Ue-3<<5|8208),Ue=0)}for(;Ue--;)He(Be);Ue=1,Be=Ie[Ee]}return[Me.subarray(0,Oe),r]},clen=function(Ie,r){for(var Me=0,Oe=0;Oe<r.length;++Oe)Me+=Ie[Oe]*r[Oe];return Me},wfblk=function(Ie,r,Me){var Oe=Me.length,Be=shft(r+2);Ie[Be]=Oe&255,Ie[Be+1]=Oe>>>8,Ie[Be+2]=Ie[Be]^255,Ie[Be+3]=Ie[Be+1]^255;for(var Ue=0;Ue<Oe;++Ue)Ie[Be+Ue+4]=Me[Ue];return(Be+4+Oe)*8},wblk=function(Ie,r,Me,Oe,Be,Ue,He,Ee,e,xe,Te){wbits(r,Te++,Me),++Be[256];for(var _e=hTree(Be,15),Se=_e[0],t=_e[1],Ae=hTree(Ue,15),Pe=Ae[0],St=Ae[1],Ce=lc(Se),ke=Ce[0],De=Ce[1],Re=lc(Pe),je=Re[0],We=Re[1],Ke=new u16(19),Je=0;Je<ke.length;++Je)Ke[ke[Je]&31]++;for(var Je=0;Je<je.length;++Je)Ke[je[Je]&31]++;for(var hi=hTree(Ke,7),oi=hi[0],ti=hi[1],ai=19;ai>4&&!oi[clim[ai-1]];--ai);var yi=xe+5<<3,di=clen(Be,flt)+clen(Ue,fdt)+He,bi=clen(Be,Se)+clen(Ue,Pe)+He+14+3*ai+clen(Ke,oi)+(2*Ke[16]+3*Ke[17]+7*Ke[18]);if(yi<=di&&yi<=bi)return wfblk(r,Te,Ie.subarray(e,e+xe));var vi,Pi,xi,ni;if(wbits(r,Te,1+(bi<di)),Te+=2,bi<di){vi=hMap(Se,t,0),Pi=Se,xi=hMap(Pe,St,0),ni=Pe;var fi=hMap(oi,ti,0);wbits(r,Te,De-257),wbits(r,Te+5,We-1),wbits(r,Te+10,ai-4),Te+=14;for(var Je=0;Je<ai;++Je)wbits(r,Te+3*Je,oi[clim[Je]]);Te+=3*ai;for(var Si=[ke,je],Xe=0;Xe<2;++Xe)for(var Ge=Si[Xe],Je=0;Je<Ge.length;++Je){var ze=Ge[Je]&31;wbits(r,Te,fi[ze]),Te+=oi[ze],ze>15&&(wbits(r,Te,Ge[Je]>>>5&127),Te+=Ge[Je]>>>12)}}else vi=flm,Pi=flt,xi=fdm,ni=fdt;for(var Je=0;Je<Ee;++Je)if(Oe[Je]>255){var ze=Oe[Je]>>>18&31;wbits16(r,Te,vi[ze+257]),Te+=Pi[ze+257],ze>7&&(wbits(r,Te,Oe[Je]>>>23&31),Te+=fleb[ze]);var Ve=Oe[Je]&31;wbits16(r,Te,xi[Ve]),Te+=ni[Ve],Ve>3&&(wbits16(r,Te,Oe[Je]>>>5&8191),Te+=fdeb[Ve])}else wbits16(r,Te,vi[Oe[Je]]),Te+=Pi[Oe[Je]];return wbits16(r,Te,vi[256]),Te+Pi[256]},deo=new u32([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),et$1=new u8(0),dflt=function(Ie,r,Me,Oe,Be,Ue){var He=Ie.length,Ee=new u8(Oe+He+5*(1+Math.floor(He/7e3))+Be),e=Ee.subarray(Oe,Ee.length-Be),xe=0;if(!r||He<8)for(var Te=0;Te<=He;Te+=65535){var _e=Te+65535;_e<He?xe=wfblk(e,xe,Ie.subarray(Te,_e)):(e[Te]=Ue,xe=wfblk(e,xe,Ie.subarray(Te,He)))}else{for(var Se=deo[r-1],t=Se>>>13,Ae=Se&8191,Pe=(1<<Me)-1,St=new u16(32768),Ce=new u16(Pe+1),ke=Math.ceil(Me/3),De=2*ke,Re=function(Ze){return(Ie[Ze]^Ie[Ze+1]<<ke^Ie[Ze+2]<<De)&Pe},je=new u32(25e3),We=new u16(288),Ke=new u16(32),Je=0,hi=0,Te=0,oi=0,ti=0,ai=0;Te<He;++Te){var yi=Re(Te),di=Te&32767,bi=Ce[yi];if(St[di]=bi,Ce[yi]=di,ti<=Te){var vi=He-Te;if((Je>7e3||oi>24576)&&vi>423){xe=wblk(Ie,e,0,je,We,Ke,hi,oi,ai,Te-ai,xe),oi=Je=hi=0,ai=Te;for(var Pi=0;Pi<286;++Pi)We[Pi]=0;for(var Pi=0;Pi<30;++Pi)Ke[Pi]=0}var xi=2,ni=0,fi=Ae,Si=di-bi&32767;if(vi>2&&yi==Re(Te-Si))for(var Xe=Math.min(t,vi)-1,Ge=Math.min(32767,Te),ze=Math.min(258,vi);Si<=Ge&&--fi&&di!=bi;){if(Ie[Te+xi]==Ie[Te+xi-Si]){for(var Ve=0;Ve<ze&&Ie[Te+Ve]==Ie[Te+Ve-Si];++Ve);if(Ve>xi){if(xi=Ve,ni=Si,Ve>Xe)break;for(var ei=Math.min(Si,Ve-2),si=0,Pi=0;Pi<ei;++Pi){var li=Te-Si+Pi+32768&32767,ci=St[li],Ci=li-ci+32768&32767;Ci>si&&(si=Ci,bi=li)}}}di=bi,bi=St[di],Si+=di-bi+32768&32767}if(ni){je[oi++]=268435456|revfl[xi]<<18|revfd[ni];var Fi=revfl[xi]&31,Oi=revfd[ni]&31;hi+=fleb[Fi]+fdeb[Oi],++We[257+Fi],++Ke[Oi],ti=Te+xi,++Je}else je[oi++]=Ie[Te],++We[Ie[Te]]}}xe=wblk(Ie,e,Ue,je,We,Ke,hi,oi,ai,Te-ai,xe),Ue||(xe=wfblk(e,xe,et$1))}return slc(Ee,0,Oe+shft(xe)+Be)},adler=function(){var Ie=1,r=0;return{p:function(Me){for(var Oe=Ie,Be=r,Ue=Me.length,He=0;He!=Ue;){for(var Ee=Math.min(He+5552,Ue);He<Ee;++He)Oe+=Me[He],Be+=Oe;Oe%=65521,Be%=65521}Ie=Oe,r=Be},d:function(){return(Ie>>>8<<16|(r&255)<<8|r>>>8)+((Ie&255)<<23)*2}}},dopt=function(Ie,r,Me,Oe,Be){return dflt(Ie,r.level==null?6:r.level,r.mem==null?Math.ceil(Math.max(8,Math.min(13,Math.log(Ie.length)))*1.5):12+r.mem,Me,Oe,!Be)},wbytes=function(Ie,r,Me){for(;Me;++r)Ie[r]=Me,Me>>>=8},zlh=function(Ie,r){var Me=r.level,Oe=Me==0?0:Me<6?1:Me==9?3:2;Ie[0]=120,Ie[1]=Oe<<6|(Oe?32-2*Oe:1)},zlv=function(Ie){if((Ie[0]&15)!=8||Ie[0]>>>4>7||(Ie[0]<<8|Ie[1])%31)throw"invalid zlib data";if(Ie[1]&32)throw"invalid zlib data: preset dictionaries not supported"};function zlibSync(Ie,r){r===void 0&&(r={});var Me=adler();Me.p(Ie);var Oe=dopt(Ie,r,2,4);return zlh(Oe,r),wbytes(Oe,Oe.length-4,Me.d()),Oe}function unzlibSync(Ie,r){return inflt((zlv(Ie),Ie.subarray(2,-4)),r)}var n=function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this}();function i(){n.console&&typeof n.console.log=="function"&&n.console.log.apply(n.console,arguments)}var a={log:i,warn:function(Ie){n.console&&(typeof n.console.warn=="function"?n.console.warn.apply(n.console,arguments):i.call(null,arguments))},error:function(Ie){n.console&&(typeof n.console.error=="function"?n.console.error.apply(n.console,arguments):i(Ie))}};function o(Ie,r,Me){var Oe=new XMLHttpRequest;Oe.open("GET",Ie),Oe.responseType="blob",Oe.onload=function(){l(Oe.response,r,Me)},Oe.onerror=function(){a.error("could not download file")},Oe.send()}function s(Ie){var r=new XMLHttpRequest;r.open("HEAD",Ie,!1);try{r.send()}catch{}return r.status>=200&&r.status<=299}function c(Ie){try{Ie.dispatchEvent(new MouseEvent("click"))}catch{var r=document.createEvent("MouseEvents");r.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),Ie.dispatchEvent(r)}}var u,h,l=n.saveAs||((typeof window>"u"?"undefined":_typeof(window))!=="object"||window!==n?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(Ie,r,Me){var Oe=n.URL||n.webkitURL,Be=document.createElement("a");r=r||Ie.name||"download",Be.download=r,Be.rel="noopener",typeof Ie=="string"?(Be.href=Ie,Be.origin!==location.origin?s(Be.href)?o(Ie,r,Me):c(Be,Be.target="_blank"):c(Be)):(Be.href=Oe.createObjectURL(Ie),setTimeout(function(){Oe.revokeObjectURL(Be.href)},4e4),setTimeout(function(){c(Be)},0))}:"msSaveOrOpenBlob"in navigator?function(Ie,r,Me){if(r=r||Ie.name||"download",typeof Ie=="string")if(s(Ie))o(Ie,r,Me);else{var Oe=document.createElement("a");Oe.href=Ie,Oe.target="_blank",setTimeout(function(){c(Oe)})}else navigator.msSaveOrOpenBlob(function(Be,Ue){return Ue===void 0?Ue={autoBom:!1}:_typeof(Ue)!=="object"&&(a.warn("Deprecated: Expected third argument to be a object"),Ue={autoBom:!Ue}),Ue.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(Be.type)?new Blob([String.fromCharCode(65279),Be],{type:Be.type}):Be}(Ie,Me),r)}:function(Ie,r,Me,Oe){if((Oe=Oe||open("","_blank"))&&(Oe.document.title=Oe.document.body.innerText="downloading..."),typeof Ie=="string")return o(Ie,r,Me);var Be=Ie.type==="application/octet-stream",Ue=/constructor/i.test(n.HTMLElement)||n.safari,He=/CriOS\/[\d]+/.test(navigator.userAgent);if((He||Be&&Ue)&&(typeof FileReader>"u"?"undefined":_typeof(FileReader))==="object"){var Ee=new FileReader;Ee.onloadend=function(){var Te=Ee.result;Te=He?Te:Te.replace(/^data:[^;]*;/,"data:attachment/file;"),Oe?Oe.location.href=Te:location=Te,Oe=null},Ee.readAsDataURL(Ie)}else{var e=n.URL||n.webkitURL,xe=e.createObjectURL(Ie);Oe?Oe.location=xe:location.href=xe,Oe=null,setTimeout(function(){e.revokeObjectURL(xe)},4e4)}});/**
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
 * @license Use it if you like it
 */function f(Ie){var r;Ie=Ie||"",this.ok=!1,Ie.charAt(0)=="#"&&(Ie=Ie.substr(1,6)),Ie={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[Ie=(Ie=Ie.replace(/ /g,"")).toLowerCase()]||Ie;for(var Me=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(Ee){return[parseInt(Ee[1]),parseInt(Ee[2]),parseInt(Ee[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(Ee){return[parseInt(Ee[1],16),parseInt(Ee[2],16),parseInt(Ee[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(Ee){return[parseInt(Ee[1]+Ee[1],16),parseInt(Ee[2]+Ee[2],16),parseInt(Ee[3]+Ee[3],16)]}}],Oe=0;Oe<Me.length;Oe++){var Be=Me[Oe].re,Ue=Me[Oe].process,He=Be.exec(Ie);He&&(r=Ue(He),this.r=r[0],this.g=r[1],this.b=r[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var Ee=this.r.toString(16),e=this.g.toString(16),xe=this.b.toString(16);return Ee.length==1&&(Ee="0"+Ee),e.length==1&&(e="0"+e),xe.length==1&&(xe="0"+xe),"#"+Ee+e+xe}}/**
 * @license
 * Joseph Myers does not specify a particular license for his work.
 *
 * Author: Joseph Myers
 * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
 *
 * Modified by: Owen Leong
 */function d(Ie,r){var Me=Ie[0],Oe=Ie[1],Be=Ie[2],Ue=Ie[3];Me=g(Me,Oe,Be,Ue,r[0],7,-680876936),Ue=g(Ue,Me,Oe,Be,r[1],12,-389564586),Be=g(Be,Ue,Me,Oe,r[2],17,606105819),Oe=g(Oe,Be,Ue,Me,r[3],22,-1044525330),Me=g(Me,Oe,Be,Ue,r[4],7,-176418897),Ue=g(Ue,Me,Oe,Be,r[5],12,1200080426),Be=g(Be,Ue,Me,Oe,r[6],17,-1473231341),Oe=g(Oe,Be,Ue,Me,r[7],22,-45705983),Me=g(Me,Oe,Be,Ue,r[8],7,1770035416),Ue=g(Ue,Me,Oe,Be,r[9],12,-1958414417),Be=g(Be,Ue,Me,Oe,r[10],17,-42063),Oe=g(Oe,Be,Ue,Me,r[11],22,-1990404162),Me=g(Me,Oe,Be,Ue,r[12],7,1804603682),Ue=g(Ue,Me,Oe,Be,r[13],12,-40341101),Be=g(Be,Ue,Me,Oe,r[14],17,-1502002290),Me=m(Me,Oe=g(Oe,Be,Ue,Me,r[15],22,1236535329),Be,Ue,r[1],5,-165796510),Ue=m(Ue,Me,Oe,Be,r[6],9,-1069501632),Be=m(Be,Ue,Me,Oe,r[11],14,643717713),Oe=m(Oe,Be,Ue,Me,r[0],20,-373897302),Me=m(Me,Oe,Be,Ue,r[5],5,-701558691),Ue=m(Ue,Me,Oe,Be,r[10],9,38016083),Be=m(Be,Ue,Me,Oe,r[15],14,-660478335),Oe=m(Oe,Be,Ue,Me,r[4],20,-405537848),Me=m(Me,Oe,Be,Ue,r[9],5,568446438),Ue=m(Ue,Me,Oe,Be,r[14],9,-1019803690),Be=m(Be,Ue,Me,Oe,r[3],14,-187363961),Oe=m(Oe,Be,Ue,Me,r[8],20,1163531501),Me=m(Me,Oe,Be,Ue,r[13],5,-1444681467),Ue=m(Ue,Me,Oe,Be,r[2],9,-51403784),Be=m(Be,Ue,Me,Oe,r[7],14,1735328473),Me=v(Me,Oe=m(Oe,Be,Ue,Me,r[12],20,-1926607734),Be,Ue,r[5],4,-378558),Ue=v(Ue,Me,Oe,Be,r[8],11,-2022574463),Be=v(Be,Ue,Me,Oe,r[11],16,1839030562),Oe=v(Oe,Be,Ue,Me,r[14],23,-35309556),Me=v(Me,Oe,Be,Ue,r[1],4,-1530992060),Ue=v(Ue,Me,Oe,Be,r[4],11,1272893353),Be=v(Be,Ue,Me,Oe,r[7],16,-155497632),Oe=v(Oe,Be,Ue,Me,r[10],23,-1094730640),Me=v(Me,Oe,Be,Ue,r[13],4,681279174),Ue=v(Ue,Me,Oe,Be,r[0],11,-358537222),Be=v(Be,Ue,Me,Oe,r[3],16,-722521979),Oe=v(Oe,Be,Ue,Me,r[6],23,76029189),Me=v(Me,Oe,Be,Ue,r[9],4,-640364487),Ue=v(Ue,Me,Oe,Be,r[12],11,-421815835),Be=v(Be,Ue,Me,Oe,r[15],16,530742520),Me=b(Me,Oe=v(Oe,Be,Ue,Me,r[2],23,-995338651),Be,Ue,r[0],6,-198630844),Ue=b(Ue,Me,Oe,Be,r[7],10,1126891415),Be=b(Be,Ue,Me,Oe,r[14],15,-1416354905),Oe=b(Oe,Be,Ue,Me,r[5],21,-57434055),Me=b(Me,Oe,Be,Ue,r[12],6,1700485571),Ue=b(Ue,Me,Oe,Be,r[3],10,-1894986606),Be=b(Be,Ue,Me,Oe,r[10],15,-1051523),Oe=b(Oe,Be,Ue,Me,r[1],21,-2054922799),Me=b(Me,Oe,Be,Ue,r[8],6,1873313359),Ue=b(Ue,Me,Oe,Be,r[15],10,-30611744),Be=b(Be,Ue,Me,Oe,r[6],15,-1560198380),Oe=b(Oe,Be,Ue,Me,r[13],21,1309151649),Me=b(Me,Oe,Be,Ue,r[4],6,-145523070),Ue=b(Ue,Me,Oe,Be,r[11],10,-1120210379),Be=b(Be,Ue,Me,Oe,r[2],15,718787259),Oe=b(Oe,Be,Ue,Me,r[9],21,-343485551),Ie[0]=_(Me,Ie[0]),Ie[1]=_(Oe,Ie[1]),Ie[2]=_(Be,Ie[2]),Ie[3]=_(Ue,Ie[3])}function p(Ie,r,Me,Oe,Be,Ue){return r=_(_(r,Ie),_(Oe,Ue)),_(r<<Be|r>>>32-Be,Me)}function g(Ie,r,Me,Oe,Be,Ue,He){return p(r&Me|~r&Oe,Ie,r,Be,Ue,He)}function m(Ie,r,Me,Oe,Be,Ue,He){return p(r&Oe|Me&~Oe,Ie,r,Be,Ue,He)}function v(Ie,r,Me,Oe,Be,Ue,He){return p(r^Me^Oe,Ie,r,Be,Ue,He)}function b(Ie,r,Me,Oe,Be,Ue,He){return p(Me^(r|~Oe),Ie,r,Be,Ue,He)}function y(Ie){var r,Me=Ie.length,Oe=[1732584193,-271733879,-1732584194,271733878];for(r=64;r<=Ie.length;r+=64)d(Oe,w(Ie.substring(r-64,r)));Ie=Ie.substring(r-64);var Be=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(r=0;r<Ie.length;r++)Be[r>>2]|=Ie.charCodeAt(r)<<(r%4<<3);if(Be[r>>2]|=128<<(r%4<<3),r>55)for(d(Oe,Be),r=0;r<16;r++)Be[r]=0;return Be[14]=8*Me,d(Oe,Be),Oe}function w(Ie){var r,Me=[];for(r=0;r<64;r+=4)Me[r>>2]=Ie.charCodeAt(r)+(Ie.charCodeAt(r+1)<<8)+(Ie.charCodeAt(r+2)<<16)+(Ie.charCodeAt(r+3)<<24);return Me}u=n.atob.bind(n),h=n.btoa.bind(n);var N="0123456789abcdef".split("");function L(Ie){for(var r="",Me=0;Me<4;Me++)r+=N[Ie>>8*Me+4&15]+N[Ie>>8*Me&15];return r}function A(Ie){return String.fromCharCode((255&Ie)>>0,(65280&Ie)>>8,(16711680&Ie)>>16,(4278190080&Ie)>>24)}function x(Ie){return y(Ie).map(A).join("")}var S=function(Ie){for(var r=0;r<Ie.length;r++)Ie[r]=L(Ie[r]);return Ie.join("")}(y("hello"))!="5d41402abc4b2a76b9719d911017c592";function _(Ie,r){if(S){var Me=(65535&Ie)+(65535&r);return(Ie>>16)+(r>>16)+(Me>>16)<<16|65535&Me}return Ie+r&4294967295}/**
 * @license
 * FPDF is released under a permissive license: there is no usage restriction.
 * You may embed it freely in your application (commercial or not), with or
 * without modifications.
 *
 * Reference: http://www.fpdf.org/en/script/script37.php
 */function P(Ie,r){var Me,Oe,Be,Ue;if(Ie!==Me){for(var He=(Be=Ie,Ue=1+(256/Ie.length>>0),new Array(Ue+1).join(Be)),Ee=[],e=0;e<256;e++)Ee[e]=e;var xe=0;for(e=0;e<256;e++){var Te=Ee[e];xe=(xe+Te+He.charCodeAt(e))%256,Ee[e]=Ee[xe],Ee[xe]=Te}Me=Ie,Oe=Ee}else Ee=Oe;var _e=r.length,Se=0,t=0,Ae="";for(e=0;e<_e;e++)t=(t+(Te=Ee[Se=(Se+1)%256]))%256,Ee[Se]=Ee[t],Ee[t]=Te,He=Ee[(Ee[Se]+Ee[t])%256],Ae+=String.fromCharCode(r.charCodeAt(e)^He);return Ae}/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 * Author: Owen Leong (@owenl131)
 * Date: 15 Oct 2020
 * References:
 * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
 * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
 * http://www.fpdf.org/en/script/script37.php
 */var k={print:4,modify:8,copy:16,"annot-forms":32};function I(Ie,r,Me,Oe){this.v=1,this.r=2;var Be=192;Ie.forEach(function(Ee){if(k.perm!==void 0)throw new Error("Invalid permission: "+Ee);Be+=k[Ee]}),this.padding="(\xBFN^Nu\x8AAd\0NV\xFF\xFA\b..\0\xB6\xD0h>\x80/\f\xA9\xFEdSiz";var Ue=(r+this.padding).substr(0,32),He=(Me+this.padding).substr(0,32);this.O=this.processOwnerPassword(Ue,He),this.P=-(1+(255^Be)),this.encryptionKey=x(Ue+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(Oe)).substr(0,5),this.U=P(this.encryptionKey,this.padding)}function F(Ie){if(/[^\u0000-\u00ff]/.test(Ie))throw new Error("Invalid PDF Name Object: "+Ie+", Only accept ASCII characters.");for(var r="",Me=Ie.length,Oe=0;Oe<Me;Oe++){var Be=Ie.charCodeAt(Oe);Be<33||Be===35||Be===37||Be===40||Be===41||Be===47||Be===60||Be===62||Be===91||Be===93||Be===123||Be===125||Be>126?r+="#"+("0"+Be.toString(16)).slice(-2):r+=Ie[Oe]}return r}function C(Ie){if(_typeof(Ie)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var r={};this.subscribe=function(Me,Oe,Be){if(Be=Be||!1,typeof Me!="string"||typeof Oe!="function"||typeof Be!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");r.hasOwnProperty(Me)||(r[Me]={});var Ue=Math.random().toString(35);return r[Me][Ue]=[Oe,!!Be],Ue},this.unsubscribe=function(Me){for(var Oe in r)if(r[Oe][Me])return delete r[Oe][Me],Object.keys(r[Oe]).length===0&&delete r[Oe],!0;return!1},this.publish=function(Me){if(r.hasOwnProperty(Me)){var Oe=Array.prototype.slice.call(arguments,1),Be=[];for(var Ue in r[Me]){var He=r[Me][Ue];try{He[0].apply(Ie,Oe)}catch(Ee){n.console&&a.error("jsPDF PubSub Error",Ee.message,Ee)}He[1]&&Be.push(Ue)}Be.length&&Be.forEach(this.unsubscribe)}},this.getTopics=function(){return r}}function j(Ie){if(!(this instanceof j))return new j(Ie);var r="opacity,stroke-opacity".split(",");for(var Me in Ie)Ie.hasOwnProperty(Me)&&r.indexOf(Me)>=0&&(this[Me]=Ie[Me]);this.id="",this.objectNumber=-1}function O(Ie,r){this.gState=Ie,this.matrix=r,this.id="",this.objectNumber=-1}function B(Ie,r,Me,Oe,Be){if(!(this instanceof B))return new B(Ie,r,Me,Oe,Be);this.type=Ie==="axial"?2:3,this.coords=r,this.colors=Me,O.call(this,Oe,Be)}function M(Ie,r,Me,Oe,Be){if(!(this instanceof M))return new M(Ie,r,Me,Oe,Be);this.boundingBox=Ie,this.xStep=r,this.yStep=Me,this.stream="",this.cloneIndex=0,O.call(this,Oe,Be)}function E(Ie){var r,Me=typeof arguments[0]=="string"?arguments[0]:"p",Oe=arguments[1],Be=arguments[2],Ue=arguments[3],He=[],Ee=1,e=16,xe="S",Te=null;_typeof(Ie=Ie||{})==="object"&&(Me=Ie.orientation,Oe=Ie.unit||Oe,Be=Ie.format||Be,Ue=Ie.compress||Ie.compressPdf||Ue,(Te=Ie.encryption||null)!==null&&(Te.userPassword=Te.userPassword||"",Te.ownerPassword=Te.ownerPassword||"",Te.userPermissions=Te.userPermissions||[]),Ee=typeof Ie.userUnit=="number"?Math.abs(Ie.userUnit):1,Ie.precision!==void 0&&(r=Ie.precision),Ie.floatPrecision!==void 0&&(e=Ie.floatPrecision),xe=Ie.defaultPathOperation||"S"),He=Ie.filters||(Ue===!0?["FlateEncode"]:He),Oe=Oe||"mm",Me=(""+(Me||"P")).toLowerCase();var _e=Ie.putOnlyUsedFonts||!1,Se={},t={internal:{},__private__:{}};t.__private__.PubSub=C;var Ae="1.3",Pe=t.__private__.getPdfVersion=function(){return Ae};t.__private__.setPdfVersion=function(Ye){Ae=Ye};var St={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};t.__private__.getPageFormats=function(){return St};var Ce=t.__private__.getPageFormat=function(Ye){return St[Ye]};Be=Be||"a4";var ke={COMPAT:"compat",ADVANCED:"advanced"},De=ke.COMPAT;function Re(){this.saveGraphicsState(),Qe(new Cn(an,0,0,-an,0,ms()*an).toString()+" cm"),this.setFontSize(this.getFontSize()/an),xe="n",De=ke.ADVANCED}function je(){this.restoreGraphicsState(),xe="S",De=ke.COMPAT}var We=t.__private__.combineFontStyleAndFontWeight=function(Ye,mi){if(Ye=="bold"&&mi=="normal"||Ye=="bold"&&mi==400||Ye=="normal"&&mi=="italic"||Ye=="bold"&&mi=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return mi&&(Ye=mi==400||mi==="normal"?Ye==="italic"?"italic":"normal":mi!=700&&mi!=="bold"||Ye!=="normal"?(mi==700?"bold":mi)+""+Ye:"bold"),Ye};t.advancedAPI=function(Ye){var mi=De===ke.COMPAT;return mi&&Re.call(this),typeof Ye!="function"||(Ye(this),mi&&je.call(this)),this},t.compatAPI=function(Ye){var mi=De===ke.ADVANCED;return mi&&je.call(this),typeof Ye!="function"||(Ye(this),mi&&Re.call(this)),this},t.isAdvancedAPI=function(){return De===ke.ADVANCED};var Ke,Je=function(Ye){if(De!==ke.ADVANCED)throw new Error(Ye+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},hi=t.roundToPrecision=t.__private__.roundToPrecision=function(Ye,mi){var ji=r||mi;if(isNaN(Ye)||isNaN(ji))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return Ye.toFixed(ji).replace(/0+$/,"")};Ke=t.hpf=t.__private__.hpf=typeof e=="number"?function(Ye){if(isNaN(Ye))throw new Error("Invalid argument passed to jsPDF.hpf");return hi(Ye,e)}:e==="smart"?function(Ye){if(isNaN(Ye))throw new Error("Invalid argument passed to jsPDF.hpf");return hi(Ye,Ye>-1&&Ye<1?16:5)}:function(Ye){if(isNaN(Ye))throw new Error("Invalid argument passed to jsPDF.hpf");return hi(Ye,16)};var oi=t.f2=t.__private__.f2=function(Ye){if(isNaN(Ye))throw new Error("Invalid argument passed to jsPDF.f2");return hi(Ye,2)},ti=t.__private__.f3=function(Ye){if(isNaN(Ye))throw new Error("Invalid argument passed to jsPDF.f3");return hi(Ye,3)},ai=t.scale=t.__private__.scale=function(Ye){if(isNaN(Ye))throw new Error("Invalid argument passed to jsPDF.scale");return De===ke.COMPAT?Ye*an:De===ke.ADVANCED?Ye:void 0},yi=function(Ye){return De===ke.COMPAT?ms()-Ye:De===ke.ADVANCED?Ye:void 0},di=function(Ye){return ai(yi(Ye))};t.__private__.setPrecision=t.setPrecision=function(Ye){typeof parseInt(Ye,10)=="number"&&(r=parseInt(Ye,10))};var bi,vi="00000000000000000000000000000000",Pi=t.__private__.getFileId=function(){return vi},xi=t.__private__.setFileId=function(Ye){return vi=Ye!==void 0&&/^[a-fA-F0-9]{32}$/.test(Ye)?Ye.toUpperCase():vi.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),Te!==null&&(Sr=new I(Te.userPermissions,Te.userPassword,Te.ownerPassword,vi)),vi};t.setFileId=function(Ye){return xi(Ye),this},t.getFileId=function(){return Pi()};var ni=t.__private__.convertDateToPDFDate=function(Ye){var mi=Ye.getTimezoneOffset(),ji=mi<0?"+":"-",Wi=Math.floor(Math.abs(mi/60)),Ki=Math.abs(mi%60),sn=[ji,ze(Wi),"'",ze(Ki),"'"].join("");return["D:",Ye.getFullYear(),ze(Ye.getMonth()+1),ze(Ye.getDate()),ze(Ye.getHours()),ze(Ye.getMinutes()),ze(Ye.getSeconds()),sn].join("")},fi=t.__private__.convertPDFDateToDate=function(Ye){var mi=parseInt(Ye.substr(2,4),10),ji=parseInt(Ye.substr(6,2),10)-1,Wi=parseInt(Ye.substr(8,2),10),Ki=parseInt(Ye.substr(10,2),10),sn=parseInt(Ye.substr(12,2),10),gn=parseInt(Ye.substr(14,2),10);return new Date(mi,ji,Wi,Ki,sn,gn,0)},Si=t.__private__.setCreationDate=function(Ye){var mi;if(Ye===void 0&&(Ye=new Date),Ye instanceof Date)mi=ni(Ye);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(Ye))throw new Error("Invalid argument passed to jsPDF.setCreationDate");mi=Ye}return bi=mi},Xe=t.__private__.getCreationDate=function(Ye){var mi=bi;return Ye==="jsDate"&&(mi=fi(bi)),mi};t.setCreationDate=function(Ye){return Si(Ye),this},t.getCreationDate=function(Ye){return Xe(Ye)};var Ge,ze=t.__private__.padd2=function(Ye){return("0"+parseInt(Ye)).slice(-2)},Ve=t.__private__.padd2Hex=function(Ye){return("00"+(Ye=Ye.toString())).substr(Ye.length)},ei=0,si=[],li=[],ci=0,Ci=[],Fi=[],Oi=!1,Ti=li,Ze=function(){ei=0,ci=0,li=[],si=[],Ci=[],ur=Gn(),fr=Gn()};t.__private__.setCustomOutputDestination=function(Ye){Oi=!0,Ti=Ye};var ii=function(Ye){Oi||(Ti=Ye)};t.__private__.resetCustomOutputDestination=function(){Oi=!1,Ti=li};var Qe=t.__private__.out=function(Ye){return Ye=Ye.toString(),ci+=Ye.length+1,Ti.push(Ye),Ti},ui=t.__private__.write=function(Ye){return Qe(arguments.length===1?Ye.toString():Array.prototype.join.call(arguments," "))},gi=t.__private__.getArrayBuffer=function(Ye){for(var mi=Ye.length,ji=new ArrayBuffer(mi),Wi=new Uint8Array(ji);mi--;)Wi[mi]=Ye.charCodeAt(mi);return ji},_i=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];t.__private__.getStandardFonts=function(){return _i};var Ri=Ie.fontSize||16;t.__private__.setFontSize=t.setFontSize=function(Ye){return Ri=De===ke.ADVANCED?Ye/an:Ye,this};var Ui,ki=t.__private__.getFontSize=t.getFontSize=function(){return De===ke.COMPAT?Ri:Ri*an},Vi=Ie.R2L||!1;t.__private__.setR2L=t.setR2L=function(Ye){return Vi=Ye,this},t.__private__.getR2L=t.getR2L=function(){return Vi};var Ii,$i=t.__private__.setZoomMode=function(Ye){var mi=[void 0,null,"fullwidth","fullheight","fullpage","original"];if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(Ye))Ui=Ye;else if(isNaN(Ye)){if(mi.indexOf(Ye)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+Ye+'" is not recognized.');Ui=Ye}else Ui=parseInt(Ye,10)};t.__private__.getZoomMode=function(){return Ui};var tn,en=t.__private__.setPageMode=function(Ye){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(Ye)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+Ye+'" is not recognized.');Ii=Ye};t.__private__.getPageMode=function(){return Ii};var zi=t.__private__.setLayoutMode=function(Ye){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(Ye)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+Ye+'" is not recognized.');tn=Ye};t.__private__.getLayoutMode=function(){return tn},t.__private__.setDisplayMode=t.setDisplayMode=function(Ye,mi,ji){return $i(Ye),zi(mi),en(ji),this};var Ji={title:"",subject:"",author:"",keywords:"",creator:""};t.__private__.getDocumentProperty=function(Ye){if(Object.keys(Ji).indexOf(Ye)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return Ji[Ye]},t.__private__.getDocumentProperties=function(){return Ji},t.__private__.setDocumentProperties=t.setProperties=t.setDocumentProperties=function(Ye){for(var mi in Ji)Ji.hasOwnProperty(mi)&&Ye[mi]&&(Ji[mi]=Ye[mi]);return this},t.__private__.setDocumentProperty=function(Ye,mi){if(Object.keys(Ji).indexOf(Ye)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return Ji[Ye]=mi};var pn,an,kn,xn,Tn,Bn={},$n={},Bi=[],Ni={},qi={},on={},bn={},En=null,vn=0,mn=[],Pn=new C(t),In=Ie.hotfixes||[],Mn={},zn={},Fn=[],Cn=function Ye(mi,ji,Wi,Ki,sn,gn){if(!(this instanceof Ye))return new Ye(mi,ji,Wi,Ki,sn,gn);isNaN(mi)&&(mi=1),isNaN(ji)&&(ji=0),isNaN(Wi)&&(Wi=0),isNaN(Ki)&&(Ki=1),isNaN(sn)&&(sn=0),isNaN(gn)&&(gn=0),this._matrix=[mi,ji,Wi,Ki,sn,gn]};Object.defineProperty(Cn.prototype,"sx",{get:function(){return this._matrix[0]},set:function(Ye){this._matrix[0]=Ye}}),Object.defineProperty(Cn.prototype,"shy",{get:function(){return this._matrix[1]},set:function(Ye){this._matrix[1]=Ye}}),Object.defineProperty(Cn.prototype,"shx",{get:function(){return this._matrix[2]},set:function(Ye){this._matrix[2]=Ye}}),Object.defineProperty(Cn.prototype,"sy",{get:function(){return this._matrix[3]},set:function(Ye){this._matrix[3]=Ye}}),Object.defineProperty(Cn.prototype,"tx",{get:function(){return this._matrix[4]},set:function(Ye){this._matrix[4]=Ye}}),Object.defineProperty(Cn.prototype,"ty",{get:function(){return this._matrix[5]},set:function(Ye){this._matrix[5]=Ye}}),Object.defineProperty(Cn.prototype,"a",{get:function(){return this._matrix[0]},set:function(Ye){this._matrix[0]=Ye}}),Object.defineProperty(Cn.prototype,"b",{get:function(){return this._matrix[1]},set:function(Ye){this._matrix[1]=Ye}}),Object.defineProperty(Cn.prototype,"c",{get:function(){return this._matrix[2]},set:function(Ye){this._matrix[2]=Ye}}),Object.defineProperty(Cn.prototype,"d",{get:function(){return this._matrix[3]},set:function(Ye){this._matrix[3]=Ye}}),Object.defineProperty(Cn.prototype,"e",{get:function(){return this._matrix[4]},set:function(Ye){this._matrix[4]=Ye}}),Object.defineProperty(Cn.prototype,"f",{get:function(){return this._matrix[5]},set:function(Ye){this._matrix[5]=Ye}}),Object.defineProperty(Cn.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(Cn.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(Cn.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(Cn.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),Cn.prototype.join=function(Ye){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(Ke).join(Ye)},Cn.prototype.multiply=function(Ye){var mi=Ye.sx*this.sx+Ye.shy*this.shx,ji=Ye.sx*this.shy+Ye.shy*this.sy,Wi=Ye.shx*this.sx+Ye.sy*this.shx,Ki=Ye.shx*this.shy+Ye.sy*this.sy,sn=Ye.tx*this.sx+Ye.ty*this.shx+this.tx,gn=Ye.tx*this.shy+Ye.ty*this.sy+this.ty;return new Cn(mi,ji,Wi,Ki,sn,gn)},Cn.prototype.decompose=function(){var Ye=this.sx,mi=this.shy,ji=this.shx,Wi=this.sy,Ki=this.tx,sn=this.ty,gn=Math.sqrt(Ye*Ye+mi*mi),Sn=(Ye/=gn)*ji+(mi/=gn)*Wi;ji-=Ye*Sn,Wi-=mi*Sn;var Ln=Math.sqrt(ji*ji+Wi*Wi);return Sn/=Ln,Ye*(Wi/=Ln)<mi*(ji/=Ln)&&(Ye=-Ye,mi=-mi,Sn=-Sn,gn=-gn),{scale:new Cn(gn,0,0,Ln,0,0),translate:new Cn(1,0,0,1,Ki,sn),rotate:new Cn(Ye,mi,-mi,Ye,0,0),skew:new Cn(1,0,Sn,1,0,0)}},Cn.prototype.toString=function(Ye){return this.join(" ")},Cn.prototype.inversed=function(){var Ye=this.sx,mi=this.shy,ji=this.shx,Wi=this.sy,Ki=this.tx,sn=this.ty,gn=1/(Ye*Wi-mi*ji),Sn=Wi*gn,Ln=-mi*gn,Dn=-ji*gn,Un=Ye*gn;return new Cn(Sn,Ln,Dn,Un,-Sn*Ki-Dn*sn,-Ln*Ki-Un*sn)},Cn.prototype.applyToPoint=function(Ye){var mi=Ye.x*this.sx+Ye.y*this.shx+this.tx,ji=Ye.x*this.shy+Ye.y*this.sy+this.ty;return new Ks(mi,ji)},Cn.prototype.applyToRectangle=function(Ye){var mi=this.applyToPoint(Ye),ji=this.applyToPoint(new Ks(Ye.x+Ye.w,Ye.y+Ye.h));return new Aa(mi.x,mi.y,ji.x-mi.x,ji.y-mi.y)},Cn.prototype.clone=function(){var Ye=this.sx,mi=this.shy,ji=this.shx,Wi=this.sy,Ki=this.tx,sn=this.ty;return new Cn(Ye,mi,ji,Wi,Ki,sn)},t.Matrix=Cn;var Rn=t.matrixMult=function(Ye,mi){return mi.multiply(Ye)},er=new Cn(1,0,0,1,0,0);t.unitMatrix=t.identityMatrix=er;var Kn=function(Ye,mi){if(!qi[Ye]){var ji=(mi instanceof B?"Sh":"P")+(Object.keys(Ni).length+1).toString(10);mi.id=ji,qi[Ye]=ji,Ni[ji]=mi,Pn.publish("addPattern",mi)}};t.ShadingPattern=B,t.TilingPattern=M,t.addShadingPattern=function(Ye,mi){return Je("addShadingPattern()"),Kn(Ye,mi),this},t.beginTilingPattern=function(Ye){Je("beginTilingPattern()"),lo(Ye.boundingBox[0],Ye.boundingBox[1],Ye.boundingBox[2]-Ye.boundingBox[0],Ye.boundingBox[3]-Ye.boundingBox[1],Ye.matrix)},t.endTilingPattern=function(Ye,mi){Je("endTilingPattern()"),mi.stream=Fi[Ge].join(`
`),Kn(Ye,mi),Pn.publish("endTilingPattern",mi),Fn.pop().restore()};var Wn=t.__private__.newObject=function(){var Ye=Gn();return sr(Ye,!0),Ye},Gn=t.__private__.newObjectDeferred=function(){return ei++,si[ei]=function(){return ci},ei},sr=function(Ye,mi){return mi=typeof mi=="boolean"&&mi,si[Ye]=ci,mi&&Qe(Ye+" 0 obj"),Ye},rr=t.__private__.newAdditionalObject=function(){var Ye={objId:Gn(),content:""};return Ci.push(Ye),Ye},ur=Gn(),fr=Gn(),_r=t.__private__.decodeColorString=function(Ye){var mi=Ye.split(" ");if(mi.length!==2||mi[1]!=="g"&&mi[1]!=="G")mi.length===5&&(mi[4]==="k"||mi[4]==="K")&&(mi=[(1-mi[0])*(1-mi[3]),(1-mi[1])*(1-mi[3]),(1-mi[2])*(1-mi[3]),"r"]);else{var ji=parseFloat(mi[0]);mi=[ji,ji,ji,"r"]}for(var Wi="#",Ki=0;Ki<3;Ki++)Wi+=("0"+Math.floor(255*parseFloat(mi[Ki])).toString(16)).slice(-2);return Wi},Cr=t.__private__.encodeColorString=function(Ye){var mi;typeof Ye=="string"&&(Ye={ch1:Ye});var ji=Ye.ch1,Wi=Ye.ch2,Ki=Ye.ch3,sn=Ye.ch4,gn=Ye.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof ji=="string"&&ji.charAt(0)!=="#"){var Sn=new f(ji);if(Sn.ok)ji=Sn.toHex();else if(!/^\d*\.?\d*$/.test(ji))throw new Error('Invalid color "'+ji+'" passed to jsPDF.encodeColorString.')}if(typeof ji=="string"&&/^#[0-9A-Fa-f]{3}$/.test(ji)&&(ji="#"+ji[1]+ji[1]+ji[2]+ji[2]+ji[3]+ji[3]),typeof ji=="string"&&/^#[0-9A-Fa-f]{6}$/.test(ji)){var Ln=parseInt(ji.substr(1),16);ji=Ln>>16&255,Wi=Ln>>8&255,Ki=255&Ln}if(Wi===void 0||sn===void 0&&ji===Wi&&Wi===Ki)if(typeof ji=="string")mi=ji+" "+gn[0];else switch(Ye.precision){case 2:mi=oi(ji/255)+" "+gn[0];break;case 3:default:mi=ti(ji/255)+" "+gn[0]}else if(sn===void 0||_typeof(sn)==="object"){if(sn&&!isNaN(sn.a)&&sn.a===0)return mi=["1.","1.","1.",gn[1]].join(" ");if(typeof ji=="string")mi=[ji,Wi,Ki,gn[1]].join(" ");else switch(Ye.precision){case 2:mi=[oi(ji/255),oi(Wi/255),oi(Ki/255),gn[1]].join(" ");break;default:case 3:mi=[ti(ji/255),ti(Wi/255),ti(Ki/255),gn[1]].join(" ")}}else if(typeof ji=="string")mi=[ji,Wi,Ki,sn,gn[2]].join(" ");else switch(Ye.precision){case 2:mi=[oi(ji),oi(Wi),oi(Ki),oi(sn),gn[2]].join(" ");break;case 3:default:mi=[ti(ji),ti(Wi),ti(Ki),ti(sn),gn[2]].join(" ")}return mi},Jr=t.__private__.getFilters=function(){return He},Dr=t.__private__.putStream=function(Ye){var mi=(Ye=Ye||{}).data||"",ji=Ye.filters||Jr(),Wi=Ye.alreadyAppliedFilters||[],Ki=Ye.addLength1||!1,sn=mi.length,gn=Ye.objectId,Sn=function(Ar){return Ar};if(Te!==null&&gn===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");Te!==null&&(Sn=Sr.encryptor(gn,0));var Ln={};ji===!0&&(ji=["FlateEncode"]);var Dn=Ye.additionalKeyValues||[],Un=(Ln=E.API.processDataByFilters!==void 0?E.API.processDataByFilters(mi,ji):{data:mi,reverseChain:[]}).reverseChain+(Array.isArray(Wi)?Wi.join(" "):Wi.toString());if(Ln.data.length!==0&&(Dn.push({key:"Length",value:Ln.data.length}),Ki===!0&&Dn.push({key:"Length1",value:sn})),Un.length!=0)if(Un.split("/").length-1==1)Dn.push({key:"Filter",value:Un});else{Dn.push({key:"Filter",value:"["+Un+"]"});for(var Xn=0;Xn<Dn.length;Xn+=1)if(Dn[Xn].key==="DecodeParms"){for(var ar=[],or=0;or<Ln.reverseChain.split("/").length-1;or+=1)ar.push("null");ar.push(Dn[Xn].value),Dn[Xn].value="["+ar.join(" ")+"]"}}Qe("<<");for(var dr=0;dr<Dn.length;dr++)Qe("/"+Dn[dr].key+" "+Dn[dr].value);Qe(">>"),Ln.data.length!==0&&(Qe("stream"),Qe(Sn(Ln.data)),Qe("endstream"))},Qr=t.__private__.putPage=function(Ye){var mi=Ye.number,ji=Ye.data,Wi=Ye.objId,Ki=Ye.contentsObjId;sr(Wi,!0),Qe("<</Type /Page"),Qe("/Parent "+Ye.rootDictionaryObjId+" 0 R"),Qe("/Resources "+Ye.resourceDictionaryObjId+" 0 R"),Qe("/MediaBox ["+parseFloat(Ke(Ye.mediaBox.bottomLeftX))+" "+parseFloat(Ke(Ye.mediaBox.bottomLeftY))+" "+Ke(Ye.mediaBox.topRightX)+" "+Ke(Ye.mediaBox.topRightY)+"]"),Ye.cropBox!==null&&Qe("/CropBox ["+Ke(Ye.cropBox.bottomLeftX)+" "+Ke(Ye.cropBox.bottomLeftY)+" "+Ke(Ye.cropBox.topRightX)+" "+Ke(Ye.cropBox.topRightY)+"]"),Ye.bleedBox!==null&&Qe("/BleedBox ["+Ke(Ye.bleedBox.bottomLeftX)+" "+Ke(Ye.bleedBox.bottomLeftY)+" "+Ke(Ye.bleedBox.topRightX)+" "+Ke(Ye.bleedBox.topRightY)+"]"),Ye.trimBox!==null&&Qe("/TrimBox ["+Ke(Ye.trimBox.bottomLeftX)+" "+Ke(Ye.trimBox.bottomLeftY)+" "+Ke(Ye.trimBox.topRightX)+" "+Ke(Ye.trimBox.topRightY)+"]"),Ye.artBox!==null&&Qe("/ArtBox ["+Ke(Ye.artBox.bottomLeftX)+" "+Ke(Ye.artBox.bottomLeftY)+" "+Ke(Ye.artBox.topRightX)+" "+Ke(Ye.artBox.topRightY)+"]"),typeof Ye.userUnit=="number"&&Ye.userUnit!==1&&Qe("/UserUnit "+Ye.userUnit),Pn.publish("putPage",{objId:Wi,pageContext:mn[mi],pageNumber:mi,page:ji}),Qe("/Contents "+Ki+" 0 R"),Qe(">>"),Qe("endobj");var sn=ji.join(`
`);return De===ke.ADVANCED&&(sn+=`
Q`),sr(Ki,!0),Dr({data:sn,filters:Jr(),objectId:Ki}),Qe("endobj"),Wi},ks=t.__private__.putPages=function(){var Ye,mi,ji=[];for(Ye=1;Ye<=vn;Ye++)mn[Ye].objId=Gn(),mn[Ye].contentsObjId=Gn();for(Ye=1;Ye<=vn;Ye++)ji.push(Qr({number:Ye,data:Fi[Ye],objId:mn[Ye].objId,contentsObjId:mn[Ye].contentsObjId,mediaBox:mn[Ye].mediaBox,cropBox:mn[Ye].cropBox,bleedBox:mn[Ye].bleedBox,trimBox:mn[Ye].trimBox,artBox:mn[Ye].artBox,userUnit:mn[Ye].userUnit,rootDictionaryObjId:ur,resourceDictionaryObjId:fr}));sr(ur,!0),Qe("<</Type /Pages");var Wi="/Kids [";for(mi=0;mi<vn;mi++)Wi+=ji[mi]+" 0 R ";Qe(Wi+"]"),Qe("/Count "+vn),Qe(">>"),Qe("endobj"),Pn.publish("postPutPages")},Rs=function(Ye){Pn.publish("putFont",{font:Ye,out:Qe,newObject:Wn,putStream:Dr}),Ye.isAlreadyPutted!==!0&&(Ye.objectNumber=Wn(),Qe("<<"),Qe("/Type /Font"),Qe("/BaseFont /"+F(Ye.postScriptName)),Qe("/Subtype /Type1"),typeof Ye.encoding=="string"&&Qe("/Encoding /"+Ye.encoding),Qe("/FirstChar 32"),Qe("/LastChar 255"),Qe(">>"),Qe("endobj"))},js=function(){for(var Ye in Bn)Bn.hasOwnProperty(Ye)&&(_e===!1||_e===!0&&Se.hasOwnProperty(Ye))&&Rs(Bn[Ye])},Bs=function(Ye){Ye.objectNumber=Wn();var mi=[];mi.push({key:"Type",value:"/XObject"}),mi.push({key:"Subtype",value:"/Form"}),mi.push({key:"BBox",value:"["+[Ke(Ye.x),Ke(Ye.y),Ke(Ye.x+Ye.width),Ke(Ye.y+Ye.height)].join(" ")+"]"}),mi.push({key:"Matrix",value:"["+Ye.matrix.toString()+"]"});var ji=Ye.pages[1].join(`
`);Dr({data:ji,additionalKeyValues:mi,objectId:Ye.objectNumber}),Qe("endobj")},Us=function(){for(var Ye in Mn)Mn.hasOwnProperty(Ye)&&Bs(Mn[Ye])},Ha=function(Ye,mi){var ji,Wi=[],Ki=1/(mi-1);for(ji=0;ji<1;ji+=Ki)Wi.push(ji);if(Wi.push(1),Ye[0].offset!=0){var sn={offset:0,color:Ye[0].color};Ye.unshift(sn)}if(Ye[Ye.length-1].offset!=1){var gn={offset:1,color:Ye[Ye.length-1].color};Ye.push(gn)}for(var Sn="",Ln=0,Dn=0;Dn<Wi.length;Dn++){for(ji=Wi[Dn];ji>Ye[Ln+1].offset;)Ln++;var Un=Ye[Ln].offset,Xn=(ji-Un)/(Ye[Ln+1].offset-Un),ar=Ye[Ln].color,or=Ye[Ln+1].color;Sn+=Ve(Math.round((1-Xn)*ar[0]+Xn*or[0]).toString(16))+Ve(Math.round((1-Xn)*ar[1]+Xn*or[1]).toString(16))+Ve(Math.round((1-Xn)*ar[2]+Xn*or[2]).toString(16))}return Sn.trim()},Io=function(Ye,mi){mi||(mi=21);var ji=Wn(),Wi=Ha(Ye.colors,mi),Ki=[];Ki.push({key:"FunctionType",value:"0"}),Ki.push({key:"Domain",value:"[0.0 1.0]"}),Ki.push({key:"Size",value:"["+mi+"]"}),Ki.push({key:"BitsPerSample",value:"8"}),Ki.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Ki.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Dr({data:Wi,additionalKeyValues:Ki,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:ji}),Qe("endobj"),Ye.objectNumber=Wn(),Qe("<< /ShadingType "+Ye.type),Qe("/ColorSpace /DeviceRGB");var sn="/Coords ["+Ke(parseFloat(Ye.coords[0]))+" "+Ke(parseFloat(Ye.coords[1]))+" ";Ye.type===2?sn+=Ke(parseFloat(Ye.coords[2]))+" "+Ke(parseFloat(Ye.coords[3])):sn+=Ke(parseFloat(Ye.coords[2]))+" "+Ke(parseFloat(Ye.coords[3]))+" "+Ke(parseFloat(Ye.coords[4]))+" "+Ke(parseFloat(Ye.coords[5])),Qe(sn+="]"),Ye.matrix&&Qe("/Matrix ["+Ye.matrix.toString()+"]"),Qe("/Function "+ji+" 0 R"),Qe("/Extend [true true]"),Qe(">>"),Qe("endobj")},Ro=function(Ye,mi){var ji=Gn(),Wi=Wn();mi.push({resourcesOid:ji,objectOid:Wi}),Ye.objectNumber=Wi;var Ki=[];Ki.push({key:"Type",value:"/Pattern"}),Ki.push({key:"PatternType",value:"1"}),Ki.push({key:"PaintType",value:"1"}),Ki.push({key:"TilingType",value:"1"}),Ki.push({key:"BBox",value:"["+Ye.boundingBox.map(Ke).join(" ")+"]"}),Ki.push({key:"XStep",value:Ke(Ye.xStep)}),Ki.push({key:"YStep",value:Ke(Ye.yStep)}),Ki.push({key:"Resources",value:ji+" 0 R"}),Ye.matrix&&Ki.push({key:"Matrix",value:"["+Ye.matrix.toString()+"]"}),Dr({data:Ye.stream,additionalKeyValues:Ki,objectId:Ye.objectNumber}),Qe("endobj")},qs=function(Ye){var mi;for(mi in Ni)Ni.hasOwnProperty(mi)&&(Ni[mi]instanceof B?Io(Ni[mi]):Ni[mi]instanceof M&&Ro(Ni[mi],Ye))},Xa=function(Ye){for(var mi in Ye.objectNumber=Wn(),Qe("<<"),Ye)switch(mi){case"opacity":Qe("/ca "+oi(Ye[mi]));break;case"stroke-opacity":Qe("/CA "+oi(Ye[mi]))}Qe(">>"),Qe("endobj")},jo=function(){var Ye;for(Ye in on)on.hasOwnProperty(Ye)&&Xa(on[Ye])},fa=function(){for(var Ye in Qe("/XObject <<"),Mn)Mn.hasOwnProperty(Ye)&&Mn[Ye].objectNumber>=0&&Qe("/"+Ye+" "+Mn[Ye].objectNumber+" 0 R");Pn.publish("putXobjectDict"),Qe(">>")},Bo=function(){Sr.oid=Wn(),Qe("<<"),Qe("/Filter /Standard"),Qe("/V "+Sr.v),Qe("/R "+Sr.r),Qe("/U <"+Sr.toHexString(Sr.U)+">"),Qe("/O <"+Sr.toHexString(Sr.O)+">"),Qe("/P "+Sr.P),Qe(">>"),Qe("endobj")},Va=function(){for(var Ye in Qe("/Font <<"),Bn)Bn.hasOwnProperty(Ye)&&(_e===!1||_e===!0&&Se.hasOwnProperty(Ye))&&Qe("/"+Ye+" "+Bn[Ye].objectNumber+" 0 R");Qe(">>")},Uo=function(){if(Object.keys(Ni).length>0){for(var Ye in Qe("/Shading <<"),Ni)Ni.hasOwnProperty(Ye)&&Ni[Ye]instanceof B&&Ni[Ye].objectNumber>=0&&Qe("/"+Ye+" "+Ni[Ye].objectNumber+" 0 R");Pn.publish("putShadingPatternDict"),Qe(">>")}},zs=function(Ye){if(Object.keys(Ni).length>0){for(var mi in Qe("/Pattern <<"),Ni)Ni.hasOwnProperty(mi)&&Ni[mi]instanceof t.TilingPattern&&Ni[mi].objectNumber>=0&&Ni[mi].objectNumber<Ye&&Qe("/"+mi+" "+Ni[mi].objectNumber+" 0 R");Pn.publish("putTilingPatternDict"),Qe(">>")}},qo=function(){if(Object.keys(on).length>0){var Ye;for(Ye in Qe("/ExtGState <<"),on)on.hasOwnProperty(Ye)&&on[Ye].objectNumber>=0&&Qe("/"+Ye+" "+on[Ye].objectNumber+" 0 R");Pn.publish("putGStateDict"),Qe(">>")}},hr=function(Ye){sr(Ye.resourcesOid,!0),Qe("<<"),Qe("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),Va(),Uo(),zs(Ye.objectOid),qo(),fa(),Qe(">>"),Qe("endobj")},Ga=function(){var Ye=[];js(),jo(),Us(),qs(Ye),Pn.publish("putResources"),Ye.forEach(hr),hr({resourcesOid:fr,objectOid:Number.MAX_SAFE_INTEGER}),Pn.publish("postPutResources")},Ya=function(){Pn.publish("putAdditionalObjects");for(var Ye=0;Ye<Ci.length;Ye++){var mi=Ci[Ye];sr(mi.objId,!0),Qe(mi.content),Qe("endobj")}Pn.publish("postPutAdditionalObjects")},Ka=function(Ye){$n[Ye.fontName]=$n[Ye.fontName]||{},$n[Ye.fontName][Ye.fontStyle]=Ye.id},da=function(Ye,mi,ji,Wi,Ki){var sn={id:"F"+(Object.keys(Bn).length+1).toString(10),postScriptName:Ye,fontName:mi,fontStyle:ji,encoding:Wi,isStandardFont:Ki||!1,metadata:{}};return Pn.publish("addFont",{font:sn,instance:this}),Bn[sn.id]=sn,Ka(sn),sn.id},zo=function(Ye){for(var mi=0,ji=_i.length;mi<ji;mi++){var Wi=da.call(this,Ye[mi][0],Ye[mi][1],Ye[mi][2],_i[mi][3],!0);_e===!1&&(Se[Wi]=!0);var Ki=Ye[mi][0].split("-");Ka({id:Wi,fontName:Ki[0],fontStyle:Ki[1]||""})}Pn.publish("addFonts",{fonts:Bn,dictionary:$n})},zr=function(Ye){return Ye.foo=function(){try{return Ye.apply(this,arguments)}catch(Wi){var mi=Wi.stack||"";~mi.indexOf(" at ")&&(mi=mi.split(" at ")[1]);var ji="Error in function "+mi.split(`
`)[0].split("<")[0]+": "+Wi.message;if(!n.console)throw new Error(ji);n.console.error(ji,Wi),n.alert&&alert(ji)}},Ye.foo.bar=Ye,Ye.foo},Ws=function(Ye,mi){var ji,Wi,Ki,sn,gn,Sn,Ln,Dn,Un;if(Ki=(mi=mi||{}).sourceEncoding||"Unicode",gn=mi.outputEncoding,(mi.autoencode||gn)&&Bn[pn].metadata&&Bn[pn].metadata[Ki]&&Bn[pn].metadata[Ki].encoding&&(sn=Bn[pn].metadata[Ki].encoding,!gn&&Bn[pn].encoding&&(gn=Bn[pn].encoding),!gn&&sn.codePages&&(gn=sn.codePages[0]),typeof gn=="string"&&(gn=sn[gn]),gn)){for(Ln=!1,Sn=[],ji=0,Wi=Ye.length;ji<Wi;ji++)(Dn=gn[Ye.charCodeAt(ji)])?Sn.push(String.fromCharCode(Dn)):Sn.push(Ye[ji]),Sn[ji].charCodeAt(0)>>8&&(Ln=!0);Ye=Sn.join("")}for(ji=Ye.length;Ln===void 0&&ji!==0;)Ye.charCodeAt(ji-1)>>8&&(Ln=!0),ji--;if(!Ln)return Ye;for(Sn=mi.noBOM?[]:[254,255],ji=0,Wi=Ye.length;ji<Wi;ji++){if((Un=(Dn=Ye.charCodeAt(ji))>>8)>>8)throw new Error("Character at position "+ji+" of string '"+Ye+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");Sn.push(Un),Sn.push(Dn-(Un<<8))}return String.fromCharCode.apply(void 0,Sn)},Tr=t.__private__.pdfEscape=t.pdfEscape=function(Ye,mi){return Ws(Ye,mi).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},pa=t.__private__.beginPage=function(Ye){Fi[++vn]=[],mn[vn]={objId:0,contentsObjId:0,userUnit:Number(Ee),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(Ye[0]),topRightY:Number(Ye[1])}},Ja(vn),ii(Fi[Ge])},$a=function(Ye,mi){var ji,Wi,Ki;switch(Me=mi||Me,typeof Ye=="string"&&(ji=Ce(Ye.toLowerCase()),Array.isArray(ji)&&(Wi=ji[0],Ki=ji[1])),Array.isArray(Ye)&&(Wi=Ye[0]*an,Ki=Ye[1]*an),isNaN(Wi)&&(Wi=Be[0],Ki=Be[1]),(Wi>14400||Ki>14400)&&(a.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),Wi=Math.min(14400,Wi),Ki=Math.min(14400,Ki)),Be=[Wi,Ki],Me.substr(0,1)){case"l":Ki>Wi&&(Be=[Ki,Wi]);break;case"p":Wi>Ki&&(Be=[Ki,Wi])}pa(Be),no(ba),Qe(Wr),wa!==0&&Qe(wa+" J"),Sa!==0&&Qe(Sa+" j"),Pn.publish("addPage",{pageNumber:vn})},Wo=function(Ye){Ye>0&&Ye<=vn&&(Fi.splice(Ye,1),mn.splice(Ye,1),vn--,Ge>vn&&(Ge=vn),this.setPage(Ge))},Ja=function(Ye){Ye>0&&Ye<=vn&&(Ge=Ye)},Ho=t.__private__.getNumberOfPages=t.getNumberOfPages=function(){return Fi.length-1},Qa=function(Ye,mi,ji){var Wi,Ki=void 0;return ji=ji||{},Ye=Ye!==void 0?Ye:Bn[pn].fontName,mi=mi!==void 0?mi:Bn[pn].fontStyle,Wi=Ye.toLowerCase(),$n[Wi]!==void 0&&$n[Wi][mi]!==void 0?Ki=$n[Wi][mi]:$n[Ye]!==void 0&&$n[Ye][mi]!==void 0?Ki=$n[Ye][mi]:ji.disableWarning===!1&&a.warn("Unable to look up font label for font '"+Ye+"', '"+mi+"'. Refer to getFontList() for available fonts."),Ki||ji.noFallback||(Ki=$n.times[mi])==null&&(Ki=$n.times.normal),Ki},Xo=t.__private__.putInfo=function(){var Ye=Wn(),mi=function(Wi){return Wi};for(var ji in Te!==null&&(mi=Sr.encryptor(Ye,0)),Qe("<<"),Qe("/Producer ("+Tr(mi("jsPDF "+E.version))+")"),Ji)Ji.hasOwnProperty(ji)&&Ji[ji]&&Qe("/"+ji.substr(0,1).toUpperCase()+ji.substr(1)+" ("+Tr(mi(Ji[ji]))+")");Qe("/CreationDate ("+Tr(mi(bi))+")"),Qe(">>"),Qe("endobj")},ga=t.__private__.putCatalog=function(Ye){var mi=(Ye=Ye||{}).rootDictionaryObjId||ur;switch(Wn(),Qe("<<"),Qe("/Type /Catalog"),Qe("/Pages "+mi+" 0 R"),Ui||(Ui="fullwidth"),Ui){case"fullwidth":Qe("/OpenAction [3 0 R /FitH null]");break;case"fullheight":Qe("/OpenAction [3 0 R /FitV null]");break;case"fullpage":Qe("/OpenAction [3 0 R /Fit]");break;case"original":Qe("/OpenAction [3 0 R /XYZ null null 1]");break;default:var ji=""+Ui;ji.substr(ji.length-1)==="%"&&(Ui=parseInt(Ui)/100),typeof Ui=="number"&&Qe("/OpenAction [3 0 R /XYZ null null "+oi(Ui)+"]")}switch(tn||(tn="continuous"),tn){case"continuous":Qe("/PageLayout /OneColumn");break;case"single":Qe("/PageLayout /SinglePage");break;case"two":case"twoleft":Qe("/PageLayout /TwoColumnLeft");break;case"tworight":Qe("/PageLayout /TwoColumnRight")}Ii&&Qe("/PageMode /"+Ii),Pn.publish("putCatalog"),Qe(">>"),Qe("endobj")},Vo=t.__private__.putTrailer=function(){Qe("trailer"),Qe("<<"),Qe("/Size "+(ei+1)),Qe("/Root "+ei+" 0 R"),Qe("/Info "+(ei-1)+" 0 R"),Te!==null&&Qe("/Encrypt "+Sr.oid+" 0 R"),Qe("/ID [ <"+vi+"> <"+vi+"> ]"),Qe(">>")},Go=t.__private__.putHeader=function(){Qe("%PDF-"+Ae),Qe("%\xBA\xDF\xAC\xE0")},Yo=t.__private__.putXRef=function(){var Ye="0000000000";Qe("xref"),Qe("0 "+(ei+1)),Qe("0000000000 65535 f ");for(var mi=1;mi<=ei;mi++)typeof si[mi]=="function"?Qe((Ye+si[mi]()).slice(-10)+" 00000 n "):si[mi]!==void 0?Qe((Ye+si[mi]).slice(-10)+" 00000 n "):Qe("0000000000 00000 n ")},ns=t.__private__.buildDocument=function(){Ze(),ii(li),Pn.publish("buildDocument"),Go(),ks(),Ya(),Ga(),Te!==null&&Bo(),Xo(),ga();var Ye=ci;return Yo(),Vo(),Qe("startxref"),Qe(""+Ye),Qe("%%EOF"),ii(Fi[Ge]),li.join(`
`)},Hs=t.__private__.getBlob=function(Ye){return new Blob([gi(Ye)],{type:"application/pdf"})},Xs=t.output=t.__private__.output=zr(function(Ye,mi){switch(typeof(mi=mi||{})=="string"?mi={filename:mi}:mi.filename=mi.filename||"generated.pdf",Ye){case void 0:return ns();case"save":t.save(mi.filename);break;case"arraybuffer":return gi(ns());case"blob":return Hs(ns());case"bloburi":case"bloburl":if(n.URL!==void 0&&typeof n.URL.createObjectURL=="function")return n.URL&&n.URL.createObjectURL(Hs(ns()))||void 0;a.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var ji="",Wi=ns();try{ji=h(Wi)}catch{ji=h(unescape(encodeURIComponent(Wi)))}return"data:application/pdf;filename="+mi.filename+";base64,"+ji;case"pdfobjectnewwindow":if(Object.prototype.toString.call(n)==="[object Window]"){var Ki="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",sn=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';mi.pdfObjectUrl&&(Ki=mi.pdfObjectUrl,sn="");var gn='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+Ki+'"'+sn+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(mi)+");<\/script></body></html>",Sn=n.open();return Sn!==null&&Sn.document.write(gn),Sn}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(n)==="[object Window]"){var Ln='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(mi.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+mi.filename+'" width="500px" height="400px" /></body></html>',Dn=n.open();if(Dn!==null){Dn.document.write(Ln);var Un=this;Dn.document.documentElement.querySelector("#pdfViewer").onload=function(){Dn.document.title=mi.filename,Dn.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(Un.output("bloburl"))}}return Dn}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(n)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var Xn='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",mi)+'"></iframe></body></html>',ar=n.open();if(ar!==null&&(ar.document.write(Xn),ar.document.title=mi.filename),ar||typeof safari>"u")return ar;break;case"datauri":case"dataurl":return n.document.location.href=this.output("datauristring",mi);default:return null}}),Za=function(Ye){return Array.isArray(In)===!0&&In.indexOf(Ye)>-1};switch(Oe){case"pt":an=1;break;case"mm":an=72/25.4;break;case"cm":an=72/2.54;break;case"in":an=72;break;case"px":an=Za("px_scaling")==1?.75:96/72;break;case"pc":case"em":an=12;break;case"ex":an=6;break;default:if(typeof Oe!="number")throw new Error("Invalid unit: "+Oe);an=Oe}var Sr=null;Si(),xi();var Ko=function(Ye){return Te!==null?Sr.encryptor(Ye,0):function(mi){return mi}},to=t.__private__.getPageInfo=t.getPageInfo=function(Ye){if(isNaN(Ye)||Ye%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:mn[Ye].objId,pageNumber:Ye,pageContext:mn[Ye]}},Nn=t.__private__.getPageInfoByObjId=function(Ye){if(isNaN(Ye)||Ye%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var mi in mn)if(mn[mi].objId===Ye)break;return to(mi)},$o=t.__private__.getCurrentPageInfo=t.getCurrentPageInfo=function(){return{objId:mn[Ge].objId,pageNumber:Ge,pageContext:mn[Ge]}};t.addPage=function(){return $a.apply(this,arguments),this},t.setPage=function(){return Ja.apply(this,arguments),ii.call(this,Fi[Ge]),this},t.insertPage=function(Ye){return this.addPage(),this.movePage(Ge,Ye),this},t.movePage=function(Ye,mi){var ji,Wi;if(Ye>mi){ji=Fi[Ye],Wi=mn[Ye];for(var Ki=Ye;Ki>mi;Ki--)Fi[Ki]=Fi[Ki-1],mn[Ki]=mn[Ki-1];Fi[mi]=ji,mn[mi]=Wi,this.setPage(mi)}else if(Ye<mi){ji=Fi[Ye],Wi=mn[Ye];for(var sn=Ye;sn<mi;sn++)Fi[sn]=Fi[sn+1],mn[sn]=mn[sn+1];Fi[mi]=ji,mn[mi]=Wi,this.setPage(mi)}return this},t.deletePage=function(){return Wo.apply(this,arguments),this},t.__private__.text=t.text=function(Ye,mi,ji,Wi,Ki){var sn,gn,Sn,Ln,Dn,Un,Xn,ar,or,dr=(Wi=Wi||{}).scope||this;if(typeof Ye=="number"&&typeof mi=="number"&&(typeof ji=="string"||Array.isArray(ji))){var Ar=ji;ji=mi,mi=Ye,Ye=Ar}if(arguments[3]instanceof Cn?(Je("The transform parameter of text() with a Matrix value"),or=Ki):(Sn=arguments[4],Ln=arguments[5],_typeof(Xn=arguments[3])==="object"&&Xn!==null||(typeof Sn=="string"&&(Ln=Sn,Sn=null),typeof Xn=="string"&&(Ln=Xn,Xn=null),typeof Xn=="number"&&(Sn=Xn,Xn=null),Wi={flags:Xn,angle:Sn,align:Ln})),isNaN(mi)||isNaN(ji)||Ye==null)throw new Error("Invalid arguments passed to jsPDF.text");if(Ye.length===0)return dr;var vr="",Hr=!1,Or=typeof Wi.lineHeightFactor=="number"?Wi.lineHeightFactor:Os,ss=dr.internal.scaleFactor;function ho(ir){return ir=ir.split("	").join(Array(Wi.TabLen||9).join(" ")),Tr(ir,Xn)}function Pa(ir){for(var nr,cr=ir.concat(),mr=[],hs=cr.length;hs--;)typeof(nr=cr.shift())=="string"?mr.push(nr):Array.isArray(ir)&&(nr.length===1||nr[1]===void 0&&nr[2]===void 0)?mr.push(nr[0]):mr.push([nr[0],nr[1],nr[2]]);return mr}function Ea(ir,nr){var cr;if(typeof ir=="string")cr=nr(ir)[0];else if(Array.isArray(ir)){for(var mr,hs,ws=ir.concat(),sa=[],uo=ws.length;uo--;)typeof(mr=ws.shift())=="string"?sa.push(nr(mr)[0]):Array.isArray(mr)&&typeof mr[0]=="string"&&(hs=nr(mr[0],mr[1],mr[2]),sa.push([hs[0],hs[1],hs[2]]));cr=sa}return cr}var Js=!1,ka=!0;if(typeof Ye=="string")Js=!0;else if(Array.isArray(Ye)){var La=Ye.concat();gn=[];for(var Qs,Pr=La.length;Pr--;)(typeof(Qs=La.shift())!="string"||Array.isArray(Qs)&&typeof Qs[0]!="string")&&(ka=!1);Js=ka}if(Js===!1)throw new Error('Type of text must be string or Array. "'+Ye+'" is not recognized.');typeof Ye=="string"&&(Ye=Ye.match(/[\r?\n]/)?Ye.split(/\r\n|\r|\n/g):[Ye]);var Zs=Ri/dr.internal.scaleFactor,ta=Zs*(Or-1);switch(Wi.baseline){case"bottom":ji-=ta;break;case"top":ji+=Zs-ta;break;case"hanging":ji+=Zs-2*ta;break;case"middle":ji+=Zs/2-ta}if((Un=Wi.maxWidth||0)>0&&(typeof Ye=="string"?Ye=dr.splitTextToSize(Ye,Un):Object.prototype.toString.call(Ye)==="[object Array]"&&(Ye=Ye.reduce(function(ir,nr){return ir.concat(dr.splitTextToSize(nr,Un))},[]))),sn={text:Ye,x:mi,y:ji,options:Wi,mutex:{pdfEscape:Tr,activeFontKey:pn,fonts:Bn,activeFontSize:Ri}},Pn.publish("preProcessText",sn),Ye=sn.text,Sn=(Wi=sn.options).angle,!(or instanceof Cn)&&Sn&&typeof Sn=="number"){Sn*=Math.PI/180,Wi.rotationDirection===0&&(Sn=-Sn),De===ke.ADVANCED&&(Sn=-Sn);var ea=Math.cos(Sn),Oa=Math.sin(Sn);or=new Cn(ea,Oa,-Oa,ea,0,0)}else Sn&&Sn instanceof Cn&&(or=Sn);De!==ke.ADVANCED||or||(or=er),(Dn=Wi.charSpace||Ys)!==void 0&&(vr+=Ke(ai(Dn))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(ar=Wi.horizontalScale)!==void 0&&(vr+=Ke(100*ar)+` Tz
`),Wi.lang;var Er=-1,al=Wi.renderingMode!==void 0?Wi.renderingMode:Wi.stroke,Fa=dr.internal.getCurrentPageInfo().pageContext;switch(al){case 0:case!1:case"fill":Er=0;break;case 1:case!0:case"stroke":Er=1;break;case 2:case"fillThenStroke":Er=2;break;case 3:case"invisible":Er=3;break;case 4:case"fillAndAddForClipping":Er=4;break;case 5:case"strokeAndAddPathForClipping":Er=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":Er=6;break;case 7:case"addToPathForClipping":Er=7}var co=Fa.usedRenderingMode!==void 0?Fa.usedRenderingMode:-1;Er!==-1?vr+=Er+` Tr
`:co!==-1&&(vr+=`0 Tr
`),Er!==-1&&(Fa.usedRenderingMode=Er),Ln=Wi.align||"left";var Xr,Ma=Ri*Or,ol=dr.internal.pageSize.getWidth(),ll=Bn[pn];Dn=Wi.charSpace||Ys,Un=Wi.maxWidth||0,Xn=Object.assign({autoencode:!0,noBOM:!0},Wi.flags);var vs=[];if(Object.prototype.toString.call(Ye)==="[object Array]"){var Ir;gn=Pa(Ye),Ln!=="left"&&(Xr=gn.map(function(ir){return dr.getStringUnitWidth(ir,{font:ll,charSpace:Dn,fontSize:Ri,doKerning:!1})*Ri/ss}));var Vr,bs=0;if(Ln==="right"){mi-=Xr[0],Ye=[],Pr=gn.length;for(var ts=0;ts<Pr;ts++)ts===0?(Vr=rs(mi),Ir=ps(ji)):(Vr=ai(bs-Xr[ts]),Ir=-Ma),Ye.push([gn[ts],Vr,Ir]),bs=Xr[ts]}else if(Ln==="center"){mi-=Xr[0]/2,Ye=[],Pr=gn.length;for(var as=0;as<Pr;as++)as===0?(Vr=rs(mi),Ir=ps(ji)):(Vr=ai((bs-Xr[as])/2),Ir=-Ma),Ye.push([gn[as],Vr,Ir]),bs=Xr[as]}else if(Ln==="left"){Ye=[],Pr=gn.length;for(var ia=0;ia<Pr;ia++)Ye.push(gn[ia])}else{if(Ln!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');Ye=[],Pr=gn.length,Un=Un!==0?Un:ol;for(var Gr=0;Gr<Pr;Gr++)Ir=Gr===0?ps(ji):-Ma,Vr=Gr===0?rs(mi):0,Gr<Pr-1?vs.push(Ke(ai((Un-Xr[Gr])/(gn[Gr].split(" ").length-1)))):vs.push(0),Ye.push([gn[Gr],Vr,Ir])}}var na=typeof Wi.R2L=="boolean"?Wi.R2L:Vi;na===!0&&(Ye=Ea(Ye,function(ir,nr,cr){return[ir.split("").reverse().join(""),nr,cr]})),sn={text:Ye,x:mi,y:ji,options:Wi,mutex:{pdfEscape:Tr,activeFontKey:pn,fonts:Bn,activeFontSize:Ri}},Pn.publish("postProcessText",sn),Ye=sn.text,Hr=sn.mutex.isHex||!1;var Na=Bn[pn].encoding;Na!=="WinAnsiEncoding"&&Na!=="StandardEncoding"||(Ye=Ea(Ye,function(ir,nr,cr){return[ho(ir),nr,cr]})),gn=Pa(Ye),Ye=[];for(var ys,Yr,os,Ns=0,ra=1,Ds=Array.isArray(gn[0])?ra:Ns,_s="",Da=function(ir,nr,cr){var mr="";return cr instanceof Cn?(cr=typeof Wi.angle=="number"?Rn(cr,new Cn(1,0,0,1,ir,nr)):Rn(new Cn(1,0,0,1,ir,nr),cr),De===ke.ADVANCED&&(cr=Rn(new Cn(1,0,0,-1,0,0),cr)),mr=cr.join(" ")+` Tm
`):mr=Ke(ir)+" "+Ke(nr)+` Td
`,mr},Rr=0;Rr<gn.length;Rr++){switch(_s="",Ds){case ra:os=(Hr?"<":"(")+gn[Rr][0]+(Hr?">":")"),ys=parseFloat(gn[Rr][1]),Yr=parseFloat(gn[Rr][2]);break;case Ns:os=(Hr?"<":"(")+gn[Rr]+(Hr?">":")"),ys=rs(mi),Yr=ps(ji)}vs!==void 0&&vs[Rr]!==void 0&&(_s=vs[Rr]+` Tw
`),Rr===0?Ye.push(_s+Da(ys,Yr,or)+os):Ds===Ns?Ye.push(_s+os):Ds===ra&&Ye.push(_s+Da(ys,Yr,or)+os)}Ye=Ds===Ns?Ye.join(` Tj
T* `):Ye.join(` Tj
`),Ye+=` Tj
`;var ls=`BT
/`;return ls+=pn+" "+Ri+` Tf
`,ls+=Ke(Ri*Or)+` TL
`,ls+=Fs+`
`,ls+=vr,ls+=Ye,Qe(ls+="ET"),Se[pn]=!0,dr};var Jo=t.__private__.clip=t.clip=function(Ye){return Qe(Ye==="evenodd"?"W*":"W"),this};t.clipEvenOdd=function(){return Jo("evenodd")},t.__private__.discardPath=t.discardPath=function(){return Qe("n"),this};var Zr=t.__private__.isValidStyle=function(Ye){var mi=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(Ye)!==-1&&(mi=!0),mi};t.__private__.setDefaultPathOperation=t.setDefaultPathOperation=function(Ye){return Zr(Ye)&&(xe=Ye),this};var eo=t.__private__.getStyle=t.getStyle=function(Ye){var mi=xe;switch(Ye){case"D":case"S":mi="S";break;case"F":mi="f";break;case"FD":case"DF":mi="B";break;case"f":case"f*":case"B":case"B*":mi=Ye}return mi},io=t.close=function(){return Qe("h"),this};t.stroke=function(){return Qe("S"),this},t.fill=function(Ye){return Vs("f",Ye),this},t.fillEvenOdd=function(Ye){return Vs("f*",Ye),this},t.fillStroke=function(Ye){return Vs("B",Ye),this},t.fillStrokeEvenOdd=function(Ye){return Vs("B*",Ye),this};var Vs=function(Ye,mi){_typeof(mi)==="object"?Zo(mi,Ye):Qe(Ye)},ma=function(Ye){Ye===null||De===ke.ADVANCED&&Ye===void 0||(Ye=eo(Ye),Qe(Ye))};function Qo(Ye,mi,ji,Wi,Ki){var sn=new M(mi||this.boundingBox,ji||this.xStep,Wi||this.yStep,this.gState,Ki||this.matrix);sn.stream=this.stream;var gn=Ye+"$$"+this.cloneIndex+++"$$";return Kn(gn,sn),sn}var Zo=function(Ye,mi){var ji=qi[Ye.key],Wi=Ni[ji];if(Wi instanceof B)Qe("q"),Qe(tl(mi)),Wi.gState&&t.setGState(Wi.gState),Qe(Ye.matrix.toString()+" cm"),Qe("/"+ji+" sh"),Qe("Q");else if(Wi instanceof M){var Ki=new Cn(1,0,0,-1,0,ms());Ye.matrix&&(Ki=Ki.multiply(Ye.matrix||er),ji=Qo.call(Wi,Ye.key,Ye.boundingBox,Ye.xStep,Ye.yStep,Ki).id),Qe("q"),Qe("/Pattern cs"),Qe("/"+ji+" scn"),Wi.gState&&t.setGState(Wi.gState),Qe(mi),Qe("Q")}},tl=function(Ye){switch(Ye){case"f":case"F":return"W n";case"f*":return"W* n";case"B":return"W S";case"B*":return"W* S";case"S":return"W S";case"n":return"W n"}},va=t.moveTo=function(Ye,mi){return Qe(Ke(ai(Ye))+" "+Ke(di(mi))+" m"),this},Ls=t.lineTo=function(Ye,mi){return Qe(Ke(ai(Ye))+" "+Ke(di(mi))+" l"),this},ds=t.curveTo=function(Ye,mi,ji,Wi,Ki,sn){return Qe([Ke(ai(Ye)),Ke(di(mi)),Ke(ai(ji)),Ke(di(Wi)),Ke(ai(Ki)),Ke(di(sn)),"c"].join(" ")),this};t.__private__.line=t.line=function(Ye,mi,ji,Wi,Ki){if(isNaN(Ye)||isNaN(mi)||isNaN(ji)||isNaN(Wi)||!Zr(Ki))throw new Error("Invalid arguments passed to jsPDF.line");return De===ke.COMPAT?this.lines([[ji-Ye,Wi-mi]],Ye,mi,[1,1],Ki||"S"):this.lines([[ji-Ye,Wi-mi]],Ye,mi,[1,1]).stroke()},t.__private__.lines=t.lines=function(Ye,mi,ji,Wi,Ki,sn){var gn,Sn,Ln,Dn,Un,Xn,ar,or,dr,Ar,vr,Hr;if(typeof Ye=="number"&&(Hr=ji,ji=mi,mi=Ye,Ye=Hr),Wi=Wi||[1,1],sn=sn||!1,isNaN(mi)||isNaN(ji)||!Array.isArray(Ye)||!Array.isArray(Wi)||!Zr(Ki)||typeof sn!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(va(mi,ji),gn=Wi[0],Sn=Wi[1],Dn=Ye.length,Ar=mi,vr=ji,Ln=0;Ln<Dn;Ln++)(Un=Ye[Ln]).length===2?(Ar=Un[0]*gn+Ar,vr=Un[1]*Sn+vr,Ls(Ar,vr)):(Xn=Un[0]*gn+Ar,ar=Un[1]*Sn+vr,or=Un[2]*gn+Ar,dr=Un[3]*Sn+vr,Ar=Un[4]*gn+Ar,vr=Un[5]*Sn+vr,ds(Xn,ar,or,dr,Ar,vr));return sn&&io(),ma(Ki),this},t.path=function(Ye){for(var mi=0;mi<Ye.length;mi++){var ji=Ye[mi],Wi=ji.c;switch(ji.op){case"m":va(Wi[0],Wi[1]);break;case"l":Ls(Wi[0],Wi[1]);break;case"c":ds.apply(this,Wi);break;case"h":io()}}return this},t.__private__.rect=t.rect=function(Ye,mi,ji,Wi,Ki){if(isNaN(Ye)||isNaN(mi)||isNaN(ji)||isNaN(Wi)||!Zr(Ki))throw new Error("Invalid arguments passed to jsPDF.rect");return De===ke.COMPAT&&(Wi=-Wi),Qe([Ke(ai(Ye)),Ke(di(mi)),Ke(ai(ji)),Ke(ai(Wi)),"re"].join(" ")),ma(Ki),this},t.__private__.triangle=t.triangle=function(Ye,mi,ji,Wi,Ki,sn,gn){if(isNaN(Ye)||isNaN(mi)||isNaN(ji)||isNaN(Wi)||isNaN(Ki)||isNaN(sn)||!Zr(gn))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[ji-Ye,Wi-mi],[Ki-ji,sn-Wi],[Ye-Ki,mi-sn]],Ye,mi,[1,1],gn,!0),this},t.__private__.roundedRect=t.roundedRect=function(Ye,mi,ji,Wi,Ki,sn,gn){if(isNaN(Ye)||isNaN(mi)||isNaN(ji)||isNaN(Wi)||isNaN(Ki)||isNaN(sn)||!Zr(gn))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var Sn=4/3*(Math.SQRT2-1);return Ki=Math.min(Ki,.5*ji),sn=Math.min(sn,.5*Wi),this.lines([[ji-2*Ki,0],[Ki*Sn,0,Ki,sn-sn*Sn,Ki,sn],[0,Wi-2*sn],[0,sn*Sn,-Ki*Sn,sn,-Ki,sn],[2*Ki-ji,0],[-Ki*Sn,0,-Ki,-sn*Sn,-Ki,-sn],[0,2*sn-Wi],[0,-sn*Sn,Ki*Sn,-sn,Ki,-sn]],Ye+Ki,mi,[1,1],gn,!0),this},t.__private__.ellipse=t.ellipse=function(Ye,mi,ji,Wi,Ki){if(isNaN(Ye)||isNaN(mi)||isNaN(ji)||isNaN(Wi)||!Zr(Ki))throw new Error("Invalid arguments passed to jsPDF.ellipse");var sn=4/3*(Math.SQRT2-1)*ji,gn=4/3*(Math.SQRT2-1)*Wi;return va(Ye+ji,mi),ds(Ye+ji,mi-gn,Ye+sn,mi-Wi,Ye,mi-Wi),ds(Ye-sn,mi-Wi,Ye-ji,mi-gn,Ye-ji,mi),ds(Ye-ji,mi+gn,Ye-sn,mi+Wi,Ye,mi+Wi),ds(Ye+sn,mi+Wi,Ye+ji,mi+gn,Ye+ji,mi),ma(Ki),this},t.__private__.circle=t.circle=function(Ye,mi,ji,Wi){if(isNaN(Ye)||isNaN(mi)||isNaN(ji)||!Zr(Wi))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(Ye,mi,ji,ji,Wi)},t.setFont=function(Ye,mi,ji){return ji&&(mi=We(mi,ji)),pn=Qa(Ye,mi,{disableWarning:!1}),this};var el=t.__private__.getFont=t.getFont=function(){return Bn[Qa.apply(t,arguments)]};t.__private__.getFontList=t.getFontList=function(){var Ye,mi,ji={};for(Ye in $n)if($n.hasOwnProperty(Ye))for(mi in ji[Ye]=[],$n[Ye])$n[Ye].hasOwnProperty(mi)&&ji[Ye].push(mi);return ji},t.addFont=function(Ye,mi,ji,Wi,Ki){var sn=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&sn.indexOf(arguments[3])!==-1?Ki=arguments[3]:arguments[3]&&sn.indexOf(arguments[3])==-1&&(ji=We(ji,Wi)),Ki=Ki||"Identity-H",da.call(this,Ye,mi,ji,Ki)};var Os,ba=Ie.lineWidth||.200025,Gs=t.__private__.getLineWidth=t.getLineWidth=function(){return ba},no=t.__private__.setLineWidth=t.setLineWidth=function(Ye){return ba=Ye,Qe(Ke(ai(Ye))+" w"),this};t.__private__.setLineDash=E.API.setLineDash=E.API.setLineDashPattern=function(Ye,mi){if(Ye=Ye||[],mi=mi||0,isNaN(mi)||!Array.isArray(Ye))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return Ye=Ye.map(function(ji){return Ke(ai(ji))}).join(" "),mi=Ke(ai(mi)),Qe("["+Ye+"] "+mi+" d"),this};var ro=t.__private__.getLineHeight=t.getLineHeight=function(){return Ri*Os};t.__private__.getLineHeight=t.getLineHeight=function(){return Ri*Os};var so=t.__private__.setLineHeightFactor=t.setLineHeightFactor=function(Ye){return typeof(Ye=Ye||1.15)=="number"&&(Os=Ye),this},ao=t.__private__.getLineHeightFactor=t.getLineHeightFactor=function(){return Os};so(Ie.lineHeight);var rs=t.__private__.getHorizontalCoordinate=function(Ye){return ai(Ye)},ps=t.__private__.getVerticalCoordinate=function(Ye){return De===ke.ADVANCED?Ye:mn[Ge].mediaBox.topRightY-mn[Ge].mediaBox.bottomLeftY-ai(Ye)},il=t.__private__.getHorizontalCoordinateString=t.getHorizontalCoordinateString=function(Ye){return Ke(rs(Ye))},gs=t.__private__.getVerticalCoordinateString=t.getVerticalCoordinateString=function(Ye){return Ke(ps(Ye))},Wr=Ie.strokeColor||"0 G";t.__private__.getStrokeColor=t.getDrawColor=function(){return _r(Wr)},t.__private__.setStrokeColor=t.setDrawColor=function(Ye,mi,ji,Wi){return Wr=Cr({ch1:Ye,ch2:mi,ch3:ji,ch4:Wi,pdfColorType:"draw",precision:2}),Qe(Wr),this};var ya=Ie.fillColor||"0 g";t.__private__.getFillColor=t.getFillColor=function(){return _r(ya)},t.__private__.setFillColor=t.setFillColor=function(Ye,mi,ji,Wi){return ya=Cr({ch1:Ye,ch2:mi,ch3:ji,ch4:Wi,pdfColorType:"fill",precision:2}),Qe(ya),this};var Fs=Ie.textColor||"0 g",nl=t.__private__.getTextColor=t.getTextColor=function(){return _r(Fs)};t.__private__.setTextColor=t.setTextColor=function(Ye,mi,ji,Wi){return Fs=Cr({ch1:Ye,ch2:mi,ch3:ji,ch4:Wi,pdfColorType:"text",precision:3}),this};var Ys=Ie.charSpace,rl=t.__private__.getCharSpace=t.getCharSpace=function(){return parseFloat(Ys||0)};t.__private__.setCharSpace=t.setCharSpace=function(Ye){if(isNaN(Ye))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return Ys=Ye,this};var wa=0;t.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},t.__private__.setLineCap=t.setLineCap=function(Ye){var mi=t.CapJoinStyles[Ye];if(mi===void 0)throw new Error("Line cap style of '"+Ye+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return wa=mi,Qe(mi+" J"),this};var Sa=0;t.__private__.setLineJoin=t.setLineJoin=function(Ye){var mi=t.CapJoinStyles[Ye];if(mi===void 0)throw new Error("Line join style of '"+Ye+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Sa=mi,Qe(mi+" j"),this},t.__private__.setLineMiterLimit=t.__private__.setMiterLimit=t.setLineMiterLimit=t.setMiterLimit=function(Ye){if(Ye=Ye||0,isNaN(Ye))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return Qe(Ke(ai(Ye))+" M"),this},t.GState=j,t.setGState=function(Ye){(Ye=typeof Ye=="string"?on[bn[Ye]]:oo(null,Ye)).equals(En)||(Qe("/"+Ye.id+" gs"),En=Ye)};var oo=function(Ye,mi){if(!Ye||!bn[Ye]){var ji=!1;for(var Wi in on)if(on.hasOwnProperty(Wi)&&on[Wi].equals(mi)){ji=!0;break}if(ji)mi=on[Wi];else{var Ki="GS"+(Object.keys(on).length+1).toString(10);on[Ki]=mi,mi.id=Ki}return Ye&&(bn[Ye]=mi.id),Pn.publish("addGState",mi),mi}};t.addGState=function(Ye,mi){return oo(Ye,mi),this},t.saveGraphicsState=function(){return Qe("q"),Bi.push({key:pn,size:Ri,color:Fs}),this},t.restoreGraphicsState=function(){Qe("Q");var Ye=Bi.pop();return pn=Ye.key,Ri=Ye.size,Fs=Ye.color,En=null,this},t.setCurrentTransformationMatrix=function(Ye){return Qe(Ye.toString()+" cm"),this},t.comment=function(Ye){return Qe("#"+Ye),this};var Ks=function(Ye,mi){var ji=Ye||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return ji},set:function(sn){isNaN(sn)||(ji=parseFloat(sn))}});var Wi=mi||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return Wi},set:function(sn){isNaN(sn)||(Wi=parseFloat(sn))}});var Ki="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return Ki},set:function(sn){Ki=sn.toString()}}),this},Aa=function(Ye,mi,ji,Wi){Ks.call(this,Ye,mi),this.type="rect";var Ki=ji||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return Ki},set:function(gn){isNaN(gn)||(Ki=parseFloat(gn))}});var sn=Wi||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return sn},set:function(gn){isNaN(gn)||(sn=parseFloat(gn))}}),this},xa=function(){this.page=vn,this.currentPage=Ge,this.pages=Fi.slice(0),this.pagesContext=mn.slice(0),this.x=kn,this.y=xn,this.matrix=Tn,this.width=Ms(Ge),this.height=ms(Ge),this.outputDestination=Ti,this.id="",this.objectNumber=-1};xa.prototype.restore=function(){vn=this.page,Ge=this.currentPage,mn=this.pagesContext,Fi=this.pages,kn=this.x,xn=this.y,Tn=this.matrix,Ca(Ge,this.width),Ta(Ge,this.height),Ti=this.outputDestination};var lo=function(Ye,mi,ji,Wi,Ki){Fn.push(new xa),vn=Ge=0,Fi=[],kn=Ye,xn=mi,Tn=Ki,pa([ji,Wi])},sl=function(Ye){if(zn[Ye])Fn.pop().restore();else{var mi=new xa,ji="Xo"+(Object.keys(Mn).length+1).toString(10);mi.id=ji,zn[Ye]=ji,Mn[ji]=mi,Pn.publish("addFormObject",mi),Fn.pop().restore()}};for(var $s in t.beginFormObject=function(Ye,mi,ji,Wi,Ki){return lo(Ye,mi,ji,Wi,Ki),this},t.endFormObject=function(Ye){return sl(Ye),this},t.doFormObject=function(Ye,mi){var ji=Mn[zn[Ye]];return Qe("q"),Qe(mi.toString()+" cm"),Qe("/"+ji.id+" Do"),Qe("Q"),this},t.getFormObject=function(Ye){var mi=Mn[zn[Ye]];return{x:mi.x,y:mi.y,width:mi.width,height:mi.height,matrix:mi.matrix}},t.save=function(Ye,mi){return Ye=Ye||"generated.pdf",(mi=mi||{}).returnPromise=mi.returnPromise||!1,mi.returnPromise===!1?(l(Hs(ns()),Ye),typeof l.unload=="function"&&n.setTimeout&&setTimeout(l.unload,911),this):new Promise(function(ji,Wi){try{var Ki=l(Hs(ns()),Ye);typeof l.unload=="function"&&n.setTimeout&&setTimeout(l.unload,911),ji(Ki)}catch(sn){Wi(sn.message)}})},E.API)E.API.hasOwnProperty($s)&&($s==="events"&&E.API.events.length?function(Ye,mi){var ji,Wi,Ki;for(Ki=mi.length-1;Ki!==-1;Ki--)ji=mi[Ki][0],Wi=mi[Ki][1],Ye.subscribe.apply(Ye,[ji].concat(typeof Wi=="function"?[Wi]:Wi))}(Pn,E.API.events):t[$s]=E.API[$s]);var Ms=t.getPageWidth=function(Ye){return(mn[Ye=Ye||Ge].mediaBox.topRightX-mn[Ye].mediaBox.bottomLeftX)/an},Ca=t.setPageWidth=function(Ye,mi){mn[Ye].mediaBox.topRightX=mi*an+mn[Ye].mediaBox.bottomLeftX},ms=t.getPageHeight=function(Ye){return(mn[Ye=Ye||Ge].mediaBox.topRightY-mn[Ye].mediaBox.bottomLeftY)/an},Ta=t.setPageHeight=function(Ye,mi){mn[Ye].mediaBox.topRightY=mi*an+mn[Ye].mediaBox.bottomLeftY};return t.internal={pdfEscape:Tr,getStyle:eo,getFont:el,getFontSize:ki,getCharSpace:rl,getTextColor:nl,getLineHeight:ro,getLineHeightFactor:ao,getLineWidth:Gs,write:ui,getHorizontalCoordinate:rs,getVerticalCoordinate:ps,getCoordinateString:il,getVerticalCoordinateString:gs,collections:{},newObject:Wn,newAdditionalObject:rr,newObjectDeferred:Gn,newObjectDeferredBegin:sr,getFilters:Jr,putStream:Dr,events:Pn,scaleFactor:an,pageSize:{getWidth:function(){return Ms(Ge)},setWidth:function(Ye){Ca(Ge,Ye)},getHeight:function(){return ms(Ge)},setHeight:function(Ye){Ta(Ge,Ye)}},encryptionOptions:Te,encryption:Sr,getEncryptor:Ko,output:Xs,getNumberOfPages:Ho,pages:Fi,out:Qe,f2:oi,f3:ti,getPageInfo:to,getPageInfoByObjId:Nn,getCurrentPageInfo:$o,getPDFVersion:Pe,Point:Ks,Rectangle:Aa,Matrix:Cn,hasHotfix:Za},Object.defineProperty(t.internal.pageSize,"width",{get:function(){return Ms(Ge)},set:function(Ye){Ca(Ge,Ye)},enumerable:!0,configurable:!0}),Object.defineProperty(t.internal.pageSize,"height",{get:function(){return ms(Ge)},set:function(Ye){Ta(Ge,Ye)},enumerable:!0,configurable:!0}),zo.call(t,_i),pn="F1",$a(Be,Me),Pn.publish("initialized"),t}I.prototype.lsbFirstWord=function(Ie){return String.fromCharCode(Ie>>0&255,Ie>>8&255,Ie>>16&255,Ie>>24&255)},I.prototype.toHexString=function(Ie){return Ie.split("").map(function(r){return("0"+(255&r.charCodeAt(0)).toString(16)).slice(-2)}).join("")},I.prototype.hexToBytes=function(Ie){for(var r=[],Me=0;Me<Ie.length;Me+=2)r.push(String.fromCharCode(parseInt(Ie.substr(Me,2),16)));return r.join("")},I.prototype.processOwnerPassword=function(Ie,r){return P(x(r).substr(0,5),Ie)},I.prototype.encryptor=function(Ie,r){var Me=x(this.encryptionKey+String.fromCharCode(255&Ie,Ie>>8&255,Ie>>16&255,255&r,r>>8&255)).substr(0,10);return function(Oe){return P(Me,Oe)}},j.prototype.equals=function(Ie){var r,Me="id,objectNumber,equals";if(!Ie||_typeof(Ie)!==_typeof(this))return!1;var Oe=0;for(r in this)if(!(Me.indexOf(r)>=0)){if(this.hasOwnProperty(r)&&!Ie.hasOwnProperty(r)||this[r]!==Ie[r])return!1;Oe++}for(r in Ie)Ie.hasOwnProperty(r)&&Me.indexOf(r)<0&&Oe--;return Oe===0},E.API={events:[]},E.version="2.5.1";var q=E.API,D=1,R=function(Ie){return Ie.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},T=function(Ie){return Ie.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},U=function(Ie){return Ie.toFixed(2)},z=function(Ie){return Ie.toFixed(5)};q.__acroform__={};var H=function(Ie,r){Ie.prototype=Object.create(r.prototype),Ie.prototype.constructor=Ie},W=function(Ie){return Ie*D},V=function(Ie){var r=new ut,Me=At.internal.getHeight(Ie)||0,Oe=At.internal.getWidth(Ie)||0;return r.BBox=[0,0,Number(U(Oe)),Number(U(Me))],r},G=q.__acroform__.setBit=function(Ie,r){if(Ie=Ie||0,r=r||0,isNaN(Ie)||isNaN(r))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return Ie|=1<<r},Y=q.__acroform__.clearBit=function(Ie,r){if(Ie=Ie||0,r=r||0,isNaN(Ie)||isNaN(r))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return Ie&=~(1<<r)},J=q.__acroform__.getBit=function(Ie,r){if(isNaN(Ie)||isNaN(r))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return(Ie&1<<r)==0?0:1},X=q.__acroform__.getBitForPdf=function(Ie,r){if(isNaN(Ie)||isNaN(r))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return J(Ie,r-1)},K=q.__acroform__.setBitForPdf=function(Ie,r){if(isNaN(Ie)||isNaN(r))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return G(Ie,r-1)},Z=q.__acroform__.clearBitForPdf=function(Ie,r){if(isNaN(Ie)||isNaN(r))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return Y(Ie,r-1)},$=q.__acroform__.calculateCoordinates=function(Ie,r){var Me=r.internal.getHorizontalCoordinate,Oe=r.internal.getVerticalCoordinate,Be=Ie[0],Ue=Ie[1],He=Ie[2],Ee=Ie[3],e={};return e.lowerLeft_X=Me(Be)||0,e.lowerLeft_Y=Oe(Ue+Ee)||0,e.upperRight_X=Me(Be+He)||0,e.upperRight_Y=Oe(Ue)||0,[Number(U(e.lowerLeft_X)),Number(U(e.lowerLeft_Y)),Number(U(e.upperRight_X)),Number(U(e.upperRight_Y))]},Q=function(Ie){if(Ie.appearanceStreamContent)return Ie.appearanceStreamContent;if(Ie.V||Ie.DV){var r=[],Me=Ie._V||Ie.DV,Oe=tt(Ie,Me),Be=Ie.scope.internal.getFont(Ie.fontName,Ie.fontStyle).id;r.push("/Tx BMC"),r.push("q"),r.push("BT"),r.push(Ie.scope.__private__.encodeColorString(Ie.color)),r.push("/"+Be+" "+U(Oe.fontSize)+" Tf"),r.push("1 0 0 1 0 0 Tm"),r.push(Oe.text),r.push("ET"),r.push("Q"),r.push("EMC");var Ue=V(Ie);return Ue.scope=Ie.scope,Ue.stream=r.join(`
`),Ue}},tt=function(Ie,r){var Me=Ie.fontSize===0?Ie.maxFontSize:Ie.fontSize,Oe={text:"",fontSize:""},Be=(r=(r=r.substr(0,1)=="("?r.substr(1):r).substr(r.length-1)==")"?r.substr(0,r.length-1):r).split(" ");Be=Ie.multiline?Be.map(function(ti){return ti.split(`
`)}):Be.map(function(ti){return[ti]});var Ue=Me,He=At.internal.getHeight(Ie)||0;He=He<0?-He:He;var Ee=At.internal.getWidth(Ie)||0;Ee=Ee<0?-Ee:Ee;var e=function(ti,ai,yi){if(ti+1<Be.length){var di=ai+" "+Be[ti+1][0];return et(di,Ie,yi).width<=Ee-4}return!1};Ue++;t:for(;Ue>0;){r="",Ue--;var xe,Te,_e=et("3",Ie,Ue).height,Se=Ie.multiline?He-Ue:(He-_e)/2,t=Se+=2,Ae=0,Pe=0,St=0;if(Ue<=0){r=`(...) Tj
`,r+="% Width of Text: "+et(r,Ie,Ue=12).width+", FieldWidth:"+Ee+`
`;break}for(var Ce="",ke=0,De=0;De<Be.length;De++)if(Be.hasOwnProperty(De)){var Re=!1;if(Be[De].length!==1&&St!==Be[De].length-1){if((_e+2)*(ke+2)+2>He)continue t;Ce+=Be[De][St],Re=!0,Pe=De,De--}else{Ce=(Ce+=Be[De][St]+" ").substr(Ce.length-1)==" "?Ce.substr(0,Ce.length-1):Ce;var je=parseInt(De),We=e(je,Ce,Ue),Ke=De>=Be.length-1;if(We&&!Ke){Ce+=" ",St=0;continue}if(We||Ke){if(Ke)Pe=je;else if(Ie.multiline&&(_e+2)*(ke+2)+2>He)continue t}else{if(!Ie.multiline||(_e+2)*(ke+2)+2>He)continue t;Pe=je}}for(var Je="",hi=Ae;hi<=Pe;hi++){var oi=Be[hi];if(Ie.multiline){if(hi===Pe){Je+=oi[St]+" ",St=(St+1)%oi.length;continue}if(hi===Ae){Je+=oi[oi.length-1]+" ";continue}}Je+=oi[0]+" "}switch(Je=Je.substr(Je.length-1)==" "?Je.substr(0,Je.length-1):Je,Te=et(Je,Ie,Ue).width,Ie.textAlign){case"right":xe=Ee-Te-2;break;case"center":xe=(Ee-Te)/2;break;case"left":default:xe=2}r+=U(xe)+" "+U(t)+` Td
`,r+="("+R(Je)+`) Tj
`,r+=-U(xe)+` 0 Td
`,t=-(Ue+2),Te=0,Ae=Re?Pe:Pe+1,ke++,Ce=""}break}return Oe.text=r,Oe.fontSize=Ue,Oe},et=function(Ie,r,Me){var Oe=r.scope.internal.getFont(r.fontName,r.fontStyle),Be=r.scope.getStringUnitWidth(Ie,{font:Oe,fontSize:parseFloat(Me),charSpace:0})*parseFloat(Me);return{height:r.scope.getStringUnitWidth("3",{font:Oe,fontSize:parseFloat(Me),charSpace:0})*parseFloat(Me)*1.5,width:Be}},rt={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},nt=function(Ie,r){var Me={type:"reference",object:Ie};r.internal.getPageInfo(Ie.page).pageContext.annotations.find(function(Oe){return Oe.type===Me.type&&Oe.object===Me.object})===void 0&&r.internal.getPageInfo(Ie.page).pageContext.annotations.push(Me)},it=function(Ie,r){for(var Me in Ie)if(Ie.hasOwnProperty(Me)){var Oe=Me,Be=Ie[Me];r.internal.newObjectDeferredBegin(Be.objId,!0),_typeof(Be)==="object"&&typeof Be.putStream=="function"&&Be.putStream(),delete Ie[Oe]}},at=function(Ie,r){if(r.scope=Ie,Ie.internal!==void 0&&(Ie.internal.acroformPlugin===void 0||Ie.internal.acroformPlugin.isInitialized===!1)){if(lt.FieldNum=0,Ie.internal.acroformPlugin=JSON.parse(JSON.stringify(rt)),Ie.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");D=Ie.internal.scaleFactor,Ie.internal.acroformPlugin.acroFormDictionaryRoot=new ht,Ie.internal.acroformPlugin.acroFormDictionaryRoot.scope=Ie,Ie.internal.acroformPlugin.acroFormDictionaryRoot._eventID=Ie.internal.events.subscribe("postPutResources",function(){(function(Me){Me.internal.events.unsubscribe(Me.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete Me.internal.acroformPlugin.acroFormDictionaryRoot._eventID,Me.internal.acroformPlugin.printedOut=!0})(Ie)}),Ie.internal.events.subscribe("buildDocument",function(){(function(Me){Me.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var Oe=Me.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var Be in Oe)if(Oe.hasOwnProperty(Be)){var Ue=Oe[Be];Ue.objId=void 0,Ue.hasAnnotation&&nt(Ue,Me)}})(Ie)}),Ie.internal.events.subscribe("putCatalog",function(){(function(Me){if(Me.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");Me.internal.write("/AcroForm "+Me.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(Ie)}),Ie.internal.events.subscribe("postPutPages",function(Me){(function(Oe,Be){var Ue=!Oe;for(var He in Oe||(Be.internal.newObjectDeferredBegin(Be.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),Be.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),Oe=Oe||Be.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(Oe.hasOwnProperty(He)){var Ee=Oe[He],e=[],xe=Ee.Rect;if(Ee.Rect&&(Ee.Rect=$(Ee.Rect,Be)),Be.internal.newObjectDeferredBegin(Ee.objId,!0),Ee.DA=At.createDefaultAppearanceStream(Ee),_typeof(Ee)==="object"&&typeof Ee.getKeyValueListForStream=="function"&&(e=Ee.getKeyValueListForStream()),Ee.Rect=xe,Ee.hasAppearanceStream&&!Ee.appearanceStreamContent){var Te=Q(Ee);e.push({key:"AP",value:"<</N "+Te+">>"}),Be.internal.acroformPlugin.xForms.push(Te)}if(Ee.appearanceStreamContent){var _e="";for(var Se in Ee.appearanceStreamContent)if(Ee.appearanceStreamContent.hasOwnProperty(Se)){var t=Ee.appearanceStreamContent[Se];if(_e+="/"+Se+" ",_e+="<<",Object.keys(t).length>=1||Array.isArray(t)){for(var He in t)if(t.hasOwnProperty(He)){var Ae=t[He];typeof Ae=="function"&&(Ae=Ae.call(Be,Ee)),_e+="/"+He+" "+Ae+" ",Be.internal.acroformPlugin.xForms.indexOf(Ae)>=0||Be.internal.acroformPlugin.xForms.push(Ae)}}else typeof(Ae=t)=="function"&&(Ae=Ae.call(Be,Ee)),_e+="/"+He+" "+Ae,Be.internal.acroformPlugin.xForms.indexOf(Ae)>=0||Be.internal.acroformPlugin.xForms.push(Ae);_e+=">>"}e.push({key:"AP",value:`<<
`+_e+">>"})}Be.internal.putStream({additionalKeyValues:e,objectId:Ee.objId}),Be.internal.out("endobj")}Ue&&it(Be.internal.acroformPlugin.xForms,Be)})(Me,Ie)}),Ie.internal.acroformPlugin.isInitialized=!0}},ot=q.__acroform__.arrayToPdfArray=function(Ie,r,Me){var Oe=function(He){return He};if(Array.isArray(Ie)){for(var Be="[",Ue=0;Ue<Ie.length;Ue++)switch(Ue!==0&&(Be+=" "),_typeof(Ie[Ue])){case"boolean":case"number":case"object":Be+=Ie[Ue].toString();break;case"string":Ie[Ue].substr(0,1)!=="/"?(r!==void 0&&Me&&(Oe=Me.internal.getEncryptor(r)),Be+="("+R(Oe(Ie[Ue].toString()))+")"):Be+=Ie[Ue].toString()}return Be+="]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},st=function(Ie,r,Me){var Oe=function(Be){return Be};return r!==void 0&&Me&&(Oe=Me.internal.getEncryptor(r)),(Ie=Ie||"").toString(),Ie="("+R(Oe(Ie))+")"},ct=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(Ie){this._objId=Ie}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};ct.prototype.toString=function(){return this.objId+" 0 R"},ct.prototype.putStream=function(){var Ie=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:Ie,objectId:this.objId}),this.scope.internal.out("endobj")},ct.prototype.getKeyValueListForStream=function(){var Ie=[],r=Object.getOwnPropertyNames(this).filter(function(Ue){return Ue!="content"&&Ue!="appearanceStreamContent"&&Ue!="scope"&&Ue!="objId"&&Ue.substring(0,1)!="_"});for(var Me in r)if(Object.getOwnPropertyDescriptor(this,r[Me]).configurable===!1){var Oe=r[Me],Be=this[Oe];Be&&(Array.isArray(Be)?Ie.push({key:Oe,value:ot(Be,this.objId,this.scope)}):Be instanceof ct?(Be.scope=this.scope,Ie.push({key:Oe,value:Be.objId+" 0 R"})):typeof Be!="function"&&Ie.push({key:Oe,value:Be}))}return Ie};var ut=function(){ct.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var Ie,r=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return r},set:function(Me){r=Me}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(Me){Ie=Me.trim()},get:function(){return Ie||null}})};H(ut,ct);var ht=function(){ct.call(this);var Ie,r=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return r.length>0?r:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return r}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(Ie){var Me=function(Oe){return Oe};return this.scope&&(Me=this.scope.internal.getEncryptor(this.objId)),"("+R(Me(Ie))+")"}},set:function(Me){Ie=Me}})};H(ht,ct);var lt=function Ie(){ct.call(this);var r=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return r},set:function(Ce){if(isNaN(Ce))throw new Error('Invalid value "'+Ce+'" for attribute F supplied.');r=Ce}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return Boolean(X(r,3))},set:function(Ce){Boolean(Ce)===!0?this.F=K(r,3):this.F=Z(r,3)}});var Me=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return Me},set:function(Ce){if(isNaN(Ce))throw new Error('Invalid value "'+Ce+'" for attribute Ff supplied.');Me=Ce}});var Oe=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(Oe.length!==0)return Oe},set:function(Ce){Oe=Ce!==void 0?Ce:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!Oe||isNaN(Oe[0])?0:Oe[0]},set:function(Ce){Oe[0]=Ce}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!Oe||isNaN(Oe[1])?0:Oe[1]},set:function(Ce){Oe[1]=Ce}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!Oe||isNaN(Oe[2])?0:Oe[2]},set:function(Ce){Oe[2]=Ce}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!Oe||isNaN(Oe[3])?0:Oe[3]},set:function(Ce){Oe[3]=Ce}});var Be="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return Be},set:function(Ce){switch(Ce){case"/Btn":case"/Tx":case"/Ch":case"/Sig":Be=Ce;break;default:throw new Error('Invalid value "'+Ce+'" for attribute FT supplied.')}}});var Ue=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!Ue||Ue.length<1){if(this instanceof yt)return;Ue="FieldObject"+Ie.FieldNum++}var Ce=function(ke){return ke};return this.scope&&(Ce=this.scope.internal.getEncryptor(this.objId)),"("+R(Ce(Ue))+")"},set:function(Ce){Ue=Ce.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return Ue},set:function(Ce){Ue=Ce}});var He="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return He},set:function(Ce){He=Ce}});var Ee="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return Ee},set:function(Ce){Ee=Ce}});var e=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return e},set:function(Ce){e=Ce}});var xe=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return xe===void 0?50/D:xe},set:function(Ce){xe=Ce}});var Te="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return Te},set:function(Ce){Te=Ce}});var _e="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!_e||this instanceof yt||this instanceof Nt))return st(_e,this.objId,this.scope)},set:function(Ce){Ce=Ce.toString(),_e=Ce}});var Se=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(Se)return this instanceof mt?Se:st(Se,this.objId,this.scope)},set:function(Ce){Ce=Ce.toString(),Se=this instanceof mt?Ce:Ce.substr(0,1)==="("?T(Ce.substr(1,Ce.length-2)):T(Ce)}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof mt?T(Se.substr(1,Se.length-1)):Se},set:function(Ce){Ce=Ce.toString(),Se=this instanceof mt?"/"+Ce:Ce}});var t=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(t)return t},set:function(Ce){this.V=Ce}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(t)return this instanceof mt?t:st(t,this.objId,this.scope)},set:function(Ce){Ce=Ce.toString(),t=this instanceof mt?Ce:Ce.substr(0,1)==="("?T(Ce.substr(1,Ce.length-2)):T(Ce)}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof mt?T(t.substr(1,t.length-1)):t},set:function(Ce){Ce=Ce.toString(),t=this instanceof mt?"/"+Ce:Ce}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var Ae,Pe=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return Pe},set:function(Ce){Ce=Boolean(Ce),Pe=Ce}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(Ae)return Ae},set:function(Ce){Ae=Ce}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return Boolean(X(this.Ff,1))},set:function(Ce){Boolean(Ce)===!0?this.Ff=K(this.Ff,1):this.Ff=Z(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return Boolean(X(this.Ff,2))},set:function(Ce){Boolean(Ce)===!0?this.Ff=K(this.Ff,2):this.Ff=Z(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return Boolean(X(this.Ff,3))},set:function(Ce){Boolean(Ce)===!0?this.Ff=K(this.Ff,3):this.Ff=Z(this.Ff,3)}});var St=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(St!==null)return St},set:function(Ce){if([0,1,2].indexOf(Ce)===-1)throw new Error('Invalid value "'+Ce+'" for attribute Q supplied.');St=Ce}}),Object.defineProperty(this,"textAlign",{get:function(){var Ce;switch(St){case 0:default:Ce="left";break;case 1:Ce="center";break;case 2:Ce="right"}return Ce},configurable:!0,enumerable:!0,set:function(Ce){switch(Ce){case"right":case 2:St=2;break;case"center":case 1:St=1;break;case"left":case 0:default:St=0}}})};H(lt,ct);var ft=function(){lt.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var Ie=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return Ie},set:function(Me){Ie=Me}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return Ie},set:function(Me){Ie=Me}});var r=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return ot(r,this.objId,this.scope)},set:function(Me){var Oe,Be;Be=[],typeof(Oe=Me)=="string"&&(Be=function(Ue,He,Ee){Ee||(Ee=1);for(var e,xe=[];e=He.exec(Ue);)xe.push(e[Ee]);return xe}(Oe,/\((.*?)\)/g)),r=Be}}),this.getOptions=function(){return r},this.setOptions=function(Me){r=Me,this.sort&&r.sort()},this.addOption=function(Me){Me=(Me=Me||"").toString(),r.push(Me),this.sort&&r.sort()},this.removeOption=function(Me,Oe){for(Oe=Oe||!1,Me=(Me=Me||"").toString();r.indexOf(Me)!==-1&&(r.splice(r.indexOf(Me),1),Oe!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return Boolean(X(this.Ff,18))},set:function(Me){Boolean(Me)===!0?this.Ff=K(this.Ff,18):this.Ff=Z(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return Boolean(X(this.Ff,19))},set:function(Me){this.combo===!0&&(Boolean(Me)===!0?this.Ff=K(this.Ff,19):this.Ff=Z(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return Boolean(X(this.Ff,20))},set:function(Me){Boolean(Me)===!0?(this.Ff=K(this.Ff,20),r.sort()):this.Ff=Z(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return Boolean(X(this.Ff,22))},set:function(Me){Boolean(Me)===!0?this.Ff=K(this.Ff,22):this.Ff=Z(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return Boolean(X(this.Ff,23))},set:function(Me){Boolean(Me)===!0?this.Ff=K(this.Ff,23):this.Ff=Z(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return Boolean(X(this.Ff,27))},set:function(Me){Boolean(Me)===!0?this.Ff=K(this.Ff,27):this.Ff=Z(this.Ff,27)}}),this.hasAppearanceStream=!1};H(ft,lt);var dt=function(){ft.call(this),this.fontName="helvetica",this.combo=!1};H(dt,ft);var pt=function(){dt.call(this),this.combo=!0};H(pt,dt);var gt=function(){pt.call(this),this.edit=!0};H(gt,pt);var mt=function(){lt.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return Boolean(X(this.Ff,15))},set:function(Me){Boolean(Me)===!0?this.Ff=K(this.Ff,15):this.Ff=Z(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return Boolean(X(this.Ff,16))},set:function(Me){Boolean(Me)===!0?this.Ff=K(this.Ff,16):this.Ff=Z(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return Boolean(X(this.Ff,17))},set:function(Me){Boolean(Me)===!0?this.Ff=K(this.Ff,17):this.Ff=Z(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return Boolean(X(this.Ff,26))},set:function(Me){Boolean(Me)===!0?this.Ff=K(this.Ff,26):this.Ff=Z(this.Ff,26)}});var Ie,r={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var Me=function(Ue){return Ue};if(this.scope&&(Me=this.scope.internal.getEncryptor(this.objId)),Object.keys(r).length!==0){var Oe,Be=[];for(Oe in Be.push("<<"),r)Be.push("/"+Oe+" ("+R(Me(r[Oe]))+")");return Be.push(">>"),Be.join(`
`)}},set:function(Me){_typeof(Me)==="object"&&(r=Me)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return r.CA||""},set:function(Me){typeof Me=="string"&&(r.CA=Me)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return Ie},set:function(Me){Ie=Me}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return Ie.substr(1,Ie.length-1)},set:function(Me){Ie="/"+Me}})};H(mt,lt);var vt=function(){mt.call(this),this.pushButton=!0};H(vt,mt);var bt=function(){mt.call(this),this.radio=!0,this.pushButton=!1;var Ie=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return Ie},set:function(r){Ie=r!==void 0?r:[]}})};H(bt,mt);var yt=function(){var Ie,r;lt.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return Ie},set:function(Be){Ie=Be}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return r},set:function(Be){r=Be}});var Me,Oe={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var Be=function(Ee){return Ee};this.scope&&(Be=this.scope.internal.getEncryptor(this.objId));var Ue,He=[];for(Ue in He.push("<<"),Oe)He.push("/"+Ue+" ("+R(Be(Oe[Ue]))+")");return He.push(">>"),He.join(`
`)},set:function(Be){_typeof(Be)==="object"&&(Oe=Be)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return Oe.CA||""},set:function(Be){typeof Be=="string"&&(Oe.CA=Be)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return Me},set:function(Be){Me=Be}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return Me.substr(1,Me.length-1)},set:function(Be){Me="/"+Be}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=At.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};H(yt,lt),bt.prototype.setAppearance=function(Ie){if(!("createAppearanceStream"in Ie)||!("getCA"in Ie))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var r in this.Kids)if(this.Kids.hasOwnProperty(r)){var Me=this.Kids[r];Me.appearanceStreamContent=Ie.createAppearanceStream(Me.optionName),Me.caption=Ie.getCA()}},bt.prototype.createOption=function(Ie){var r=new yt;return r.Parent=this,r.optionName=Ie,this.Kids.push(r),xt.call(this.scope,r),r};var wt=function(){mt.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=At.CheckBox.createAppearanceStream()};H(wt,mt);var Nt=function(){lt.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return Boolean(X(this.Ff,13))},set:function(r){Boolean(r)===!0?this.Ff=K(this.Ff,13):this.Ff=Z(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return Boolean(X(this.Ff,21))},set:function(r){Boolean(r)===!0?this.Ff=K(this.Ff,21):this.Ff=Z(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return Boolean(X(this.Ff,23))},set:function(r){Boolean(r)===!0?this.Ff=K(this.Ff,23):this.Ff=Z(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return Boolean(X(this.Ff,24))},set:function(r){Boolean(r)===!0?this.Ff=K(this.Ff,24):this.Ff=Z(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return Boolean(X(this.Ff,25))},set:function(r){Boolean(r)===!0?this.Ff=K(this.Ff,25):this.Ff=Z(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return Boolean(X(this.Ff,26))},set:function(r){Boolean(r)===!0?this.Ff=K(this.Ff,26):this.Ff=Z(this.Ff,26)}});var Ie=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return Ie},set:function(r){Ie=r}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return Ie},set:function(r){Number.isInteger(r)&&(Ie=r)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};H(Nt,lt);var Lt=function(){Nt.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return Boolean(X(this.Ff,14))},set:function(Ie){Boolean(Ie)===!0?this.Ff=K(this.Ff,14):this.Ff=Z(this.Ff,14)}}),this.password=!0};H(Lt,Nt);var At={CheckBox:{createAppearanceStream:function(){return{N:{On:At.CheckBox.YesNormal},D:{On:At.CheckBox.YesPushDown,Off:At.CheckBox.OffPushDown}}},YesPushDown:function(Ie){var r=V(Ie);r.scope=Ie.scope;var Me=[],Oe=Ie.scope.internal.getFont(Ie.fontName,Ie.fontStyle).id,Be=Ie.scope.__private__.encodeColorString(Ie.color),Ue=tt(Ie,Ie.caption);return Me.push("0.749023 g"),Me.push("0 0 "+U(At.internal.getWidth(Ie))+" "+U(At.internal.getHeight(Ie))+" re"),Me.push("f"),Me.push("BMC"),Me.push("q"),Me.push("0 0 1 rg"),Me.push("/"+Oe+" "+U(Ue.fontSize)+" Tf "+Be),Me.push("BT"),Me.push(Ue.text),Me.push("ET"),Me.push("Q"),Me.push("EMC"),r.stream=Me.join(`
`),r},YesNormal:function(Ie){var r=V(Ie);r.scope=Ie.scope;var Me=Ie.scope.internal.getFont(Ie.fontName,Ie.fontStyle).id,Oe=Ie.scope.__private__.encodeColorString(Ie.color),Be=[],Ue=At.internal.getHeight(Ie),He=At.internal.getWidth(Ie),Ee=tt(Ie,Ie.caption);return Be.push("1 g"),Be.push("0 0 "+U(He)+" "+U(Ue)+" re"),Be.push("f"),Be.push("q"),Be.push("0 0 1 rg"),Be.push("0 0 "+U(He-1)+" "+U(Ue-1)+" re"),Be.push("W"),Be.push("n"),Be.push("0 g"),Be.push("BT"),Be.push("/"+Me+" "+U(Ee.fontSize)+" Tf "+Oe),Be.push(Ee.text),Be.push("ET"),Be.push("Q"),r.stream=Be.join(`
`),r},OffPushDown:function(Ie){var r=V(Ie);r.scope=Ie.scope;var Me=[];return Me.push("0.749023 g"),Me.push("0 0 "+U(At.internal.getWidth(Ie))+" "+U(At.internal.getHeight(Ie))+" re"),Me.push("f"),r.stream=Me.join(`
`),r}},RadioButton:{Circle:{createAppearanceStream:function(Ie){var r={D:{Off:At.RadioButton.Circle.OffPushDown},N:{}};return r.N[Ie]=At.RadioButton.Circle.YesNormal,r.D[Ie]=At.RadioButton.Circle.YesPushDown,r},getCA:function(){return"l"},YesNormal:function(Ie){var r=V(Ie);r.scope=Ie.scope;var Me=[],Oe=At.internal.getWidth(Ie)<=At.internal.getHeight(Ie)?At.internal.getWidth(Ie)/4:At.internal.getHeight(Ie)/4;Oe=Number((.9*Oe).toFixed(5));var Be=At.internal.Bezier_C,Ue=Number((Oe*Be).toFixed(5));return Me.push("q"),Me.push("1 0 0 1 "+z(At.internal.getWidth(Ie)/2)+" "+z(At.internal.getHeight(Ie)/2)+" cm"),Me.push(Oe+" 0 m"),Me.push(Oe+" "+Ue+" "+Ue+" "+Oe+" 0 "+Oe+" c"),Me.push("-"+Ue+" "+Oe+" -"+Oe+" "+Ue+" -"+Oe+" 0 c"),Me.push("-"+Oe+" -"+Ue+" -"+Ue+" -"+Oe+" 0 -"+Oe+" c"),Me.push(Ue+" -"+Oe+" "+Oe+" -"+Ue+" "+Oe+" 0 c"),Me.push("f"),Me.push("Q"),r.stream=Me.join(`
`),r},YesPushDown:function(Ie){var r=V(Ie);r.scope=Ie.scope;var Me=[],Oe=At.internal.getWidth(Ie)<=At.internal.getHeight(Ie)?At.internal.getWidth(Ie)/4:At.internal.getHeight(Ie)/4;Oe=Number((.9*Oe).toFixed(5));var Be=Number((2*Oe).toFixed(5)),Ue=Number((Be*At.internal.Bezier_C).toFixed(5)),He=Number((Oe*At.internal.Bezier_C).toFixed(5));return Me.push("0.749023 g"),Me.push("q"),Me.push("1 0 0 1 "+z(At.internal.getWidth(Ie)/2)+" "+z(At.internal.getHeight(Ie)/2)+" cm"),Me.push(Be+" 0 m"),Me.push(Be+" "+Ue+" "+Ue+" "+Be+" 0 "+Be+" c"),Me.push("-"+Ue+" "+Be+" -"+Be+" "+Ue+" -"+Be+" 0 c"),Me.push("-"+Be+" -"+Ue+" -"+Ue+" -"+Be+" 0 -"+Be+" c"),Me.push(Ue+" -"+Be+" "+Be+" -"+Ue+" "+Be+" 0 c"),Me.push("f"),Me.push("Q"),Me.push("0 g"),Me.push("q"),Me.push("1 0 0 1 "+z(At.internal.getWidth(Ie)/2)+" "+z(At.internal.getHeight(Ie)/2)+" cm"),Me.push(Oe+" 0 m"),Me.push(Oe+" "+He+" "+He+" "+Oe+" 0 "+Oe+" c"),Me.push("-"+He+" "+Oe+" -"+Oe+" "+He+" -"+Oe+" 0 c"),Me.push("-"+Oe+" -"+He+" -"+He+" -"+Oe+" 0 -"+Oe+" c"),Me.push(He+" -"+Oe+" "+Oe+" -"+He+" "+Oe+" 0 c"),Me.push("f"),Me.push("Q"),r.stream=Me.join(`
`),r},OffPushDown:function(Ie){var r=V(Ie);r.scope=Ie.scope;var Me=[],Oe=At.internal.getWidth(Ie)<=At.internal.getHeight(Ie)?At.internal.getWidth(Ie)/4:At.internal.getHeight(Ie)/4;Oe=Number((.9*Oe).toFixed(5));var Be=Number((2*Oe).toFixed(5)),Ue=Number((Be*At.internal.Bezier_C).toFixed(5));return Me.push("0.749023 g"),Me.push("q"),Me.push("1 0 0 1 "+z(At.internal.getWidth(Ie)/2)+" "+z(At.internal.getHeight(Ie)/2)+" cm"),Me.push(Be+" 0 m"),Me.push(Be+" "+Ue+" "+Ue+" "+Be+" 0 "+Be+" c"),Me.push("-"+Ue+" "+Be+" -"+Be+" "+Ue+" -"+Be+" 0 c"),Me.push("-"+Be+" -"+Ue+" -"+Ue+" -"+Be+" 0 -"+Be+" c"),Me.push(Ue+" -"+Be+" "+Be+" -"+Ue+" "+Be+" 0 c"),Me.push("f"),Me.push("Q"),r.stream=Me.join(`
`),r}},Cross:{createAppearanceStream:function(Ie){var r={D:{Off:At.RadioButton.Cross.OffPushDown},N:{}};return r.N[Ie]=At.RadioButton.Cross.YesNormal,r.D[Ie]=At.RadioButton.Cross.YesPushDown,r},getCA:function(){return"8"},YesNormal:function(Ie){var r=V(Ie);r.scope=Ie.scope;var Me=[],Oe=At.internal.calculateCross(Ie);return Me.push("q"),Me.push("1 1 "+U(At.internal.getWidth(Ie)-2)+" "+U(At.internal.getHeight(Ie)-2)+" re"),Me.push("W"),Me.push("n"),Me.push(U(Oe.x1.x)+" "+U(Oe.x1.y)+" m"),Me.push(U(Oe.x2.x)+" "+U(Oe.x2.y)+" l"),Me.push(U(Oe.x4.x)+" "+U(Oe.x4.y)+" m"),Me.push(U(Oe.x3.x)+" "+U(Oe.x3.y)+" l"),Me.push("s"),Me.push("Q"),r.stream=Me.join(`
`),r},YesPushDown:function(Ie){var r=V(Ie);r.scope=Ie.scope;var Me=At.internal.calculateCross(Ie),Oe=[];return Oe.push("0.749023 g"),Oe.push("0 0 "+U(At.internal.getWidth(Ie))+" "+U(At.internal.getHeight(Ie))+" re"),Oe.push("f"),Oe.push("q"),Oe.push("1 1 "+U(At.internal.getWidth(Ie)-2)+" "+U(At.internal.getHeight(Ie)-2)+" re"),Oe.push("W"),Oe.push("n"),Oe.push(U(Me.x1.x)+" "+U(Me.x1.y)+" m"),Oe.push(U(Me.x2.x)+" "+U(Me.x2.y)+" l"),Oe.push(U(Me.x4.x)+" "+U(Me.x4.y)+" m"),Oe.push(U(Me.x3.x)+" "+U(Me.x3.y)+" l"),Oe.push("s"),Oe.push("Q"),r.stream=Oe.join(`
`),r},OffPushDown:function(Ie){var r=V(Ie);r.scope=Ie.scope;var Me=[];return Me.push("0.749023 g"),Me.push("0 0 "+U(At.internal.getWidth(Ie))+" "+U(At.internal.getHeight(Ie))+" re"),Me.push("f"),r.stream=Me.join(`
`),r}}},createDefaultAppearanceStream:function(Ie){var r=Ie.scope.internal.getFont(Ie.fontName,Ie.fontStyle).id,Me=Ie.scope.__private__.encodeColorString(Ie.color);return"/"+r+" "+Ie.fontSize+" Tf "+Me}};At.internal={Bezier_C:.551915024494,calculateCross:function(Ie){var r=At.internal.getWidth(Ie),Me=At.internal.getHeight(Ie),Oe=Math.min(r,Me);return{x1:{x:(r-Oe)/2,y:(Me-Oe)/2+Oe},x2:{x:(r-Oe)/2+Oe,y:(Me-Oe)/2},x3:{x:(r-Oe)/2,y:(Me-Oe)/2},x4:{x:(r-Oe)/2+Oe,y:(Me-Oe)/2+Oe}}}},At.internal.getWidth=function(Ie){var r=0;return _typeof(Ie)==="object"&&(r=W(Ie.Rect[2])),r},At.internal.getHeight=function(Ie){var r=0;return _typeof(Ie)==="object"&&(r=W(Ie.Rect[3])),r};var xt=q.addField=function(Ie){if(at(this,Ie),!(Ie instanceof lt))throw new Error("Invalid argument passed to jsPDF.addField.");var r;return(r=Ie).scope.internal.acroformPlugin.printedOut&&(r.scope.internal.acroformPlugin.printedOut=!1,r.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),r.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(r),Ie.page=Ie.scope.internal.getCurrentPageInfo().pageNumber,this};q.AcroFormChoiceField=ft,q.AcroFormListBox=dt,q.AcroFormComboBox=pt,q.AcroFormEditBox=gt,q.AcroFormButton=mt,q.AcroFormPushButton=vt,q.AcroFormRadioButton=bt,q.AcroFormCheckBox=wt,q.AcroFormTextField=Nt,q.AcroFormPasswordField=Lt,q.AcroFormAppearance=At,q.AcroForm={ChoiceField:ft,ListBox:dt,ComboBox:pt,EditBox:gt,Button:mt,PushButton:vt,RadioButton:bt,CheckBox:wt,TextField:Nt,PasswordField:Lt,Appearance:At},E.AcroForm={ChoiceField:ft,ListBox:dt,ComboBox:pt,EditBox:gt,Button:mt,PushButton:vt,RadioButton:bt,CheckBox:wt,TextField:Nt,PasswordField:Lt,Appearance:At};E.AcroForm;function _t(Ie){return Ie.reduce(function(r,Me,Oe){return r[Me]=Oe,r},{})}(function(Ie){Ie.__addimage__={};var r="UNKNOWN",Me={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},Oe=Ie.__addimage__.getImageFileTypeByImageData=function(ti,ai){var yi,di,bi,vi,Pi,xi=r;if((ai=ai||r)==="RGBA"||ti.data!==void 0&&ti.data instanceof Uint8ClampedArray&&"height"in ti&&"width"in ti)return"RGBA";if(We(ti))for(Pi in Me)for(bi=Me[Pi],yi=0;yi<bi.length;yi+=1){for(vi=!0,di=0;di<bi[yi].length;di+=1)if(bi[yi][di]!==void 0&&bi[yi][di]!==ti[di]){vi=!1;break}if(vi===!0){xi=Pi;break}}else for(Pi in Me)for(bi=Me[Pi],yi=0;yi<bi.length;yi+=1){for(vi=!0,di=0;di<bi[yi].length;di+=1)if(bi[yi][di]!==void 0&&bi[yi][di]!==ti.charCodeAt(di)){vi=!1;break}if(vi===!0){xi=Pi;break}}return xi===r&&ai!==r&&(xi=ai),xi},Be=function ti(ai){for(var yi=this.internal.write,di=this.internal.putStream,bi=(0,this.internal.getFilters)();bi.indexOf("FlateEncode")!==-1;)bi.splice(bi.indexOf("FlateEncode"),1);ai.objectId=this.internal.newObject();var vi=[];if(vi.push({key:"Type",value:"/XObject"}),vi.push({key:"Subtype",value:"/Image"}),vi.push({key:"Width",value:ai.width}),vi.push({key:"Height",value:ai.height}),ai.colorSpace===St.INDEXED?vi.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(ai.palette.length/3-1)+" "+("sMask"in ai&&ai.sMask!==void 0?ai.objectId+2:ai.objectId+1)+" 0 R]"}):(vi.push({key:"ColorSpace",value:"/"+ai.colorSpace}),ai.colorSpace===St.DEVICE_CMYK&&vi.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),vi.push({key:"BitsPerComponent",value:ai.bitsPerComponent}),"decodeParameters"in ai&&ai.decodeParameters!==void 0&&vi.push({key:"DecodeParms",value:"<<"+ai.decodeParameters+">>"}),"transparency"in ai&&Array.isArray(ai.transparency)){for(var Pi="",xi=0,ni=ai.transparency.length;xi<ni;xi++)Pi+=ai.transparency[xi]+" "+ai.transparency[xi]+" ";vi.push({key:"Mask",value:"["+Pi+"]"})}ai.sMask!==void 0&&vi.push({key:"SMask",value:ai.objectId+1+" 0 R"});var fi=ai.filter!==void 0?["/"+ai.filter]:void 0;if(di({data:ai.data,additionalKeyValues:vi,alreadyAppliedFilters:fi,objectId:ai.objectId}),yi("endobj"),"sMask"in ai&&ai.sMask!==void 0){var Si="/Predictor "+ai.predictor+" /Colors 1 /BitsPerComponent "+ai.bitsPerComponent+" /Columns "+ai.width,Xe={width:ai.width,height:ai.height,colorSpace:"DeviceGray",bitsPerComponent:ai.bitsPerComponent,decodeParameters:Si,data:ai.sMask};"filter"in ai&&(Xe.filter=ai.filter),ti.call(this,Xe)}if(ai.colorSpace===St.INDEXED){var Ge=this.internal.newObject();di({data:Je(new Uint8Array(ai.palette)),objectId:Ge}),yi("endobj")}},Ue=function(){var ti=this.internal.collections.addImage_images;for(var ai in ti)Be.call(this,ti[ai])},He=function(){var ti,ai=this.internal.collections.addImage_images,yi=this.internal.write;for(var di in ai)yi("/I"+(ti=ai[di]).index,ti.objectId,"0","R")},Ee=function(){this.internal.collections.addImage_images||(this.internal.collections.addImage_images={},this.internal.events.subscribe("putResources",Ue),this.internal.events.subscribe("putXobjectDict",He))},e=function(){var ti=this.internal.collections.addImage_images;return Ee.call(this),ti},xe=function(){return Object.keys(this.internal.collections.addImage_images).length},Te=function(ti){return typeof Ie["process"+ti.toUpperCase()]=="function"},_e=function(ti){return _typeof(ti)==="object"&&ti.nodeType===1},Se=function(ti,ai){if(ti.nodeName==="IMG"&&ti.hasAttribute("src")){var yi=""+ti.getAttribute("src");if(yi.indexOf("data:image/")===0)return u(unescape(yi).split("base64,").pop());var di=Ie.loadFile(yi,!0);if(di!==void 0)return di}if(ti.nodeName==="CANVAS"){if(ti.width===0||ti.height===0)throw new Error("Given canvas must have data. Canvas width: "+ti.width+", height: "+ti.height);var bi;switch(ai){case"PNG":bi="image/png";break;case"WEBP":bi="image/webp";break;case"JPEG":case"JPG":default:bi="image/jpeg"}return u(ti.toDataURL(bi,1).split("base64,").pop())}},t=function(ti){var ai=this.internal.collections.addImage_images;if(ai){for(var yi in ai)if(ti===ai[yi].alias)return ai[yi]}},Ae=function(ti,ai,yi){return ti||ai||(ti=-96,ai=-96),ti<0&&(ti=-1*yi.width*72/ti/this.internal.scaleFactor),ai<0&&(ai=-1*yi.height*72/ai/this.internal.scaleFactor),ti===0&&(ti=ai*yi.width/yi.height),ai===0&&(ai=ti*yi.height/yi.width),[ti,ai]},Pe=function(ti,ai,yi,di,bi,vi){var Pi=Ae.call(this,yi,di,bi),xi=this.internal.getCoordinateString,ni=this.internal.getVerticalCoordinateString,fi=e.call(this);if(yi=Pi[0],di=Pi[1],fi[bi.index]=bi,vi){vi*=Math.PI/180;var Si=Math.cos(vi),Xe=Math.sin(vi),Ge=function(Ve){return Ve.toFixed(4)},ze=[Ge(Si),Ge(Xe),Ge(-1*Xe),Ge(Si),0,0,"cm"]}this.internal.write("q"),vi?(this.internal.write([1,"0","0",1,xi(ti),ni(ai+di),"cm"].join(" ")),this.internal.write(ze.join(" ")),this.internal.write([xi(yi),"0","0",xi(di),"0","0","cm"].join(" "))):this.internal.write([xi(yi),"0","0",xi(di),xi(ti),ni(ai+di),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+bi.index+" Do"),this.internal.write("Q")},St=Ie.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};Ie.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var Ce=Ie.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},ke=Ie.__addimage__.sHashCode=function(ti){var ai,yi,di=0;if(typeof ti=="string")for(yi=ti.length,ai=0;ai<yi;ai++)di=(di<<5)-di+ti.charCodeAt(ai),di|=0;else if(We(ti))for(yi=ti.byteLength/2,ai=0;ai<yi;ai++)di=(di<<5)-di+ti[ai],di|=0;return di},De=Ie.__addimage__.validateStringAsBase64=function(ti){(ti=ti||"").toString().trim();var ai=!0;return ti.length===0&&(ai=!1),ti.length%4!=0&&(ai=!1),/^[A-Za-z0-9+/]+$/.test(ti.substr(0,ti.length-2))===!1&&(ai=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(ti.substr(-2))===!1&&(ai=!1),ai},Re=Ie.__addimage__.extractImageFromDataUrl=function(ti){var ai=(ti=ti||"").split("base64,"),yi=null;if(ai.length===2){var di=/^data:(\w*\/\w*);*(charset=(?!charset=)[\w=-]*)*;*$/.exec(ai[0]);Array.isArray(di)&&(yi={mimeType:di[1],charset:di[2],data:ai[1]})}return yi},je=Ie.__addimage__.supportsArrayBuffer=function(){return typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"};Ie.__addimage__.isArrayBuffer=function(ti){return je()&&ti instanceof ArrayBuffer};var We=Ie.__addimage__.isArrayBufferView=function(ti){return je()&&typeof Uint32Array<"u"&&(ti instanceof Int8Array||ti instanceof Uint8Array||typeof Uint8ClampedArray<"u"&&ti instanceof Uint8ClampedArray||ti instanceof Int16Array||ti instanceof Uint16Array||ti instanceof Int32Array||ti instanceof Uint32Array||ti instanceof Float32Array||ti instanceof Float64Array)},Ke=Ie.__addimage__.binaryStringToUint8Array=function(ti){for(var ai=ti.length,yi=new Uint8Array(ai),di=0;di<ai;di++)yi[di]=ti.charCodeAt(di);return yi},Je=Ie.__addimage__.arrayBufferToBinaryString=function(ti){for(var ai="",yi=We(ti)?ti:new Uint8Array(ti),di=0;di<yi.length;di+=8192)ai+=String.fromCharCode.apply(null,yi.subarray(di,di+8192));return ai};Ie.addImage=function(){var ti,ai,yi,di,bi,vi,Pi,xi,ni;if(typeof arguments[1]=="number"?(ai=r,yi=arguments[1],di=arguments[2],bi=arguments[3],vi=arguments[4],Pi=arguments[5],xi=arguments[6],ni=arguments[7]):(ai=arguments[1],yi=arguments[2],di=arguments[3],bi=arguments[4],vi=arguments[5],Pi=arguments[6],xi=arguments[7],ni=arguments[8]),_typeof(ti=arguments[0])==="object"&&!_e(ti)&&"imageData"in ti){var fi=ti;ti=fi.imageData,ai=fi.format||ai||r,yi=fi.x||yi||0,di=fi.y||di||0,bi=fi.w||fi.width||bi,vi=fi.h||fi.height||vi,Pi=fi.alias||Pi,xi=fi.compression||xi,ni=fi.rotation||fi.angle||ni}var Si=this.internal.getFilters();if(xi===void 0&&Si.indexOf("FlateEncode")!==-1&&(xi="SLOW"),isNaN(yi)||isNaN(di))throw new Error("Invalid coordinates passed to jsPDF.addImage");Ee.call(this);var Xe=hi.call(this,ti,ai,Pi,xi);return Pe.call(this,yi,di,bi,vi,Xe,ni),this};var hi=function(ti,ai,yi,di){var bi,vi,Pi;if(typeof ti=="string"&&Oe(ti)===r){ti=unescape(ti);var xi=oi(ti,!1);(xi!==""||(xi=Ie.loadFile(ti,!0))!==void 0)&&(ti=xi)}if(_e(ti)&&(ti=Se(ti,ai)),ai=Oe(ti,ai),!Te(ai))throw new Error("addImage does not support files of type '"+ai+"', please ensure that a plugin for '"+ai+"' support is added.");if(((Pi=yi)==null||Pi.length===0)&&(yi=function(ni){return typeof ni=="string"||We(ni)?ke(ni):We(ni.data)?ke(ni.data):null}(ti)),(bi=t.call(this,yi))||(je()&&(ti instanceof Uint8Array||ai==="RGBA"||(vi=ti,ti=Ke(ti))),bi=this["process"+ai.toUpperCase()](ti,xe.call(this),yi,function(ni){return ni&&typeof ni=="string"&&(ni=ni.toUpperCase()),ni in Ie.image_compression?ni:Ce.NONE}(di),vi)),!bi)throw new Error("An unknown error occurred whilst processing the image.");return bi},oi=Ie.__addimage__.convertBase64ToBinaryString=function(ti,ai){var yi;ai=typeof ai!="boolean"||ai;var di,bi="";if(typeof ti=="string"){di=(yi=Re(ti))!==null?yi.data:ti;try{bi=u(di)}catch(vi){if(ai)throw De(di)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+vi.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return bi};Ie.getImageProperties=function(ti){var ai,yi,di="";if(_e(ti)&&(ti=Se(ti)),typeof ti=="string"&&Oe(ti)===r&&((di=oi(ti,!1))===""&&(di=Ie.loadFile(ti)||""),ti=di),yi=Oe(ti),!Te(yi))throw new Error("addImage does not support files of type '"+yi+"', please ensure that a plugin for '"+yi+"' support is added.");if(!je()||ti instanceof Uint8Array||(ti=Ke(ti)),!(ai=this["process"+yi.toUpperCase()](ti)))throw new Error("An unknown error occurred whilst processing the image");return ai.fileType=yi,ai}})(E.API),function(Ie){var r=function(Me){if(Me!==void 0&&Me!="")return!0};E.API.events.push(["addPage",function(Me){this.internal.getPageInfo(Me.pageNumber).pageContext.annotations=[]}]),Ie.events.push(["putPage",function(Me){for(var Oe,Be,Ue,He=this.internal.getCoordinateString,Ee=this.internal.getVerticalCoordinateString,e=this.internal.getPageInfoByObjId(Me.objId),xe=Me.pageContext.annotations,Te=!1,_e=0;_e<xe.length&&!Te;_e++)switch((Oe=xe[_e]).type){case"link":(r(Oe.options.url)||r(Oe.options.pageNumber))&&(Te=!0);break;case"reference":case"text":case"freetext":Te=!0}if(Te!=0){this.internal.write("/Annots [");for(var Se=0;Se<xe.length;Se++){Oe=xe[Se];var t=this.internal.pdfEscape,Ae=this.internal.getEncryptor(Me.objId);switch(Oe.type){case"reference":this.internal.write(" "+Oe.object.objId+" 0 R ");break;case"text":var Pe=this.internal.newAdditionalObject(),St=this.internal.newAdditionalObject(),Ce=this.internal.getEncryptor(Pe.objId),ke=Oe.title||"Note";Ue="<</Type /Annot /Subtype /Text "+(Be="/Rect ["+He(Oe.bounds.x)+" "+Ee(Oe.bounds.y+Oe.bounds.h)+" "+He(Oe.bounds.x+Oe.bounds.w)+" "+Ee(Oe.bounds.y)+"] ")+"/Contents ("+t(Ce(Oe.contents))+")",Ue+=" /Popup "+St.objId+" 0 R",Ue+=" /P "+e.objId+" 0 R",Ue+=" /T ("+t(Ce(ke))+") >>",Pe.content=Ue;var De=Pe.objId+" 0 R";Ue="<</Type /Annot /Subtype /Popup "+(Be="/Rect ["+He(Oe.bounds.x+30)+" "+Ee(Oe.bounds.y+Oe.bounds.h)+" "+He(Oe.bounds.x+Oe.bounds.w+30)+" "+Ee(Oe.bounds.y)+"] ")+" /Parent "+De,Oe.open&&(Ue+=" /Open true"),Ue+=" >>",St.content=Ue,this.internal.write(Pe.objId,"0 R",St.objId,"0 R");break;case"freetext":Be="/Rect ["+He(Oe.bounds.x)+" "+Ee(Oe.bounds.y)+" "+He(Oe.bounds.x+Oe.bounds.w)+" "+Ee(Oe.bounds.y+Oe.bounds.h)+"] ";var Re=Oe.color||"#000000";Ue="<</Type /Annot /Subtype /FreeText "+Be+"/Contents ("+t(Ae(Oe.contents))+")",Ue+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+Re+")",Ue+=" /Border [0 0 0]",Ue+=" >>",this.internal.write(Ue);break;case"link":if(Oe.options.name){var je=this.annotations._nameMap[Oe.options.name];Oe.options.pageNumber=je.page,Oe.options.top=je.y}else Oe.options.top||(Oe.options.top=0);if(Be="/Rect ["+Oe.finalBounds.x+" "+Oe.finalBounds.y+" "+Oe.finalBounds.w+" "+Oe.finalBounds.h+"] ",Ue="",Oe.options.url)Ue="<</Type /Annot /Subtype /Link "+Be+"/Border [0 0 0] /A <</S /URI /URI ("+t(Ae(Oe.options.url))+") >>";else if(Oe.options.pageNumber)switch(Ue="<</Type /Annot /Subtype /Link "+Be+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(Oe.options.pageNumber).objId+" 0 R",Oe.options.magFactor=Oe.options.magFactor||"XYZ",Oe.options.magFactor){case"Fit":Ue+=" /Fit]";break;case"FitH":Ue+=" /FitH "+Oe.options.top+"]";break;case"FitV":Oe.options.left=Oe.options.left||0,Ue+=" /FitV "+Oe.options.left+"]";break;case"XYZ":default:var We=Ee(Oe.options.top);Oe.options.left=Oe.options.left||0,Oe.options.zoom===void 0&&(Oe.options.zoom=0),Ue+=" /XYZ "+Oe.options.left+" "+We+" "+Oe.options.zoom+"]"}Ue!=""&&(Ue+=" >>",this.internal.write(Ue))}}this.internal.write("]")}}]),Ie.createAnnotation=function(Me){var Oe=this.internal.getCurrentPageInfo();switch(Me.type){case"link":this.link(Me.bounds.x,Me.bounds.y,Me.bounds.w,Me.bounds.h,Me);break;case"text":case"freetext":Oe.pageContext.annotations.push(Me)}},Ie.link=function(Me,Oe,Be,Ue,He){var Ee=this.internal.getCurrentPageInfo(),e=this.internal.getCoordinateString,xe=this.internal.getVerticalCoordinateString;Ee.pageContext.annotations.push({finalBounds:{x:e(Me),y:xe(Oe),w:e(Me+Be),h:xe(Oe+Ue)},options:He,type:"link"})},Ie.textWithLink=function(Me,Oe,Be,Ue){var He,Ee,e=this.getTextWidth(Me),xe=this.internal.getLineHeight()/this.internal.scaleFactor;if(Ue.maxWidth!==void 0){Ee=Ue.maxWidth;var Te=this.splitTextToSize(Me,Ee).length;He=Math.ceil(xe*Te)}else Ee=e,He=xe;return this.text(Me,Oe,Be,Ue),Be+=.2*xe,Ue.align==="center"&&(Oe-=e/2),Ue.align==="right"&&(Oe-=e),this.link(Oe,Be-xe,Ee,He,Ue),e},Ie.getTextWidth=function(Me){var Oe=this.internal.getFontSize();return this.getStringUnitWidth(Me)*Oe/this.internal.scaleFactor}}(E.API),function(Ie){var r={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},Me={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},Oe={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},Be=[1570,1571,1573,1575];Ie.__arabicParser__={};var Ue=Ie.__arabicParser__.isInArabicSubstitutionA=function(Pe){return r[Pe.charCodeAt(0)]!==void 0},He=Ie.__arabicParser__.isArabicLetter=function(Pe){return typeof Pe=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(Pe)},Ee=Ie.__arabicParser__.isArabicEndLetter=function(Pe){return He(Pe)&&Ue(Pe)&&r[Pe.charCodeAt(0)].length<=2},e=Ie.__arabicParser__.isArabicAlfLetter=function(Pe){return He(Pe)&&Be.indexOf(Pe.charCodeAt(0))>=0};Ie.__arabicParser__.arabicLetterHasIsolatedForm=function(Pe){return He(Pe)&&Ue(Pe)&&r[Pe.charCodeAt(0)].length>=1};var xe=Ie.__arabicParser__.arabicLetterHasFinalForm=function(Pe){return He(Pe)&&Ue(Pe)&&r[Pe.charCodeAt(0)].length>=2};Ie.__arabicParser__.arabicLetterHasInitialForm=function(Pe){return He(Pe)&&Ue(Pe)&&r[Pe.charCodeAt(0)].length>=3};var Te=Ie.__arabicParser__.arabicLetterHasMedialForm=function(Pe){return He(Pe)&&Ue(Pe)&&r[Pe.charCodeAt(0)].length==4},_e=Ie.__arabicParser__.resolveLigatures=function(Pe){var St=0,Ce=Me,ke="",De=0;for(St=0;St<Pe.length;St+=1)Ce[Pe.charCodeAt(St)]!==void 0?(De++,typeof(Ce=Ce[Pe.charCodeAt(St)])=="number"&&(ke+=String.fromCharCode(Ce),Ce=Me,De=0),St===Pe.length-1&&(Ce=Me,ke+=Pe.charAt(St-(De-1)),St-=De-1,De=0)):(Ce=Me,ke+=Pe.charAt(St-De),St-=De,De=0);return ke};Ie.__arabicParser__.isArabicDiacritic=function(Pe){return Pe!==void 0&&Oe[Pe.charCodeAt(0)]!==void 0};var Se=Ie.__arabicParser__.getCorrectForm=function(Pe,St,Ce){return He(Pe)?Ue(Pe)===!1?-1:!xe(Pe)||!He(St)&&!He(Ce)||!He(Ce)&&Ee(St)||Ee(Pe)&&!He(St)||Ee(Pe)&&e(St)||Ee(Pe)&&Ee(St)?0:Te(Pe)&&He(St)&&!Ee(St)&&He(Ce)&&xe(Ce)?3:Ee(Pe)||!He(Ce)?1:2:-1},t=function(Pe){var St=0,Ce=0,ke=0,De="",Re="",je="",We=(Pe=Pe||"").split("\\s+"),Ke=[];for(St=0;St<We.length;St+=1){for(Ke.push(""),Ce=0;Ce<We[St].length;Ce+=1)De=We[St][Ce],Re=We[St][Ce-1],je=We[St][Ce+1],He(De)?(ke=Se(De,Re,je),Ke[St]+=ke!==-1?String.fromCharCode(r[De.charCodeAt(0)][ke]):De):Ke[St]+=De;Ke[St]=_e(Ke[St])}return Ke.join(" ")},Ae=Ie.__arabicParser__.processArabic=Ie.processArabic=function(){var Pe,St=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,Ce=[];if(Array.isArray(St)){var ke=0;for(Ce=[],ke=0;ke<St.length;ke+=1)Array.isArray(St[ke])?Ce.push([t(St[ke][0]),St[ke][1],St[ke][2]]):Ce.push([t(St[ke])]);Pe=Ce}else Pe=t(St);return typeof arguments[0]=="string"?Pe:(arguments[0].text=Pe,arguments[0])};Ie.events.push(["preProcessText",Ae])}(E.API),E.API.autoPrint=function(Ie){var r;switch((Ie=Ie||{}).variant=Ie.variant||"non-conform",Ie.variant){case"javascript":this.addJS("print({});");break;case"non-conform":default:this.internal.events.subscribe("postPutResources",function(){r=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+r+" 0 R")})}return this},function(Ie){var r=function(){var Me=void 0;Object.defineProperty(this,"pdf",{get:function(){return Me},set:function(Ee){Me=Ee}});var Oe=150;Object.defineProperty(this,"width",{get:function(){return Oe},set:function(Ee){Oe=isNaN(Ee)||Number.isInteger(Ee)===!1||Ee<0?150:Ee,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=Oe+1)}});var Be=300;Object.defineProperty(this,"height",{get:function(){return Be},set:function(Ee){Be=isNaN(Ee)||Number.isInteger(Ee)===!1||Ee<0?300:Ee,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=Be+1)}});var Ue=[];Object.defineProperty(this,"childNodes",{get:function(){return Ue},set:function(Ee){Ue=Ee}});var He={};Object.defineProperty(this,"style",{get:function(){return He},set:function(Ee){He=Ee}}),Object.defineProperty(this,"parentNode",{})};r.prototype.getContext=function(Me,Oe){var Be;if((Me=Me||"2d")!=="2d")return null;for(Be in Oe)this.pdf.context2d.hasOwnProperty(Be)&&(this.pdf.context2d[Be]=Oe[Be]);return this.pdf.context2d._canvas=this,this.pdf.context2d},r.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},Ie.events.push(["initialized",function(){this.canvas=new r,this.canvas.pdf=this}])}(E.API),function(Ie){var r={left:0,top:0,bottom:0,right:0},Me=!1,Oe=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},r),this.internal.__cell__.margins.width=this.getPageWidth(),Be.call(this))},Be=function(){this.internal.__cell__.lastCell=new Ue,this.internal.__cell__.pages=1},Ue=function(){var e=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return e},set:function(Pe){e=Pe}});var xe=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return xe},set:function(Pe){xe=Pe}});var Te=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return Te},set:function(Pe){Te=Pe}});var _e=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return _e},set:function(Pe){_e=Pe}});var Se=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return Se},set:function(Pe){Se=Pe}});var t=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return t},set:function(Pe){t=Pe}});var Ae=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return Ae},set:function(Pe){Ae=Pe}}),this};Ue.prototype.clone=function(){return new Ue(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},Ue.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},Ie.setHeaderFunction=function(e){return Oe.call(this),this.internal.__cell__.headerFunction=typeof e=="function"?e:void 0,this},Ie.getTextDimensions=function(e,xe){Oe.call(this);var Te=(xe=xe||{}).fontSize||this.getFontSize(),_e=xe.font||this.getFont(),Se=xe.scaleFactor||this.internal.scaleFactor,t=0,Ae=0,Pe=0,St=this;if(!Array.isArray(e)&&typeof e!="string"){if(typeof e!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");e=String(e)}var Ce=xe.maxWidth;Ce>0?typeof e=="string"?e=this.splitTextToSize(e,Ce):Object.prototype.toString.call(e)==="[object Array]"&&(e=e.reduce(function(De,Re){return De.concat(St.splitTextToSize(Re,Ce))},[])):e=Array.isArray(e)?e:[e];for(var ke=0;ke<e.length;ke++)t<(Pe=this.getStringUnitWidth(e[ke],{font:_e})*Te)&&(t=Pe);return t!==0&&(Ae=e.length),{w:t/=Se,h:Math.max((Ae*Te*this.getLineHeightFactor()-Te*(this.getLineHeightFactor()-1))/Se,0)}},Ie.cellAddPage=function(){Oe.call(this),this.addPage();var e=this.internal.__cell__.margins||r;return this.internal.__cell__.lastCell=new Ue(e.left,e.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var He=Ie.cell=function(){var e;e=arguments[0]instanceof Ue?arguments[0]:new Ue(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]),Oe.call(this);var xe=this.internal.__cell__.lastCell,Te=this.internal.__cell__.padding,_e=this.internal.__cell__.margins||r,Se=this.internal.__cell__.tableHeaderRow,t=this.internal.__cell__.printHeaders;return xe.lineNumber!==void 0&&(xe.lineNumber===e.lineNumber?(e.x=(xe.x||0)+(xe.width||0),e.y=xe.y||0):xe.y+xe.height+e.height+_e.bottom>this.getPageHeight()?(this.cellAddPage(),e.y=_e.top,t&&Se&&(this.printHeaderRow(e.lineNumber,!0),e.y+=Se[0].height)):e.y=xe.y+xe.height||e.y),e.text[0]!==void 0&&(this.rect(e.x,e.y,e.width,e.height,Me===!0?"FD":void 0),e.align==="right"?this.text(e.text,e.x+e.width-Te,e.y+Te,{align:"right",baseline:"top"}):e.align==="center"?this.text(e.text,e.x+e.width/2,e.y+Te,{align:"center",baseline:"top",maxWidth:e.width-Te-Te}):this.text(e.text,e.x+Te,e.y+Te,{align:"left",baseline:"top",maxWidth:e.width-Te-Te})),this.internal.__cell__.lastCell=e,this};Ie.table=function(e,xe,Te,_e,Se){if(Oe.call(this),!Te)throw new Error("No data for PDF table.");var t,Ae,Pe,St,Ce=[],ke=[],De=[],Re={},je={},We=[],Ke=[],Je=(Se=Se||{}).autoSize||!1,hi=Se.printHeaders!==!1,oi=Se.css&&Se.css["font-size"]!==void 0?16*Se.css["font-size"]:Se.fontSize||12,ti=Se.margins||Object.assign({width:this.getPageWidth()},r),ai=typeof Se.padding=="number"?Se.padding:3,yi=Se.headerBackgroundColor||"#c8c8c8",di=Se.headerTextColor||"#000";if(Be.call(this),this.internal.__cell__.printHeaders=hi,this.internal.__cell__.margins=ti,this.internal.__cell__.table_font_size=oi,this.internal.__cell__.padding=ai,this.internal.__cell__.headerBackgroundColor=yi,this.internal.__cell__.headerTextColor=di,this.setFontSize(oi),_e==null)ke=Ce=Object.keys(Te[0]),De=Ce.map(function(){return"left"});else if(Array.isArray(_e)&&_typeof(_e[0])==="object")for(Ce=_e.map(function(fi){return fi.name}),ke=_e.map(function(fi){return fi.prompt||fi.name||""}),De=_e.map(function(fi){return fi.align||"left"}),t=0;t<_e.length;t+=1)je[_e[t].name]=_e[t].width*(19.049976/25.4);else Array.isArray(_e)&&typeof _e[0]=="string"&&(ke=Ce=_e,De=Ce.map(function(){return"left"}));if(Je||Array.isArray(_e)&&typeof _e[0]=="string")for(t=0;t<Ce.length;t+=1){for(Re[St=Ce[t]]=Te.map(function(fi){return fi[St]}),this.setFont(void 0,"bold"),We.push(this.getTextDimensions(ke[t],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),Ae=Re[St],this.setFont(void 0,"normal"),Pe=0;Pe<Ae.length;Pe+=1)We.push(this.getTextDimensions(Ae[Pe],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);je[St]=Math.max.apply(null,We)+ai+ai,We=[]}if(hi){var bi={};for(t=0;t<Ce.length;t+=1)bi[Ce[t]]={},bi[Ce[t]].text=ke[t],bi[Ce[t]].align=De[t];var vi=Ee.call(this,bi,je);Ke=Ce.map(function(fi){return new Ue(e,xe,je[fi],vi,bi[fi].text,void 0,bi[fi].align)}),this.setTableHeaderRow(Ke),this.printHeaderRow(1,!1)}var Pi=_e.reduce(function(fi,Si){return fi[Si.name]=Si.align,fi},{});for(t=0;t<Te.length;t+=1){"rowStart"in Se&&Se.rowStart instanceof Function&&Se.rowStart({row:t,data:Te[t]},this);var xi=Ee.call(this,Te[t],je);for(Pe=0;Pe<Ce.length;Pe+=1){var ni=Te[t][Ce[Pe]];"cellStart"in Se&&Se.cellStart instanceof Function&&Se.cellStart({row:t,col:Pe,data:ni},this),He.call(this,new Ue(e,xe,je[Ce[Pe]],xi,ni,t+2,Pi[Ce[Pe]]))}}return this.internal.__cell__.table_x=e,this.internal.__cell__.table_y=xe,this};var Ee=function(e,xe){var Te=this.internal.__cell__.padding,_e=this.internal.__cell__.table_font_size,Se=this.internal.scaleFactor;return Object.keys(e).map(function(t){var Ae=e[t];return this.splitTextToSize(Ae.hasOwnProperty("text")?Ae.text:Ae,xe[t]-Te-Te)},this).map(function(t){return this.getLineHeightFactor()*t.length*_e/Se+Te+Te},this).reduce(function(t,Ae){return Math.max(t,Ae)},0)};Ie.setTableHeaderRow=function(e){Oe.call(this),this.internal.__cell__.tableHeaderRow=e},Ie.printHeaderRow=function(e,xe){if(Oe.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var Te;if(Me=!0,typeof this.internal.__cell__.headerFunction=="function"){var _e=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new Ue(_e[0],_e[1],_e[2],_e[3],void 0,-1)}this.setFont(void 0,"bold");for(var Se=[],t=0;t<this.internal.__cell__.tableHeaderRow.length;t+=1){Te=this.internal.__cell__.tableHeaderRow[t].clone(),xe&&(Te.y=this.internal.__cell__.margins.top||0,Se.push(Te)),Te.lineNumber=e;var Ae=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),He.call(this,Te),this.setTextColor(Ae)}Se.length>0&&this.setTableHeaderRow(Se),this.setFont(void 0,"normal"),Me=!1}}(E.API);var Pt={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},kt=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],It=_t(kt),Ft=[100,200,300,400,500,600,700,800,900],Ct=_t(Ft);function jt(Ie){var r=Ie.family.replace(/"|'/g,"").toLowerCase(),Me=function(Ue){return Pt[Ue=Ue||"normal"]?Ue:"normal"}(Ie.style),Oe=function(Ue){if(!Ue)return 400;if(typeof Ue=="number")return Ue>=100&&Ue<=900&&Ue%100==0?Ue:400;if(/^\d00$/.test(Ue))return parseInt(Ue);switch(Ue){case"bold":return 700;case"normal":default:return 400}}(Ie.weight),Be=function(Ue){return typeof It[Ue=Ue||"normal"]=="number"?Ue:"normal"}(Ie.stretch);return{family:r,style:Me,weight:Oe,stretch:Be,src:Ie.src||[],ref:Ie.ref||{name:r,style:[Be,Me,Oe].join(" ")}}}function Ot(Ie,r,Me,Oe){var Be;for(Be=Me;Be>=0&&Be<r.length;Be+=Oe)if(Ie[r[Be]])return Ie[r[Be]];for(Be=Me;Be>=0&&Be<r.length;Be-=Oe)if(Ie[r[Be]])return Ie[r[Be]]}var Bt={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},Mt={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function Et(Ie){return[Ie.stretch,Ie.style,Ie.weight,Ie.family].join(" ")}function qt(Ie,r,Me){for(var Oe=(Me=Me||{}).defaultFontFamily||"times",Be=Object.assign({},Bt,Me.genericFontFamilies||{}),Ue=null,He=null,Ee=0;Ee<r.length;++Ee)if(Be[(Ue=jt(r[Ee])).family]&&(Ue.family=Be[Ue.family]),Ie.hasOwnProperty(Ue.family)){He=Ie[Ue.family];break}if(!(He=He||Ie[Oe]))throw new Error("Could not find a font-family for the rule '"+Et(Ue)+"' and default family '"+Oe+"'.");if(He=function(e,xe){if(xe[e])return xe[e];var Te=It[e],_e=Te<=It.normal?-1:1,Se=Ot(xe,kt,Te,_e);if(!Se)throw new Error("Could not find a matching font-stretch value for "+e);return Se}(Ue.stretch,He),He=function(e,xe){if(xe[e])return xe[e];for(var Te=Pt[e],_e=0;_e<Te.length;++_e)if(xe[Te[_e]])return xe[Te[_e]];throw new Error("Could not find a matching font-style for "+e)}(Ue.style,He),!(He=function(e,xe){if(xe[e])return xe[e];if(e===400&&xe[500])return xe[500];if(e===500&&xe[400])return xe[400];var Te=Ct[e],_e=Ot(xe,Ft,Te,e<400?-1:1);if(!_e)throw new Error("Could not find a matching font-weight for value "+e);return _e}(Ue.weight,He)))throw new Error("Failed to resolve a font for the rule '"+Et(Ue)+"'.");return He}function Dt(Ie){return Ie.trimLeft()}function Rt(Ie,r){for(var Me=0;Me<Ie.length;){if(Ie.charAt(Me)===r)return[Ie.substring(0,Me),Ie.substring(Me+1)];Me+=1}return null}function Tt(Ie){var r=Ie.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return r===null?null:[r[0],Ie.substring(r[0].length)]}var Ut,zt,Ht,Wt=["times"];(function(Ie){var r,Me,Oe,Be,Ue,He,Ee,e,xe,Te=function(Xe){return Xe=Xe||{},this.isStrokeTransparent=Xe.isStrokeTransparent||!1,this.strokeOpacity=Xe.strokeOpacity||1,this.strokeStyle=Xe.strokeStyle||"#000000",this.fillStyle=Xe.fillStyle||"#000000",this.isFillTransparent=Xe.isFillTransparent||!1,this.fillOpacity=Xe.fillOpacity||1,this.font=Xe.font||"10px sans-serif",this.textBaseline=Xe.textBaseline||"alphabetic",this.textAlign=Xe.textAlign||"left",this.lineWidth=Xe.lineWidth||1,this.lineJoin=Xe.lineJoin||"miter",this.lineCap=Xe.lineCap||"butt",this.path=Xe.path||[],this.transform=Xe.transform!==void 0?Xe.transform.clone():new e,this.globalCompositeOperation=Xe.globalCompositeOperation||"normal",this.globalAlpha=Xe.globalAlpha||1,this.clip_path=Xe.clip_path||[],this.currentPoint=Xe.currentPoint||new He,this.miterLimit=Xe.miterLimit||10,this.lastPoint=Xe.lastPoint||new He,this.lineDashOffset=Xe.lineDashOffset||0,this.lineDash=Xe.lineDash||[],this.margin=Xe.margin||[0,0,0,0],this.prevPageLastElemOffset=Xe.prevPageLastElemOffset||0,this.ignoreClearRect=typeof Xe.ignoreClearRect!="boolean"||Xe.ignoreClearRect,this};Ie.events.push(["initialized",function(){this.context2d=new _e(this),r=this.internal.f2,Me=this.internal.getCoordinateString,Oe=this.internal.getVerticalCoordinateString,Be=this.internal.getHorizontalCoordinate,Ue=this.internal.getVerticalCoordinate,He=this.internal.Point,Ee=this.internal.Rectangle,e=this.internal.Matrix,xe=new Te}]);var _e=function(Xe){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var Ge=Xe;Object.defineProperty(this,"pdf",{get:function(){return Ge}});var ze=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return ze},set:function(ii){ze=Boolean(ii)}});var Ve=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return Ve},set:function(ii){Ve=Boolean(ii)}});var ei=0;Object.defineProperty(this,"posX",{get:function(){return ei},set:function(ii){isNaN(ii)||(ei=ii)}});var si=0;Object.defineProperty(this,"posY",{get:function(){return si},set:function(ii){isNaN(ii)||(si=ii)}}),Object.defineProperty(this,"margin",{get:function(){return xe.margin},set:function(ii){var Qe;typeof ii=="number"?Qe=[ii,ii,ii,ii]:((Qe=new Array(4))[0]=ii[0],Qe[1]=ii.length>=2?ii[1]:Qe[0],Qe[2]=ii.length>=3?ii[2]:Qe[0],Qe[3]=ii.length>=4?ii[3]:Qe[1]),xe.margin=Qe}});var li=!1;Object.defineProperty(this,"autoPaging",{get:function(){return li},set:function(ii){li=ii}});var ci=0;Object.defineProperty(this,"lastBreak",{get:function(){return ci},set:function(ii){ci=ii}});var Ci=[];Object.defineProperty(this,"pageBreaks",{get:function(){return Ci},set:function(ii){Ci=ii}}),Object.defineProperty(this,"ctx",{get:function(){return xe},set:function(ii){ii instanceof Te&&(xe=ii)}}),Object.defineProperty(this,"path",{get:function(){return xe.path},set:function(ii){xe.path=ii}});var Fi=[];Object.defineProperty(this,"ctxStack",{get:function(){return Fi},set:function(ii){Fi=ii}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(ii){var Qe;Qe=Se(ii),this.ctx.fillStyle=Qe.style,this.ctx.isFillTransparent=Qe.a===0,this.ctx.fillOpacity=Qe.a,this.pdf.setFillColor(Qe.r,Qe.g,Qe.b,{a:Qe.a}),this.pdf.setTextColor(Qe.r,Qe.g,Qe.b,{a:Qe.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(ii){var Qe=Se(ii);this.ctx.strokeStyle=Qe.style,this.ctx.isStrokeTransparent=Qe.a===0,this.ctx.strokeOpacity=Qe.a,Qe.a===0?this.pdf.setDrawColor(255,255,255):(Qe.a,this.pdf.setDrawColor(Qe.r,Qe.g,Qe.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(ii){["butt","round","square"].indexOf(ii)!==-1&&(this.ctx.lineCap=ii,this.pdf.setLineCap(ii))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(ii){isNaN(ii)||(this.ctx.lineWidth=ii,this.pdf.setLineWidth(ii))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(ii){["bevel","round","miter"].indexOf(ii)!==-1&&(this.ctx.lineJoin=ii,this.pdf.setLineJoin(ii))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(ii){isNaN(ii)||(this.ctx.miterLimit=ii,this.pdf.setMiterLimit(ii))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(ii){this.ctx.textBaseline=ii}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(ii){["right","end","center","left","start"].indexOf(ii)!==-1&&(this.ctx.textAlign=ii)}});var Oi=null;function Ti(ii,Qe){if(Oi===null){var ui=function(gi){var _i=[];return Object.keys(gi).forEach(function(Ri){gi[Ri].forEach(function(Ui){var ki=null;switch(Ui){case"bold":ki={family:Ri,weight:"bold"};break;case"italic":ki={family:Ri,style:"italic"};break;case"bolditalic":ki={family:Ri,weight:"bold",style:"italic"};break;case"":case"normal":ki={family:Ri}}ki!==null&&(ki.ref={name:Ri,style:Ui},_i.push(ki))})}),_i}(ii.getFontList());Oi=function(gi){for(var _i={},Ri=0;Ri<gi.length;++Ri){var Ui=jt(gi[Ri]),ki=Ui.family,Vi=Ui.stretch,Ii=Ui.style,$i=Ui.weight;_i[ki]=_i[ki]||{},_i[ki][Vi]=_i[ki][Vi]||{},_i[ki][Vi][Ii]=_i[ki][Vi][Ii]||{},_i[ki][Vi][Ii][$i]=Ui}return _i}(ui.concat(Qe))}return Oi}var Ze=null;Object.defineProperty(this,"fontFaces",{get:function(){return Ze},set:function(ii){Oi=null,Ze=ii}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(ii){var Qe;if(this.ctx.font=ii,(Qe=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z]+?)\s*$/i.exec(ii))!==null){var ui=Qe[1],gi=(Qe[2],Qe[3]),_i=Qe[4],Ri=(Qe[5],Qe[6]),Ui=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(_i)[2];_i=Math.floor(Ui==="px"?parseFloat(_i)*this.pdf.internal.scaleFactor:Ui==="em"?parseFloat(_i)*this.pdf.getFontSize():parseFloat(_i)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(_i);var ki=function(Ji){var pn,an,kn=[],xn=Ji.trim();if(xn==="")return Wt;if(xn in Mt)return[Mt[xn]];for(;xn!=="";){switch(an=null,pn=(xn=Dt(xn)).charAt(0)){case'"':case"'":an=Rt(xn.substring(1),pn);break;default:an=Tt(xn)}if(an===null||(kn.push(an[0]),(xn=Dt(an[1]))!==""&&xn.charAt(0)!==","))return Wt;xn=xn.replace(/^,/,"")}return kn}(Ri);if(this.fontFaces){var Vi=qt(Ti(this.pdf,this.fontFaces),ki.map(function(Ji){return{family:Ji,stretch:"normal",weight:gi,style:ui}}));this.pdf.setFont(Vi.ref.name,Vi.ref.style)}else{var Ii="";(gi==="bold"||parseInt(gi,10)>=700||ui==="bold")&&(Ii="bold"),ui==="italic"&&(Ii+="italic"),Ii.length===0&&(Ii="normal");for(var $i="",tn={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},en=0;en<ki.length;en++){if(this.pdf.internal.getFont(ki[en],Ii,{noFallback:!0,disableWarning:!0})!==void 0){$i=ki[en];break}if(Ii==="bolditalic"&&this.pdf.internal.getFont(ki[en],"bold",{noFallback:!0,disableWarning:!0})!==void 0)$i=ki[en],Ii="bold";else if(this.pdf.internal.getFont(ki[en],"normal",{noFallback:!0,disableWarning:!0})!==void 0){$i=ki[en],Ii="normal";break}}if($i===""){for(var zi=0;zi<ki.length;zi++)if(tn[ki[zi]]){$i=tn[ki[zi]];break}}$i=$i===""?"Times":$i,this.pdf.setFont($i,Ii)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(ii){this.ctx.globalCompositeOperation=ii}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(ii){this.ctx.globalAlpha=ii}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(ii){this.ctx.lineDashOffset=ii,Si.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(ii){this.ctx.lineDash=ii,Si.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(ii){this.ctx.ignoreClearRect=Boolean(ii)}})};_e.prototype.setLineDash=function(Xe){this.lineDash=Xe},_e.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},_e.prototype.fill=function(){Re.call(this,"fill",!1)},_e.prototype.stroke=function(){Re.call(this,"stroke",!1)},_e.prototype.beginPath=function(){this.path=[{type:"begin"}]},_e.prototype.moveTo=function(Xe,Ge){if(isNaN(Xe)||isNaN(Ge))throw a.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var ze=this.ctx.transform.applyToPoint(new He(Xe,Ge));this.path.push({type:"mt",x:ze.x,y:ze.y}),this.ctx.lastPoint=new He(Xe,Ge)},_e.prototype.closePath=function(){var Xe=new He(0,0),Ge=0;for(Ge=this.path.length-1;Ge!==-1;Ge--)if(this.path[Ge].type==="begin"&&_typeof(this.path[Ge+1])==="object"&&typeof this.path[Ge+1].x=="number"){Xe=new He(this.path[Ge+1].x,this.path[Ge+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new He(Xe.x,Xe.y)},_e.prototype.lineTo=function(Xe,Ge){if(isNaN(Xe)||isNaN(Ge))throw a.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var ze=this.ctx.transform.applyToPoint(new He(Xe,Ge));this.path.push({type:"lt",x:ze.x,y:ze.y}),this.ctx.lastPoint=new He(ze.x,ze.y)},_e.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),Re.call(this,null,!0)},_e.prototype.quadraticCurveTo=function(Xe,Ge,ze,Ve){if(isNaN(ze)||isNaN(Ve)||isNaN(Xe)||isNaN(Ge))throw a.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var ei=this.ctx.transform.applyToPoint(new He(ze,Ve)),si=this.ctx.transform.applyToPoint(new He(Xe,Ge));this.path.push({type:"qct",x1:si.x,y1:si.y,x:ei.x,y:ei.y}),this.ctx.lastPoint=new He(ei.x,ei.y)},_e.prototype.bezierCurveTo=function(Xe,Ge,ze,Ve,ei,si){if(isNaN(ei)||isNaN(si)||isNaN(Xe)||isNaN(Ge)||isNaN(ze)||isNaN(Ve))throw a.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var li=this.ctx.transform.applyToPoint(new He(ei,si)),ci=this.ctx.transform.applyToPoint(new He(Xe,Ge)),Ci=this.ctx.transform.applyToPoint(new He(ze,Ve));this.path.push({type:"bct",x1:ci.x,y1:ci.y,x2:Ci.x,y2:Ci.y,x:li.x,y:li.y}),this.ctx.lastPoint=new He(li.x,li.y)},_e.prototype.arc=function(Xe,Ge,ze,Ve,ei,si){if(isNaN(Xe)||isNaN(Ge)||isNaN(ze)||isNaN(Ve)||isNaN(ei))throw a.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(si=Boolean(si),!this.ctx.transform.isIdentity){var li=this.ctx.transform.applyToPoint(new He(Xe,Ge));Xe=li.x,Ge=li.y;var ci=this.ctx.transform.applyToPoint(new He(0,ze)),Ci=this.ctx.transform.applyToPoint(new He(0,0));ze=Math.sqrt(Math.pow(ci.x-Ci.x,2)+Math.pow(ci.y-Ci.y,2))}Math.abs(ei-Ve)>=2*Math.PI&&(Ve=0,ei=2*Math.PI),this.path.push({type:"arc",x:Xe,y:Ge,radius:ze,startAngle:Ve,endAngle:ei,counterclockwise:si})},_e.prototype.arcTo=function(Xe,Ge,ze,Ve,ei){throw new Error("arcTo not implemented.")},_e.prototype.rect=function(Xe,Ge,ze,Ve){if(isNaN(Xe)||isNaN(Ge)||isNaN(ze)||isNaN(Ve))throw a.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(Xe,Ge),this.lineTo(Xe+ze,Ge),this.lineTo(Xe+ze,Ge+Ve),this.lineTo(Xe,Ge+Ve),this.lineTo(Xe,Ge),this.lineTo(Xe+ze,Ge),this.lineTo(Xe,Ge)},_e.prototype.fillRect=function(Xe,Ge,ze,Ve){if(isNaN(Xe)||isNaN(Ge)||isNaN(ze)||isNaN(Ve))throw a.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!t.call(this)){var ei={};this.lineCap!=="butt"&&(ei.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(ei.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(Xe,Ge,ze,Ve),this.fill(),ei.hasOwnProperty("lineCap")&&(this.lineCap=ei.lineCap),ei.hasOwnProperty("lineJoin")&&(this.lineJoin=ei.lineJoin)}},_e.prototype.strokeRect=function(Xe,Ge,ze,Ve){if(isNaN(Xe)||isNaN(Ge)||isNaN(ze)||isNaN(Ve))throw a.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");Ae.call(this)||(this.beginPath(),this.rect(Xe,Ge,ze,Ve),this.stroke())},_e.prototype.clearRect=function(Xe,Ge,ze,Ve){if(isNaN(Xe)||isNaN(Ge)||isNaN(ze)||isNaN(Ve))throw a.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(Xe,Ge,ze,Ve))},_e.prototype.save=function(Xe){Xe=typeof Xe!="boolean"||Xe;for(var Ge=this.pdf.internal.getCurrentPageInfo().pageNumber,ze=0;ze<this.pdf.internal.getNumberOfPages();ze++)this.pdf.setPage(ze+1),this.pdf.internal.out("q");if(this.pdf.setPage(Ge),Xe){this.ctx.fontSize=this.pdf.internal.getFontSize();var Ve=new Te(this.ctx);this.ctxStack.push(this.ctx),this.ctx=Ve}},_e.prototype.restore=function(Xe){Xe=typeof Xe!="boolean"||Xe;for(var Ge=this.pdf.internal.getCurrentPageInfo().pageNumber,ze=0;ze<this.pdf.internal.getNumberOfPages();ze++)this.pdf.setPage(ze+1),this.pdf.internal.out("Q");this.pdf.setPage(Ge),Xe&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},_e.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var Se=function(Xe){var Ge,ze,Ve,ei;if(Xe.isCanvasGradient===!0&&(Xe=Xe.getColor()),!Xe)return{r:0,g:0,b:0,a:0,style:Xe};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(Xe))Ge=0,ze=0,Ve=0,ei=0;else{var si=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(Xe);if(si!==null)Ge=parseInt(si[1]),ze=parseInt(si[2]),Ve=parseInt(si[3]),ei=1;else if((si=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(Xe))!==null)Ge=parseInt(si[1]),ze=parseInt(si[2]),Ve=parseInt(si[3]),ei=parseFloat(si[4]);else{if(ei=1,typeof Xe=="string"&&Xe.charAt(0)!=="#"){var li=new f(Xe);Xe=li.ok?li.toHex():"#000000"}Xe.length===4?(Ge=Xe.substring(1,2),Ge+=Ge,ze=Xe.substring(2,3),ze+=ze,Ve=Xe.substring(3,4),Ve+=Ve):(Ge=Xe.substring(1,3),ze=Xe.substring(3,5),Ve=Xe.substring(5,7)),Ge=parseInt(Ge,16),ze=parseInt(ze,16),Ve=parseInt(Ve,16)}}return{r:Ge,g:ze,b:Ve,a:ei,style:Xe}},t=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},Ae=function(){return Boolean(this.ctx.isStrokeTransparent||this.globalAlpha==0)};_e.prototype.fillText=function(Xe,Ge,ze,Ve){if(isNaN(Ge)||isNaN(ze)||typeof Xe!="string")throw a.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(Ve=isNaN(Ve)?void 0:Ve,!t.call(this)){var ei=xi(this.ctx.transform.rotation),si=this.ctx.transform.scaleX;ai.call(this,{text:Xe,x:Ge,y:ze,scale:si,angle:ei,align:this.textAlign,maxWidth:Ve})}},_e.prototype.strokeText=function(Xe,Ge,ze,Ve){if(isNaN(Ge)||isNaN(ze)||typeof Xe!="string")throw a.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!Ae.call(this)){Ve=isNaN(Ve)?void 0:Ve;var ei=xi(this.ctx.transform.rotation),si=this.ctx.transform.scaleX;ai.call(this,{text:Xe,x:Ge,y:ze,scale:si,renderingMode:"stroke",angle:ei,align:this.textAlign,maxWidth:Ve})}},_e.prototype.measureText=function(Xe){if(typeof Xe!="string")throw a.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var Ge=this.pdf,ze=this.pdf.internal.scaleFactor,Ve=Ge.internal.getFontSize(),ei=Ge.getStringUnitWidth(Xe)*Ve/Ge.internal.scaleFactor,si=function(li){var ci=(li=li||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return ci}}),this};return new si({width:ei*=Math.round(96*ze/72*1e4)/1e4})},_e.prototype.scale=function(Xe,Ge){if(isNaN(Xe)||isNaN(Ge))throw a.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var ze=new e(Xe,0,0,Ge,0,0);this.ctx.transform=this.ctx.transform.multiply(ze)},_e.prototype.rotate=function(Xe){if(isNaN(Xe))throw a.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var Ge=new e(Math.cos(Xe),Math.sin(Xe),-Math.sin(Xe),Math.cos(Xe),0,0);this.ctx.transform=this.ctx.transform.multiply(Ge)},_e.prototype.translate=function(Xe,Ge){if(isNaN(Xe)||isNaN(Ge))throw a.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var ze=new e(1,0,0,1,Xe,Ge);this.ctx.transform=this.ctx.transform.multiply(ze)},_e.prototype.transform=function(Xe,Ge,ze,Ve,ei,si){if(isNaN(Xe)||isNaN(Ge)||isNaN(ze)||isNaN(Ve)||isNaN(ei)||isNaN(si))throw a.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var li=new e(Xe,Ge,ze,Ve,ei,si);this.ctx.transform=this.ctx.transform.multiply(li)},_e.prototype.setTransform=function(Xe,Ge,ze,Ve,ei,si){Xe=isNaN(Xe)?1:Xe,Ge=isNaN(Ge)?0:Ge,ze=isNaN(ze)?0:ze,Ve=isNaN(Ve)?1:Ve,ei=isNaN(ei)?0:ei,si=isNaN(si)?0:si,this.ctx.transform=new e(Xe,Ge,ze,Ve,ei,si)};var Pe=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};_e.prototype.drawImage=function(Xe,Ge,ze,Ve,ei,si,li,ci,Ci){var Fi=this.pdf.getImageProperties(Xe),Oi=1,Ti=1,Ze=1,ii=1;Ve!==void 0&&ci!==void 0&&(Ze=ci/Ve,ii=Ci/ei,Oi=Fi.width/Ve*ci/Ve,Ti=Fi.height/ei*Ci/ei),si===void 0&&(si=Ge,li=ze,Ge=0,ze=0),Ve!==void 0&&ci===void 0&&(ci=Ve,Ci=ei),Ve===void 0&&ci===void 0&&(ci=Fi.width,Ci=Fi.height);for(var Qe,ui=this.ctx.transform.decompose(),gi=xi(ui.rotate.shx),_i=new e,Ri=(_i=(_i=(_i=_i.multiply(ui.translate)).multiply(ui.skew)).multiply(ui.scale)).applyToRectangle(new Ee(si-Ge*Ze,li-ze*ii,Ve*Oi,ei*Ti)),Ui=St.call(this,Ri),ki=[],Vi=0;Vi<Ui.length;Vi+=1)ki.indexOf(Ui[Vi])===-1&&ki.push(Ui[Vi]);if(De(ki),this.autoPaging)for(var Ii=ki[0],$i=ki[ki.length-1],tn=Ii;tn<$i+1;tn++){this.pdf.setPage(tn);var en=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],zi=tn===1?this.posY+this.margin[0]:this.margin[0],Ji=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],pn=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],an=tn===1?0:Ji+(tn-2)*pn;if(this.ctx.clip_path.length!==0){var kn=this.path;Qe=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=ke(Qe,this.posX+this.margin[3],-an+zi+this.ctx.prevPageLastElemOffset),je.call(this,"fill",!0),this.path=kn}var xn=JSON.parse(JSON.stringify(Ri));xn=ke([xn],this.posX+this.margin[3],-an+zi+this.ctx.prevPageLastElemOffset)[0];var Tn=(tn>Ii||tn<$i)&&Pe.call(this);Tn&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],en,pn,null).clip().discardPath()),this.pdf.addImage(Xe,"JPEG",xn.x,xn.y,xn.w,xn.h,null,null,gi),Tn&&this.pdf.restoreGraphicsState()}else this.pdf.addImage(Xe,"JPEG",Ri.x,Ri.y,Ri.w,Ri.h,null,null,gi)};var St=function(Xe,Ge,ze){var Ve=[];Ge=Ge||this.pdf.internal.pageSize.width,ze=ze||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var ei=this.posY+this.ctx.prevPageLastElemOffset;switch(Xe.type){default:case"mt":case"lt":Ve.push(Math.floor((Xe.y+ei)/ze)+1);break;case"arc":Ve.push(Math.floor((Xe.y+ei-Xe.radius)/ze)+1),Ve.push(Math.floor((Xe.y+ei+Xe.radius)/ze)+1);break;case"qct":var si=ni(this.ctx.lastPoint.x,this.ctx.lastPoint.y,Xe.x1,Xe.y1,Xe.x,Xe.y);Ve.push(Math.floor((si.y+ei)/ze)+1),Ve.push(Math.floor((si.y+si.h+ei)/ze)+1);break;case"bct":var li=fi(this.ctx.lastPoint.x,this.ctx.lastPoint.y,Xe.x1,Xe.y1,Xe.x2,Xe.y2,Xe.x,Xe.y);Ve.push(Math.floor((li.y+ei)/ze)+1),Ve.push(Math.floor((li.y+li.h+ei)/ze)+1);break;case"rect":Ve.push(Math.floor((Xe.y+ei)/ze)+1),Ve.push(Math.floor((Xe.y+Xe.h+ei)/ze)+1)}for(var ci=0;ci<Ve.length;ci+=1)for(;this.pdf.internal.getNumberOfPages()<Ve[ci];)Ce.call(this);return Ve},Ce=function(){var Xe=this.fillStyle,Ge=this.strokeStyle,ze=this.font,Ve=this.lineCap,ei=this.lineWidth,si=this.lineJoin;this.pdf.addPage(),this.fillStyle=Xe,this.strokeStyle=Ge,this.font=ze,this.lineCap=Ve,this.lineWidth=ei,this.lineJoin=si},ke=function(Xe,Ge,ze){for(var Ve=0;Ve<Xe.length;Ve++)switch(Xe[Ve].type){case"bct":Xe[Ve].x2+=Ge,Xe[Ve].y2+=ze;case"qct":Xe[Ve].x1+=Ge,Xe[Ve].y1+=ze;case"mt":case"lt":case"arc":default:Xe[Ve].x+=Ge,Xe[Ve].y+=ze}return Xe},De=function(Xe){return Xe.sort(function(Ge,ze){return Ge-ze})},Re=function(Xe,Ge){for(var ze,Ve,ei=this.fillStyle,si=this.strokeStyle,li=this.lineCap,ci=this.lineWidth,Ci=Math.abs(ci*this.ctx.transform.scaleX),Fi=this.lineJoin,Oi=JSON.parse(JSON.stringify(this.path)),Ti=JSON.parse(JSON.stringify(this.path)),Ze=[],ii=0;ii<Ti.length;ii++)if(Ti[ii].x!==void 0)for(var Qe=St.call(this,Ti[ii]),ui=0;ui<Qe.length;ui+=1)Ze.indexOf(Qe[ui])===-1&&Ze.push(Qe[ui]);for(var gi=0;gi<Ze.length;gi++)for(;this.pdf.internal.getNumberOfPages()<Ze[gi];)Ce.call(this);if(De(Ze),this.autoPaging)for(var _i=Ze[0],Ri=Ze[Ze.length-1],Ui=_i;Ui<Ri+1;Ui++){this.pdf.setPage(Ui),this.fillStyle=ei,this.strokeStyle=si,this.lineCap=li,this.lineWidth=Ci,this.lineJoin=Fi;var ki=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Vi=Ui===1?this.posY+this.margin[0]:this.margin[0],Ii=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],$i=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],tn=Ui===1?0:Ii+(Ui-2)*$i;if(this.ctx.clip_path.length!==0){var en=this.path;ze=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=ke(ze,this.posX+this.margin[3],-tn+Vi+this.ctx.prevPageLastElemOffset),je.call(this,Xe,!0),this.path=en}if(Ve=JSON.parse(JSON.stringify(Oi)),this.path=ke(Ve,this.posX+this.margin[3],-tn+Vi+this.ctx.prevPageLastElemOffset),Ge===!1||Ui===0){var zi=(Ui>_i||Ui<Ri)&&Pe.call(this);zi&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],ki,$i,null).clip().discardPath()),je.call(this,Xe,Ge),zi&&this.pdf.restoreGraphicsState()}this.lineWidth=ci}else this.lineWidth=Ci,je.call(this,Xe,Ge),this.lineWidth=ci;this.path=Oi},je=function(Xe,Ge){if((Xe!=="stroke"||Ge||!Ae.call(this))&&(Xe==="stroke"||Ge||!t.call(this))){for(var ze,Ve,ei=[],si=this.path,li=0;li<si.length;li++){var ci=si[li];switch(ci.type){case"begin":ei.push({begin:!0});break;case"close":ei.push({close:!0});break;case"mt":ei.push({start:ci,deltas:[],abs:[]});break;case"lt":var Ci=ei.length;if(si[li-1]&&!isNaN(si[li-1].x)&&(ze=[ci.x-si[li-1].x,ci.y-si[li-1].y],Ci>0)){for(;Ci>=0;Ci--)if(ei[Ci-1].close!==!0&&ei[Ci-1].begin!==!0){ei[Ci-1].deltas.push(ze),ei[Ci-1].abs.push(ci);break}}break;case"bct":ze=[ci.x1-si[li-1].x,ci.y1-si[li-1].y,ci.x2-si[li-1].x,ci.y2-si[li-1].y,ci.x-si[li-1].x,ci.y-si[li-1].y],ei[ei.length-1].deltas.push(ze);break;case"qct":var Fi=si[li-1].x+2/3*(ci.x1-si[li-1].x),Oi=si[li-1].y+2/3*(ci.y1-si[li-1].y),Ti=ci.x+2/3*(ci.x1-ci.x),Ze=ci.y+2/3*(ci.y1-ci.y),ii=ci.x,Qe=ci.y;ze=[Fi-si[li-1].x,Oi-si[li-1].y,Ti-si[li-1].x,Ze-si[li-1].y,ii-si[li-1].x,Qe-si[li-1].y],ei[ei.length-1].deltas.push(ze);break;case"arc":ei.push({deltas:[],abs:[],arc:!0}),Array.isArray(ei[ei.length-1].abs)&&ei[ei.length-1].abs.push(ci)}}Ve=Ge?null:Xe==="stroke"?"stroke":"fill";for(var ui=!1,gi=0;gi<ei.length;gi++)if(ei[gi].arc)for(var _i=ei[gi].abs,Ri=0;Ri<_i.length;Ri++){var Ui=_i[Ri];Ui.type==="arc"?Je.call(this,Ui.x,Ui.y,Ui.radius,Ui.startAngle,Ui.endAngle,Ui.counterclockwise,void 0,Ge,!ui):yi.call(this,Ui.x,Ui.y),ui=!0}else if(ei[gi].close===!0)this.pdf.internal.out("h"),ui=!1;else if(ei[gi].begin!==!0){var ki=ei[gi].start.x,Vi=ei[gi].start.y;di.call(this,ei[gi].deltas,ki,Vi),ui=!0}Ve&&hi.call(this,Ve),Ge&&oi.call(this)}},We=function(Xe){var Ge=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,ze=Ge*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return Xe-ze;case"top":return Xe+Ge-ze;case"hanging":return Xe+Ge-2*ze;case"middle":return Xe+Ge/2-ze;case"ideographic":return Xe;case"alphabetic":default:return Xe}},Ke=function(Xe){return Xe+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};_e.prototype.createLinearGradient=function(){var Xe=function(){};return Xe.colorStops=[],Xe.addColorStop=function(Ge,ze){this.colorStops.push([Ge,ze])},Xe.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},Xe.isCanvasGradient=!0,Xe},_e.prototype.createPattern=function(){return this.createLinearGradient()},_e.prototype.createRadialGradient=function(){return this.createLinearGradient()};var Je=function(Xe,Ge,ze,Ve,ei,si,li,ci,Ci){for(var Fi=vi.call(this,ze,Ve,ei,si),Oi=0;Oi<Fi.length;Oi++){var Ti=Fi[Oi];Oi===0&&(Ci?ti.call(this,Ti.x1+Xe,Ti.y1+Ge):yi.call(this,Ti.x1+Xe,Ti.y1+Ge)),bi.call(this,Xe,Ge,Ti.x2,Ti.y2,Ti.x3,Ti.y3,Ti.x4,Ti.y4)}ci?oi.call(this):hi.call(this,li)},hi=function(Xe){switch(Xe){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},oi=function(){this.pdf.clip(),this.pdf.discardPath()},ti=function(Xe,Ge){this.pdf.internal.out(Me(Xe)+" "+Oe(Ge)+" m")},ai=function(Xe){var Ge;switch(Xe.align){case"right":case"end":Ge="right";break;case"center":Ge="center";break;case"left":case"start":default:Ge="left"}var ze=this.pdf.getTextDimensions(Xe.text),Ve=We.call(this,Xe.y),ei=Ke.call(this,Ve)-ze.h,si=this.ctx.transform.applyToPoint(new He(Xe.x,Ve)),li=this.ctx.transform.decompose(),ci=new e;ci=(ci=(ci=ci.multiply(li.translate)).multiply(li.skew)).multiply(li.scale);for(var Ci,Fi,Oi,Ti=this.ctx.transform.applyToRectangle(new Ee(Xe.x,Ve,ze.w,ze.h)),Ze=ci.applyToRectangle(new Ee(Xe.x,ei,ze.w,ze.h)),ii=St.call(this,Ze),Qe=[],ui=0;ui<ii.length;ui+=1)Qe.indexOf(ii[ui])===-1&&Qe.push(ii[ui]);if(De(Qe),this.autoPaging)for(var gi=Qe[0],_i=Qe[Qe.length-1],Ri=gi;Ri<_i+1;Ri++){this.pdf.setPage(Ri);var Ui=Ri===1?this.posY+this.margin[0]:this.margin[0],ki=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Vi=this.pdf.internal.pageSize.height-this.margin[2],Ii=Vi-this.margin[0],$i=this.pdf.internal.pageSize.width-this.margin[1],tn=$i-this.margin[3],en=Ri===1?0:ki+(Ri-2)*Ii;if(this.ctx.clip_path.length!==0){var zi=this.path;Ci=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=ke(Ci,this.posX+this.margin[3],-1*en+Ui),je.call(this,"fill",!0),this.path=zi}var Ji=ke([JSON.parse(JSON.stringify(Ze))],this.posX+this.margin[3],-en+Ui+this.ctx.prevPageLastElemOffset)[0];Xe.scale>=.01&&(Fi=this.pdf.internal.getFontSize(),this.pdf.setFontSize(Fi*Xe.scale),Oi=this.lineWidth,this.lineWidth=Oi*Xe.scale);var pn=this.autoPaging!=="text";if(pn||Ji.y+Ji.h<=Vi){if(pn||Ji.y>=Ui&&Ji.x<=$i){var an=pn?Xe.text:this.pdf.splitTextToSize(Xe.text,Xe.maxWidth||$i-Ji.x)[0],kn=ke([JSON.parse(JSON.stringify(Ti))],this.posX+this.margin[3],-en+Ui+this.ctx.prevPageLastElemOffset)[0],xn=pn&&(Ri>gi||Ri<_i)&&Pe.call(this);xn&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],tn,Ii,null).clip().discardPath()),this.pdf.text(an,kn.x,kn.y,{angle:Xe.angle,align:Ge,renderingMode:Xe.renderingMode}),xn&&this.pdf.restoreGraphicsState()}}else Ji.y<Vi&&(this.ctx.prevPageLastElemOffset+=Vi-Ji.y);Xe.scale>=.01&&(this.pdf.setFontSize(Fi),this.lineWidth=Oi)}else Xe.scale>=.01&&(Fi=this.pdf.internal.getFontSize(),this.pdf.setFontSize(Fi*Xe.scale),Oi=this.lineWidth,this.lineWidth=Oi*Xe.scale),this.pdf.text(Xe.text,si.x+this.posX,si.y+this.posY,{angle:Xe.angle,align:Ge,renderingMode:Xe.renderingMode,maxWidth:Xe.maxWidth}),Xe.scale>=.01&&(this.pdf.setFontSize(Fi),this.lineWidth=Oi)},yi=function(Xe,Ge,ze,Ve){ze=ze||0,Ve=Ve||0,this.pdf.internal.out(Me(Xe+ze)+" "+Oe(Ge+Ve)+" l")},di=function(Xe,Ge,ze){return this.pdf.lines(Xe,Ge,ze,null,null)},bi=function(Xe,Ge,ze,Ve,ei,si,li,ci){this.pdf.internal.out([r(Be(ze+Xe)),r(Ue(Ve+Ge)),r(Be(ei+Xe)),r(Ue(si+Ge)),r(Be(li+Xe)),r(Ue(ci+Ge)),"c"].join(" "))},vi=function(Xe,Ge,ze,Ve){for(var ei=2*Math.PI,si=Math.PI/2;Ge>ze;)Ge-=ei;var li=Math.abs(ze-Ge);li<ei&&Ve&&(li=ei-li);for(var ci=[],Ci=Ve?-1:1,Fi=Ge;li>1e-5;){var Oi=Fi+Ci*Math.min(li,si);ci.push(Pi.call(this,Xe,Fi,Oi)),li-=Math.abs(Oi-Fi),Fi=Oi}return ci},Pi=function(Xe,Ge,ze){var Ve=(ze-Ge)/2,ei=Xe*Math.cos(Ve),si=Xe*Math.sin(Ve),li=ei,ci=-si,Ci=li*li+ci*ci,Fi=Ci+li*ei+ci*si,Oi=4/3*(Math.sqrt(2*Ci*Fi)-Fi)/(li*si-ci*ei),Ti=li-Oi*ci,Ze=ci+Oi*li,ii=Ti,Qe=-Ze,ui=Ve+Ge,gi=Math.cos(ui),_i=Math.sin(ui);return{x1:Xe*Math.cos(Ge),y1:Xe*Math.sin(Ge),x2:Ti*gi-Ze*_i,y2:Ti*_i+Ze*gi,x3:ii*gi-Qe*_i,y3:ii*_i+Qe*gi,x4:Xe*Math.cos(ze),y4:Xe*Math.sin(ze)}},xi=function(Xe){return 180*Xe/Math.PI},ni=function(Xe,Ge,ze,Ve,ei,si){var li=Xe+.5*(ze-Xe),ci=Ge+.5*(Ve-Ge),Ci=ei+.5*(ze-ei),Fi=si+.5*(Ve-si),Oi=Math.min(Xe,ei,li,Ci),Ti=Math.max(Xe,ei,li,Ci),Ze=Math.min(Ge,si,ci,Fi),ii=Math.max(Ge,si,ci,Fi);return new Ee(Oi,Ze,Ti-Oi,ii-Ze)},fi=function(Xe,Ge,ze,Ve,ei,si,li,ci){var Ci,Fi,Oi,Ti,Ze,ii,Qe,ui,gi,_i,Ri,Ui,ki,Vi,Ii=ze-Xe,$i=Ve-Ge,tn=ei-ze,en=si-Ve,zi=li-ei,Ji=ci-si;for(Fi=0;Fi<41;Fi++)gi=(Qe=(Oi=Xe+(Ci=Fi/40)*Ii)+Ci*((Ze=ze+Ci*tn)-Oi))+Ci*(Ze+Ci*(ei+Ci*zi-Ze)-Qe),_i=(ui=(Ti=Ge+Ci*$i)+Ci*((ii=Ve+Ci*en)-Ti))+Ci*(ii+Ci*(si+Ci*Ji-ii)-ui),Fi==0?(Ri=gi,Ui=_i,ki=gi,Vi=_i):(Ri=Math.min(Ri,gi),Ui=Math.min(Ui,_i),ki=Math.max(ki,gi),Vi=Math.max(Vi,_i));return new Ee(Math.round(Ri),Math.round(Ui),Math.round(ki-Ri),Math.round(Vi-Ui))},Si=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var Xe,Ge,ze=(Xe=this.ctx.lineDash,Ge=this.ctx.lineDashOffset,JSON.stringify({lineDash:Xe,lineDashOffset:Ge}));this.prevLineDash!==ze&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=ze)}}})(E.API),function(Ie){var r=function(Ue){var He,Ee,e,xe,Te,_e,Se,t,Ae,Pe;for(/[^\x00-\xFF]/.test(Ue),Ee=[],e=0,xe=(Ue+=He="\0\0\0\0".slice(Ue.length%4||4)).length;xe>e;e+=4)(Te=(Ue.charCodeAt(e)<<24)+(Ue.charCodeAt(e+1)<<16)+(Ue.charCodeAt(e+2)<<8)+Ue.charCodeAt(e+3))!==0?(_e=(Te=((Te=((Te=((Te=(Te-(Pe=Te%85))/85)-(Ae=Te%85))/85)-(t=Te%85))/85)-(Se=Te%85))/85)%85,Ee.push(_e+33,Se+33,t+33,Ae+33,Pe+33)):Ee.push(122);return function(St,Ce){for(var ke=Ce;ke>0;ke--)St.pop()}(Ee,He.length),String.fromCharCode.apply(String,Ee)+"~>"},Me=function(Ue){var He,Ee,e,xe,Te,_e=String,Se="length",t=255,Ae="charCodeAt",Pe="slice",St="replace";for(Ue[Pe](-2),Ue=Ue[Pe](0,-2)[St](/\s/g,"")[St]("z","!!!!!"),e=[],xe=0,Te=(Ue+=He="uuuuu"[Pe](Ue[Se]%5||5))[Se];Te>xe;xe+=5)Ee=52200625*(Ue[Ae](xe)-33)+614125*(Ue[Ae](xe+1)-33)+7225*(Ue[Ae](xe+2)-33)+85*(Ue[Ae](xe+3)-33)+(Ue[Ae](xe+4)-33),e.push(t&Ee>>24,t&Ee>>16,t&Ee>>8,t&Ee);return function(Ce,ke){for(var De=ke;De>0;De--)Ce.pop()}(e,He[Se]),_e.fromCharCode.apply(_e,e)},Oe=function(Ue){var He=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((Ue=Ue.replace(/\s/g,"")).indexOf(">")!==-1&&(Ue=Ue.substr(0,Ue.indexOf(">"))),Ue.length%2&&(Ue+="0"),He.test(Ue)===!1)return"";for(var Ee="",e=0;e<Ue.length;e+=2)Ee+=String.fromCharCode("0x"+(Ue[e]+Ue[e+1]));return Ee},Be=function(Ue){for(var He=new Uint8Array(Ue.length),Ee=Ue.length;Ee--;)He[Ee]=Ue.charCodeAt(Ee);return Ue=(He=zlibSync(He)).reduce(function(e,xe){return e+String.fromCharCode(xe)},"")};Ie.processDataByFilters=function(Ue,He){var Ee=0,e=Ue||"",xe=[];for(typeof(He=He||[])=="string"&&(He=[He]),Ee=0;Ee<He.length;Ee+=1)switch(He[Ee]){case"ASCII85Decode":case"/ASCII85Decode":e=Me(e),xe.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":e=r(e),xe.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":e=Oe(e),xe.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":e=e.split("").map(function(Te){return("0"+Te.charCodeAt().toString(16)).slice(-2)}).join("")+">",xe.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":e=Be(e),xe.push("/FlateDecode");break;default:throw new Error('The filter: "'+He[Ee]+'" is not implemented')}return{data:e,reverseChain:xe.reverse().join(" ")}}}(E.API),function(Ie){Ie.loadFile=function(r,Me,Oe){return function(Be,Ue,He){Ue=Ue!==!1,He=typeof He=="function"?He:function(){};var Ee=void 0;try{Ee=function(e,xe,Te){var _e=new XMLHttpRequest,Se=0,t=function(Ae){var Pe=Ae.length,St=[],Ce=String.fromCharCode;for(Se=0;Se<Pe;Se+=1)St.push(Ce(255&Ae.charCodeAt(Se)));return St.join("")};if(_e.open("GET",e,!xe),_e.overrideMimeType("text/plain; charset=x-user-defined"),xe===!1&&(_e.onload=function(){_e.status===200?Te(t(this.responseText)):Te(void 0)}),_e.send(null),xe&&_e.status===200)return t(_e.responseText)}(Be,Ue,He)}catch{}return Ee}(r,Me,Oe)},Ie.loadImageFile=Ie.loadFile}(E.API),function(Ie){function r(){return(n.html2canvas?Promise.resolve(n.html2canvas):__vitePreload(()=>import("./html2canvas.esm.0eae2bf4.js"),[])).catch(function(He){return Promise.reject(new Error("Could not load html2canvas: "+He))}).then(function(He){return He.default?He.default:He})}function Me(){return(n.DOMPurify?Promise.resolve(n.DOMPurify):__vitePreload(()=>import("./purify.es.b8146866.js"),[])).catch(function(He){return Promise.reject(new Error("Could not load dompurify: "+He))}).then(function(He){return He.default?He.default:He})}var Oe=function(He){var Ee=_typeof(He);return Ee==="undefined"?"undefined":Ee==="string"||He instanceof String?"string":Ee==="number"||He instanceof Number?"number":Ee==="function"||He instanceof Function?"function":He&&He.constructor===Array?"array":He&&He.nodeType===1?"element":Ee==="object"?"object":"unknown"},Be=function(He,Ee){var e=document.createElement(He);for(var xe in Ee.className&&(e.className=Ee.className),Ee.innerHTML&&Ee.dompurify&&(e.innerHTML=Ee.dompurify.sanitize(Ee.innerHTML)),Ee.style)e.style[xe]=Ee.style[xe];return e},Ue=function He(Ee){var e=Object.assign(He.convert(Promise.resolve()),JSON.parse(JSON.stringify(He.template))),xe=He.convert(Promise.resolve(),e);return xe=(xe=xe.setProgress(1,He,1,[He])).set(Ee)};(Ue.prototype=Object.create(Promise.prototype)).constructor=Ue,Ue.convert=function(He,Ee){return He.__proto__=Ee||Ue.prototype,He},Ue.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},Ue.prototype.from=function(He,Ee){return this.then(function(){switch(Ee=Ee||function(e){switch(Oe(e)){case"string":return"string";case"element":return e.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}}(He)){case"string":return this.then(Me).then(function(e){return this.set({src:Be("div",{innerHTML:He,dompurify:e})})});case"element":return this.set({src:He});case"canvas":return this.set({canvas:He});case"img":return this.set({img:He});default:return this.error("Unknown source type.")}})},Ue.prototype.to=function(He){switch(He){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},Ue.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var He={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},Ee=function e(xe,Te){for(var _e=xe.nodeType===3?document.createTextNode(xe.nodeValue):xe.cloneNode(!1),Se=xe.firstChild;Se;Se=Se.nextSibling)Te!==!0&&Se.nodeType===1&&Se.nodeName==="SCRIPT"||_e.appendChild(e(Se,Te));return xe.nodeType===1&&(xe.nodeName==="CANVAS"?(_e.width=xe.width,_e.height=xe.height,_e.getContext("2d").drawImage(xe,0,0)):xe.nodeName!=="TEXTAREA"&&xe.nodeName!=="SELECT"||(_e.value=xe.value),_e.addEventListener("load",function(){_e.scrollTop=xe.scrollTop,_e.scrollLeft=xe.scrollLeft},!0)),_e}(this.prop.src,this.opt.html2canvas.javascriptEnabled);Ee.tagName==="BODY"&&(He.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=Be("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=Be("div",{className:"html2pdf__container",style:He}),this.prop.container.appendChild(Ee),this.prop.container.firstChild.appendChild(Be("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},Ue.prototype.toCanvas=function(){var He=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(He).then(r).then(function(Ee){var e=Object.assign({},this.opt.html2canvas);return delete e.onrendered,Ee(this.prop.container,e)}).then(function(Ee){(this.opt.html2canvas.onrendered||function(){})(Ee),this.prop.canvas=Ee,document.body.removeChild(this.prop.overlay)})},Ue.prototype.toContext2d=function(){var He=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(He).then(r).then(function(Ee){var e=this.opt.jsPDF,xe=this.opt.fontFaces,Te=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,_e=Object.assign({async:!0,allowTaint:!0,scale:Te,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete _e.onrendered,e.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,e.context2d.posX=this.opt.x,e.context2d.posY=this.opt.y,e.context2d.margin=this.opt.margin,e.context2d.fontFaces=xe,xe)for(var Se=0;Se<xe.length;++Se){var t=xe[Se],Ae=t.src.find(function(Pe){return Pe.format==="truetype"});Ae&&e.addFont(Ae.url,t.ref.name,t.ref.style)}return _e.windowHeight=_e.windowHeight||0,_e.windowHeight=_e.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):_e.windowHeight,e.context2d.save(!0),Ee(this.prop.container,_e)}).then(function(Ee){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(Ee),this.prop.canvas=Ee,document.body.removeChild(this.prop.overlay)})},Ue.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var He=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=He})},Ue.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},Ue.prototype.output=function(He,Ee,e){return(e=e||"pdf").toLowerCase()==="img"||e.toLowerCase()==="image"?this.outputImg(He,Ee):this.outputPdf(He,Ee)},Ue.prototype.outputPdf=function(He,Ee){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(He,Ee)})},Ue.prototype.outputImg=function(He){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(He){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+He+'" is not supported.'}})},Ue.prototype.save=function(He){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(He?{filename:He}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},Ue.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},Ue.prototype.set=function(He){if(Oe(He)!=="object")return this;var Ee=Object.keys(He||{}).map(function(e){if(e in Ue.template.prop)return function(){this.prop[e]=He[e]};switch(e){case"margin":return this.setMargin.bind(this,He.margin);case"jsPDF":return function(){return this.opt.jsPDF=He.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,He.pageSize);default:return function(){this.opt[e]=He[e]}}},this);return this.then(function(){return this.thenList(Ee)})},Ue.prototype.get=function(He,Ee){return this.then(function(){var e=He in Ue.template.prop?this.prop[He]:this.opt[He];return Ee?Ee(e):e})},Ue.prototype.setMargin=function(He){return this.then(function(){switch(Oe(He)){case"number":He=[He,He,He,He];case"array":if(He.length===2&&(He=[He[0],He[1],He[0],He[1]]),He.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=He}).then(this.setPageSize)},Ue.prototype.setPageSize=function(He){function Ee(e,xe){return Math.floor(e*xe/72*96)}return this.then(function(){(He=He||E.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(He.inner={width:He.width-this.opt.margin[1]-this.opt.margin[3],height:He.height-this.opt.margin[0]-this.opt.margin[2]},He.inner.px={width:Ee(He.inner.width,He.k),height:Ee(He.inner.height,He.k)},He.inner.ratio=He.inner.height/He.inner.width),this.prop.pageSize=He})},Ue.prototype.setProgress=function(He,Ee,e,xe){return He!=null&&(this.progress.val=He),Ee!=null&&(this.progress.state=Ee),e!=null&&(this.progress.n=e),xe!=null&&(this.progress.stack=xe),this.progress.ratio=this.progress.val/this.progress.state,this},Ue.prototype.updateProgress=function(He,Ee,e,xe){return this.setProgress(He?this.progress.val+He:null,Ee||null,e?this.progress.n+e:null,xe?this.progress.stack.concat(xe):null)},Ue.prototype.then=function(He,Ee){var e=this;return this.thenCore(He,Ee,function(xe,Te){return e.updateProgress(null,null,1,[xe]),Promise.prototype.then.call(this,function(_e){return e.updateProgress(null,xe),_e}).then(xe,Te).then(function(_e){return e.updateProgress(1),_e})})},Ue.prototype.thenCore=function(He,Ee,e){e=e||Promise.prototype.then,He&&(He=He.bind(this)),Ee&&(Ee=Ee.bind(this));var xe=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?this:Ue.convert(Object.assign({},this),Promise.prototype),Te=e.call(xe,He,Ee);return Ue.convert(Te,this.__proto__)},Ue.prototype.thenExternal=function(He,Ee){return Promise.prototype.then.call(this,He,Ee)},Ue.prototype.thenList=function(He){var Ee=this;return He.forEach(function(e){Ee=Ee.thenCore(e)}),Ee},Ue.prototype.catch=function(He){He&&(He=He.bind(this));var Ee=Promise.prototype.catch.call(this,He);return Ue.convert(Ee,this)},Ue.prototype.catchExternal=function(He){return Promise.prototype.catch.call(this,He)},Ue.prototype.error=function(He){return this.then(function(){throw new Error(He)})},Ue.prototype.using=Ue.prototype.set,Ue.prototype.saveAs=Ue.prototype.save,Ue.prototype.export=Ue.prototype.output,Ue.prototype.run=Ue.prototype.then,E.getPageSize=function(He,Ee,e){if(_typeof(He)==="object"){var xe=He;He=xe.orientation,Ee=xe.unit||Ee,e=xe.format||e}Ee=Ee||"mm",e=e||"a4",He=(""+(He||"P")).toLowerCase();var Te,_e=(""+e).toLowerCase(),Se={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(Ee){case"pt":Te=1;break;case"mm":Te=72/25.4;break;case"cm":Te=72/2.54;break;case"in":Te=72;break;case"px":Te=.75;break;case"pc":case"em":Te=12;break;case"ex":Te=6;break;default:throw"Invalid unit: "+Ee}var t,Ae=0,Pe=0;if(Se.hasOwnProperty(_e))Ae=Se[_e][1]/Te,Pe=Se[_e][0]/Te;else try{Ae=e[1],Pe=e[0]}catch{throw new Error("Invalid format: "+e)}if(He==="p"||He==="portrait")He="p",Pe>Ae&&(t=Pe,Pe=Ae,Ae=t);else{if(He!=="l"&&He!=="landscape")throw"Invalid orientation: "+He;He="l",Ae>Pe&&(t=Pe,Pe=Ae,Ae=t)}return{width:Pe,height:Ae,unit:Ee,k:Te,orientation:He}},Ie.html=function(He,Ee){(Ee=Ee||{}).callback=Ee.callback||function(){},Ee.html2canvas=Ee.html2canvas||{},Ee.html2canvas.canvas=Ee.html2canvas.canvas||this.canvas,Ee.jsPDF=Ee.jsPDF||this,Ee.fontFaces=Ee.fontFaces?Ee.fontFaces.map(jt):null;var e=new Ue(Ee);return Ee.worker?e:e.from(He).doCallback()}}(E.API),E.API.addJS=function(Ie){return Ht=Ie,this.internal.events.subscribe("postPutResources",function(){Ut=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(Ut+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),zt=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+Ht+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){Ut!==void 0&&zt!==void 0&&this.internal.out("/Names <</JavaScript "+Ut+" 0 R>>")}),this},function(Ie){var r;Ie.events.push(["postPutResources",function(){var Me=this,Oe=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var Be=Me.outline.render().split(/\r\n/),Ue=0;Ue<Be.length;Ue++){var He=Be[Ue],Ee=Oe.exec(He);if(Ee!=null){var e=Ee[1];Me.internal.newObjectDeferredBegin(e,!1)}Me.internal.write(He)}if(this.outline.createNamedDestinations){var xe=this.internal.pages.length,Te=[];for(Ue=0;Ue<xe;Ue++){var _e=Me.internal.newObject();Te.push(_e);var Se=Me.internal.getPageInfo(Ue+1);Me.internal.write("<< /D["+Se.objId+" 0 R /XYZ null null null]>> endobj")}var t=Me.internal.newObject();for(Me.internal.write("<< /Names [ "),Ue=0;Ue<Te.length;Ue++)Me.internal.write("(page_"+(Ue+1)+")"+Te[Ue]+" 0 R");Me.internal.write(" ] >>","endobj"),r=Me.internal.newObject(),Me.internal.write("<< /Dests "+t+" 0 R"),Me.internal.write(">>","endobj")}}]),Ie.events.push(["putCatalog",function(){this.outline.root.children.length>0&&(this.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&this.internal.write("/Names "+r+" 0 R"))}]),Ie.events.push(["initialized",function(){var Me=this;Me.outline={createNamedDestinations:!1,root:{children:[]}},Me.outline.add=function(Oe,Be,Ue){var He={title:Be,options:Ue,children:[]};return Oe==null&&(Oe=this.root),Oe.children.push(He),He},Me.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=Me,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},Me.outline.genIds_r=function(Oe){Oe.id=Me.internal.newObjectDeferred();for(var Be=0;Be<Oe.children.length;Be++)this.genIds_r(Oe.children[Be])},Me.outline.renderRoot=function(Oe){this.objStart(Oe),this.line("/Type /Outlines"),Oe.children.length>0&&(this.line("/First "+this.makeRef(Oe.children[0])),this.line("/Last "+this.makeRef(Oe.children[Oe.children.length-1]))),this.line("/Count "+this.count_r({count:0},Oe)),this.objEnd()},Me.outline.renderItems=function(Oe){for(var Be=this.ctx.pdf.internal.getVerticalCoordinateString,Ue=0;Ue<Oe.children.length;Ue++){var He=Oe.children[Ue];this.objStart(He),this.line("/Title "+this.makeString(He.title)),this.line("/Parent "+this.makeRef(Oe)),Ue>0&&this.line("/Prev "+this.makeRef(Oe.children[Ue-1])),Ue<Oe.children.length-1&&this.line("/Next "+this.makeRef(Oe.children[Ue+1])),He.children.length>0&&(this.line("/First "+this.makeRef(He.children[0])),this.line("/Last "+this.makeRef(He.children[He.children.length-1])));var Ee=this.count=this.count_r({count:0},He);if(Ee>0&&this.line("/Count "+Ee),He.options&&He.options.pageNumber){var e=Me.internal.getPageInfo(He.options.pageNumber);this.line("/Dest ["+e.objId+" 0 R /XYZ 0 "+Be(0)+" 0]")}this.objEnd()}for(var xe=0;xe<Oe.children.length;xe++)this.renderItems(Oe.children[xe])},Me.outline.line=function(Oe){this.ctx.val+=Oe+`\r
`},Me.outline.makeRef=function(Oe){return Oe.id+" 0 R"},Me.outline.makeString=function(Oe){return"("+Me.internal.pdfEscape(Oe)+")"},Me.outline.objStart=function(Oe){this.ctx.val+=`\r
`+Oe.id+` 0 obj\r
<<\r
`},Me.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},Me.outline.count_r=function(Oe,Be){for(var Ue=0;Ue<Be.children.length;Ue++)Oe.count++,this.count_r(Oe,Be.children[Ue]);return Oe.count}}])}(E.API),function(Ie){var r=[192,193,194,195,196,197,198,199];Ie.processJPEG=function(Me,Oe,Be,Ue,He,Ee){var e,xe=this.decode.DCT_DECODE,Te=null;if(typeof Me=="string"||this.__addimage__.isArrayBuffer(Me)||this.__addimage__.isArrayBufferView(Me)){switch(Me=He||Me,Me=this.__addimage__.isArrayBuffer(Me)?new Uint8Array(Me):Me,(e=function(_e){for(var Se,t=256*_e.charCodeAt(4)+_e.charCodeAt(5),Ae=_e.length,Pe={width:0,height:0,numcomponents:1},St=4;St<Ae;St+=2){if(St+=t,r.indexOf(_e.charCodeAt(St+1))!==-1){Se=256*_e.charCodeAt(St+5)+_e.charCodeAt(St+6),Pe={width:256*_e.charCodeAt(St+7)+_e.charCodeAt(St+8),height:Se,numcomponents:_e.charCodeAt(St+9)};break}t=256*_e.charCodeAt(St+2)+_e.charCodeAt(St+3)}return Pe}(Me=this.__addimage__.isArrayBufferView(Me)?this.__addimage__.arrayBufferToBinaryString(Me):Me)).numcomponents){case 1:Ee=this.color_spaces.DEVICE_GRAY;break;case 4:Ee=this.color_spaces.DEVICE_CMYK;break;case 3:Ee=this.color_spaces.DEVICE_RGB}Te={data:Me,width:e.width,height:e.height,colorSpace:Ee,bitsPerComponent:8,filter:xe,index:Oe,alias:Be}}return Te}}(E.API);var Vt,Gt,Yt,Jt,Xt,Kt=function(){var Ie,r,Me;function Oe(Ue){var He,Ee,e,xe,Te,_e,Se,t,Ae,Pe,St,Ce,ke,De;for(this.data=Ue,this.pos=8,this.palette=[],this.imgData=[],this.transparency={},this.animation=null,this.text={},_e=null;;){switch(He=this.readUInt32(),Ae=function(){var Re,je;for(je=[],Re=0;Re<4;++Re)je.push(String.fromCharCode(this.data[this.pos++]));return je}.call(this).join("")){case"IHDR":this.width=this.readUInt32(),this.height=this.readUInt32(),this.bits=this.data[this.pos++],this.colorType=this.data[this.pos++],this.compressionMethod=this.data[this.pos++],this.filterMethod=this.data[this.pos++],this.interlaceMethod=this.data[this.pos++];break;case"acTL":this.animation={numFrames:this.readUInt32(),numPlays:this.readUInt32()||1/0,frames:[]};break;case"PLTE":this.palette=this.read(He);break;case"fcTL":_e&&this.animation.frames.push(_e),this.pos+=4,_e={width:this.readUInt32(),height:this.readUInt32(),xOffset:this.readUInt32(),yOffset:this.readUInt32()},Te=this.readUInt16(),xe=this.readUInt16()||100,_e.delay=1e3*Te/xe,_e.disposeOp=this.data[this.pos++],_e.blendOp=this.data[this.pos++],_e.data=[];break;case"IDAT":case"fdAT":for(Ae==="fdAT"&&(this.pos+=4,He-=4),Ue=(_e!=null?_e.data:void 0)||this.imgData,Ce=0;0<=He?Ce<He:Ce>He;0<=He?++Ce:--Ce)Ue.push(this.data[this.pos++]);break;case"tRNS":switch(this.transparency={},this.colorType){case 3:if(e=this.palette.length/3,this.transparency.indexed=this.read(He),this.transparency.indexed.length>e)throw new Error("More transparent colors than palette size");if((Pe=e-this.transparency.indexed.length)>0)for(ke=0;0<=Pe?ke<Pe:ke>Pe;0<=Pe?++ke:--ke)this.transparency.indexed.push(255);break;case 0:this.transparency.grayscale=this.read(He)[0];break;case 2:this.transparency.rgb=this.read(He)}break;case"tEXt":Se=(St=this.read(He)).indexOf(0),t=String.fromCharCode.apply(String,St.slice(0,Se)),this.text[t]=String.fromCharCode.apply(String,St.slice(Se+1));break;case"IEND":return _e&&this.animation.frames.push(_e),this.colors=function(){switch(this.colorType){case 0:case 3:case 4:return 1;case 2:case 6:return 3}}.call(this),this.hasAlphaChannel=(De=this.colorType)===4||De===6,Ee=this.colors+(this.hasAlphaChannel?1:0),this.pixelBitlength=this.bits*Ee,this.colorSpace=function(){switch(this.colors){case 1:return"DeviceGray";case 3:return"DeviceRGB"}}.call(this),void(this.imgData=new Uint8Array(this.imgData));default:this.pos+=He}if(this.pos+=4,this.pos>this.data.length)throw new Error("Incomplete or corrupt PNG file")}}Oe.prototype.read=function(Ue){var He,Ee;for(Ee=[],He=0;0<=Ue?He<Ue:He>Ue;0<=Ue?++He:--He)Ee.push(this.data[this.pos++]);return Ee},Oe.prototype.readUInt32=function(){return this.data[this.pos++]<<24|this.data[this.pos++]<<16|this.data[this.pos++]<<8|this.data[this.pos++]},Oe.prototype.readUInt16=function(){return this.data[this.pos++]<<8|this.data[this.pos++]},Oe.prototype.decodePixels=function(Ue){var He=this.pixelBitlength/8,Ee=new Uint8Array(this.width*this.height*He),e=0,xe=this;if(Ue==null&&(Ue=this.imgData),Ue.length===0)return new Uint8Array(0);function Te(_e,Se,t,Ae){var Pe,St,Ce,ke,De,Re,je,We,Ke,Je,hi,oi,ti,ai,yi,di,bi,vi,Pi,xi,ni,fi=Math.ceil((xe.width-_e)/t),Si=Math.ceil((xe.height-Se)/Ae),Xe=xe.width==fi&&xe.height==Si;for(ai=He*fi,oi=Xe?Ee:new Uint8Array(ai*Si),Re=Ue.length,ti=0,St=0;ti<Si&&e<Re;){switch(Ue[e++]){case 0:for(ke=bi=0;bi<ai;ke=bi+=1)oi[St++]=Ue[e++];break;case 1:for(ke=vi=0;vi<ai;ke=vi+=1)Pe=Ue[e++],De=ke<He?0:oi[St-He],oi[St++]=(Pe+De)%256;break;case 2:for(ke=Pi=0;Pi<ai;ke=Pi+=1)Pe=Ue[e++],Ce=(ke-ke%He)/He,yi=ti&&oi[(ti-1)*ai+Ce*He+ke%He],oi[St++]=(yi+Pe)%256;break;case 3:for(ke=xi=0;xi<ai;ke=xi+=1)Pe=Ue[e++],Ce=(ke-ke%He)/He,De=ke<He?0:oi[St-He],yi=ti&&oi[(ti-1)*ai+Ce*He+ke%He],oi[St++]=(Pe+Math.floor((De+yi)/2))%256;break;case 4:for(ke=ni=0;ni<ai;ke=ni+=1)Pe=Ue[e++],Ce=(ke-ke%He)/He,De=ke<He?0:oi[St-He],ti===0?yi=di=0:(yi=oi[(ti-1)*ai+Ce*He+ke%He],di=Ce&&oi[(ti-1)*ai+(Ce-1)*He+ke%He]),je=De+yi-di,We=Math.abs(je-De),Je=Math.abs(je-yi),hi=Math.abs(je-di),Ke=We<=Je&&We<=hi?De:Je<=hi?yi:di,oi[St++]=(Pe+Ke)%256;break;default:throw new Error("Invalid filter algorithm: "+Ue[e-1])}if(!Xe){var Ge=((Se+ti*Ae)*xe.width+_e)*He,ze=ti*ai;for(ke=0;ke<fi;ke+=1){for(var Ve=0;Ve<He;Ve+=1)Ee[Ge++]=oi[ze++];Ge+=(t-1)*He}}ti++}}return Ue=unzlibSync(Ue),xe.interlaceMethod==1?(Te(0,0,8,8),Te(4,0,8,8),Te(0,4,4,8),Te(2,0,4,4),Te(0,2,2,4),Te(1,0,2,2),Te(0,1,1,2)):Te(0,0,1,1),Ee},Oe.prototype.decodePalette=function(){var Ue,He,Ee,e,xe,Te,_e,Se,t;for(Ee=this.palette,Te=this.transparency.indexed||[],xe=new Uint8Array((Te.length||0)+Ee.length),e=0,Ue=0,He=_e=0,Se=Ee.length;_e<Se;He=_e+=3)xe[e++]=Ee[He],xe[e++]=Ee[He+1],xe[e++]=Ee[He+2],xe[e++]=(t=Te[Ue++])!=null?t:255;return xe},Oe.prototype.copyToImageData=function(Ue,He){var Ee,e,xe,Te,_e,Se,t,Ae,Pe,St,Ce;if(e=this.colors,Pe=null,Ee=this.hasAlphaChannel,this.palette.length&&(Pe=(Ce=this._decodedPalette)!=null?Ce:this._decodedPalette=this.decodePalette(),e=4,Ee=!0),Ae=(xe=Ue.data||Ue).length,_e=Pe||He,Te=Se=0,e===1)for(;Te<Ae;)t=Pe?4*He[Te/4]:Se,St=_e[t++],xe[Te++]=St,xe[Te++]=St,xe[Te++]=St,xe[Te++]=Ee?_e[t++]:255,Se=t;else for(;Te<Ae;)t=Pe?4*He[Te/4]:Se,xe[Te++]=_e[t++],xe[Te++]=_e[t++],xe[Te++]=_e[t++],xe[Te++]=Ee?_e[t++]:255,Se=t},Oe.prototype.decode=function(){var Ue;return Ue=new Uint8Array(this.width*this.height*4),this.copyToImageData(Ue,this.decodePixels()),Ue};var Be=function(){if(Object.prototype.toString.call(n)==="[object Window]"){try{r=n.document.createElement("canvas"),Me=r.getContext("2d")}catch{return!1}return!0}return!1};return Be(),Ie=function(Ue){var He;if(Be()===!0)return Me.width=Ue.width,Me.height=Ue.height,Me.clearRect(0,0,Ue.width,Ue.height),Me.putImageData(Ue,0,0),(He=new Image).src=r.toDataURL(),He;throw new Error("This method requires a Browser with Canvas-capability.")},Oe.prototype.decodeFrames=function(Ue){var He,Ee,e,xe,Te,_e,Se,t;if(this.animation){for(t=[],Ee=Te=0,_e=(Se=this.animation.frames).length;Te<_e;Ee=++Te)He=Se[Ee],e=Ue.createImageData(He.width,He.height),xe=this.decodePixels(new Uint8Array(He.data)),this.copyToImageData(e,xe),He.imageData=e,t.push(He.image=Ie(e));return t}},Oe.prototype.renderFrame=function(Ue,He){var Ee,e,xe;return Ee=(e=this.animation.frames)[He],xe=e[He-1],He===0&&Ue.clearRect(0,0,this.width,this.height),(xe!=null?xe.disposeOp:void 0)===1?Ue.clearRect(xe.xOffset,xe.yOffset,xe.width,xe.height):(xe!=null?xe.disposeOp:void 0)===2&&Ue.putImageData(xe.imageData,xe.xOffset,xe.yOffset),Ee.blendOp===0&&Ue.clearRect(Ee.xOffset,Ee.yOffset,Ee.width,Ee.height),Ue.drawImage(Ee.image,Ee.xOffset,Ee.yOffset)},Oe.prototype.animate=function(Ue){var He,Ee,e,xe,Te,_e,Se=this;return Ee=0,_e=this.animation,xe=_e.numFrames,e=_e.frames,Te=_e.numPlays,(He=function(){var t,Ae;if(t=Ee++%xe,Ae=e[t],Se.renderFrame(Ue,t),xe>1&&Ee/xe<Te)return Se.animation._timeout=setTimeout(He,Ae.delay)})()},Oe.prototype.stopAnimation=function(){var Ue;return clearTimeout((Ue=this.animation)!=null?Ue._timeout:void 0)},Oe.prototype.render=function(Ue){var He,Ee;return Ue._png&&Ue._png.stopAnimation(),Ue._png=this,Ue.width=this.width,Ue.height=this.height,He=Ue.getContext("2d"),this.animation?(this.decodeFrames(He),this.animate(He)):(Ee=He.createImageData(this.width,this.height),this.copyToImageData(Ee,this.decodePixels()),He.putImageData(Ee,0,0))},Oe}();/**
 * @license
 *
 * Copyright (c) 2014 James Robb, https://github.com/jamesbrobb
 *
 * Permission is hereby granted, free of charge, to any person obtaining
 * a copy of this software and associated documentation files (the
 * "Software"), to deal in the Software without restriction, including
 * without limitation the rights to use, copy, modify, merge, publish,
 * distribute, sublicense, and/or sell copies of the Software, and to
 * permit persons to whom the Software is furnished to do so, subject to
 * the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 * ====================================================================
 *//**
 * @license
 * (c) Dean McNamee <dean@gmail.com>, 2013.
 *
 * https://github.com/deanm/omggif
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to
 * deal in the Software without restriction, including without limitation the
 * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
 * sell copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
 * IN THE SOFTWARE.
 *
 * omggif is a JavaScript implementation of a GIF 89a encoder and decoder,
 * including animation and compression.  It does not rely on any specific
 * underlying system, so should run in the browser, Node, or Plask.
 */function Zt(Ie){var r=0;if(Ie[r++]!==71||Ie[r++]!==73||Ie[r++]!==70||Ie[r++]!==56||(Ie[r++]+1&253)!=56||Ie[r++]!==97)throw new Error("Invalid GIF 87a/89a header.");var Me=Ie[r++]|Ie[r++]<<8,Oe=Ie[r++]|Ie[r++]<<8,Be=Ie[r++],Ue=Be>>7,He=1<<(7&Be)+1;Ie[r++],Ie[r++];var Ee=null,e=null;Ue&&(Ee=r,e=He,r+=3*He);var xe=!0,Te=[],_e=0,Se=null,t=0,Ae=null;for(this.width=Me,this.height=Oe;xe&&r<Ie.length;)switch(Ie[r++]){case 33:switch(Ie[r++]){case 255:if(Ie[r]!==11||Ie[r+1]==78&&Ie[r+2]==69&&Ie[r+3]==84&&Ie[r+4]==83&&Ie[r+5]==67&&Ie[r+6]==65&&Ie[r+7]==80&&Ie[r+8]==69&&Ie[r+9]==50&&Ie[r+10]==46&&Ie[r+11]==48&&Ie[r+12]==3&&Ie[r+13]==1&&Ie[r+16]==0)r+=14,Ae=Ie[r++]|Ie[r++]<<8,r++;else for(r+=12;;){if(!((ti=Ie[r++])>=0))throw Error("Invalid block size");if(ti===0)break;r+=ti}break;case 249:if(Ie[r++]!==4||Ie[r+4]!==0)throw new Error("Invalid graphics extension block.");var Pe=Ie[r++];_e=Ie[r++]|Ie[r++]<<8,Se=Ie[r++],(1&Pe)==0&&(Se=null),t=Pe>>2&7,r++;break;case 254:for(;;){if(!((ti=Ie[r++])>=0))throw Error("Invalid block size");if(ti===0)break;r+=ti}break;default:throw new Error("Unknown graphic control label: 0x"+Ie[r-1].toString(16))}break;case 44:var St=Ie[r++]|Ie[r++]<<8,Ce=Ie[r++]|Ie[r++]<<8,ke=Ie[r++]|Ie[r++]<<8,De=Ie[r++]|Ie[r++]<<8,Re=Ie[r++],je=Re>>6&1,We=1<<(7&Re)+1,Ke=Ee,Je=e,hi=!1;Re>>7&&(hi=!0,Ke=r,Je=We,r+=3*We);var oi=r;for(r++;;){var ti;if(!((ti=Ie[r++])>=0))throw Error("Invalid block size");if(ti===0)break;r+=ti}Te.push({x:St,y:Ce,width:ke,height:De,has_local_palette:hi,palette_offset:Ke,palette_size:Je,data_offset:oi,data_length:r-oi,transparent_index:Se,interlaced:!!je,delay:_e,disposal:t});break;case 59:xe=!1;break;default:throw new Error("Unknown gif block: 0x"+Ie[r-1].toString(16))}this.numFrames=function(){return Te.length},this.loopCount=function(){return Ae},this.frameInfo=function(ai){if(ai<0||ai>=Te.length)throw new Error("Frame index out of range.");return Te[ai]},this.decodeAndBlitFrameBGRA=function(ai,yi){var di=this.frameInfo(ai),bi=di.width*di.height,vi=new Uint8Array(bi);$t(Ie,di.data_offset,vi,bi);var Pi=di.palette_offset,xi=di.transparent_index;xi===null&&(xi=256);var ni=di.width,fi=Me-ni,Si=ni,Xe=4*(di.y*Me+di.x),Ge=4*((di.y+di.height)*Me+di.x),ze=Xe,Ve=4*fi;di.interlaced===!0&&(Ve+=4*Me*7);for(var ei=8,si=0,li=vi.length;si<li;++si){var ci=vi[si];if(Si===0&&(Si=ni,(ze+=Ve)>=Ge&&(Ve=4*fi+4*Me*(ei-1),ze=Xe+(ni+fi)*(ei<<1),ei>>=1)),ci===xi)ze+=4;else{var Ci=Ie[Pi+3*ci],Fi=Ie[Pi+3*ci+1],Oi=Ie[Pi+3*ci+2];yi[ze++]=Oi,yi[ze++]=Fi,yi[ze++]=Ci,yi[ze++]=255}--Si}},this.decodeAndBlitFrameRGBA=function(ai,yi){var di=this.frameInfo(ai),bi=di.width*di.height,vi=new Uint8Array(bi);$t(Ie,di.data_offset,vi,bi);var Pi=di.palette_offset,xi=di.transparent_index;xi===null&&(xi=256);var ni=di.width,fi=Me-ni,Si=ni,Xe=4*(di.y*Me+di.x),Ge=4*((di.y+di.height)*Me+di.x),ze=Xe,Ve=4*fi;di.interlaced===!0&&(Ve+=4*Me*7);for(var ei=8,si=0,li=vi.length;si<li;++si){var ci=vi[si];if(Si===0&&(Si=ni,(ze+=Ve)>=Ge&&(Ve=4*fi+4*Me*(ei-1),ze=Xe+(ni+fi)*(ei<<1),ei>>=1)),ci===xi)ze+=4;else{var Ci=Ie[Pi+3*ci],Fi=Ie[Pi+3*ci+1],Oi=Ie[Pi+3*ci+2];yi[ze++]=Ci,yi[ze++]=Fi,yi[ze++]=Oi,yi[ze++]=255}--Si}}}function $t(Ie,r,Me,Oe){for(var Be=Ie[r++],Ue=1<<Be,He=Ue+1,Ee=He+1,e=Be+1,xe=(1<<e)-1,Te=0,_e=0,Se=0,t=Ie[r++],Ae=new Int32Array(4096),Pe=null;;){for(;Te<16&&t!==0;)_e|=Ie[r++]<<Te,Te+=8,t===1?t=Ie[r++]:--t;if(Te<e)break;var St=_e&xe;if(_e>>=e,Te-=e,St!==Ue){if(St===He)break;for(var Ce=St<Ee?St:Pe,ke=0,De=Ce;De>Ue;)De=Ae[De]>>8,++ke;var Re=De;if(Se+ke+(Ce!==St?1:0)>Oe)return void a.log("Warning, gif stream longer than expected.");Me[Se++]=Re;var je=Se+=ke;for(Ce!==St&&(Me[Se++]=Re),De=Ce;ke--;)De=Ae[De],Me[--je]=255&De,De>>=8;Pe!==null&&Ee<4096&&(Ae[Ee++]=Pe<<8|Re,Ee>=xe+1&&e<12&&(++e,xe=xe<<1|1)),Pe=St}else Ee=He+1,xe=(1<<(e=Be+1))-1,Pe=null}return Se!==Oe&&a.log("Warning, gif stream shorter than expected."),Me}/**
 * @license
  Copyright (c) 2008, Adobe Systems Incorporated
  All rights reserved.

  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer.
  
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution.
  
  * Neither the name of Adobe Systems Incorporated nor the names of its 
    contributors may be used to endorse or promote products derived from 
    this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/function Qt(Ie){var r,Me,Oe,Be,Ue,He=Math.floor,Ee=new Array(64),e=new Array(64),xe=new Array(64),Te=new Array(64),_e=new Array(65535),Se=new Array(65535),t=new Array(64),Ae=new Array(64),Pe=[],St=0,Ce=7,ke=new Array(64),De=new Array(64),Re=new Array(64),je=new Array(256),We=new Array(2048),Ke=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],Je=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],hi=[0,1,2,3,4,5,6,7,8,9,10,11],oi=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],ti=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],ai=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],yi=[0,1,2,3,4,5,6,7,8,9,10,11],di=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],bi=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function vi(Xe,Ge){for(var ze=0,Ve=0,ei=new Array,si=1;si<=16;si++){for(var li=1;li<=Xe[si];li++)ei[Ge[Ve]]=[],ei[Ge[Ve]][0]=ze,ei[Ge[Ve]][1]=si,Ve++,ze++;ze*=2}return ei}function Pi(Xe){for(var Ge=Xe[0],ze=Xe[1]-1;ze>=0;)Ge&1<<ze&&(St|=1<<Ce),ze--,--Ce<0&&(St==255?(xi(255),xi(0)):xi(St),Ce=7,St=0)}function xi(Xe){Pe.push(Xe)}function ni(Xe){xi(Xe>>8&255),xi(255&Xe)}function fi(Xe,Ge,ze,Ve,ei){for(var si,li=ei[0],ci=ei[240],Ci=function(_i,Ri){var Ui,ki,Vi,Ii,$i,tn,en,zi,Ji,pn,an=0;for(Ji=0;Ji<8;++Ji){Ui=_i[an],ki=_i[an+1],Vi=_i[an+2],Ii=_i[an+3],$i=_i[an+4],tn=_i[an+5],en=_i[an+6];var kn=Ui+(zi=_i[an+7]),xn=Ui-zi,Tn=ki+en,Bn=ki-en,$n=Vi+tn,Bi=Vi-tn,Ni=Ii+$i,qi=Ii-$i,on=kn+Ni,bn=kn-Ni,En=Tn+$n,vn=Tn-$n;_i[an]=on+En,_i[an+4]=on-En;var mn=.707106781*(vn+bn);_i[an+2]=bn+mn,_i[an+6]=bn-mn;var Pn=.382683433*((on=qi+Bi)-(vn=Bn+xn)),In=.5411961*on+Pn,Mn=1.306562965*vn+Pn,zn=.707106781*(En=Bi+Bn),Fn=xn+zn,Cn=xn-zn;_i[an+5]=Cn+In,_i[an+3]=Cn-In,_i[an+1]=Fn+Mn,_i[an+7]=Fn-Mn,an+=8}for(an=0,Ji=0;Ji<8;++Ji){Ui=_i[an],ki=_i[an+8],Vi=_i[an+16],Ii=_i[an+24],$i=_i[an+32],tn=_i[an+40],en=_i[an+48];var Rn=Ui+(zi=_i[an+56]),er=Ui-zi,Kn=ki+en,Wn=ki-en,Gn=Vi+tn,sr=Vi-tn,rr=Ii+$i,ur=Ii-$i,fr=Rn+rr,_r=Rn-rr,Cr=Kn+Gn,Jr=Kn-Gn;_i[an]=fr+Cr,_i[an+32]=fr-Cr;var Dr=.707106781*(Jr+_r);_i[an+16]=_r+Dr,_i[an+48]=_r-Dr;var Qr=.382683433*((fr=ur+sr)-(Jr=Wn+er)),ks=.5411961*fr+Qr,Rs=1.306562965*Jr+Qr,js=.707106781*(Cr=sr+Wn),Bs=er+js,Us=er-js;_i[an+40]=Us+ks,_i[an+24]=Us-ks,_i[an+8]=Bs+Rs,_i[an+56]=Bs-Rs,an++}for(Ji=0;Ji<64;++Ji)pn=_i[Ji]*Ri[Ji],t[Ji]=pn>0?pn+.5|0:pn-.5|0;return t}(Xe,Ge),Fi=0;Fi<64;++Fi)Ae[Ke[Fi]]=Ci[Fi];var Oi=Ae[0]-ze;ze=Ae[0],Oi==0?Pi(Ve[0]):(Pi(Ve[Se[si=32767+Oi]]),Pi(_e[si]));for(var Ti=63;Ti>0&&Ae[Ti]==0;)Ti--;if(Ti==0)return Pi(li),ze;for(var Ze,ii=1;ii<=Ti;){for(var Qe=ii;Ae[ii]==0&&ii<=Ti;)++ii;var ui=ii-Qe;if(ui>=16){Ze=ui>>4;for(var gi=1;gi<=Ze;++gi)Pi(ci);ui&=15}si=32767+Ae[ii],Pi(ei[(ui<<4)+Se[si]]),Pi(_e[si]),ii++}return Ti!=63&&Pi(li),ze}function Si(Xe){Xe=Math.min(Math.max(Xe,1),100),Ue!=Xe&&(function(Ge){for(var ze=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],Ve=0;Ve<64;Ve++){var ei=He((ze[Ve]*Ge+50)/100);ei=Math.min(Math.max(ei,1),255),Ee[Ke[Ve]]=ei}for(var si=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],li=0;li<64;li++){var ci=He((si[li]*Ge+50)/100);ci=Math.min(Math.max(ci,1),255),e[Ke[li]]=ci}for(var Ci=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],Fi=0,Oi=0;Oi<8;Oi++)for(var Ti=0;Ti<8;Ti++)xe[Fi]=1/(Ee[Ke[Fi]]*Ci[Oi]*Ci[Ti]*8),Te[Fi]=1/(e[Ke[Fi]]*Ci[Oi]*Ci[Ti]*8),Fi++}(Xe<50?Math.floor(5e3/Xe):Math.floor(200-2*Xe)),Ue=Xe)}this.encode=function(Xe,Ge){Ge&&Si(Ge),Pe=new Array,St=0,Ce=7,ni(65496),ni(65504),ni(16),xi(74),xi(70),xi(73),xi(70),xi(0),xi(1),xi(1),xi(0),ni(1),ni(1),xi(0),xi(0),function(){ni(65499),ni(132),xi(0);for(var ki=0;ki<64;ki++)xi(Ee[ki]);xi(1);for(var Vi=0;Vi<64;Vi++)xi(e[Vi])}(),function(ki,Vi){ni(65472),ni(17),xi(8),ni(Vi),ni(ki),xi(3),xi(1),xi(17),xi(0),xi(2),xi(17),xi(1),xi(3),xi(17),xi(1)}(Xe.width,Xe.height),function(){ni(65476),ni(418),xi(0);for(var ki=0;ki<16;ki++)xi(Je[ki+1]);for(var Vi=0;Vi<=11;Vi++)xi(hi[Vi]);xi(16);for(var Ii=0;Ii<16;Ii++)xi(oi[Ii+1]);for(var $i=0;$i<=161;$i++)xi(ti[$i]);xi(1);for(var tn=0;tn<16;tn++)xi(ai[tn+1]);for(var en=0;en<=11;en++)xi(yi[en]);xi(17);for(var zi=0;zi<16;zi++)xi(di[zi+1]);for(var Ji=0;Ji<=161;Ji++)xi(bi[Ji])}(),ni(65498),ni(12),xi(3),xi(1),xi(0),xi(2),xi(17),xi(3),xi(17),xi(0),xi(63),xi(0);var ze=0,Ve=0,ei=0;St=0,Ce=7,this.encode.displayName="_encode_";for(var si,li,ci,Ci,Fi,Oi,Ti,Ze,ii,Qe=Xe.data,ui=Xe.width,gi=Xe.height,_i=4*ui,Ri=0;Ri<gi;){for(si=0;si<_i;){for(Fi=_i*Ri+si,Ti=-1,Ze=0,ii=0;ii<64;ii++)Oi=Fi+(Ze=ii>>3)*_i+(Ti=4*(7&ii)),Ri+Ze>=gi&&(Oi-=_i*(Ri+1+Ze-gi)),si+Ti>=_i&&(Oi-=si+Ti-_i+4),li=Qe[Oi++],ci=Qe[Oi++],Ci=Qe[Oi++],ke[ii]=(We[li]+We[ci+256>>0]+We[Ci+512>>0]>>16)-128,De[ii]=(We[li+768>>0]+We[ci+1024>>0]+We[Ci+1280>>0]>>16)-128,Re[ii]=(We[li+1280>>0]+We[ci+1536>>0]+We[Ci+1792>>0]>>16)-128;ze=fi(ke,xe,ze,r,Oe),Ve=fi(De,Te,Ve,Me,Be),ei=fi(Re,Te,ei,Me,Be),si+=32}Ri+=8}if(Ce>=0){var Ui=[];Ui[1]=Ce+1,Ui[0]=(1<<Ce+1)-1,Pi(Ui)}return ni(65497),new Uint8Array(Pe)},Ie=Ie||50,function(){for(var Xe=String.fromCharCode,Ge=0;Ge<256;Ge++)je[Ge]=Xe(Ge)}(),r=vi(Je,hi),Me=vi(ai,yi),Oe=vi(oi,ti),Be=vi(di,bi),function(){for(var Xe=1,Ge=2,ze=1;ze<=15;ze++){for(var Ve=Xe;Ve<Ge;Ve++)Se[32767+Ve]=ze,_e[32767+Ve]=[],_e[32767+Ve][1]=ze,_e[32767+Ve][0]=Ve;for(var ei=-(Ge-1);ei<=-Xe;ei++)Se[32767+ei]=ze,_e[32767+ei]=[],_e[32767+ei][1]=ze,_e[32767+ei][0]=Ge-1+ei;Xe<<=1,Ge<<=1}}(),function(){for(var Xe=0;Xe<256;Xe++)We[Xe]=19595*Xe,We[Xe+256>>0]=38470*Xe,We[Xe+512>>0]=7471*Xe+32768,We[Xe+768>>0]=-11059*Xe,We[Xe+1024>>0]=-21709*Xe,We[Xe+1280>>0]=32768*Xe+8421375,We[Xe+1536>>0]=-27439*Xe,We[Xe+1792>>0]=-5329*Xe}(),Si(Ie)}/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */function te(Ie,r){if(this.pos=0,this.buffer=Ie,this.datav=new DataView(Ie.buffer),this.is_with_alpha=!!r,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function ee(Ie){function r(Je){if(!Je)throw Error("assert :P")}function Me(Je,hi,oi){for(var ti=0;4>ti;ti++)if(Je[hi+ti]!=oi.charCodeAt(ti))return!0;return!1}function Oe(Je,hi,oi,ti,ai){for(var yi=0;yi<ai;yi++)Je[hi+yi]=oi[ti+yi]}function Be(Je,hi,oi,ti){for(var ai=0;ai<ti;ai++)Je[hi+ai]=oi}function Ue(Je){return new Int32Array(Je)}function He(Je,hi){for(var oi=[],ti=0;ti<Je;ti++)oi.push(new hi);return oi}function Ee(Je,hi){var oi=[];return function ti(ai,yi,di){for(var bi=di[yi],vi=0;vi<bi&&(ai.push(di.length>yi+1?[]:new hi),!(di.length<yi+1));vi++)ti(ai[vi],yi+1,di)}(oi,0,Je),oi}var e=function(){var Je=this;function hi(Fe,qe){for(var $e=1<<qe-1>>>0;Fe&$e;)$e>>>=1;return $e?(Fe&$e-1)+$e:Fe}function oi(Fe,qe,$e,ri,pi){r(!(ri%$e));do Fe[qe+(ri-=$e)]=pi;while(0<ri)}function ti(Fe,qe,$e,ri,pi){if(r(2328>=pi),512>=pi)var wi=Ue(512);else if((wi=Ue(pi))==null)return 0;return function(Ai,Ei,Li,Di,Hi,Qi){var Zi,Yi,un=Ei,nn=1<<Li,Xi=Ue(16),Gi=Ue(16);for(r(Hi!=0),r(Di!=null),r(Ai!=null),r(0<Li),Yi=0;Yi<Hi;++Yi){if(15<Di[Yi])return 0;++Xi[Di[Yi]]}if(Xi[0]==Hi)return 0;for(Gi[1]=0,Zi=1;15>Zi;++Zi){if(Xi[Zi]>1<<Zi)return 0;Gi[Zi+1]=Gi[Zi]+Xi[Zi]}for(Yi=0;Yi<Hi;++Yi)Zi=Di[Yi],0<Di[Yi]&&(Qi[Gi[Zi]++]=Yi);if(Gi[15]==1)return(Di=new ai).g=0,Di.value=Qi[0],oi(Ai,un,1,nn,Di),nn;var hn,dn=-1,cn=nn-1,An=0,_n=1,On=1,wn=1<<Li;for(Yi=0,Zi=1,Hi=2;Zi<=Li;++Zi,Hi<<=1){if(_n+=On<<=1,0>(On-=Xi[Zi]))return 0;for(;0<Xi[Zi];--Xi[Zi])(Di=new ai).g=Zi,Di.value=Qi[Yi++],oi(Ai,un+An,Hi,wn,Di),An=hi(An,Zi)}for(Zi=Li+1,Hi=2;15>=Zi;++Zi,Hi<<=1){if(_n+=On<<=1,0>(On-=Xi[Zi]))return 0;for(;0<Xi[Zi];--Xi[Zi]){if(Di=new ai,(An&cn)!=dn){for(un+=wn,hn=1<<(dn=Zi)-Li;15>dn&&!(0>=(hn-=Xi[dn]));)++dn,hn<<=1;nn+=wn=1<<(hn=dn-Li),Ai[Ei+(dn=An&cn)].g=hn+Li,Ai[Ei+dn].value=un-Ei-dn}Di.g=Zi-Li,Di.value=Qi[Yi++],oi(Ai,un+(An>>Li),Hi,wn,Di),An=hi(An,Zi)}}return _n!=2*Gi[15]-1?0:nn}(Fe,qe,$e,ri,pi,wi)}function ai(){this.value=this.g=0}function yi(){this.value=this.g=0}function di(){this.G=He(5,ai),this.H=Ue(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=He(Pr,yi)}function bi(Fe,qe,$e,ri){r(Fe!=null),r(qe!=null),r(2147483648>ri),Fe.Ca=254,Fe.I=0,Fe.b=-8,Fe.Ka=0,Fe.oa=qe,Fe.pa=$e,Fe.Jd=qe,Fe.Yc=$e+ri,Fe.Zc=4<=ri?$e+ri-4+1:$e,si(Fe)}function vi(Fe,qe){for(var $e=0;0<qe--;)$e|=ci(Fe,128)<<qe;return $e}function Pi(Fe,qe){var $e=vi(Fe,qe);return li(Fe)?-$e:$e}function xi(Fe,qe,$e,ri){var pi,wi=0;for(r(Fe!=null),r(qe!=null),r(4294967288>ri),Fe.Sb=ri,Fe.Ra=0,Fe.u=0,Fe.h=0,4<ri&&(ri=4),pi=0;pi<ri;++pi)wi+=qe[$e+pi]<<8*pi;Fe.Ra=wi,Fe.bb=ri,Fe.oa=qe,Fe.pa=$e}function ni(Fe){for(;8<=Fe.u&&Fe.bb<Fe.Sb;)Fe.Ra>>>=8,Fe.Ra+=Fe.oa[Fe.pa+Fe.bb]<<ea-8>>>0,++Fe.bb,Fe.u-=8;ze(Fe)&&(Fe.h=1,Fe.u=0)}function fi(Fe,qe){if(r(0<=qe),!Fe.h&&qe<=ta){var $e=Ge(Fe)&Zs[qe];return Fe.u+=qe,ni(Fe),$e}return Fe.h=1,Fe.u=0}function Si(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function Xe(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function Ge(Fe){return Fe.Ra>>>(Fe.u&ea-1)>>>0}function ze(Fe){return r(Fe.bb<=Fe.Sb),Fe.h||Fe.bb==Fe.Sb&&Fe.u>ea}function Ve(Fe,qe){Fe.u=qe,Fe.h=ze(Fe)}function ei(Fe){Fe.u>=Oa&&(r(Fe.u>=Oa),ni(Fe))}function si(Fe){r(Fe!=null&&Fe.oa!=null),Fe.pa<Fe.Zc?(Fe.I=(Fe.oa[Fe.pa++]|Fe.I<<8)>>>0,Fe.b+=8):(r(Fe!=null&&Fe.oa!=null),Fe.pa<Fe.Yc?(Fe.b+=8,Fe.I=Fe.oa[Fe.pa++]|Fe.I<<8):Fe.Ka?Fe.b=0:(Fe.I<<=8,Fe.b+=8,Fe.Ka=1))}function li(Fe){return vi(Fe,1)}function ci(Fe,qe){var $e=Fe.Ca;0>Fe.b&&si(Fe);var ri=Fe.b,pi=$e*qe>>>8,wi=(Fe.I>>>ri>pi)+0;for(wi?($e-=pi,Fe.I-=pi+1<<ri>>>0):$e=pi+1,ri=$e,pi=0;256<=ri;)pi+=8,ri>>=8;return ri=7^pi+Er[ri],Fe.b-=ri,Fe.Ca=($e<<ri)-1,wi}function Ci(Fe,qe,$e){Fe[qe+0]=$e>>24&255,Fe[qe+1]=$e>>16&255,Fe[qe+2]=$e>>8&255,Fe[qe+3]=$e>>0&255}function Fi(Fe,qe){return Fe[qe+0]<<0|Fe[qe+1]<<8}function Oi(Fe,qe){return Fi(Fe,qe)|Fe[qe+2]<<16}function Ti(Fe,qe){return Fi(Fe,qe)|Fi(Fe,qe+2)<<16}function Ze(Fe,qe){var $e=1<<qe;return r(Fe!=null),r(0<qe),Fe.X=Ue($e),Fe.X==null?0:(Fe.Mb=32-qe,Fe.Xa=qe,1)}function ii(Fe,qe){r(Fe!=null),r(qe!=null),r(Fe.Xa==qe.Xa),Oe(qe.X,0,Fe.X,0,1<<qe.Xa)}function Qe(){this.X=[],this.Xa=this.Mb=0}function ui(Fe,qe,$e,ri){r($e!=null),r(ri!=null);var pi=$e[0],wi=ri[0];return pi==0&&(pi=(Fe*wi+qe/2)/qe),wi==0&&(wi=(qe*pi+Fe/2)/Fe),0>=pi||0>=wi?0:($e[0]=pi,ri[0]=wi,1)}function gi(Fe,qe){return Fe+(1<<qe)-1>>>qe}function _i(Fe,qe){return((4278255360&Fe)+(4278255360&qe)>>>0&4278255360)+((16711935&Fe)+(16711935&qe)>>>0&16711935)>>>0}function Ri(Fe,qe){Je[qe]=function($e,ri,pi,wi,Ai,Ei,Li){var Di;for(Di=0;Di<Ai;++Di){var Hi=Je[Fe](Ei[Li+Di-1],pi,wi+Di);Ei[Li+Di]=_i($e[ri+Di],Hi)}}}function Ui(){this.ud=this.hd=this.jd=0}function ki(Fe,qe){return((4278124286&(Fe^qe))>>>1)+(Fe&qe)>>>0}function Vi(Fe){return 0<=Fe&&256>Fe?Fe:0>Fe?0:255<Fe?255:void 0}function Ii(Fe,qe){return Vi(Fe+(Fe-qe+.5>>1))}function $i(Fe,qe,$e){return Math.abs(qe-$e)-Math.abs(Fe-$e)}function tn(Fe,qe,$e,ri,pi,wi,Ai){for(ri=wi[Ai-1],$e=0;$e<pi;++$e)wi[Ai+$e]=ri=_i(Fe[qe+$e],ri)}function en(Fe,qe,$e,ri,pi){var wi;for(wi=0;wi<$e;++wi){var Ai=Fe[qe+wi],Ei=Ai>>8&255,Li=16711935&(Li=(Li=16711935&Ai)+((Ei<<16)+Ei));ri[pi+wi]=(4278255360&Ai)+Li>>>0}}function zi(Fe,qe){qe.jd=Fe>>0&255,qe.hd=Fe>>8&255,qe.ud=Fe>>16&255}function Ji(Fe,qe,$e,ri,pi,wi){var Ai;for(Ai=0;Ai<ri;++Ai){var Ei=qe[$e+Ai],Li=Ei>>>8,Di=Ei,Hi=255&(Hi=(Hi=Ei>>>16)+((Fe.jd<<24>>24)*(Li<<24>>24)>>>5));Di=255&(Di=(Di=Di+((Fe.hd<<24>>24)*(Li<<24>>24)>>>5))+((Fe.ud<<24>>24)*(Hi<<24>>24)>>>5)),pi[wi+Ai]=(4278255360&Ei)+(Hi<<16)+Di}}function pn(Fe,qe,$e,ri,pi){Je[qe]=function(wi,Ai,Ei,Li,Di,Hi,Qi,Zi,Yi){for(Li=Qi;Li<Zi;++Li)for(Qi=0;Qi<Yi;++Qi)Di[Hi++]=pi(Ei[ri(wi[Ai++])])},Je[Fe]=function(wi,Ai,Ei,Li,Di,Hi,Qi){var Zi=8>>wi.b,Yi=wi.Ea,un=wi.K[0],nn=wi.w;if(8>Zi)for(wi=(1<<wi.b)-1,nn=(1<<Zi)-1;Ai<Ei;++Ai){var Xi,Gi=0;for(Xi=0;Xi<Yi;++Xi)Xi&wi||(Gi=ri(Li[Di++])),Hi[Qi++]=pi(un[Gi&nn]),Gi>>=Zi}else Je["VP8LMapColor"+$e](Li,Di,un,nn,Hi,Qi,Ai,Ei,Yi)}}function an(Fe,qe,$e,ri,pi){for($e=qe+$e;qe<$e;){var wi=Fe[qe++];ri[pi++]=wi>>16&255,ri[pi++]=wi>>8&255,ri[pi++]=wi>>0&255}}function kn(Fe,qe,$e,ri,pi){for($e=qe+$e;qe<$e;){var wi=Fe[qe++];ri[pi++]=wi>>16&255,ri[pi++]=wi>>8&255,ri[pi++]=wi>>0&255,ri[pi++]=wi>>24&255}}function xn(Fe,qe,$e,ri,pi){for($e=qe+$e;qe<$e;){var wi=(Ai=Fe[qe++])>>16&240|Ai>>12&15,Ai=Ai>>0&240|Ai>>28&15;ri[pi++]=wi,ri[pi++]=Ai}}function Tn(Fe,qe,$e,ri,pi){for($e=qe+$e;qe<$e;){var wi=(Ai=Fe[qe++])>>16&248|Ai>>13&7,Ai=Ai>>5&224|Ai>>3&31;ri[pi++]=wi,ri[pi++]=Ai}}function Bn(Fe,qe,$e,ri,pi){for($e=qe+$e;qe<$e;){var wi=Fe[qe++];ri[pi++]=wi>>0&255,ri[pi++]=wi>>8&255,ri[pi++]=wi>>16&255}}function $n(Fe,qe,$e,ri,pi,wi){if(wi==0)for($e=qe+$e;qe<$e;)Ci(ri,((wi=Fe[qe++])[0]>>24|wi[1]>>8&65280|wi[2]<<8&16711680|wi[3]<<24)>>>0),pi+=32;else Oe(ri,pi,Fe,qe,$e)}function Bi(Fe,qe){Je[qe][0]=Je[Fe+"0"],Je[qe][1]=Je[Fe+"1"],Je[qe][2]=Je[Fe+"2"],Je[qe][3]=Je[Fe+"3"],Je[qe][4]=Je[Fe+"4"],Je[qe][5]=Je[Fe+"5"],Je[qe][6]=Je[Fe+"6"],Je[qe][7]=Je[Fe+"7"],Je[qe][8]=Je[Fe+"8"],Je[qe][9]=Je[Fe+"9"],Je[qe][10]=Je[Fe+"10"],Je[qe][11]=Je[Fe+"11"],Je[qe][12]=Je[Fe+"12"],Je[qe][13]=Je[Fe+"13"],Je[qe][14]=Je[Fe+"0"],Je[qe][15]=Je[Fe+"0"]}function Ni(Fe){return Fe==ul||Fe==dl||Fe==bo||Fe==pl}function qi(){this.eb=[],this.size=this.A=this.fb=0}function on(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function bn(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new qi,this.f.kb=new on,this.sd=null}function En(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function vn(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function mn(Fe){return alert("todo:WebPSamplerProcessPlane"),Fe.T}function Pn(Fe,qe){var $e=Fe.T,ri=qe.ba.f.RGBA,pi=ri.eb,wi=ri.fb+Fe.ka*ri.A,Ai=Br[qe.ba.S],Ei=Fe.y,Li=Fe.O,Di=Fe.f,Hi=Fe.N,Qi=Fe.ea,Zi=Fe.W,Yi=qe.cc,un=qe.dc,nn=qe.Mc,Xi=qe.Nc,Gi=Fe.ka,hn=Fe.ka+Fe.T,dn=Fe.U,cn=dn+1>>1;for(Gi==0?Ai(Ei,Li,null,null,Di,Hi,Qi,Zi,Di,Hi,Qi,Zi,pi,wi,null,null,dn):(Ai(qe.ec,qe.fc,Ei,Li,Yi,un,nn,Xi,Di,Hi,Qi,Zi,pi,wi-ri.A,pi,wi,dn),++$e);Gi+2<hn;Gi+=2)Yi=Di,un=Hi,nn=Qi,Xi=Zi,Hi+=Fe.Rc,Zi+=Fe.Rc,wi+=2*ri.A,Ai(Ei,(Li+=2*Fe.fa)-Fe.fa,Ei,Li,Yi,un,nn,Xi,Di,Hi,Qi,Zi,pi,wi-ri.A,pi,wi,dn);return Li+=Fe.fa,Fe.j+hn<Fe.o?(Oe(qe.ec,qe.fc,Ei,Li,dn),Oe(qe.cc,qe.dc,Di,Hi,cn),Oe(qe.Mc,qe.Nc,Qi,Zi,cn),$e--):1&hn||Ai(Ei,Li,null,null,Di,Hi,Qi,Zi,Di,Hi,Qi,Zi,pi,wi+ri.A,null,null,dn),$e}function In(Fe,qe,$e){var ri=Fe.F,pi=[Fe.J];if(ri!=null){var wi=Fe.U,Ai=qe.ba.S,Ei=Ai==vo||Ai==bo;qe=qe.ba.f.RGBA;var Li=[0],Di=Fe.ka;Li[0]=Fe.T,Fe.Kb&&(Di==0?--Li[0]:(--Di,pi[0]-=Fe.width),Fe.j+Fe.ka+Fe.T==Fe.o&&(Li[0]=Fe.o-Fe.j-Di));var Hi=qe.eb;Di=qe.fb+Di*qe.A,Fe=uo(ri,pi[0],Fe.width,wi,Li,Hi,Di+(Ei?0:3),qe.A),r($e==Li),Fe&&Ni(Ai)&&ws(Hi,Di,Ei,wi,Li,qe.A)}return 0}function Mn(Fe){var qe=Fe.ma,$e=qe.ba.S,ri=11>$e,pi=$e==go||$e==mo||$e==vo||$e==cl||$e==12||Ni($e);if(qe.memory=null,qe.Ib=null,qe.Jb=null,qe.Nd=null,!ka(qe.Oa,Fe,pi?11:12))return 0;if(pi&&Ni($e)&&gn(),Fe.da)alert("todo:use_scaling");else{if(ri){if(qe.Ib=mn,Fe.Kb){if($e=Fe.U+1>>1,qe.memory=Ue(Fe.U+2*$e),qe.memory==null)return 0;qe.ec=qe.memory,qe.fc=0,qe.cc=qe.ec,qe.dc=qe.fc+Fe.U,qe.Mc=qe.cc,qe.Nc=qe.dc+$e,qe.Ib=Pn,gn()}}else alert("todo:EmitYUV");pi&&(qe.Jb=In,ri&&Ki())}if(ri&&!hh){for(Fe=0;256>Fe;++Fe)gc[Fe]=89858*(Fe-128)+_o>>yo,bc[Fe]=-22014*(Fe-128)+_o,vc[Fe]=-45773*(Fe-128),mc[Fe]=113618*(Fe-128)+_o>>yo;for(Fe=Ra;Fe<vl;++Fe)qe=76283*(Fe-16)+_o>>yo,yc[Fe-Ra]=Or(qe,255),_c[Fe-Ra]=Or(qe+8>>4,15);hh=1}return 1}function zn(Fe){var qe=Fe.ma,$e=Fe.U,ri=Fe.T;return r(!(1&Fe.ka)),0>=$e||0>=ri?0:($e=qe.Ib(Fe,qe),qe.Jb!=null&&qe.Jb(Fe,qe,$e),qe.Dc+=$e,1)}function Fn(Fe){Fe.ma.memory=null}function Cn(Fe,qe,$e,ri){return fi(Fe,8)!=47?0:(qe[0]=fi(Fe,14)+1,$e[0]=fi(Fe,14)+1,ri[0]=fi(Fe,1),fi(Fe,3)!=0?0:!Fe.h)}function Rn(Fe,qe){if(4>Fe)return Fe+1;var $e=Fe-2>>1;return(2+(1&Fe)<<$e)+fi(qe,$e)+1}function er(Fe,qe){return 120<qe?qe-120:1<=($e=(($e=tc[qe-1])>>4)*Fe+(8-(15&$e)))?$e:1;var $e}function Kn(Fe,qe,$e){var ri=Ge($e),pi=Fe[qe+=255&ri].g-8;return 0<pi&&(Ve($e,$e.u+8),ri=Ge($e),qe+=Fe[qe].value,qe+=ri&(1<<pi)-1),Ve($e,$e.u+Fe[qe].g),Fe[qe].value}function Wn(Fe,qe,$e){return $e.g+=Fe.g,$e.value+=Fe.value<<qe>>>0,r(8>=$e.g),Fe.g}function Gn(Fe,qe,$e){var ri=Fe.xc;return r((qe=ri==0?0:Fe.vc[Fe.md*($e>>ri)+(qe>>ri)])<Fe.Wb),Fe.Ya[qe]}function sr(Fe,qe,$e,ri){var pi=Fe.ab,wi=Fe.c*qe,Ai=Fe.C;qe=Ai+qe;var Ei=$e,Li=ri;for(ri=Fe.Ta,$e=Fe.Ua;0<pi--;){var Di=Fe.gc[pi],Hi=Ai,Qi=qe,Zi=Ei,Yi=Li,un=(Li=ri,Ei=$e,Di.Ea);switch(r(Hi<Qi),r(Qi<=Di.nc),Di.hc){case 2:co(Zi,Yi,(Qi-Hi)*un,Li,Ei);break;case 0:var nn=Hi,Xi=Qi,Gi=Li,hn=Ei,dn=(wn=Di).Ea;nn==0&&(al(Zi,Yi,null,null,1,Gi,hn),tn(Zi,Yi+1,0,0,dn-1,Gi,hn+1),Yi+=dn,hn+=dn,++nn);for(var cn=1<<wn.b,An=cn-1,_n=gi(dn,wn.b),On=wn.K,wn=wn.w+(nn>>wn.b)*_n;nn<Xi;){var Yn=On,Jn=wn,Vn=1;for(Fa(Zi,Yi,Gi,hn-dn,1,Gi,hn);Vn<dn;){var Hn=(Vn&~An)+cn;Hn>dn&&(Hn=dn),(0,vs[Yn[Jn++]>>8&15])(Zi,Yi+ +Vn,Gi,hn+Vn-dn,Hn-Vn,Gi,hn+Vn),Vn=Hn}Yi+=dn,hn+=dn,++nn&An||(wn+=_n)}Qi!=Di.nc&&Oe(Li,Ei-un,Li,Ei+(Qi-Hi-1)*un,un);break;case 1:for(un=Zi,Xi=Yi,dn=(Zi=Di.Ea)-(hn=Zi&~(Gi=(Yi=1<<Di.b)-1)),nn=gi(Zi,Di.b),cn=Di.K,Di=Di.w+(Hi>>Di.b)*nn;Hi<Qi;){for(An=cn,_n=Di,On=new Ui,wn=Xi+hn,Yn=Xi+Zi;Xi<wn;)zi(An[_n++],On),Ir(On,un,Xi,Yi,Li,Ei),Xi+=Yi,Ei+=Yi;Xi<Yn&&(zi(An[_n++],On),Ir(On,un,Xi,dn,Li,Ei),Xi+=dn,Ei+=dn),++Hi&Gi||(Di+=nn)}break;case 3:if(Zi==Li&&Yi==Ei&&0<Di.b){for(Xi=Li,Zi=un=Ei+(Qi-Hi)*un-(hn=(Qi-Hi)*gi(Di.Ea,Di.b)),Yi=Li,Gi=Ei,nn=[],hn=(dn=hn)-1;0<=hn;--hn)nn[hn]=Yi[Gi+hn];for(hn=dn-1;0<=hn;--hn)Xi[Zi+hn]=nn[hn];Xr(Di,Hi,Qi,Li,un,Li,Ei)}else Xr(Di,Hi,Qi,Zi,Yi,Li,Ei)}Ei=ri,Li=$e}Li!=$e&&Oe(ri,$e,Ei,Li,wi)}function rr(Fe,qe){var $e=Fe.V,ri=Fe.Ba+Fe.c*Fe.C,pi=qe-Fe.C;if(r(qe<=Fe.l.o),r(16>=pi),0<pi){var wi=Fe.l,Ai=Fe.Ta,Ei=Fe.Ua,Li=wi.width;if(sr(Fe,pi,$e,ri),pi=Ei=[Ei],r(($e=Fe.C)<(ri=qe)),r(wi.v<wi.va),ri>wi.o&&(ri=wi.o),$e<wi.j){var Di=wi.j-$e;$e=wi.j,pi[0]+=Di*Li}if($e>=ri?$e=0:(pi[0]+=4*wi.v,wi.ka=$e-wi.j,wi.U=wi.va-wi.v,wi.T=ri-$e,$e=1),$e){if(Ei=Ei[0],11>($e=Fe.ca).S){var Hi=$e.f.RGBA,Qi=(ri=$e.S,pi=wi.U,wi=wi.T,Di=Hi.eb,Hi.A),Zi=wi;for(Hi=Hi.fb+Fe.Ma*Hi.A;0<Zi--;){var Yi=Ai,un=Ei,nn=pi,Xi=Di,Gi=Hi;switch(ri){case po:Vr(Yi,un,nn,Xi,Gi);break;case go:bs(Yi,un,nn,Xi,Gi);break;case ul:bs(Yi,un,nn,Xi,Gi),ws(Xi,Gi,0,nn,1,0);break;case Zl:ia(Yi,un,nn,Xi,Gi);break;case mo:$n(Yi,un,nn,Xi,Gi,1);break;case dl:$n(Yi,un,nn,Xi,Gi,1),ws(Xi,Gi,0,nn,1,0);break;case vo:$n(Yi,un,nn,Xi,Gi,0);break;case bo:$n(Yi,un,nn,Xi,Gi,0),ws(Xi,Gi,1,nn,1,0);break;case cl:ts(Yi,un,nn,Xi,Gi);break;case pl:ts(Yi,un,nn,Xi,Gi),sa(Xi,Gi,nn,1,0);break;case th:as(Yi,un,nn,Xi,Gi);break;default:r(0)}Ei+=Li,Hi+=Qi}Fe.Ma+=wi}else alert("todo:EmitRescaledRowsYUVA");r(Fe.Ma<=$e.height)}}Fe.C=qe,r(Fe.C<=Fe.i)}function ur(Fe){var qe;if(0<Fe.ua)return 0;for(qe=0;qe<Fe.Wb;++qe){var $e=Fe.Ya[qe].G,ri=Fe.Ya[qe].H;if(0<$e[1][ri[1]+0].g||0<$e[2][ri[2]+0].g||0<$e[3][ri[3]+0].g)return 0}return 1}function fr(Fe,qe,$e,ri,pi,wi){if(Fe.Z!=0){var Ai=Fe.qd,Ei=Fe.rd;for(r(As[Fe.Z]!=null);qe<$e;++qe)As[Fe.Z](Ai,Ei,ri,pi,ri,pi,wi),Ai=ri,Ei=pi,pi+=wi;Fe.qd=Ai,Fe.rd=Ei}}function _r(Fe,qe){var $e=Fe.l.ma,ri=$e.Z==0||$e.Z==1?Fe.l.j:Fe.C;if(ri=Fe.C<ri?ri:Fe.C,r(qe<=Fe.l.o),qe>ri){var pi=Fe.l.width,wi=$e.ca,Ai=$e.tb+pi*ri,Ei=Fe.V,Li=Fe.Ba+Fe.c*ri,Di=Fe.gc;r(Fe.ab==1),r(Di[0].hc==3),ol(Di[0],ri,qe,Ei,Li,wi,Ai),fr($e,ri,qe,wi,Ai,pi)}Fe.C=Fe.Ma=qe}function Cr(Fe,qe,$e,ri,pi,wi,Ai){var Ei=Fe.$/ri,Li=Fe.$%ri,Di=Fe.m,Hi=Fe.s,Qi=$e+Fe.$,Zi=Qi;pi=$e+ri*pi;var Yi=$e+ri*wi,un=280+Hi.ua,nn=Fe.Pb?Ei:16777216,Xi=0<Hi.ua?Hi.Wa:null,Gi=Hi.wc,hn=Qi<Yi?Gn(Hi,Li,Ei):null;r(Fe.C<wi),r(Yi<=pi);var dn=!1;t:for(;;){for(;dn||Qi<Yi;){var cn=0;if(Ei>=nn){var An=Qi-$e;r((nn=Fe).Pb),nn.wd=nn.m,nn.xd=An,0<nn.s.ua&&ii(nn.s.Wa,nn.s.vb),nn=Ei+ic}if(Li&Gi||(hn=Gn(Hi,Li,Ei)),r(hn!=null),hn.Qb&&(qe[Qi]=hn.qb,dn=!0),!dn)if(ei(Di),hn.jc){cn=Di,An=qe;var _n=Qi,On=hn.pd[Ge(cn)&Pr-1];r(hn.jc),256>On.g?(Ve(cn,cn.u+On.g),An[_n]=On.value,cn=0):(Ve(cn,cn.u+On.g-256),r(256<=On.value),cn=On.value),cn==0&&(dn=!0)}else cn=Kn(hn.G[0],hn.H[0],Di);if(Di.h)break;if(dn||256>cn){if(!dn)if(hn.nd)qe[Qi]=(hn.qb|cn<<8)>>>0;else{if(ei(Di),dn=Kn(hn.G[1],hn.H[1],Di),ei(Di),An=Kn(hn.G[2],hn.H[2],Di),_n=Kn(hn.G[3],hn.H[3],Di),Di.h)break;qe[Qi]=(_n<<24|dn<<16|cn<<8|An)>>>0}if(dn=!1,++Qi,++Li>=ri&&(Li=0,++Ei,Ai!=null&&Ei<=wi&&!(Ei%16)&&Ai(Fe,Ei),Xi!=null))for(;Zi<Qi;)cn=qe[Zi++],Xi.X[(506832829*cn&4294967295)>>>Xi.Mb]=cn}else if(280>cn){if(cn=Rn(cn-256,Di),An=Kn(hn.G[4],hn.H[4],Di),ei(Di),An=er(ri,An=Rn(An,Di)),Di.h)break;if(Qi-$e<An||pi-Qi<cn)break t;for(_n=0;_n<cn;++_n)qe[Qi+_n]=qe[Qi+_n-An];for(Qi+=cn,Li+=cn;Li>=ri;)Li-=ri,++Ei,Ai!=null&&Ei<=wi&&!(Ei%16)&&Ai(Fe,Ei);if(r(Qi<=pi),Li&Gi&&(hn=Gn(Hi,Li,Ei)),Xi!=null)for(;Zi<Qi;)cn=qe[Zi++],Xi.X[(506832829*cn&4294967295)>>>Xi.Mb]=cn}else{if(!(cn<un))break t;for(dn=cn-280,r(Xi!=null);Zi<Qi;)cn=qe[Zi++],Xi.X[(506832829*cn&4294967295)>>>Xi.Mb]=cn;cn=Qi,r(!(dn>>>(An=Xi).Xa)),qe[cn]=An.X[dn],dn=!0}dn||r(Di.h==ze(Di))}if(Fe.Pb&&Di.h&&Qi<pi)r(Fe.m.h),Fe.a=5,Fe.m=Fe.wd,Fe.$=Fe.xd,0<Fe.s.ua&&ii(Fe.s.vb,Fe.s.Wa);else{if(Di.h)break t;Ai!=null&&Ai(Fe,Ei>wi?wi:Ei),Fe.a=0,Fe.$=Qi-$e}return 1}return Fe.a=3,0}function Jr(Fe){r(Fe!=null),Fe.vc=null,Fe.yc=null,Fe.Ya=null;var qe=Fe.Wa;qe!=null&&(qe.X=null),Fe.vb=null,r(Fe!=null)}function Dr(){var Fe=new sl;return Fe==null?null:(Fe.a=0,Fe.xb=nh,Bi("Predictor","VP8LPredictors"),Bi("Predictor","VP8LPredictors_C"),Bi("PredictorAdd","VP8LPredictorsAdd"),Bi("PredictorAdd","VP8LPredictorsAdd_C"),co=en,Ir=Ji,Vr=an,bs=kn,ts=xn,as=Tn,ia=Bn,Je.VP8LMapColor32b=Ma,Je.VP8LMapColor8b=ll,Fe)}function Qr(Fe,qe,$e,ri,pi){var wi=1,Ai=[Fe],Ei=[qe],Li=ri.m,Di=ri.s,Hi=null,Qi=0;t:for(;;){if($e)for(;wi&&fi(Li,1);){var Zi=Ai,Yi=Ei,un=ri,nn=1,Xi=un.m,Gi=un.gc[un.ab],hn=fi(Xi,2);if(un.Oc&1<<hn)wi=0;else{switch(un.Oc|=1<<hn,Gi.hc=hn,Gi.Ea=Zi[0],Gi.nc=Yi[0],Gi.K=[null],++un.ab,r(4>=un.ab),hn){case 0:case 1:Gi.b=fi(Xi,3)+2,nn=Qr(gi(Gi.Ea,Gi.b),gi(Gi.nc,Gi.b),0,un,Gi.K),Gi.K=Gi.K[0];break;case 3:var dn,cn=fi(Xi,8)+1,An=16<cn?0:4<cn?1:2<cn?2:3;if(Zi[0]=gi(Gi.Ea,An),Gi.b=An,dn=nn=Qr(cn,1,0,un,Gi.K)){var _n,On=cn,wn=Gi,Yn=1<<(8>>wn.b),Jn=Ue(Yn);if(Jn==null)dn=0;else{var Vn=wn.K[0],Hn=wn.w;for(Jn[0]=wn.K[0][0],_n=1;_n<1*On;++_n)Jn[_n]=_i(Vn[Hn+_n],Jn[_n-1]);for(;_n<4*Yn;++_n)Jn[_n]=0;wn.K[0]=null,wn.K[0]=Jn,dn=1}}nn=dn;break;case 2:break;default:r(0)}wi=nn}}if(Ai=Ai[0],Ei=Ei[0],wi&&fi(Li,1)&&!(wi=1<=(Qi=fi(Li,4))&&11>=Qi)){ri.a=3;break t}var tr;if(tr=wi)e:{var Zn,jn,pr,kr=ri,gr=Ai,Lr=Ei,Qn=Qi,Mr=$e,Nr=kr.m,br=kr.s,wr=[null],xr=1,Ur=0,es=ec[Qn];i:for(;;){if(Mr&&fi(Nr,1)){var yr=fi(Nr,3)+2,us=gi(gr,yr),Is=gi(Lr,yr),aa=us*Is;if(!Qr(us,Is,0,kr,wr))break i;for(wr=wr[0],br.xc=yr,Zn=0;Zn<aa;++Zn){var xs=wr[Zn]>>8&65535;wr[Zn]=xs,xs>=xr&&(xr=xs+1)}}if(Nr.h)break i;for(jn=0;5>jn;++jn){var lr=eh[jn];!jn&&0<Qn&&(lr+=1<<Qn),Ur<lr&&(Ur=lr)}var bl=He(xr*es,ai),fh=xr,dh=He(fh,di);if(dh==null)var So=null;else r(65536>=fh),So=dh;var ja=Ue(Ur);if(So==null||ja==null||bl==null){kr.a=1;break i}var Ao=bl;for(Zn=pr=0;Zn<xr;++Zn){var $r=So[Zn],oa=$r.G,la=$r.H,ph=0,xo=1,gh=0;for(jn=0;5>jn;++jn){lr=eh[jn],oa[jn]=Ao,la[jn]=pr,!jn&&0<Qn&&(lr+=1<<Qn);r:{var Co,yl=lr,To=kr,Ba=ja,Ac=Ao,xc=pr,_l=0,Cs=To.m,Cc=fi(Cs,1);if(Be(Ba,0,0,yl),Cc){var Tc=fi(Cs,1)+1,Pc=fi(Cs,1),mh=fi(Cs,Pc==0?1:8);Ba[mh]=1,Tc==2&&(Ba[mh=fi(Cs,8)]=1);var Po=1}else{var vh=Ue(19),bh=fi(Cs,4)+4;if(19<bh){To.a=3;var Eo=0;break r}for(Co=0;Co<bh;++Co)vh[Zh[Co]]=fi(Cs,3);var wl=void 0,Ua=void 0,yh=To,Ec=vh,ko=yl,_h=Ba,Sl=0,Ts=yh.m,wh=8,Sh=He(128,ai);n:for(;ti(Sh,0,7,Ec,19);){if(fi(Ts,1)){var kc=2+2*fi(Ts,3);if((wl=2+fi(Ts,kc))>ko)break n}else wl=ko;for(Ua=0;Ua<ko&&wl--;){ei(Ts);var Ah=Sh[0+(127&Ge(Ts))];Ve(Ts,Ts.u+Ah.g);var ha=Ah.value;if(16>ha)_h[Ua++]=ha,ha!=0&&(wh=ha);else{var Lc=ha==16,xh=ha-16,Oc=Jh[xh],Ch=fi(Ts,$h[xh])+Oc;if(Ua+Ch>ko)break n;for(var Fc=Lc?wh:0;0<Ch--;)_h[Ua++]=Fc}}Sl=1;break n}Sl||(yh.a=3),Po=Sl}(Po=Po&&!Cs.h)&&(_l=ti(Ac,xc,8,Ba,yl)),Po&&_l!=0?Eo=_l:(To.a=3,Eo=0)}if(Eo==0)break i;if(xo&&Qh[jn]==1&&(xo=Ao[pr].g==0),ph+=Ao[pr].g,pr+=Eo,3>=jn){var qa,Al=ja[0];for(qa=1;qa<lr;++qa)ja[qa]>Al&&(Al=ja[qa]);gh+=Al}}if($r.nd=xo,$r.Qb=0,xo&&($r.qb=(oa[3][la[3]+0].value<<24|oa[1][la[1]+0].value<<16|oa[2][la[2]+0].value)>>>0,ph==0&&256>oa[0][la[0]+0].value&&($r.Qb=1,$r.qb+=oa[0][la[0]+0].value<<8)),$r.jc=!$r.Qb&&6>gh,$r.jc){var Lo,fs=$r;for(Lo=0;Lo<Pr;++Lo){var Ps=Lo,Es=fs.pd[Ps],Oo=fs.G[0][fs.H[0]+Ps];256<=Oo.value?(Es.g=Oo.g+256,Es.value=Oo.value):(Es.g=0,Es.value=0,Ps>>=Wn(Oo,8,Es),Ps>>=Wn(fs.G[1][fs.H[1]+Ps],16,Es),Ps>>=Wn(fs.G[2][fs.H[2]+Ps],0,Es),Wn(fs.G[3][fs.H[3]+Ps],24,Es))}}}br.vc=wr,br.Wb=xr,br.Ya=So,br.yc=bl,tr=1;break e}tr=0}if(!(wi=tr)){ri.a=3;break t}if(0<Qi){if(Di.ua=1<<Qi,!Ze(Di.Wa,Qi)){ri.a=1,wi=0;break t}}else Di.ua=0;var xl=ri,Th=Ai,Mc=Ei,Cl=xl.s,Tl=Cl.xc;if(xl.c=Th,xl.i=Mc,Cl.md=gi(Th,Tl),Cl.wc=Tl==0?-1:(1<<Tl)-1,$e){ri.xb=cc;break t}if((Hi=Ue(Ai*Ei))==null){ri.a=1,wi=0;break t}wi=(wi=Cr(ri,Hi,0,Ai,Ei,Ei,null))&&!Li.h;break t}return wi?(pi!=null?pi[0]=Hi:(r(Hi==null),r($e)),ri.$=0,$e||Jr(Di)):Jr(Di),wi}function ks(Fe,qe){var $e=Fe.c*Fe.i,ri=$e+qe+16*qe;return r(Fe.c<=qe),Fe.V=Ue(ri),Fe.V==null?(Fe.Ta=null,Fe.Ua=0,Fe.a=1,0):(Fe.Ta=Fe.V,Fe.Ua=Fe.Ba+$e+qe,1)}function Rs(Fe,qe){var $e=Fe.C,ri=qe-$e,pi=Fe.V,wi=Fe.Ba+Fe.c*$e;for(r(qe<=Fe.l.o);0<ri;){var Ai=16<ri?16:ri,Ei=Fe.l.ma,Li=Fe.l.width,Di=Li*Ai,Hi=Ei.ca,Qi=Ei.tb+Li*$e,Zi=Fe.Ta,Yi=Fe.Ua;sr(Fe,Ai,pi,wi),Gl(Zi,Yi,Hi,Qi,Di),fr(Ei,$e,$e+Ai,Hi,Qi,Li),ri-=Ai,pi+=Ai*Fe.c,$e+=Ai}r($e==qe),Fe.C=Fe.Ma=qe}function js(){this.ub=this.yd=this.td=this.Rb=0}function Bs(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function Us(){this.Fb=this.Bb=this.Cb=0,this.Zb=Ue(4),this.Lb=Ue(4)}function Ha(){this.Yb=function(){var Fe=[];return function qe($e,ri,pi){for(var wi=pi[ri],Ai=0;Ai<wi&&($e.push(pi.length>ri+1?[]:0),!(pi.length<ri+1));Ai++)qe($e[Ai],ri+1,pi)}(Fe,0,[3,11]),Fe}()}function Io(){this.jb=Ue(3),this.Wc=Ee([4,8],Ha),this.Xc=Ee([4,17],Ha)}function Ro(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new Ue(4),this.od=new Ue(4)}function qs(){this.ld=this.La=this.dd=this.tc=0}function Xa(){this.Na=this.la=0}function jo(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function fa(){this.ad=Ue(384),this.Za=0,this.Ob=Ue(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function Bo(){this.uc=this.M=this.Nb=0,this.wa=Array(new qs),this.Y=0,this.ya=Array(new fa),this.aa=0,this.l=new zs}function Va(){this.y=Ue(16),this.f=Ue(8),this.ea=Ue(8)}function Uo(){this.cb=this.a=0,this.sc="",this.m=new Si,this.Od=new js,this.Kc=new Bs,this.ed=new Ro,this.Qa=new Us,this.Ic=this.$c=this.Aa=0,this.D=new Bo,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=He(8,Si),this.ia=0,this.pb=He(4,jo),this.Pa=new Io,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new Va),this.Hd=0,this.rb=Array(new Xa),this.sb=0,this.wa=Array(new qs),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new fa),this.L=this.aa=0,this.gd=Ee([4,2],qs),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function zs(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function qo(){var Fe=new Uo;return Fe!=null&&(Fe.a=0,Fe.sc="OK",Fe.cb=0,Fe.Xb=0,Ia||(Ia=Ka)),Fe}function hr(Fe,qe,$e){return Fe.a==0&&(Fe.a=qe,Fe.sc=$e,Fe.cb=0),0}function Ga(Fe,qe,$e){return 3<=$e&&Fe[qe+0]==157&&Fe[qe+1]==1&&Fe[qe+2]==42}function Ya(Fe,qe){if(Fe==null)return 0;if(Fe.a=0,Fe.sc="OK",qe==null)return hr(Fe,2,"null VP8Io passed to VP8GetHeaders()");var $e=qe.data,ri=qe.w,pi=qe.ha;if(4>pi)return hr(Fe,7,"Truncated header.");var wi=$e[ri+0]|$e[ri+1]<<8|$e[ri+2]<<16,Ai=Fe.Od;if(Ai.Rb=!(1&wi),Ai.td=wi>>1&7,Ai.yd=wi>>4&1,Ai.ub=wi>>5,3<Ai.td)return hr(Fe,3,"Incorrect keyframe parameters.");if(!Ai.yd)return hr(Fe,4,"Frame not displayable.");ri+=3,pi-=3;var Ei=Fe.Kc;if(Ai.Rb){if(7>pi)return hr(Fe,7,"cannot parse picture header");if(!Ga($e,ri,pi))return hr(Fe,3,"Bad code word");Ei.c=16383&($e[ri+4]<<8|$e[ri+3]),Ei.Td=$e[ri+4]>>6,Ei.i=16383&($e[ri+6]<<8|$e[ri+5]),Ei.Ud=$e[ri+6]>>6,ri+=7,pi-=7,Fe.za=Ei.c+15>>4,Fe.Ub=Ei.i+15>>4,qe.width=Ei.c,qe.height=Ei.i,qe.Da=0,qe.j=0,qe.v=0,qe.va=qe.width,qe.o=qe.height,qe.da=0,qe.ib=qe.width,qe.hb=qe.height,qe.U=qe.width,qe.T=qe.height,Be((wi=Fe.Pa).jb,0,255,wi.jb.length),r((wi=Fe.Qa)!=null),wi.Cb=0,wi.Bb=0,wi.Fb=1,Be(wi.Zb,0,0,wi.Zb.length),Be(wi.Lb,0,0,wi.Lb)}if(Ai.ub>pi)return hr(Fe,7,"bad partition length");bi(wi=Fe.m,$e,ri,Ai.ub),ri+=Ai.ub,pi-=Ai.ub,Ai.Rb&&(Ei.Ld=li(wi),Ei.Kd=li(wi)),Ei=Fe.Qa;var Li,Di=Fe.Pa;if(r(wi!=null),r(Ei!=null),Ei.Cb=li(wi),Ei.Cb){if(Ei.Bb=li(wi),li(wi)){for(Ei.Fb=li(wi),Li=0;4>Li;++Li)Ei.Zb[Li]=li(wi)?Pi(wi,7):0;for(Li=0;4>Li;++Li)Ei.Lb[Li]=li(wi)?Pi(wi,6):0}if(Ei.Bb)for(Li=0;3>Li;++Li)Di.jb[Li]=li(wi)?vi(wi,8):255}else Ei.Bb=0;if(wi.Ka)return hr(Fe,3,"cannot parse segment header");if((Ei=Fe.ed).zd=li(wi),Ei.Tb=vi(wi,6),Ei.wb=vi(wi,3),Ei.Pc=li(wi),Ei.Pc&&li(wi)){for(Di=0;4>Di;++Di)li(wi)&&(Ei.vd[Di]=Pi(wi,6));for(Di=0;4>Di;++Di)li(wi)&&(Ei.od[Di]=Pi(wi,6))}if(Fe.L=Ei.Tb==0?0:Ei.zd?1:2,wi.Ka)return hr(Fe,3,"cannot parse filter header");var Hi=pi;if(pi=Li=ri,ri=Li+Hi,Ei=Hi,Fe.Xb=(1<<vi(Fe.m,2))-1,Hi<3*(Di=Fe.Xb))$e=7;else{for(Li+=3*Di,Ei-=3*Di,Hi=0;Hi<Di;++Hi){var Qi=$e[pi+0]|$e[pi+1]<<8|$e[pi+2]<<16;Qi>Ei&&(Qi=Ei),bi(Fe.Jc[+Hi],$e,Li,Qi),Li+=Qi,Ei-=Qi,pi+=3}bi(Fe.Jc[+Di],$e,Li,Ei),$e=Li<ri?0:5}if($e!=0)return hr(Fe,$e,"cannot parse partitions");for($e=vi(Li=Fe.m,7),pi=li(Li)?Pi(Li,4):0,ri=li(Li)?Pi(Li,4):0,Ei=li(Li)?Pi(Li,4):0,Di=li(Li)?Pi(Li,4):0,Li=li(Li)?Pi(Li,4):0,Hi=Fe.Qa,Qi=0;4>Qi;++Qi){if(Hi.Cb){var Zi=Hi.Zb[Qi];Hi.Fb||(Zi+=$e)}else{if(0<Qi){Fe.pb[Qi]=Fe.pb[0];continue}Zi=$e}var Yi=Fe.pb[Qi];Yi.Sc[0]=gl[Or(Zi+pi,127)],Yi.Sc[1]=ml[Or(Zi+0,127)],Yi.Eb[0]=2*gl[Or(Zi+ri,127)],Yi.Eb[1]=101581*ml[Or(Zi+Ei,127)]>>16,8>Yi.Eb[1]&&(Yi.Eb[1]=8),Yi.Qc[0]=gl[Or(Zi+Di,117)],Yi.Qc[1]=ml[Or(Zi+Li,127)],Yi.lc=Zi+Li}if(!Ai.Rb)return hr(Fe,4,"Not a key frame.");for(li(wi),Ai=Fe.Pa,$e=0;4>$e;++$e){for(pi=0;8>pi;++pi)for(ri=0;3>ri;++ri)for(Ei=0;11>Ei;++Ei)Di=ci(wi,oc[$e][pi][ri][Ei])?vi(wi,8):sc[$e][pi][ri][Ei],Ai.Wc[$e][pi].Yb[ri][Ei]=Di;for(pi=0;17>pi;++pi)Ai.Xc[$e][pi]=Ai.Wc[$e][hc[pi]]}return Fe.kc=li(wi),Fe.kc&&(Fe.Bd=vi(wi,8)),Fe.cb=1}function Ka(Fe,qe,$e,ri,pi,wi,Ai){var Ei=qe[pi].Yb[$e];for($e=0;16>pi;++pi){if(!ci(Fe,Ei[$e+0]))return pi;for(;!ci(Fe,Ei[$e+1]);)if(Ei=qe[++pi].Yb[0],$e=0,pi==16)return 16;var Li=qe[pi+1].Yb;if(ci(Fe,Ei[$e+2])){var Di=Fe,Hi=0;if(ci(Di,(Zi=Ei)[(Qi=$e)+3]))if(ci(Di,Zi[Qi+6])){for(Ei=0,Qi=2*(Hi=ci(Di,Zi[Qi+8]))+(Zi=ci(Di,Zi[Qi+9+Hi])),Hi=0,Zi=nc[Qi];Zi[Ei];++Ei)Hi+=Hi+ci(Di,Zi[Ei]);Hi+=3+(8<<Qi)}else ci(Di,Zi[Qi+7])?(Hi=7+2*ci(Di,165),Hi+=ci(Di,145)):Hi=5+ci(Di,159);else Hi=ci(Di,Zi[Qi+4])?3+ci(Di,Zi[Qi+5]):2;Ei=Li[2]}else Hi=1,Ei=Li[1];Li=Ai+rc[pi],0>(Di=Fe).b&&si(Di);var Qi,Zi=Di.b,Yi=(Qi=Di.Ca>>1)-(Di.I>>Zi)>>31;--Di.b,Di.Ca+=Yi,Di.Ca|=1,Di.I-=(Qi+1&Yi)<<Zi,wi[Li]=((Hi^Yi)-Yi)*ri[(0<pi)+0]}return 16}function da(Fe){var qe=Fe.rb[Fe.sb-1];qe.la=0,qe.Na=0,Be(Fe.zc,0,0,Fe.zc.length),Fe.ja=0}function zo(Fe,qe){if(Fe==null)return 0;if(qe==null)return hr(Fe,2,"NULL VP8Io parameter in VP8Decode().");if(!Fe.cb&&!Ya(Fe,qe))return 0;if(r(Fe.cb),qe.ac==null||qe.ac(qe)){qe.ob&&(Fe.L=0);var $e=wo[Fe.L];if(Fe.L==2?(Fe.yb=0,Fe.zb=0):(Fe.yb=qe.v-$e>>4,Fe.zb=qe.j-$e>>4,0>Fe.yb&&(Fe.yb=0),0>Fe.zb&&(Fe.zb=0)),Fe.Va=qe.o+15+$e>>4,Fe.Hb=qe.va+15+$e>>4,Fe.Hb>Fe.za&&(Fe.Hb=Fe.za),Fe.Va>Fe.Ub&&(Fe.Va=Fe.Ub),0<Fe.L){var ri=Fe.ed;for($e=0;4>$e;++$e){var pi;if(Fe.Qa.Cb){var wi=Fe.Qa.Lb[$e];Fe.Qa.Fb||(wi+=ri.Tb)}else wi=ri.Tb;for(pi=0;1>=pi;++pi){var Ai=Fe.gd[$e][pi],Ei=wi;if(ri.Pc&&(Ei+=ri.vd[0],pi&&(Ei+=ri.od[0])),0<(Ei=0>Ei?0:63<Ei?63:Ei)){var Li=Ei;0<ri.wb&&(Li=4<ri.wb?Li>>2:Li>>1)>9-ri.wb&&(Li=9-ri.wb),1>Li&&(Li=1),Ai.dd=Li,Ai.tc=2*Ei+Li,Ai.ld=40<=Ei?2:15<=Ei?1:0}else Ai.tc=0;Ai.La=pi}}}$e=0}else hr(Fe,6,"Frame setup failed"),$e=Fe.a;if($e=$e==0){if($e){Fe.$c=0,0<Fe.Aa||(Fe.Ic=Sc);t:{$e=Fe.Ic,ri=4*(Li=Fe.za);var Di=32*Li,Hi=Li+1,Qi=0<Fe.L?Li*(0<Fe.Aa?2:1):0,Zi=(Fe.Aa==2?2:1)*Li;if((Ai=ri+832+(pi=3*(16*$e+wo[Fe.L])/2*Di)+(wi=Fe.Fa!=null&&0<Fe.Fa.length?Fe.Kc.c*Fe.Kc.i:0))!=Ai)$e=0;else{if(Ai>Fe.Vb){if(Fe.Vb=0,Fe.Ec=Ue(Ai),Fe.Fc=0,Fe.Ec==null){$e=hr(Fe,1,"no memory during frame initialization.");break t}Fe.Vb=Ai}Ai=Fe.Ec,Ei=Fe.Fc,Fe.Ac=Ai,Fe.Bc=Ei,Ei+=ri,Fe.Gd=He(Di,Va),Fe.Hd=0,Fe.rb=He(Hi+1,Xa),Fe.sb=1,Fe.wa=Qi?He(Qi,qs):null,Fe.Y=0,Fe.D.Nb=0,Fe.D.wa=Fe.wa,Fe.D.Y=Fe.Y,0<Fe.Aa&&(Fe.D.Y+=Li),r(!0),Fe.oc=Ai,Fe.pc=Ei,Ei+=832,Fe.ya=He(Zi,fa),Fe.aa=0,Fe.D.ya=Fe.ya,Fe.D.aa=Fe.aa,Fe.Aa==2&&(Fe.D.aa+=Li),Fe.R=16*Li,Fe.B=8*Li,Li=(Di=wo[Fe.L])*Fe.R,Di=Di/2*Fe.B,Fe.sa=Ai,Fe.ta=Ei+Li,Fe.qa=Fe.sa,Fe.ra=Fe.ta+16*$e*Fe.R+Di,Fe.Ha=Fe.qa,Fe.Ia=Fe.ra+8*$e*Fe.B+Di,Fe.$c=0,Ei+=pi,Fe.mb=wi?Ai:null,Fe.nb=wi?Ei:null,r(Ei+wi<=Fe.Fc+Fe.Vb),da(Fe),Be(Fe.Ac,Fe.Bc,0,ri),$e=1}}if($e){if(qe.ka=0,qe.y=Fe.sa,qe.O=Fe.ta,qe.f=Fe.qa,qe.N=Fe.ra,qe.ea=Fe.Ha,qe.Vd=Fe.Ia,qe.fa=Fe.R,qe.Rc=Fe.B,qe.F=null,qe.J=0,!Ql){for($e=-255;255>=$e;++$e)Yl[255+$e]=0>$e?-$e:$e;for($e=-1020;1020>=$e;++$e)Kl[1020+$e]=-128>$e?-128:127<$e?127:$e;for($e=-112;112>=$e;++$e)$l[112+$e]=-16>$e?-16:15<$e?15:$e;for($e=-255;510>=$e;++$e)Jl[255+$e]=0>$e?0:255<$e?255:$e;Ql=1}Gr=Xo,na=Wo,ys=Ja,Yr=Ho,os=Qa,Na=$a,Ns=ya,ra=Fs,Ds=rl,_s=wa,Da=nl,Rr=Ys,ls=Sa,ir=oo,nr=ao,cr=rs,mr=ps,hs=il,Kr[0]=Zr,Kr[1]=Vo,Kr[2]=$o,Kr[3]=Jo,Kr[4]=eo,Kr[5]=Vs,Kr[6]=io,Kr[7]=ma,Kr[8]=Zo,Kr[9]=Qo,Ss[0]=Za,Ss[1]=Yo,Ss[2]=ns,Ss[3]=Hs,Ss[4]=Sr,Ss[5]=Ko,Ss[6]=to,cs[0]=ds,cs[1]=Go,cs[2]=tl,cs[3]=va,cs[4]=Os,cs[5]=el,cs[6]=ba,$e=1}else $e=0}$e&&($e=function(Yi,un){for(Yi.M=0;Yi.M<Yi.Va;++Yi.M){var nn,Xi=Yi.Jc[Yi.M&Yi.Xb],Gi=Yi.m,hn=Yi;for(nn=0;nn<hn.za;++nn){var dn=Gi,cn=hn,An=cn.Ac,_n=cn.Bc+4*nn,On=cn.zc,wn=cn.ya[cn.aa+nn];if(cn.Qa.Bb?wn.$b=ci(dn,cn.Pa.jb[0])?2+ci(dn,cn.Pa.jb[2]):ci(dn,cn.Pa.jb[1]):wn.$b=0,cn.kc&&(wn.Ad=ci(dn,cn.Bd)),wn.Za=!ci(dn,145)+0,wn.Za){var Yn=wn.Ob,Jn=0;for(cn=0;4>cn;++cn){var Vn,Hn=On[0+cn];for(Vn=0;4>Vn;++Vn){Hn=ac[An[_n+Vn]][Hn];for(var tr=ih[ci(dn,Hn[0])];0<tr;)tr=ih[2*tr+ci(dn,Hn[tr])];Hn=-tr,An[_n+Vn]=Hn}Oe(Yn,Jn,An,_n,4),Jn+=4,On[0+cn]=Hn}}else Hn=ci(dn,156)?ci(dn,128)?1:3:ci(dn,163)?2:0,wn.Ob[0]=Hn,Be(An,_n,Hn,4),Be(On,0,Hn,4);wn.Dd=ci(dn,142)?ci(dn,114)?ci(dn,183)?1:3:2:0}if(hn.m.Ka)return hr(Yi,7,"Premature end-of-partition0 encountered.");for(;Yi.ja<Yi.za;++Yi.ja){if(hn=Xi,dn=(Gi=Yi).rb[Gi.sb-1],An=Gi.rb[Gi.sb+Gi.ja],nn=Gi.ya[Gi.aa+Gi.ja],_n=Gi.kc?nn.Ad:0)dn.la=An.la=0,nn.Za||(dn.Na=An.Na=0),nn.Hc=0,nn.Gc=0,nn.ia=0;else{var Zn,jn;if(dn=An,An=hn,_n=Gi.Pa.Xc,On=Gi.ya[Gi.aa+Gi.ja],wn=Gi.pb[On.$b],cn=On.ad,Yn=0,Jn=Gi.rb[Gi.sb-1],Hn=Vn=0,Be(cn,Yn,0,384),On.Za)var pr=0,kr=_n[3];else{tr=Ue(16);var gr=dn.Na+Jn.Na;if(gr=Ia(An,_n[1],gr,wn.Eb,0,tr,0),dn.Na=Jn.Na=(0<gr)+0,1<gr)Gr(tr,0,cn,Yn);else{var Lr=tr[0]+3>>3;for(tr=0;256>tr;tr+=16)cn[Yn+tr]=Lr}pr=1,kr=_n[0]}var Qn=15&dn.la,Mr=15&Jn.la;for(tr=0;4>tr;++tr){var Nr=1&Mr;for(Lr=jn=0;4>Lr;++Lr)Qn=Qn>>1|(Nr=(gr=Ia(An,kr,gr=Nr+(1&Qn),wn.Sc,pr,cn,Yn))>pr)<<7,jn=jn<<2|(3<gr?3:1<gr?2:cn[Yn+0]!=0),Yn+=16;Qn>>=4,Mr=Mr>>1|Nr<<7,Vn=(Vn<<8|jn)>>>0}for(kr=Qn,pr=Mr>>4,Zn=0;4>Zn;Zn+=2){for(jn=0,Qn=dn.la>>4+Zn,Mr=Jn.la>>4+Zn,tr=0;2>tr;++tr){for(Nr=1&Mr,Lr=0;2>Lr;++Lr)gr=Nr+(1&Qn),Qn=Qn>>1|(Nr=0<(gr=Ia(An,_n[2],gr,wn.Qc,0,cn,Yn)))<<3,jn=jn<<2|(3<gr?3:1<gr?2:cn[Yn+0]!=0),Yn+=16;Qn>>=2,Mr=Mr>>1|Nr<<5}Hn|=jn<<4*Zn,kr|=Qn<<4<<Zn,pr|=(240&Mr)<<Zn}dn.la=kr,Jn.la=pr,On.Hc=Vn,On.Gc=Hn,On.ia=43690&Hn?0:wn.ia,_n=!(Vn|Hn)}if(0<Gi.L&&(Gi.wa[Gi.Y+Gi.ja]=Gi.gd[nn.$b][nn.Za],Gi.wa[Gi.Y+Gi.ja].La|=!_n),hn.Ka)return hr(Yi,7,"Premature end-of-file encountered.")}if(da(Yi),Gi=un,hn=1,nn=(Xi=Yi).D,dn=0<Xi.L&&Xi.M>=Xi.zb&&Xi.M<=Xi.Va,Xi.Aa==0)t:{if(nn.M=Xi.M,nn.uc=dn,Ea(Xi,nn),hn=1,nn=(jn=Xi.D).Nb,dn=(Hn=wo[Xi.L])*Xi.R,An=Hn/2*Xi.B,tr=16*nn*Xi.R,Lr=8*nn*Xi.B,_n=Xi.sa,On=Xi.ta-dn+tr,wn=Xi.qa,cn=Xi.ra-An+Lr,Yn=Xi.Ha,Jn=Xi.Ia-An+Lr,Mr=(Qn=jn.M)==0,Vn=Qn>=Xi.Va-1,Xi.Aa==2&&Ea(Xi,jn),jn.uc)for(Nr=(gr=Xi).D.M,r(gr.D.uc),jn=gr.yb;jn<gr.Hb;++jn){pr=jn,kr=Nr;var br=(wr=(lr=gr).D).Nb;Zn=lr.R;var wr=wr.wa[wr.Y+pr],xr=lr.sa,Ur=lr.ta+16*br*Zn+16*pr,es=wr.dd,yr=wr.tc;if(yr!=0)if(r(3<=yr),lr.L==1)0<pr&&cr(xr,Ur,Zn,yr+4),wr.La&&hs(xr,Ur,Zn,yr),0<kr&&nr(xr,Ur,Zn,yr+4),wr.La&&mr(xr,Ur,Zn,yr);else{var us=lr.B,Is=lr.qa,aa=lr.ra+8*br*us+8*pr,xs=lr.Ha,lr=lr.Ia+8*br*us+8*pr;br=wr.ld,0<pr&&(ra(xr,Ur,Zn,yr+4,es,br),_s(Is,aa,xs,lr,us,yr+4,es,br)),wr.La&&(Rr(xr,Ur,Zn,yr,es,br),ir(Is,aa,xs,lr,us,yr,es,br)),0<kr&&(Ns(xr,Ur,Zn,yr+4,es,br),Ds(Is,aa,xs,lr,us,yr+4,es,br)),wr.La&&(Da(xr,Ur,Zn,yr,es,br),ls(Is,aa,xs,lr,us,yr,es,br))}}if(Xi.ia&&alert("todo:DitherRow"),Gi.put!=null){if(jn=16*Qn,Qn=16*(Qn+1),Mr?(Gi.y=Xi.sa,Gi.O=Xi.ta+tr,Gi.f=Xi.qa,Gi.N=Xi.ra+Lr,Gi.ea=Xi.Ha,Gi.W=Xi.Ia+Lr):(jn-=Hn,Gi.y=_n,Gi.O=On,Gi.f=wn,Gi.N=cn,Gi.ea=Yn,Gi.W=Jn),Vn||(Qn-=Hn),Qn>Gi.o&&(Qn=Gi.o),Gi.F=null,Gi.J=null,Xi.Fa!=null&&0<Xi.Fa.length&&jn<Qn&&(Gi.J=Ta(Xi,Gi,jn,Qn-jn),Gi.F=Xi.mb,Gi.F==null&&Gi.F.length==0)){hn=hr(Xi,3,"Could not decode alpha data.");break t}jn<Gi.j&&(Hn=Gi.j-jn,jn=Gi.j,r(!(1&Hn)),Gi.O+=Xi.R*Hn,Gi.N+=Xi.B*(Hn>>1),Gi.W+=Xi.B*(Hn>>1),Gi.F!=null&&(Gi.J+=Gi.width*Hn)),jn<Qn&&(Gi.O+=Gi.v,Gi.N+=Gi.v>>1,Gi.W+=Gi.v>>1,Gi.F!=null&&(Gi.J+=Gi.v),Gi.ka=jn-Gi.j,Gi.U=Gi.va-Gi.v,Gi.T=Qn-jn,hn=Gi.put(Gi))}nn+1!=Xi.Ic||Vn||(Oe(Xi.sa,Xi.ta-dn,_n,On+16*Xi.R,dn),Oe(Xi.qa,Xi.ra-An,wn,cn+8*Xi.B,An),Oe(Xi.Ha,Xi.Ia-An,Yn,Jn+8*Xi.B,An))}if(!hn)return hr(Yi,6,"Output aborted.")}return 1}(Fe,qe)),qe.bc!=null&&qe.bc(qe),$e&=1}return $e?(Fe.cb=0,$e):0}function zr(Fe,qe,$e,ri,pi){pi=Fe[qe+$e+32*ri]+(pi>>3),Fe[qe+$e+32*ri]=-256&pi?0>pi?0:255:pi}function Ws(Fe,qe,$e,ri,pi,wi){zr(Fe,qe,0,$e,ri+pi),zr(Fe,qe,1,$e,ri+wi),zr(Fe,qe,2,$e,ri-wi),zr(Fe,qe,3,$e,ri-pi)}function Tr(Fe){return(20091*Fe>>16)+Fe}function pa(Fe,qe,$e,ri){var pi,wi=0,Ai=Ue(16);for(pi=0;4>pi;++pi){var Ei=Fe[qe+0]+Fe[qe+8],Li=Fe[qe+0]-Fe[qe+8],Di=(35468*Fe[qe+4]>>16)-Tr(Fe[qe+12]),Hi=Tr(Fe[qe+4])+(35468*Fe[qe+12]>>16);Ai[wi+0]=Ei+Hi,Ai[wi+1]=Li+Di,Ai[wi+2]=Li-Di,Ai[wi+3]=Ei-Hi,wi+=4,qe++}for(pi=wi=0;4>pi;++pi)Ei=(Fe=Ai[wi+0]+4)+Ai[wi+8],Li=Fe-Ai[wi+8],Di=(35468*Ai[wi+4]>>16)-Tr(Ai[wi+12]),zr($e,ri,0,0,Ei+(Hi=Tr(Ai[wi+4])+(35468*Ai[wi+12]>>16))),zr($e,ri,1,0,Li+Di),zr($e,ri,2,0,Li-Di),zr($e,ri,3,0,Ei-Hi),wi++,ri+=32}function $a(Fe,qe,$e,ri){var pi=Fe[qe+0]+4,wi=35468*Fe[qe+4]>>16,Ai=Tr(Fe[qe+4]),Ei=35468*Fe[qe+1]>>16;Ws($e,ri,0,pi+Ai,Fe=Tr(Fe[qe+1]),Ei),Ws($e,ri,1,pi+wi,Fe,Ei),Ws($e,ri,2,pi-wi,Fe,Ei),Ws($e,ri,3,pi-Ai,Fe,Ei)}function Wo(Fe,qe,$e,ri,pi){pa(Fe,qe,$e,ri),pi&&pa(Fe,qe+16,$e,ri+4)}function Ja(Fe,qe,$e,ri){na(Fe,qe+0,$e,ri,1),na(Fe,qe+32,$e,ri+128,1)}function Ho(Fe,qe,$e,ri){var pi;for(Fe=Fe[qe+0]+4,pi=0;4>pi;++pi)for(qe=0;4>qe;++qe)zr($e,ri,qe,pi,Fe)}function Qa(Fe,qe,$e,ri){Fe[qe+0]&&Yr(Fe,qe+0,$e,ri),Fe[qe+16]&&Yr(Fe,qe+16,$e,ri+4),Fe[qe+32]&&Yr(Fe,qe+32,$e,ri+128),Fe[qe+48]&&Yr(Fe,qe+48,$e,ri+128+4)}function Xo(Fe,qe,$e,ri){var pi,wi=Ue(16);for(pi=0;4>pi;++pi){var Ai=Fe[qe+0+pi]+Fe[qe+12+pi],Ei=Fe[qe+4+pi]+Fe[qe+8+pi],Li=Fe[qe+4+pi]-Fe[qe+8+pi],Di=Fe[qe+0+pi]-Fe[qe+12+pi];wi[0+pi]=Ai+Ei,wi[8+pi]=Ai-Ei,wi[4+pi]=Di+Li,wi[12+pi]=Di-Li}for(pi=0;4>pi;++pi)Ai=(Fe=wi[0+4*pi]+3)+wi[3+4*pi],Ei=wi[1+4*pi]+wi[2+4*pi],Li=wi[1+4*pi]-wi[2+4*pi],Di=Fe-wi[3+4*pi],$e[ri+0]=Ai+Ei>>3,$e[ri+16]=Di+Li>>3,$e[ri+32]=Ai-Ei>>3,$e[ri+48]=Di-Li>>3,ri+=64}function ga(Fe,qe,$e){var ri,pi=qe-32,wi=Fr,Ai=255-Fe[pi-1];for(ri=0;ri<$e;++ri){var Ei,Li=wi,Di=Ai+Fe[qe-1];for(Ei=0;Ei<$e;++Ei)Fe[qe+Ei]=Li[Di+Fe[pi+Ei]];qe+=32}}function Vo(Fe,qe){ga(Fe,qe,4)}function Go(Fe,qe){ga(Fe,qe,8)}function Yo(Fe,qe){ga(Fe,qe,16)}function ns(Fe,qe){var $e;for($e=0;16>$e;++$e)Oe(Fe,qe+32*$e,Fe,qe-32,16)}function Hs(Fe,qe){var $e;for($e=16;0<$e;--$e)Be(Fe,qe,Fe[qe-1],16),qe+=32}function Xs(Fe,qe,$e){var ri;for(ri=0;16>ri;++ri)Be(qe,$e+32*ri,Fe,16)}function Za(Fe,qe){var $e,ri=16;for($e=0;16>$e;++$e)ri+=Fe[qe-1+32*$e]+Fe[qe+$e-32];Xs(ri>>5,Fe,qe)}function Sr(Fe,qe){var $e,ri=8;for($e=0;16>$e;++$e)ri+=Fe[qe-1+32*$e];Xs(ri>>4,Fe,qe)}function Ko(Fe,qe){var $e,ri=8;for($e=0;16>$e;++$e)ri+=Fe[qe+$e-32];Xs(ri>>4,Fe,qe)}function to(Fe,qe){Xs(128,Fe,qe)}function Nn(Fe,qe,$e){return Fe+2*qe+$e+2>>2}function $o(Fe,qe){var $e,ri=qe-32;for(ri=new Uint8Array([Nn(Fe[ri-1],Fe[ri+0],Fe[ri+1]),Nn(Fe[ri+0],Fe[ri+1],Fe[ri+2]),Nn(Fe[ri+1],Fe[ri+2],Fe[ri+3]),Nn(Fe[ri+2],Fe[ri+3],Fe[ri+4])]),$e=0;4>$e;++$e)Oe(Fe,qe+32*$e,ri,0,ri.length)}function Jo(Fe,qe){var $e=Fe[qe-1],ri=Fe[qe-1+32],pi=Fe[qe-1+64],wi=Fe[qe-1+96];Ci(Fe,qe+0,16843009*Nn(Fe[qe-1-32],$e,ri)),Ci(Fe,qe+32,16843009*Nn($e,ri,pi)),Ci(Fe,qe+64,16843009*Nn(ri,pi,wi)),Ci(Fe,qe+96,16843009*Nn(pi,wi,wi))}function Zr(Fe,qe){var $e,ri=4;for($e=0;4>$e;++$e)ri+=Fe[qe+$e-32]+Fe[qe-1+32*$e];for(ri>>=3,$e=0;4>$e;++$e)Be(Fe,qe+32*$e,ri,4)}function eo(Fe,qe){var $e=Fe[qe-1+0],ri=Fe[qe-1+32],pi=Fe[qe-1+64],wi=Fe[qe-1-32],Ai=Fe[qe+0-32],Ei=Fe[qe+1-32],Li=Fe[qe+2-32],Di=Fe[qe+3-32];Fe[qe+0+96]=Nn(ri,pi,Fe[qe-1+96]),Fe[qe+1+96]=Fe[qe+0+64]=Nn($e,ri,pi),Fe[qe+2+96]=Fe[qe+1+64]=Fe[qe+0+32]=Nn(wi,$e,ri),Fe[qe+3+96]=Fe[qe+2+64]=Fe[qe+1+32]=Fe[qe+0+0]=Nn(Ai,wi,$e),Fe[qe+3+64]=Fe[qe+2+32]=Fe[qe+1+0]=Nn(Ei,Ai,wi),Fe[qe+3+32]=Fe[qe+2+0]=Nn(Li,Ei,Ai),Fe[qe+3+0]=Nn(Di,Li,Ei)}function io(Fe,qe){var $e=Fe[qe+1-32],ri=Fe[qe+2-32],pi=Fe[qe+3-32],wi=Fe[qe+4-32],Ai=Fe[qe+5-32],Ei=Fe[qe+6-32],Li=Fe[qe+7-32];Fe[qe+0+0]=Nn(Fe[qe+0-32],$e,ri),Fe[qe+1+0]=Fe[qe+0+32]=Nn($e,ri,pi),Fe[qe+2+0]=Fe[qe+1+32]=Fe[qe+0+64]=Nn(ri,pi,wi),Fe[qe+3+0]=Fe[qe+2+32]=Fe[qe+1+64]=Fe[qe+0+96]=Nn(pi,wi,Ai),Fe[qe+3+32]=Fe[qe+2+64]=Fe[qe+1+96]=Nn(wi,Ai,Ei),Fe[qe+3+64]=Fe[qe+2+96]=Nn(Ai,Ei,Li),Fe[qe+3+96]=Nn(Ei,Li,Li)}function Vs(Fe,qe){var $e=Fe[qe-1+0],ri=Fe[qe-1+32],pi=Fe[qe-1+64],wi=Fe[qe-1-32],Ai=Fe[qe+0-32],Ei=Fe[qe+1-32],Li=Fe[qe+2-32],Di=Fe[qe+3-32];Fe[qe+0+0]=Fe[qe+1+64]=wi+Ai+1>>1,Fe[qe+1+0]=Fe[qe+2+64]=Ai+Ei+1>>1,Fe[qe+2+0]=Fe[qe+3+64]=Ei+Li+1>>1,Fe[qe+3+0]=Li+Di+1>>1,Fe[qe+0+96]=Nn(pi,ri,$e),Fe[qe+0+64]=Nn(ri,$e,wi),Fe[qe+0+32]=Fe[qe+1+96]=Nn($e,wi,Ai),Fe[qe+1+32]=Fe[qe+2+96]=Nn(wi,Ai,Ei),Fe[qe+2+32]=Fe[qe+3+96]=Nn(Ai,Ei,Li),Fe[qe+3+32]=Nn(Ei,Li,Di)}function ma(Fe,qe){var $e=Fe[qe+0-32],ri=Fe[qe+1-32],pi=Fe[qe+2-32],wi=Fe[qe+3-32],Ai=Fe[qe+4-32],Ei=Fe[qe+5-32],Li=Fe[qe+6-32],Di=Fe[qe+7-32];Fe[qe+0+0]=$e+ri+1>>1,Fe[qe+1+0]=Fe[qe+0+64]=ri+pi+1>>1,Fe[qe+2+0]=Fe[qe+1+64]=pi+wi+1>>1,Fe[qe+3+0]=Fe[qe+2+64]=wi+Ai+1>>1,Fe[qe+0+32]=Nn($e,ri,pi),Fe[qe+1+32]=Fe[qe+0+96]=Nn(ri,pi,wi),Fe[qe+2+32]=Fe[qe+1+96]=Nn(pi,wi,Ai),Fe[qe+3+32]=Fe[qe+2+96]=Nn(wi,Ai,Ei),Fe[qe+3+64]=Nn(Ai,Ei,Li),Fe[qe+3+96]=Nn(Ei,Li,Di)}function Qo(Fe,qe){var $e=Fe[qe-1+0],ri=Fe[qe-1+32],pi=Fe[qe-1+64],wi=Fe[qe-1+96];Fe[qe+0+0]=$e+ri+1>>1,Fe[qe+2+0]=Fe[qe+0+32]=ri+pi+1>>1,Fe[qe+2+32]=Fe[qe+0+64]=pi+wi+1>>1,Fe[qe+1+0]=Nn($e,ri,pi),Fe[qe+3+0]=Fe[qe+1+32]=Nn(ri,pi,wi),Fe[qe+3+32]=Fe[qe+1+64]=Nn(pi,wi,wi),Fe[qe+3+64]=Fe[qe+2+64]=Fe[qe+0+96]=Fe[qe+1+96]=Fe[qe+2+96]=Fe[qe+3+96]=wi}function Zo(Fe,qe){var $e=Fe[qe-1+0],ri=Fe[qe-1+32],pi=Fe[qe-1+64],wi=Fe[qe-1+96],Ai=Fe[qe-1-32],Ei=Fe[qe+0-32],Li=Fe[qe+1-32],Di=Fe[qe+2-32];Fe[qe+0+0]=Fe[qe+2+32]=$e+Ai+1>>1,Fe[qe+0+32]=Fe[qe+2+64]=ri+$e+1>>1,Fe[qe+0+64]=Fe[qe+2+96]=pi+ri+1>>1,Fe[qe+0+96]=wi+pi+1>>1,Fe[qe+3+0]=Nn(Ei,Li,Di),Fe[qe+2+0]=Nn(Ai,Ei,Li),Fe[qe+1+0]=Fe[qe+3+32]=Nn($e,Ai,Ei),Fe[qe+1+32]=Fe[qe+3+64]=Nn(ri,$e,Ai),Fe[qe+1+64]=Fe[qe+3+96]=Nn(pi,ri,$e),Fe[qe+1+96]=Nn(wi,pi,ri)}function tl(Fe,qe){var $e;for($e=0;8>$e;++$e)Oe(Fe,qe+32*$e,Fe,qe-32,8)}function va(Fe,qe){var $e;for($e=0;8>$e;++$e)Be(Fe,qe,Fe[qe-1],8),qe+=32}function Ls(Fe,qe,$e){var ri;for(ri=0;8>ri;++ri)Be(qe,$e+32*ri,Fe,8)}function ds(Fe,qe){var $e,ri=8;for($e=0;8>$e;++$e)ri+=Fe[qe+$e-32]+Fe[qe-1+32*$e];Ls(ri>>4,Fe,qe)}function el(Fe,qe){var $e,ri=4;for($e=0;8>$e;++$e)ri+=Fe[qe+$e-32];Ls(ri>>3,Fe,qe)}function Os(Fe,qe){var $e,ri=4;for($e=0;8>$e;++$e)ri+=Fe[qe-1+32*$e];Ls(ri>>3,Fe,qe)}function ba(Fe,qe){Ls(128,Fe,qe)}function Gs(Fe,qe,$e){var ri=Fe[qe-$e],pi=Fe[qe+0],wi=3*(pi-ri)+hl[1020+Fe[qe-2*$e]-Fe[qe+$e]],Ai=fo[112+(wi+4>>3)];Fe[qe-$e]=Fr[255+ri+fo[112+(wi+3>>3)]],Fe[qe+0]=Fr[255+pi-Ai]}function no(Fe,qe,$e,ri){var pi=Fe[qe+0],wi=Fe[qe+$e];return jr[255+Fe[qe-2*$e]-Fe[qe-$e]]>ri||jr[255+wi-pi]>ri}function ro(Fe,qe,$e,ri){return 4*jr[255+Fe[qe-$e]-Fe[qe+0]]+jr[255+Fe[qe-2*$e]-Fe[qe+$e]]<=ri}function so(Fe,qe,$e,ri,pi){var wi=Fe[qe-3*$e],Ai=Fe[qe-2*$e],Ei=Fe[qe-$e],Li=Fe[qe+0],Di=Fe[qe+$e],Hi=Fe[qe+2*$e],Qi=Fe[qe+3*$e];return 4*jr[255+Ei-Li]+jr[255+Ai-Di]>ri?0:jr[255+Fe[qe-4*$e]-wi]<=pi&&jr[255+wi-Ai]<=pi&&jr[255+Ai-Ei]<=pi&&jr[255+Qi-Hi]<=pi&&jr[255+Hi-Di]<=pi&&jr[255+Di-Li]<=pi}function ao(Fe,qe,$e,ri){var pi=2*ri+1;for(ri=0;16>ri;++ri)ro(Fe,qe+ri,$e,pi)&&Gs(Fe,qe+ri,$e)}function rs(Fe,qe,$e,ri){var pi=2*ri+1;for(ri=0;16>ri;++ri)ro(Fe,qe+ri*$e,1,pi)&&Gs(Fe,qe+ri*$e,1)}function ps(Fe,qe,$e,ri){var pi;for(pi=3;0<pi;--pi)ao(Fe,qe+=4*$e,$e,ri)}function il(Fe,qe,$e,ri){var pi;for(pi=3;0<pi;--pi)rs(Fe,qe+=4,$e,ri)}function gs(Fe,qe,$e,ri,pi,wi,Ai,Ei){for(wi=2*wi+1;0<pi--;){if(so(Fe,qe,$e,wi,Ai))if(no(Fe,qe,$e,Ei))Gs(Fe,qe,$e);else{var Li=Fe,Di=qe,Hi=$e,Qi=Li[Di-2*Hi],Zi=Li[Di-Hi],Yi=Li[Di+0],un=Li[Di+Hi],nn=Li[Di+2*Hi],Xi=27*(hn=hl[1020+3*(Yi-Zi)+hl[1020+Qi-un]])+63>>7,Gi=18*hn+63>>7,hn=9*hn+63>>7;Li[Di-3*Hi]=Fr[255+Li[Di-3*Hi]+hn],Li[Di-2*Hi]=Fr[255+Qi+Gi],Li[Di-Hi]=Fr[255+Zi+Xi],Li[Di+0]=Fr[255+Yi-Xi],Li[Di+Hi]=Fr[255+un-Gi],Li[Di+2*Hi]=Fr[255+nn-hn]}qe+=ri}}function Wr(Fe,qe,$e,ri,pi,wi,Ai,Ei){for(wi=2*wi+1;0<pi--;){if(so(Fe,qe,$e,wi,Ai))if(no(Fe,qe,$e,Ei))Gs(Fe,qe,$e);else{var Li=Fe,Di=qe,Hi=$e,Qi=Li[Di-Hi],Zi=Li[Di+0],Yi=Li[Di+Hi],un=fo[112+((nn=3*(Zi-Qi))+4>>3)],nn=fo[112+(nn+3>>3)],Xi=un+1>>1;Li[Di-2*Hi]=Fr[255+Li[Di-2*Hi]+Xi],Li[Di-Hi]=Fr[255+Qi+nn],Li[Di+0]=Fr[255+Zi-un],Li[Di+Hi]=Fr[255+Yi-Xi]}qe+=ri}}function ya(Fe,qe,$e,ri,pi,wi){gs(Fe,qe,$e,1,16,ri,pi,wi)}function Fs(Fe,qe,$e,ri,pi,wi){gs(Fe,qe,1,$e,16,ri,pi,wi)}function nl(Fe,qe,$e,ri,pi,wi){var Ai;for(Ai=3;0<Ai;--Ai)Wr(Fe,qe+=4*$e,$e,1,16,ri,pi,wi)}function Ys(Fe,qe,$e,ri,pi,wi){var Ai;for(Ai=3;0<Ai;--Ai)Wr(Fe,qe+=4,1,$e,16,ri,pi,wi)}function rl(Fe,qe,$e,ri,pi,wi,Ai,Ei){gs(Fe,qe,pi,1,8,wi,Ai,Ei),gs($e,ri,pi,1,8,wi,Ai,Ei)}function wa(Fe,qe,$e,ri,pi,wi,Ai,Ei){gs(Fe,qe,1,pi,8,wi,Ai,Ei),gs($e,ri,1,pi,8,wi,Ai,Ei)}function Sa(Fe,qe,$e,ri,pi,wi,Ai,Ei){Wr(Fe,qe+4*pi,pi,1,8,wi,Ai,Ei),Wr($e,ri+4*pi,pi,1,8,wi,Ai,Ei)}function oo(Fe,qe,$e,ri,pi,wi,Ai,Ei){Wr(Fe,qe+4,1,pi,8,wi,Ai,Ei),Wr($e,ri+4,1,pi,8,wi,Ai,Ei)}function Ks(){this.ba=new bn,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new vn,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function Aa(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function xa(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function lo(){this.ua=0,this.Wa=new Qe,this.vb=new Qe,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new di,this.yc=new ai}function sl(){this.xb=this.a=0,this.l=new zs,this.ca=new bn,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new Xe,this.Pb=0,this.wd=new Xe,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new lo,this.ab=0,this.gc=He(4,xa),this.Oc=0}function $s(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new zs,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function Ms(Fe,qe,$e,ri,pi,wi,Ai){for(Fe=Fe==null?0:Fe[qe+0],qe=0;qe<Ai;++qe)pi[wi+qe]=Fe+$e[ri+qe]&255,Fe=pi[wi+qe]}function Ca(Fe,qe,$e,ri,pi,wi,Ai){var Ei;if(Fe==null)Ms(null,null,$e,ri,pi,wi,Ai);else for(Ei=0;Ei<Ai;++Ei)pi[wi+Ei]=Fe[qe+Ei]+$e[ri+Ei]&255}function ms(Fe,qe,$e,ri,pi,wi,Ai){if(Fe==null)Ms(null,null,$e,ri,pi,wi,Ai);else{var Ei,Li=Fe[qe+0],Di=Li,Hi=Li;for(Ei=0;Ei<Ai;++Ei)Di=Hi+(Li=Fe[qe+Ei])-Di,Hi=$e[ri+Ei]+(-256&Di?0>Di?0:255:Di)&255,Di=Li,pi[wi+Ei]=Hi}}function Ta(Fe,qe,$e,ri){var pi=qe.width,wi=qe.o;if(r(Fe!=null&&qe!=null),0>$e||0>=ri||$e+ri>wi)return null;if(!Fe.Cc){if(Fe.ga==null){var Ai;if(Fe.ga=new $s,(Ai=Fe.ga==null)||(Ai=qe.width*qe.o,r(Fe.Gb.length==0),Fe.Gb=Ue(Ai),Fe.Uc=0,Fe.Gb==null?Ai=0:(Fe.mb=Fe.Gb,Fe.nb=Fe.Uc,Fe.rc=null,Ai=1),Ai=!Ai),!Ai){Ai=Fe.ga;var Ei=Fe.Fa,Li=Fe.P,Di=Fe.qc,Hi=Fe.mb,Qi=Fe.nb,Zi=Li+1,Yi=Di-1,un=Ai.l;if(r(Ei!=null&&Hi!=null&&qe!=null),As[0]=null,As[1]=Ms,As[2]=Ca,As[3]=ms,Ai.ca=Hi,Ai.tb=Qi,Ai.c=qe.width,Ai.i=qe.height,r(0<Ai.c&&0<Ai.i),1>=Di)qe=0;else if(Ai.$a=Ei[Li+0]>>0&3,Ai.Z=Ei[Li+0]>>2&3,Ai.Lc=Ei[Li+0]>>4&3,Li=Ei[Li+0]>>6&3,0>Ai.$a||1<Ai.$a||4<=Ai.Z||1<Ai.Lc||Li)qe=0;else if(un.put=zn,un.ac=Mn,un.bc=Fn,un.ma=Ai,un.width=qe.width,un.height=qe.height,un.Da=qe.Da,un.v=qe.v,un.va=qe.va,un.j=qe.j,un.o=qe.o,Ai.$a)t:{r(Ai.$a==1),qe=Dr();e:for(;;){if(qe==null){qe=0;break t}if(r(Ai!=null),Ai.mc=qe,qe.c=Ai.c,qe.i=Ai.i,qe.l=Ai.l,qe.l.ma=Ai,qe.l.width=Ai.c,qe.l.height=Ai.i,qe.a=0,xi(qe.m,Ei,Zi,Yi),!Qr(Ai.c,Ai.i,1,qe,null)||(qe.ab==1&&qe.gc[0].hc==3&&ur(qe.s)?(Ai.ic=1,Ei=qe.c*qe.i,qe.Ta=null,qe.Ua=0,qe.V=Ue(Ei),qe.Ba=0,qe.V==null?(qe.a=1,qe=0):qe=1):(Ai.ic=0,qe=ks(qe,Ai.c)),!qe))break e;qe=1;break t}Ai.mc=null,qe=0}else qe=Yi>=Ai.c*Ai.i;Ai=!qe}if(Ai)return null;Fe.ga.Lc!=1?Fe.Ga=0:ri=wi-$e}r(Fe.ga!=null),r($e+ri<=wi);t:{if(qe=(Ei=Fe.ga).c,wi=Ei.l.o,Ei.$a==0){if(Zi=Fe.rc,Yi=Fe.Vc,un=Fe.Fa,Li=Fe.P+1+$e*qe,Di=Fe.mb,Hi=Fe.nb+$e*qe,r(Li<=Fe.P+Fe.qc),Ei.Z!=0)for(r(As[Ei.Z]!=null),Ai=0;Ai<ri;++Ai)As[Ei.Z](Zi,Yi,un,Li,Di,Hi,qe),Zi=Di,Yi=Hi,Hi+=qe,Li+=qe;else for(Ai=0;Ai<ri;++Ai)Oe(Di,Hi,un,Li,qe),Zi=Di,Yi=Hi,Hi+=qe,Li+=qe;Fe.rc=Zi,Fe.Vc=Yi}else{if(r(Ei.mc!=null),qe=$e+ri,r((Ai=Ei.mc)!=null),r(qe<=Ai.i),Ai.C>=qe)qe=1;else if(Ei.ic||Ki(),Ei.ic){Ei=Ai.V,Zi=Ai.Ba,Yi=Ai.c;var nn=Ai.i,Xi=(un=1,Li=Ai.$/Yi,Di=Ai.$%Yi,Hi=Ai.m,Qi=Ai.s,Ai.$),Gi=Yi*nn,hn=Yi*qe,dn=Qi.wc,cn=Xi<hn?Gn(Qi,Di,Li):null;r(Xi<=Gi),r(qe<=nn),r(ur(Qi));e:for(;;){for(;!Hi.h&&Xi<hn;){if(Di&dn||(cn=Gn(Qi,Di,Li)),r(cn!=null),ei(Hi),256>(nn=Kn(cn.G[0],cn.H[0],Hi)))Ei[Zi+Xi]=nn,++Xi,++Di>=Yi&&(Di=0,++Li<=qe&&!(Li%16)&&_r(Ai,Li));else{if(!(280>nn)){un=0;break e}nn=Rn(nn-256,Hi);var An,_n=Kn(cn.G[4],cn.H[4],Hi);if(ei(Hi),!(Xi>=(_n=er(Yi,_n=Rn(_n,Hi)))&&Gi-Xi>=nn)){un=0;break e}for(An=0;An<nn;++An)Ei[Zi+Xi+An]=Ei[Zi+Xi+An-_n];for(Xi+=nn,Di+=nn;Di>=Yi;)Di-=Yi,++Li<=qe&&!(Li%16)&&_r(Ai,Li);Xi<hn&&Di&dn&&(cn=Gn(Qi,Di,Li))}r(Hi.h==ze(Hi))}_r(Ai,Li>qe?qe:Li);break e}!un||Hi.h&&Xi<Gi?(un=0,Ai.a=Hi.h?5:3):Ai.$=Xi,qe=un}else qe=Cr(Ai,Ai.V,Ai.Ba,Ai.c,Ai.i,qe,Rs);if(!qe){ri=0;break t}}$e+ri>=wi&&(Fe.Cc=1),ri=1}if(!ri)return null;if(Fe.Cc&&((ri=Fe.ga)!=null&&(ri.mc=null),Fe.ga=null,0<Fe.Ga))return alert("todo:WebPDequantizeLevels"),null}return Fe.nb+$e*pi}function Ye(Fe,qe,$e,ri,pi,wi){for(;0<pi--;){var Ai,Ei=Fe,Li=qe+($e?1:0),Di=Fe,Hi=qe+($e?0:3);for(Ai=0;Ai<ri;++Ai){var Qi=Di[Hi+4*Ai];Qi!=255&&(Qi*=32897,Ei[Li+4*Ai+0]=Ei[Li+4*Ai+0]*Qi>>23,Ei[Li+4*Ai+1]=Ei[Li+4*Ai+1]*Qi>>23,Ei[Li+4*Ai+2]=Ei[Li+4*Ai+2]*Qi>>23)}qe+=wi}}function mi(Fe,qe,$e,ri,pi){for(;0<ri--;){var wi;for(wi=0;wi<$e;++wi){var Ai=Fe[qe+2*wi+0],Ei=15&(Di=Fe[qe+2*wi+1]),Li=4369*Ei,Di=(240&Di|Di>>4)*Li>>16;Fe[qe+2*wi+0]=(240&Ai|Ai>>4)*Li>>16&240|(15&Ai|Ai<<4)*Li>>16>>4&15,Fe[qe+2*wi+1]=240&Di|Ei}qe+=pi}}function ji(Fe,qe,$e,ri,pi,wi,Ai,Ei){var Li,Di,Hi=255;for(Di=0;Di<pi;++Di){for(Li=0;Li<ri;++Li){var Qi=Fe[qe+Li];wi[Ai+4*Li]=Qi,Hi&=Qi}qe+=$e,Ai+=Ei}return Hi!=255}function Wi(Fe,qe,$e,ri,pi){var wi;for(wi=0;wi<pi;++wi)$e[ri+wi]=Fe[qe+wi]>>8}function Ki(){ws=Ye,sa=mi,uo=ji,Gl=Wi}function sn(Fe,qe,$e){Je[Fe]=function(ri,pi,wi,Ai,Ei,Li,Di,Hi,Qi,Zi,Yi,un,nn,Xi,Gi,hn,dn){var cn,An=dn-1>>1,_n=Ei[Li+0]|Di[Hi+0]<<16,On=Qi[Zi+0]|Yi[un+0]<<16;r(ri!=null);var wn=3*_n+On+131074>>2;for(qe(ri[pi+0],255&wn,wn>>16,nn,Xi),wi!=null&&(wn=3*On+_n+131074>>2,qe(wi[Ai+0],255&wn,wn>>16,Gi,hn)),cn=1;cn<=An;++cn){var Yn=Ei[Li+cn]|Di[Hi+cn]<<16,Jn=Qi[Zi+cn]|Yi[un+cn]<<16,Vn=_n+Yn+On+Jn+524296,Hn=Vn+2*(Yn+On)>>3;wn=Hn+_n>>1,_n=(Vn=Vn+2*(_n+Jn)>>3)+Yn>>1,qe(ri[pi+2*cn-1],255&wn,wn>>16,nn,Xi+(2*cn-1)*$e),qe(ri[pi+2*cn-0],255&_n,_n>>16,nn,Xi+(2*cn-0)*$e),wi!=null&&(wn=Vn+On>>1,_n=Hn+Jn>>1,qe(wi[Ai+2*cn-1],255&wn,wn>>16,Gi,hn+(2*cn-1)*$e),qe(wi[Ai+2*cn+0],255&_n,_n>>16,Gi,hn+(2*cn+0)*$e)),_n=Yn,On=Jn}1&dn||(wn=3*_n+On+131074>>2,qe(ri[pi+dn-1],255&wn,wn>>16,nn,Xi+(dn-1)*$e),wi!=null&&(wn=3*On+_n+131074>>2,qe(wi[Ai+dn-1],255&wn,wn>>16,Gi,hn+(dn-1)*$e)))}}function gn(){Br[po]=uc,Br[go]=rh,Br[Zl]=fc,Br[mo]=sh,Br[vo]=ah,Br[cl]=oh,Br[th]=dc,Br[ul]=rh,Br[dl]=sh,Br[bo]=ah,Br[pl]=oh}function Sn(Fe){return Fe&~pc?0>Fe?0:255:Fe>>lh}function Ln(Fe,qe){return Sn((19077*Fe>>8)+(26149*qe>>8)-14234)}function Dn(Fe,qe,$e){return Sn((19077*Fe>>8)-(6419*qe>>8)-(13320*$e>>8)+8708)}function Un(Fe,qe){return Sn((19077*Fe>>8)+(33050*qe>>8)-17685)}function Xn(Fe,qe,$e,ri,pi){ri[pi+0]=Ln(Fe,$e),ri[pi+1]=Dn(Fe,qe,$e),ri[pi+2]=Un(Fe,qe)}function ar(Fe,qe,$e,ri,pi){ri[pi+0]=Un(Fe,qe),ri[pi+1]=Dn(Fe,qe,$e),ri[pi+2]=Ln(Fe,$e)}function or(Fe,qe,$e,ri,pi){var wi=Dn(Fe,qe,$e);qe=wi<<3&224|Un(Fe,qe)>>3,ri[pi+0]=248&Ln(Fe,$e)|wi>>5,ri[pi+1]=qe}function dr(Fe,qe,$e,ri,pi){var wi=240&Un(Fe,qe)|15;ri[pi+0]=240&Ln(Fe,$e)|Dn(Fe,qe,$e)>>4,ri[pi+1]=wi}function Ar(Fe,qe,$e,ri,pi){ri[pi+0]=255,Xn(Fe,qe,$e,ri,pi+1)}function vr(Fe,qe,$e,ri,pi){ar(Fe,qe,$e,ri,pi),ri[pi+3]=255}function Hr(Fe,qe,$e,ri,pi){Xn(Fe,qe,$e,ri,pi),ri[pi+3]=255}function Or(Fe,qe){return 0>Fe?0:Fe>qe?qe:Fe}function ss(Fe,qe,$e){Je[Fe]=function(ri,pi,wi,Ai,Ei,Li,Di,Hi,Qi){for(var Zi=Hi+(-2&Qi)*$e;Hi!=Zi;)qe(ri[pi+0],wi[Ai+0],Ei[Li+0],Di,Hi),qe(ri[pi+1],wi[Ai+0],Ei[Li+0],Di,Hi+$e),pi+=2,++Ai,++Li,Hi+=2*$e;1&Qi&&qe(ri[pi+0],wi[Ai+0],Ei[Li+0],Di,Hi)}}function ho(Fe,qe,$e){return $e==0?Fe==0?qe==0?6:5:qe==0?4:0:$e}function Pa(Fe,qe,$e,ri,pi){switch(Fe>>>30){case 3:na(qe,$e,ri,pi,0);break;case 2:Na(qe,$e,ri,pi);break;case 1:Yr(qe,$e,ri,pi)}}function Ea(Fe,qe){var $e,ri,pi=qe.M,wi=qe.Nb,Ai=Fe.oc,Ei=Fe.pc+40,Li=Fe.oc,Di=Fe.pc+584,Hi=Fe.oc,Qi=Fe.pc+600;for($e=0;16>$e;++$e)Ai[Ei+32*$e-1]=129;for($e=0;8>$e;++$e)Li[Di+32*$e-1]=129,Hi[Qi+32*$e-1]=129;for(0<pi?Ai[Ei-1-32]=Li[Di-1-32]=Hi[Qi-1-32]=129:(Be(Ai,Ei-32-1,127,21),Be(Li,Di-32-1,127,9),Be(Hi,Qi-32-1,127,9)),ri=0;ri<Fe.za;++ri){var Zi=qe.ya[qe.aa+ri];if(0<ri){for($e=-1;16>$e;++$e)Oe(Ai,Ei+32*$e-4,Ai,Ei+32*$e+12,4);for($e=-1;8>$e;++$e)Oe(Li,Di+32*$e-4,Li,Di+32*$e+4,4),Oe(Hi,Qi+32*$e-4,Hi,Qi+32*$e+4,4)}var Yi=Fe.Gd,un=Fe.Hd+ri,nn=Zi.ad,Xi=Zi.Hc;if(0<pi&&(Oe(Ai,Ei-32,Yi[un].y,0,16),Oe(Li,Di-32,Yi[un].f,0,8),Oe(Hi,Qi-32,Yi[un].ea,0,8)),Zi.Za){var Gi=Ai,hn=Ei-32+16;for(0<pi&&(ri>=Fe.za-1?Be(Gi,hn,Yi[un].y[15],4):Oe(Gi,hn,Yi[un+1].y,0,4)),$e=0;4>$e;$e++)Gi[hn+128+$e]=Gi[hn+256+$e]=Gi[hn+384+$e]=Gi[hn+0+$e];for($e=0;16>$e;++$e,Xi<<=2)Gi=Ai,hn=Ei+ch[$e],Kr[Zi.Ob[$e]](Gi,hn),Pa(Xi,nn,16*+$e,Gi,hn)}else if(Gi=ho(ri,pi,Zi.Ob[0]),Ss[Gi](Ai,Ei),Xi!=0)for($e=0;16>$e;++$e,Xi<<=2)Pa(Xi,nn,16*+$e,Ai,Ei+ch[$e]);for($e=Zi.Gc,Gi=ho(ri,pi,Zi.Dd),cs[Gi](Li,Di),cs[Gi](Hi,Qi),Xi=nn,Gi=Li,hn=Di,255&(Zi=$e>>0)&&(170&Zi?ys(Xi,256,Gi,hn):os(Xi,256,Gi,hn)),Zi=Hi,Xi=Qi,255&($e>>=8)&&(170&$e?ys(nn,320,Zi,Xi):os(nn,320,Zi,Xi)),pi<Fe.Ub-1&&(Oe(Yi[un].y,0,Ai,Ei+480,16),Oe(Yi[un].f,0,Li,Di+224,8),Oe(Yi[un].ea,0,Hi,Qi+224,8)),$e=8*wi*Fe.B,Yi=Fe.sa,un=Fe.ta+16*ri+16*wi*Fe.R,nn=Fe.qa,Zi=Fe.ra+8*ri+$e,Xi=Fe.Ha,Gi=Fe.Ia+8*ri+$e,$e=0;16>$e;++$e)Oe(Yi,un+$e*Fe.R,Ai,Ei+32*$e,16);for($e=0;8>$e;++$e)Oe(nn,Zi+$e*Fe.B,Li,Di+32*$e,8),Oe(Xi,Gi+$e*Fe.B,Hi,Qi+32*$e,8)}}function Js(Fe,qe,$e,ri,pi,wi,Ai,Ei,Li){var Di=[0],Hi=[0],Qi=0,Zi=Li!=null?Li.kd:0,Yi=Li!=null?Li:new Aa;if(Fe==null||12>$e)return 7;Yi.data=Fe,Yi.w=qe,Yi.ha=$e,qe=[qe],$e=[$e],Yi.gb=[Yi.gb];t:{var un=qe,nn=$e,Xi=Yi.gb;if(r(Fe!=null),r(nn!=null),r(Xi!=null),Xi[0]=0,12<=nn[0]&&!Me(Fe,un[0],"RIFF")){if(Me(Fe,un[0]+8,"WEBP")){Xi=3;break t}var Gi=Ti(Fe,un[0]+4);if(12>Gi||4294967286<Gi){Xi=3;break t}if(Zi&&Gi>nn[0]-8){Xi=7;break t}Xi[0]=Gi,un[0]+=12,nn[0]-=12}Xi=0}if(Xi!=0)return Xi;for(Gi=0<Yi.gb[0],$e=$e[0];;){t:{var hn=Fe;nn=qe,Xi=$e;var dn=Di,cn=Hi,An=un=[0];if((wn=Qi=[Qi])[0]=0,8>Xi[0])Xi=7;else{if(!Me(hn,nn[0],"VP8X")){if(Ti(hn,nn[0]+4)!=10){Xi=3;break t}if(18>Xi[0]){Xi=7;break t}var _n=Ti(hn,nn[0]+8),On=1+Oi(hn,nn[0]+12);if(2147483648<=On*(hn=1+Oi(hn,nn[0]+15))){Xi=3;break t}An!=null&&(An[0]=_n),dn!=null&&(dn[0]=On),cn!=null&&(cn[0]=hn),nn[0]+=18,Xi[0]-=18,wn[0]=1}Xi=0}}if(Qi=Qi[0],un=un[0],Xi!=0)return Xi;if(nn=!!(2&un),!Gi&&Qi)return 3;if(wi!=null&&(wi[0]=!!(16&un)),Ai!=null&&(Ai[0]=nn),Ei!=null&&(Ei[0]=0),Ai=Di[0],un=Hi[0],Qi&&nn&&Li==null){Xi=0;break}if(4>$e){Xi=7;break}if(Gi&&Qi||!Gi&&!Qi&&!Me(Fe,qe[0],"ALPH")){$e=[$e],Yi.na=[Yi.na],Yi.P=[Yi.P],Yi.Sa=[Yi.Sa];t:{_n=Fe,Xi=qe,Gi=$e;var wn=Yi.gb;dn=Yi.na,cn=Yi.P,An=Yi.Sa,On=22,r(_n!=null),r(Gi!=null),hn=Xi[0];var Yn=Gi[0];for(r(dn!=null),r(An!=null),dn[0]=null,cn[0]=null,An[0]=0;;){if(Xi[0]=hn,Gi[0]=Yn,8>Yn){Xi=7;break t}var Jn=Ti(_n,hn+4);if(4294967286<Jn){Xi=3;break t}var Vn=8+Jn+1&-2;if(On+=Vn,0<wn&&On>wn){Xi=3;break t}if(!Me(_n,hn,"VP8 ")||!Me(_n,hn,"VP8L")){Xi=0;break t}if(Yn[0]<Vn){Xi=7;break t}Me(_n,hn,"ALPH")||(dn[0]=_n,cn[0]=hn+8,An[0]=Jn),hn+=Vn,Yn-=Vn}}if($e=$e[0],Yi.na=Yi.na[0],Yi.P=Yi.P[0],Yi.Sa=Yi.Sa[0],Xi!=0)break}$e=[$e],Yi.Ja=[Yi.Ja],Yi.xa=[Yi.xa];t:if(wn=Fe,Xi=qe,Gi=$e,dn=Yi.gb[0],cn=Yi.Ja,An=Yi.xa,_n=Xi[0],hn=!Me(wn,_n,"VP8 "),On=!Me(wn,_n,"VP8L"),r(wn!=null),r(Gi!=null),r(cn!=null),r(An!=null),8>Gi[0])Xi=7;else{if(hn||On){if(wn=Ti(wn,_n+4),12<=dn&&wn>dn-12){Xi=3;break t}if(Zi&&wn>Gi[0]-8){Xi=7;break t}cn[0]=wn,Xi[0]+=8,Gi[0]-=8,An[0]=On}else An[0]=5<=Gi[0]&&wn[_n+0]==47&&!(wn[_n+4]>>5),cn[0]=Gi[0];Xi=0}if($e=$e[0],Yi.Ja=Yi.Ja[0],Yi.xa=Yi.xa[0],qe=qe[0],Xi!=0)break;if(4294967286<Yi.Ja)return 3;if(Ei==null||nn||(Ei[0]=Yi.xa?2:1),Ai=[Ai],un=[un],Yi.xa){if(5>$e){Xi=7;break}Ei=Ai,Zi=un,nn=wi,Fe==null||5>$e?Fe=0:5<=$e&&Fe[qe+0]==47&&!(Fe[qe+4]>>5)?(Gi=[0],wn=[0],dn=[0],xi(cn=new Xe,Fe,qe,$e),Cn(cn,Gi,wn,dn)?(Ei!=null&&(Ei[0]=Gi[0]),Zi!=null&&(Zi[0]=wn[0]),nn!=null&&(nn[0]=dn[0]),Fe=1):Fe=0):Fe=0}else{if(10>$e){Xi=7;break}Ei=un,Fe==null||10>$e||!Ga(Fe,qe+3,$e-3)?Fe=0:(Zi=Fe[qe+0]|Fe[qe+1]<<8|Fe[qe+2]<<16,nn=16383&(Fe[qe+7]<<8|Fe[qe+6]),Fe=16383&(Fe[qe+9]<<8|Fe[qe+8]),1&Zi||3<(Zi>>1&7)||!(Zi>>4&1)||Zi>>5>=Yi.Ja||!nn||!Fe?Fe=0:(Ai&&(Ai[0]=nn),Ei&&(Ei[0]=Fe),Fe=1))}if(!Fe||(Ai=Ai[0],un=un[0],Qi&&(Di[0]!=Ai||Hi[0]!=un)))return 3;Li!=null&&(Li[0]=Yi,Li.offset=qe-Li.w,r(4294967286>qe-Li.w),r(Li.offset==Li.ha-$e));break}return Xi==0||Xi==7&&Qi&&Li==null?(wi!=null&&(wi[0]|=Yi.na!=null&&0<Yi.na.length),ri!=null&&(ri[0]=Ai),pi!=null&&(pi[0]=un),0):Xi}function ka(Fe,qe,$e){var ri=qe.width,pi=qe.height,wi=0,Ai=0,Ei=ri,Li=pi;if(qe.Da=Fe!=null&&0<Fe.Da,qe.Da&&(Ei=Fe.cd,Li=Fe.bd,wi=Fe.v,Ai=Fe.j,11>$e||(wi&=-2,Ai&=-2),0>wi||0>Ai||0>=Ei||0>=Li||wi+Ei>ri||Ai+Li>pi))return 0;if(qe.v=wi,qe.j=Ai,qe.va=wi+Ei,qe.o=Ai+Li,qe.U=Ei,qe.T=Li,qe.da=Fe!=null&&0<Fe.da,qe.da){if(!ui(Ei,Li,$e=[Fe.ib],wi=[Fe.hb]))return 0;qe.ib=$e[0],qe.hb=wi[0]}return qe.ob=Fe!=null&&Fe.ob,qe.Kb=Fe==null||!Fe.Sd,qe.da&&(qe.ob=qe.ib<3*ri/4&&qe.hb<3*pi/4,qe.Kb=0),1}function La(Fe){if(Fe==null)return 2;if(11>Fe.S){var qe=Fe.f.RGBA;qe.fb+=(Fe.height-1)*qe.A,qe.A=-qe.A}else qe=Fe.f.kb,Fe=Fe.height,qe.O+=(Fe-1)*qe.fa,qe.fa=-qe.fa,qe.N+=(Fe-1>>1)*qe.Ab,qe.Ab=-qe.Ab,qe.W+=(Fe-1>>1)*qe.Db,qe.Db=-qe.Db,qe.F!=null&&(qe.J+=(Fe-1)*qe.lb,qe.lb=-qe.lb);return 0}function Qs(Fe,qe,$e,ri){if(ri==null||0>=Fe||0>=qe)return 2;if($e!=null){if($e.Da){var pi=$e.cd,wi=$e.bd,Ai=-2&$e.v,Ei=-2&$e.j;if(0>Ai||0>Ei||0>=pi||0>=wi||Ai+pi>Fe||Ei+wi>qe)return 2;Fe=pi,qe=wi}if($e.da){if(!ui(Fe,qe,pi=[$e.ib],wi=[$e.hb]))return 2;Fe=pi[0],qe=wi[0]}}ri.width=Fe,ri.height=qe;t:{var Li=ri.width,Di=ri.height;if(Fe=ri.S,0>=Li||0>=Di||!(Fe>=po&&13>Fe))Fe=2;else{if(0>=ri.Rd&&ri.sd==null){Ai=wi=pi=qe=0;var Hi=(Ei=Li*uh[Fe])*Di;if(11>Fe||(wi=(Di+1)/2*(qe=(Li+1)/2),Fe==12&&(Ai=(pi=Li)*Di)),(Di=Ue(Hi+2*wi+Ai))==null){Fe=1;break t}ri.sd=Di,11>Fe?((Li=ri.f.RGBA).eb=Di,Li.fb=0,Li.A=Ei,Li.size=Hi):((Li=ri.f.kb).y=Di,Li.O=0,Li.fa=Ei,Li.Fd=Hi,Li.f=Di,Li.N=0+Hi,Li.Ab=qe,Li.Cd=wi,Li.ea=Di,Li.W=0+Hi+wi,Li.Db=qe,Li.Ed=wi,Fe==12&&(Li.F=Di,Li.J=0+Hi+2*wi),Li.Tc=Ai,Li.lb=pi)}if(qe=1,pi=ri.S,wi=ri.width,Ai=ri.height,pi>=po&&13>pi)if(11>pi)Fe=ri.f.RGBA,qe&=(Ei=Math.abs(Fe.A))*(Ai-1)+wi<=Fe.size,qe&=Ei>=wi*uh[pi],qe&=Fe.eb!=null;else{Fe=ri.f.kb,Ei=(wi+1)/2,Hi=(Ai+1)/2,Li=Math.abs(Fe.fa),Di=Math.abs(Fe.Ab);var Qi=Math.abs(Fe.Db),Zi=Math.abs(Fe.lb),Yi=Zi*(Ai-1)+wi;qe&=Li*(Ai-1)+wi<=Fe.Fd,qe&=Di*(Hi-1)+Ei<=Fe.Cd,qe=(qe&=Qi*(Hi-1)+Ei<=Fe.Ed)&Li>=wi&Di>=Ei&Qi>=Ei,qe&=Fe.y!=null,qe&=Fe.f!=null,qe&=Fe.ea!=null,pi==12&&(qe&=Zi>=wi,qe&=Yi<=Fe.Tc,qe&=Fe.F!=null)}else qe=0;Fe=qe?0:2}}return Fe!=0||$e!=null&&$e.fd&&(Fe=La(ri)),Fe}var Pr=64,Zs=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],ta=24,ea=32,Oa=8,Er=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];Ri("Predictor0","PredictorAdd0"),Je.Predictor0=function(){return 4278190080},Je.Predictor1=function(Fe){return Fe},Je.Predictor2=function(Fe,qe,$e){return qe[$e+0]},Je.Predictor3=function(Fe,qe,$e){return qe[$e+1]},Je.Predictor4=function(Fe,qe,$e){return qe[$e-1]},Je.Predictor5=function(Fe,qe,$e){return ki(ki(Fe,qe[$e+1]),qe[$e+0])},Je.Predictor6=function(Fe,qe,$e){return ki(Fe,qe[$e-1])},Je.Predictor7=function(Fe,qe,$e){return ki(Fe,qe[$e+0])},Je.Predictor8=function(Fe,qe,$e){return ki(qe[$e-1],qe[$e+0])},Je.Predictor9=function(Fe,qe,$e){return ki(qe[$e+0],qe[$e+1])},Je.Predictor10=function(Fe,qe,$e){return ki(ki(Fe,qe[$e-1]),ki(qe[$e+0],qe[$e+1]))},Je.Predictor11=function(Fe,qe,$e){var ri=qe[$e+0];return 0>=$i(ri>>24&255,Fe>>24&255,(qe=qe[$e-1])>>24&255)+$i(ri>>16&255,Fe>>16&255,qe>>16&255)+$i(ri>>8&255,Fe>>8&255,qe>>8&255)+$i(255&ri,255&Fe,255&qe)?ri:Fe},Je.Predictor12=function(Fe,qe,$e){var ri=qe[$e+0];return(Vi((Fe>>24&255)+(ri>>24&255)-((qe=qe[$e-1])>>24&255))<<24|Vi((Fe>>16&255)+(ri>>16&255)-(qe>>16&255))<<16|Vi((Fe>>8&255)+(ri>>8&255)-(qe>>8&255))<<8|Vi((255&Fe)+(255&ri)-(255&qe)))>>>0},Je.Predictor13=function(Fe,qe,$e){var ri=qe[$e-1];return(Ii((Fe=ki(Fe,qe[$e+0]))>>24&255,ri>>24&255)<<24|Ii(Fe>>16&255,ri>>16&255)<<16|Ii(Fe>>8&255,ri>>8&255)<<8|Ii(Fe>>0&255,ri>>0&255))>>>0};var al=Je.PredictorAdd0;Je.PredictorAdd1=tn,Ri("Predictor2","PredictorAdd2"),Ri("Predictor3","PredictorAdd3"),Ri("Predictor4","PredictorAdd4"),Ri("Predictor5","PredictorAdd5"),Ri("Predictor6","PredictorAdd6"),Ri("Predictor7","PredictorAdd7"),Ri("Predictor8","PredictorAdd8"),Ri("Predictor9","PredictorAdd9"),Ri("Predictor10","PredictorAdd10"),Ri("Predictor11","PredictorAdd11"),Ri("Predictor12","PredictorAdd12"),Ri("Predictor13","PredictorAdd13");var Fa=Je.PredictorAdd2;pn("ColorIndexInverseTransform","MapARGB","32b",function(Fe){return Fe>>8&255},function(Fe){return Fe}),pn("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(Fe){return Fe},function(Fe){return Fe>>8&255});var co,Xr=Je.ColorIndexInverseTransform,Ma=Je.MapARGB,ol=Je.VP8LColorIndexInverseTransformAlpha,ll=Je.MapAlpha,vs=Je.VP8LPredictorsAdd=[];vs.length=16,(Je.VP8LPredictors=[]).length=16,(Je.VP8LPredictorsAdd_C=[]).length=16,(Je.VP8LPredictors_C=[]).length=16;var Ir,Vr,bs,ts,as,ia,Gr,na,Na,ys,Yr,os,Ns,ra,Ds,_s,Da,Rr,ls,ir,nr,cr,mr,hs,ws,sa,uo,Gl,Yl=Ue(511),Kl=Ue(2041),$l=Ue(225),Jl=Ue(767),Ql=0,hl=Kl,fo=$l,Fr=Jl,jr=Yl,po=0,go=1,Zl=2,mo=3,vo=4,cl=5,th=6,ul=7,dl=8,bo=9,pl=10,$h=[2,3,7],Jh=[3,3,11],eh=[280,256,256,256,40],Qh=[0,1,1,1,0],Zh=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],tc=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],ec=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],ic=8,gl=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],ml=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],Ia=null,nc=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],rc=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],ih=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],sc=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],ac=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],oc=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],hc=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],Ss=[],Kr=[],cs=[],cc=1,nh=2,As=[],Br=[];sn("UpsampleRgbLinePair",Xn,3),sn("UpsampleBgrLinePair",ar,3),sn("UpsampleRgbaLinePair",Hr,4),sn("UpsampleBgraLinePair",vr,4),sn("UpsampleArgbLinePair",Ar,4),sn("UpsampleRgba4444LinePair",dr,2),sn("UpsampleRgb565LinePair",or,2);var uc=Je.UpsampleRgbLinePair,fc=Je.UpsampleBgrLinePair,rh=Je.UpsampleRgbaLinePair,sh=Je.UpsampleBgraLinePair,ah=Je.UpsampleArgbLinePair,oh=Je.UpsampleRgba4444LinePair,dc=Je.UpsampleRgb565LinePair,yo=16,_o=1<<yo-1,Ra=-227,vl=482,lh=6,pc=(256<<lh)-1,hh=0,gc=Ue(256),mc=Ue(256),vc=Ue(256),bc=Ue(256),yc=Ue(vl-Ra),_c=Ue(vl-Ra);ss("YuvToRgbRow",Xn,3),ss("YuvToBgrRow",ar,3),ss("YuvToRgbaRow",Hr,4),ss("YuvToBgraRow",vr,4),ss("YuvToArgbRow",Ar,4),ss("YuvToRgba4444Row",dr,2),ss("YuvToRgb565Row",or,2);var ch=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],wo=[0,2,8],wc=[8,7,6,4,4,2,2,2,1,1,1,1],Sc=1;this.WebPDecodeRGBA=function(Fe,qe,$e,ri,pi){var wi=go,Ai=new Ks,Ei=new bn;Ai.ba=Ei,Ei.S=wi,Ei.width=[Ei.width],Ei.height=[Ei.height];var Li=Ei.width,Di=Ei.height,Hi=new En;if(Hi==null||Fe==null)var Qi=2;else r(Hi!=null),Qi=Js(Fe,qe,$e,Hi.width,Hi.height,Hi.Pd,Hi.Qd,Hi.format,null);if(Qi!=0?Li=0:(Li!=null&&(Li[0]=Hi.width[0]),Di!=null&&(Di[0]=Hi.height[0]),Li=1),Li){Ei.width=Ei.width[0],Ei.height=Ei.height[0],ri!=null&&(ri[0]=Ei.width),pi!=null&&(pi[0]=Ei.height);t:{if(ri=new zs,(pi=new Aa).data=Fe,pi.w=qe,pi.ha=$e,pi.kd=1,qe=[0],r(pi!=null),((Fe=Js(pi.data,pi.w,pi.ha,null,null,null,qe,null,pi))==0||Fe==7)&&qe[0]&&(Fe=4),(qe=Fe)==0){if(r(Ai!=null),ri.data=pi.data,ri.w=pi.w+pi.offset,ri.ha=pi.ha-pi.offset,ri.put=zn,ri.ac=Mn,ri.bc=Fn,ri.ma=Ai,pi.xa){if((Fe=Dr())==null){Ai=1;break t}if(function(Zi,Yi){var un=[0],nn=[0],Xi=[0];e:for(;;){if(Zi==null)return 0;if(Yi==null)return Zi.a=2,0;if(Zi.l=Yi,Zi.a=0,xi(Zi.m,Yi.data,Yi.w,Yi.ha),!Cn(Zi.m,un,nn,Xi)){Zi.a=3;break e}if(Zi.xb=nh,Yi.width=un[0],Yi.height=nn[0],!Qr(un[0],nn[0],1,Zi,null))break e;return 1}return r(Zi.a!=0),0}(Fe,ri)){if(ri=(qe=Qs(ri.width,ri.height,Ai.Oa,Ai.ba))==0){e:{ri=Fe;i:for(;;){if(ri==null){ri=0;break e}if(r(ri.s.yc!=null),r(ri.s.Ya!=null),r(0<ri.s.Wb),r(($e=ri.l)!=null),r((pi=$e.ma)!=null),ri.xb!=0){if(ri.ca=pi.ba,ri.tb=pi.tb,r(ri.ca!=null),!ka(pi.Oa,$e,mo)){ri.a=2;break i}if(!ks(ri,$e.width)||$e.da)break i;if(($e.da||Ni(ri.ca.S))&&Ki(),11>ri.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),ri.ca.f.kb.F!=null&&Ki()),ri.Pb&&0<ri.s.ua&&ri.s.vb.X==null&&!Ze(ri.s.vb,ri.s.Wa.Xa)){ri.a=1;break i}ri.xb=0}if(!Cr(ri,ri.V,ri.Ba,ri.c,ri.i,$e.o,rr))break i;pi.Dc=ri.Ma,ri=1;break e}r(ri.a!=0),ri=0}ri=!ri}ri&&(qe=Fe.a)}else qe=Fe.a}else{if((Fe=new qo)==null){Ai=1;break t}if(Fe.Fa=pi.na,Fe.P=pi.P,Fe.qc=pi.Sa,Ya(Fe,ri)){if((qe=Qs(ri.width,ri.height,Ai.Oa,Ai.ba))==0){if(Fe.Aa=0,$e=Ai.Oa,r((pi=Fe)!=null),$e!=null){if(0<(Li=0>(Li=$e.Md)?0:100<Li?255:255*Li/100)){for(Di=Hi=0;4>Di;++Di)12>(Qi=pi.pb[Di]).lc&&(Qi.ia=Li*wc[0>Qi.lc?0:Qi.lc]>>3),Hi|=Qi.ia;Hi&&(alert("todo:VP8InitRandom"),pi.ia=1)}pi.Ga=$e.Id,100<pi.Ga?pi.Ga=100:0>pi.Ga&&(pi.Ga=0)}zo(Fe,ri)||(qe=Fe.a)}}else qe=Fe.a}qe==0&&Ai.Oa!=null&&Ai.Oa.fd&&(qe=La(Ai.ba))}Ai=qe}wi=Ai!=0?null:11>wi?Ei.f.RGBA.eb:Ei.f.kb.y}else wi=null;return wi};var uh=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function xe(Je,hi){for(var oi="",ti=0;ti<4;ti++)oi+=String.fromCharCode(Je[hi++]);return oi}function Te(Je,hi){return(Je[hi+0]<<0|Je[hi+1]<<8|Je[hi+2]<<16)>>>0}function _e(Je,hi){return(Je[hi+0]<<0|Je[hi+1]<<8|Je[hi+2]<<16|Je[hi+3]<<24)>>>0}new e;var Se=[0],t=[0],Ae=[],Pe=new e,St=Ie,Ce=function(Je,hi){var oi={},ti=0,ai=!1,yi=0,di=0;if(oi.frames=[],!function(Ge,ze,Ve,ei){for(var si=0;si<ei;si++)if(Ge[ze+si]!=Ve.charCodeAt(si))return!0;return!1}(Je,hi,"RIFF",4)){var bi,vi;for(_e(Je,hi+=4),hi+=8;hi<Je.length;){var Pi=xe(Je,hi),xi=_e(Je,hi+=4);hi+=4;var ni=xi+(1&xi);switch(Pi){case"VP8 ":case"VP8L":oi.frames[ti]===void 0&&(oi.frames[ti]={}),(Xe=oi.frames[ti]).src_off=ai?di:hi-8,Xe.src_size=yi+xi+8,ti++,ai&&(ai=!1,yi=0,di=0);break;case"VP8X":(Xe=oi.header={}).feature_flags=Je[hi];var fi=hi+4;Xe.canvas_width=1+Te(Je,fi),fi+=3,Xe.canvas_height=1+Te(Je,fi),fi+=3;break;case"ALPH":ai=!0,yi=ni+8,di=hi-8;break;case"ANIM":(Xe=oi.header).bgcolor=_e(Je,hi),fi=hi+4,Xe.loop_count=(bi=Je)[(vi=fi)+0]<<0|bi[vi+1]<<8,fi+=2;break;case"ANMF":var Si,Xe;(Xe=oi.frames[ti]={}).offset_x=2*Te(Je,hi),hi+=3,Xe.offset_y=2*Te(Je,hi),hi+=3,Xe.width=1+Te(Je,hi),hi+=3,Xe.height=1+Te(Je,hi),hi+=3,Xe.duration=Te(Je,hi),hi+=3,Si=Je[hi++],Xe.dispose=1&Si,Xe.blend=Si>>1&1}Pi!="ANMF"&&(hi+=ni)}return oi}}(St,0);Ce.response=St,Ce.rgbaoutput=!0,Ce.dataurl=!1;var ke=Ce.header?Ce.header:null,De=Ce.frames?Ce.frames:null;if(ke){ke.loop_counter=ke.loop_count,Se=[ke.canvas_height],t=[ke.canvas_width];for(var Re=0;Re<De.length&&De[Re].blend!=0;Re++);}var je=De[0],We=Pe.WebPDecodeRGBA(St,je.src_off,je.src_size,t,Se);je.rgba=We,je.imgwidth=t[0],je.imgheight=Se[0];for(var Ke=0;Ke<t[0]*Se[0]*4;Ke++)Ae[Ke]=We[Ke];return this.width=t,this.height=Se,this.data=Ae,this}(function(Ie){var r=function(){return typeof zlibSync=="function"},Me=function(Se,t,Ae,Pe){var St=4,Ce=He;switch(Pe){case Ie.image_compression.FAST:St=1,Ce=Ue;break;case Ie.image_compression.MEDIUM:St=6,Ce=Ee;break;case Ie.image_compression.SLOW:St=9,Ce=e}Se=Oe(Se,t,Ae,Ce);var ke=zlibSync(Se,{level:St});return Ie.__addimage__.arrayBufferToBinaryString(ke)},Oe=function(Se,t,Ae,Pe){for(var St,Ce,ke,De=Se.length/t,Re=new Uint8Array(Se.length+De),je=Te(),We=0;We<De;We+=1){if(ke=We*t,St=Se.subarray(ke,ke+t),Pe)Re.set(Pe(St,Ae,Ce),ke+We);else{for(var Ke,Je=je.length,hi=[];Ke<Je;Ke+=1)hi[Ke]=je[Ke](St,Ae,Ce);var oi=_e(hi.concat());Re.set(hi[oi],ke+We)}Ce=St}return Re},Be=function(Se){var t=Array.apply([],Se);return t.unshift(0),t},Ue=function(Se,t){var Ae,Pe=[],St=Se.length;Pe[0]=1;for(var Ce=0;Ce<St;Ce+=1)Ae=Se[Ce-t]||0,Pe[Ce+1]=Se[Ce]-Ae+256&255;return Pe},He=function(Se,t,Ae){var Pe,St=[],Ce=Se.length;St[0]=2;for(var ke=0;ke<Ce;ke+=1)Pe=Ae&&Ae[ke]||0,St[ke+1]=Se[ke]-Pe+256&255;return St},Ee=function(Se,t,Ae){var Pe,St,Ce=[],ke=Se.length;Ce[0]=3;for(var De=0;De<ke;De+=1)Pe=Se[De-t]||0,St=Ae&&Ae[De]||0,Ce[De+1]=Se[De]+256-(Pe+St>>>1)&255;return Ce},e=function(Se,t,Ae){var Pe,St,Ce,ke,De=[],Re=Se.length;De[0]=4;for(var je=0;je<Re;je+=1)Pe=Se[je-t]||0,St=Ae&&Ae[je]||0,Ce=Ae&&Ae[je-t]||0,ke=xe(Pe,St,Ce),De[je+1]=Se[je]-ke+256&255;return De},xe=function(Se,t,Ae){if(Se===t&&t===Ae)return Se;var Pe=Math.abs(t-Ae),St=Math.abs(Se-Ae),Ce=Math.abs(Se+t-Ae-Ae);return Pe<=St&&Pe<=Ce?Se:St<=Ce?t:Ae},Te=function(){return[Be,Ue,He,Ee,e]},_e=function(Se){var t=Se.map(function(Ae){return Ae.reduce(function(Pe,St){return Pe+Math.abs(St)},0)});return t.indexOf(Math.min.apply(null,t))};Ie.processPNG=function(Se,t,Ae,Pe){var St,Ce,ke,De,Re,je,We,Ke,Je,hi,oi,ti,ai,yi,di,bi=this.decode.FLATE_DECODE,vi="";if(this.__addimage__.isArrayBuffer(Se)&&(Se=new Uint8Array(Se)),this.__addimage__.isArrayBufferView(Se)){if(Se=(ke=new Kt(Se)).imgData,Ce=ke.bits,St=ke.colorSpace,Re=ke.colors,[4,6].indexOf(ke.colorType)!==-1){if(ke.bits===8){Je=(Ke=ke.pixelBitlength==32?new Uint32Array(ke.decodePixels().buffer):ke.pixelBitlength==16?new Uint16Array(ke.decodePixels().buffer):new Uint8Array(ke.decodePixels().buffer)).length,oi=new Uint8Array(Je*ke.colors),hi=new Uint8Array(Je);var Pi,xi=ke.pixelBitlength-ke.bits;for(yi=0,di=0;yi<Je;yi++){for(ai=Ke[yi],Pi=0;Pi<xi;)oi[di++]=ai>>>Pi&255,Pi+=ke.bits;hi[yi]=ai>>>Pi&255}}if(ke.bits===16){Je=(Ke=new Uint32Array(ke.decodePixels().buffer)).length,oi=new Uint8Array(Je*(32/ke.pixelBitlength)*ke.colors),hi=new Uint8Array(Je*(32/ke.pixelBitlength)),ti=ke.colors>1,yi=0,di=0;for(var ni=0;yi<Je;)ai=Ke[yi++],oi[di++]=ai>>>0&255,ti&&(oi[di++]=ai>>>16&255,ai=Ke[yi++],oi[di++]=ai>>>0&255),hi[ni++]=ai>>>16&255;Ce=8}Pe!==Ie.image_compression.NONE&&r()?(Se=Me(oi,ke.width*ke.colors,ke.colors,Pe),We=Me(hi,ke.width,1,Pe)):(Se=oi,We=hi,bi=void 0)}if(ke.colorType===3&&(St=this.color_spaces.INDEXED,je=ke.palette,ke.transparency.indexed)){var fi=ke.transparency.indexed,Si=0;for(yi=0,Je=fi.length;yi<Je;++yi)Si+=fi[yi];if((Si/=255)===Je-1&&fi.indexOf(0)!==-1)De=[fi.indexOf(0)];else if(Si!==Je){for(Ke=ke.decodePixels(),hi=new Uint8Array(Ke.length),yi=0,Je=Ke.length;yi<Je;yi++)hi[yi]=fi[Ke[yi]];We=Me(hi,ke.width,1)}}var Xe=function(Ge){var ze;switch(Ge){case Ie.image_compression.FAST:ze=11;break;case Ie.image_compression.MEDIUM:ze=13;break;case Ie.image_compression.SLOW:ze=14;break;default:ze=12}return ze}(Pe);return bi===this.decode.FLATE_DECODE&&(vi="/Predictor "+Xe+" "),vi+="/Colors "+Re+" /BitsPerComponent "+Ce+" /Columns "+ke.width,(this.__addimage__.isArrayBuffer(Se)||this.__addimage__.isArrayBufferView(Se))&&(Se=this.__addimage__.arrayBufferToBinaryString(Se)),(We&&this.__addimage__.isArrayBuffer(We)||this.__addimage__.isArrayBufferView(We))&&(We=this.__addimage__.arrayBufferToBinaryString(We)),{alias:Ae,data:Se,index:t,filter:bi,decodeParameters:vi,transparency:De,palette:je,sMask:We,predictor:Xe,width:ke.width,height:ke.height,bitsPerComponent:Ce,colorSpace:St}}}})(E.API),function(Ie){Ie.processGIF89A=function(r,Me,Oe,Be){var Ue=new Zt(r),He=Ue.width,Ee=Ue.height,e=[];Ue.decodeAndBlitFrameRGBA(0,e);var xe={data:e,width:He,height:Ee},Te=new Qt(100).encode(xe,100);return Ie.processJPEG.call(this,Te,Me,Oe,Be)},Ie.processGIF87A=Ie.processGIF89A}(E.API),te.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var Ie=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(Ie);for(var r=0;r<Ie;r++){var Me=this.datav.getUint8(this.pos++,!0),Oe=this.datav.getUint8(this.pos++,!0),Be=this.datav.getUint8(this.pos++,!0),Ue=this.datav.getUint8(this.pos++,!0);this.palette[r]={red:Be,green:Oe,blue:Me,quad:Ue}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},te.prototype.parseBGR=function(){this.pos=this.offset;try{var Ie="bit"+this.bitPP,r=this.width*this.height*4;this.data=new Uint8Array(r),this[Ie]()}catch(Me){a.log("bit decode error:"+Me)}},te.prototype.bit1=function(){var Ie,r=Math.ceil(this.width/8),Me=r%4;for(Ie=this.height-1;Ie>=0;Ie--){for(var Oe=this.bottom_up?Ie:this.height-1-Ie,Be=0;Be<r;Be++)for(var Ue=this.datav.getUint8(this.pos++,!0),He=Oe*this.width*4+8*Be*4,Ee=0;Ee<8&&8*Be+Ee<this.width;Ee++){var e=this.palette[Ue>>7-Ee&1];this.data[He+4*Ee]=e.blue,this.data[He+4*Ee+1]=e.green,this.data[He+4*Ee+2]=e.red,this.data[He+4*Ee+3]=255}Me!==0&&(this.pos+=4-Me)}},te.prototype.bit4=function(){for(var Ie=Math.ceil(this.width/2),r=Ie%4,Me=this.height-1;Me>=0;Me--){for(var Oe=this.bottom_up?Me:this.height-1-Me,Be=0;Be<Ie;Be++){var Ue=this.datav.getUint8(this.pos++,!0),He=Oe*this.width*4+2*Be*4,Ee=Ue>>4,e=15&Ue,xe=this.palette[Ee];if(this.data[He]=xe.blue,this.data[He+1]=xe.green,this.data[He+2]=xe.red,this.data[He+3]=255,2*Be+1>=this.width)break;xe=this.palette[e],this.data[He+4]=xe.blue,this.data[He+4+1]=xe.green,this.data[He+4+2]=xe.red,this.data[He+4+3]=255}r!==0&&(this.pos+=4-r)}},te.prototype.bit8=function(){for(var Ie=this.width%4,r=this.height-1;r>=0;r--){for(var Me=this.bottom_up?r:this.height-1-r,Oe=0;Oe<this.width;Oe++){var Be=this.datav.getUint8(this.pos++,!0),Ue=Me*this.width*4+4*Oe;if(Be<this.palette.length){var He=this.palette[Be];this.data[Ue]=He.red,this.data[Ue+1]=He.green,this.data[Ue+2]=He.blue,this.data[Ue+3]=255}else this.data[Ue]=255,this.data[Ue+1]=255,this.data[Ue+2]=255,this.data[Ue+3]=255}Ie!==0&&(this.pos+=4-Ie)}},te.prototype.bit15=function(){for(var Ie=this.width%3,r=parseInt("11111",2),Me=this.height-1;Me>=0;Me--){for(var Oe=this.bottom_up?Me:this.height-1-Me,Be=0;Be<this.width;Be++){var Ue=this.datav.getUint16(this.pos,!0);this.pos+=2;var He=(Ue&r)/r*255|0,Ee=(Ue>>5&r)/r*255|0,e=(Ue>>10&r)/r*255|0,xe=Ue>>15?255:0,Te=Oe*this.width*4+4*Be;this.data[Te]=e,this.data[Te+1]=Ee,this.data[Te+2]=He,this.data[Te+3]=xe}this.pos+=Ie}},te.prototype.bit16=function(){for(var Ie=this.width%3,r=parseInt("11111",2),Me=parseInt("111111",2),Oe=this.height-1;Oe>=0;Oe--){for(var Be=this.bottom_up?Oe:this.height-1-Oe,Ue=0;Ue<this.width;Ue++){var He=this.datav.getUint16(this.pos,!0);this.pos+=2;var Ee=(He&r)/r*255|0,e=(He>>5&Me)/Me*255|0,xe=(He>>11)/r*255|0,Te=Be*this.width*4+4*Ue;this.data[Te]=xe,this.data[Te+1]=e,this.data[Te+2]=Ee,this.data[Te+3]=255}this.pos+=Ie}},te.prototype.bit24=function(){for(var Ie=this.height-1;Ie>=0;Ie--){for(var r=this.bottom_up?Ie:this.height-1-Ie,Me=0;Me<this.width;Me++){var Oe=this.datav.getUint8(this.pos++,!0),Be=this.datav.getUint8(this.pos++,!0),Ue=this.datav.getUint8(this.pos++,!0),He=r*this.width*4+4*Me;this.data[He]=Ue,this.data[He+1]=Be,this.data[He+2]=Oe,this.data[He+3]=255}this.pos+=this.width%4}},te.prototype.bit32=function(){for(var Ie=this.height-1;Ie>=0;Ie--)for(var r=this.bottom_up?Ie:this.height-1-Ie,Me=0;Me<this.width;Me++){var Oe=this.datav.getUint8(this.pos++,!0),Be=this.datav.getUint8(this.pos++,!0),Ue=this.datav.getUint8(this.pos++,!0),He=this.datav.getUint8(this.pos++,!0),Ee=r*this.width*4+4*Me;this.data[Ee]=Ue,this.data[Ee+1]=Be,this.data[Ee+2]=Oe,this.data[Ee+3]=He}},te.prototype.getData=function(){return this.data},function(Ie){Ie.processBMP=function(r,Me,Oe,Be){var Ue=new te(r,!1),He=Ue.width,Ee=Ue.height,e={data:Ue.getData(),width:He,height:Ee},xe=new Qt(100).encode(e,100);return Ie.processJPEG.call(this,xe,Me,Oe,Be)}}(E.API),ee.prototype.getData=function(){return this.data},function(Ie){Ie.processWEBP=function(r,Me,Oe,Be){var Ue=new ee(r),He=Ue.width,Ee=Ue.height,e={data:Ue.getData(),width:He,height:Ee},xe=new Qt(100).encode(e,100);return Ie.processJPEG.call(this,xe,Me,Oe,Be)}}(E.API),E.API.processRGBA=function(Ie,r,Me){for(var Oe=Ie.data,Be=Oe.length,Ue=new Uint8Array(Be/4*3),He=new Uint8Array(Be/4),Ee=0,e=0,xe=0;xe<Be;xe+=4){var Te=Oe[xe],_e=Oe[xe+1],Se=Oe[xe+2],t=Oe[xe+3];Ue[Ee++]=Te,Ue[Ee++]=_e,Ue[Ee++]=Se,He[e++]=t}var Ae=this.__addimage__.arrayBufferToBinaryString(Ue);return{alpha:this.__addimage__.arrayBufferToBinaryString(He),data:Ae,index:r,alias:Me,colorSpace:"DeviceRGB",bitsPerComponent:8,width:Ie.width,height:Ie.height}},E.API.setLanguage=function(Ie){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[Ie]!==void 0&&(this.internal.languageSettings.languageCode=Ie,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},Vt=E.API,Gt=Vt.getCharWidthsArray=function(Ie,r){var Me,Oe,Be=(r=r||{}).font||this.internal.getFont(),Ue=r.fontSize||this.internal.getFontSize(),He=r.charSpace||this.internal.getCharSpace(),Ee=r.widths?r.widths:Be.metadata.Unicode.widths,e=Ee.fof?Ee.fof:1,xe=r.kerning?r.kerning:Be.metadata.Unicode.kerning,Te=xe.fof?xe.fof:1,_e=r.doKerning!==!1,Se=0,t=Ie.length,Ae=0,Pe=Ee[0]||e,St=[];for(Me=0;Me<t;Me++)Oe=Ie.charCodeAt(Me),typeof Be.metadata.widthOfString=="function"?St.push((Be.metadata.widthOfGlyph(Be.metadata.characterToGlyph(Oe))+He*(1e3/Ue)||0)/1e3):(Se=_e&&_typeof(xe[Oe])==="object"&&!isNaN(parseInt(xe[Oe][Ae],10))?xe[Oe][Ae]/Te:0,St.push((Ee[Oe]||Pe)/e+Se)),Ae=Oe;return St},Yt=Vt.getStringUnitWidth=function(Ie,r){var Me=(r=r||{}).fontSize||this.internal.getFontSize(),Oe=r.font||this.internal.getFont(),Be=r.charSpace||this.internal.getCharSpace();return Vt.processArabic&&(Ie=Vt.processArabic(Ie)),typeof Oe.metadata.widthOfString=="function"?Oe.metadata.widthOfString(Ie,Me,Be)/Me:Gt.apply(this,arguments).reduce(function(Ue,He){return Ue+He},0)},Jt=function(Ie,r,Me,Oe){for(var Be=[],Ue=0,He=Ie.length,Ee=0;Ue!==He&&Ee+r[Ue]<Me;)Ee+=r[Ue],Ue++;Be.push(Ie.slice(0,Ue));var e=Ue;for(Ee=0;Ue!==He;)Ee+r[Ue]>Oe&&(Be.push(Ie.slice(e,Ue)),Ee=0,e=Ue),Ee+=r[Ue],Ue++;return e!==Ue&&Be.push(Ie.slice(e,Ue)),Be},Xt=function(Ie,r,Me){Me||(Me={});var Oe,Be,Ue,He,Ee,e,xe,Te=[],_e=[Te],Se=Me.textIndent||0,t=0,Ae=0,Pe=Ie.split(" "),St=Gt.apply(this,[" ",Me])[0];if(e=Me.lineIndent===-1?Pe[0].length+2:Me.lineIndent||0){var Ce=Array(e).join(" "),ke=[];Pe.map(function(Re){(Re=Re.split(/\s*\n/)).length>1?ke=ke.concat(Re.map(function(je,We){return(We&&je.length?`
`:"")+je})):ke.push(Re[0])}),Pe=ke,e=Yt.apply(this,[Ce,Me])}for(Ue=0,He=Pe.length;Ue<He;Ue++){var De=0;if(Oe=Pe[Ue],e&&Oe[0]==`
`&&(Oe=Oe.substr(1),De=1),Se+t+(Ae=(Be=Gt.apply(this,[Oe,Me])).reduce(function(Re,je){return Re+je},0))>r||De){if(Ae>r){for(Ee=Jt.apply(this,[Oe,Be,r-(Se+t),r]),Te.push(Ee.shift()),Te=[Ee.pop()];Ee.length;)_e.push([Ee.shift()]);Ae=Be.slice(Oe.length-(Te[0]?Te[0].length:0)).reduce(function(Re,je){return Re+je},0)}else Te=[Oe];_e.push(Te),Se=Ae+e,t=St}else Te.push(Oe),Se+=t+Ae,t=St}return xe=e?function(Re,je){return(je?Ce:"")+Re.join(" ")}:function(Re){return Re.join(" ")},_e.map(xe)},Vt.splitTextToSize=function(Ie,r,Me){var Oe,Be=(Me=Me||{}).fontSize||this.internal.getFontSize(),Ue=function(Te){if(Te.widths&&Te.kerning)return{widths:Te.widths,kerning:Te.kerning};var _e=this.internal.getFont(Te.fontName,Te.fontStyle);return _e.metadata.Unicode?{widths:_e.metadata.Unicode.widths||{0:1},kerning:_e.metadata.Unicode.kerning||{}}:{font:_e.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}.call(this,Me);Oe=Array.isArray(Ie)?Ie:String(Ie).split(/\r?\n/);var He=1*this.internal.scaleFactor*r/Be;Ue.textIndent=Me.textIndent?1*Me.textIndent*this.internal.scaleFactor/Be:0,Ue.lineIndent=Me.lineIndent;var Ee,e,xe=[];for(Ee=0,e=Oe.length;Ee<e;Ee++)xe=xe.concat(Xt.apply(this,[Oe[Ee],He,Ue]));return xe},function(Ie){Ie.__fontmetrics__=Ie.__fontmetrics__||{};for(var r="klmnopqrstuvwxyz",Me={},Oe={},Be=0;Be<r.length;Be++)Me[r[Be]]="0123456789abcdef"[Be],Oe["0123456789abcdef"[Be]]=r[Be];var Ue=function(_e){return"0x"+parseInt(_e,10).toString(16)},He=Ie.__fontmetrics__.compress=function(_e){var Se,t,Ae,Pe,St=["{"];for(var Ce in _e){if(Se=_e[Ce],isNaN(parseInt(Ce,10))?t="'"+Ce+"'":(Ce=parseInt(Ce,10),t=(t=Ue(Ce).slice(2)).slice(0,-1)+Oe[t.slice(-1)]),typeof Se=="number")Se<0?(Ae=Ue(Se).slice(3),Pe="-"):(Ae=Ue(Se).slice(2),Pe=""),Ae=Pe+Ae.slice(0,-1)+Oe[Ae.slice(-1)];else{if(_typeof(Se)!=="object")throw new Error("Don't know what to do with value type "+_typeof(Se)+".");Ae=He(Se)}St.push(t+Ae)}return St.push("}"),St.join("")},Ee=Ie.__fontmetrics__.uncompress=function(_e){if(typeof _e!="string")throw new Error("Invalid argument passed to uncompress.");for(var Se,t,Ae,Pe,St={},Ce=1,ke=St,De=[],Re="",je="",We=_e.length-1,Ke=1;Ke<We;Ke+=1)(Pe=_e[Ke])=="'"?Se?(Ae=Se.join(""),Se=void 0):Se=[]:Se?Se.push(Pe):Pe=="{"?(De.push([ke,Ae]),ke={},Ae=void 0):Pe=="}"?((t=De.pop())[0][t[1]]=ke,Ae=void 0,ke=t[0]):Pe=="-"?Ce=-1:Ae===void 0?Me.hasOwnProperty(Pe)?(Re+=Me[Pe],Ae=parseInt(Re,16)*Ce,Ce=1,Re=""):Re+=Pe:Me.hasOwnProperty(Pe)?(je+=Me[Pe],ke[Ae]=parseInt(je,16)*Ce,Ce=1,Ae=void 0,je=""):je+=Pe;return St},e={codePages:["WinAnsiEncoding"],WinAnsiEncoding:Ee("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},xe={Unicode:{Courier:e,"Courier-Bold":e,"Courier-BoldOblique":e,"Courier-Oblique":e,Helvetica:e,"Helvetica-Bold":e,"Helvetica-BoldOblique":e,"Helvetica-Oblique":e,"Times-Roman":e,"Times-Bold":e,"Times-BoldItalic":e,"Times-Italic":e}},Te={Unicode:{"Courier-Oblique":Ee("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":Ee("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":Ee("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:Ee("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":Ee("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":Ee("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:Ee("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:Ee("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":Ee("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:Ee("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":Ee("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":Ee("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":Ee("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":Ee("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};Ie.events.push(["addFont",function(_e){var Se=_e.font,t=Te.Unicode[Se.postScriptName];t&&(Se.metadata.Unicode={},Se.metadata.Unicode.widths=t.widths,Se.metadata.Unicode.kerning=t.kerning);var Ae=xe.Unicode[Se.postScriptName];Ae&&(Se.metadata.Unicode.encoding=Ae,Se.encoding=Ae.codePages[0])}])}(E.API),function(Ie){var r=function(Me){for(var Oe=Me.length,Be=new Uint8Array(Oe),Ue=0;Ue<Oe;Ue++)Be[Ue]=Me.charCodeAt(Ue);return Be};Ie.API.events.push(["addFont",function(Me){var Oe=void 0,Be=Me.font,Ue=Me.instance;if(!Be.isStandardFont){if(Ue===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+Be.postScriptName+"').");if(typeof(Oe=Ue.existsFileInVFS(Be.postScriptName)===!1?Ue.loadFile(Be.postScriptName):Ue.getFileFromVFS(Be.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+Be.postScriptName+"').");(function(He,Ee){Ee=/^\x00\x01\x00\x00/.test(Ee)?r(Ee):r(u(Ee)),He.metadata=Ie.API.TTFFont.open(Ee),He.metadata.Unicode=He.metadata.Unicode||{encoding:{},kerning:{},widths:[]},He.metadata.glyIdsUsed=[0]})(Be,Oe)}}])}(E),function(Ie){function r(){return(n.canvg?Promise.resolve(n.canvg):__vitePreload(()=>import("./index.es.966fdabb.js"),["assets/index.es.966fdabb.js","assets/index.bef12da5.js","assets/index.a89a4d5c.css"])).catch(function(Me){return Promise.reject(new Error("Could not load canvg: "+Me))}).then(function(Me){return Me.default?Me.default:Me})}E.API.addSvgAsImage=function(Me,Oe,Be,Ue,He,Ee,e,xe){if(isNaN(Oe)||isNaN(Be))throw a.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(Ue)||isNaN(He))throw a.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var Te=document.createElement("canvas");Te.width=Ue,Te.height=He;var _e=Te.getContext("2d");_e.fillStyle="#fff",_e.fillRect(0,0,Te.width,Te.height);var Se={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},t=this;return r().then(function(Ae){return Ae.fromString(_e,Me,Se)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(Ae){return Ae.render(Se)}).then(function(){t.addImage(Te.toDataURL("image/jpeg",1),Oe,Be,Ue,He,e,xe)})}}(),E.API.putTotalPages=function(Ie){var r,Me=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(r=new RegExp(Ie,"g"),Me=this.internal.getNumberOfPages()):(r=new RegExp(this.pdfEscape16(Ie,this.internal.getFont()),"g"),Me=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var Oe=1;Oe<=this.internal.getNumberOfPages();Oe++)for(var Be=0;Be<this.internal.pages[Oe].length;Be++)this.internal.pages[Oe][Be]=this.internal.pages[Oe][Be].replace(r,Me);return this},E.API.viewerPreferences=function(Ie,r){var Me;Ie=Ie||{},r=r||!1;var Oe,Be,Ue,He={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},Ee=Object.keys(He),e=[],xe=0,Te=0,_e=0;function Se(Ae,Pe){var St,Ce=!1;for(St=0;St<Ae.length;St+=1)Ae[St]===Pe&&(Ce=!0);return Ce}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(He)),this.internal.viewerpreferences.isSubscribed=!1),Me=this.internal.viewerpreferences.configuration,Ie==="reset"||r===!0){var t=Ee.length;for(_e=0;_e<t;_e+=1)Me[Ee[_e]].value=Me[Ee[_e]].defaultValue,Me[Ee[_e]].explicitSet=!1}if(_typeof(Ie)==="object"){for(Be in Ie)if(Ue=Ie[Be],Se(Ee,Be)&&Ue!==void 0){if(Me[Be].type==="boolean"&&typeof Ue=="boolean")Me[Be].value=Ue;else if(Me[Be].type==="name"&&Se(Me[Be].valueSet,Ue))Me[Be].value=Ue;else if(Me[Be].type==="integer"&&Number.isInteger(Ue))Me[Be].value=Ue;else if(Me[Be].type==="array"){for(xe=0;xe<Ue.length;xe+=1)if(Oe=!0,Ue[xe].length===1&&typeof Ue[xe][0]=="number")e.push(String(Ue[xe]-1));else if(Ue[xe].length>1){for(Te=0;Te<Ue[xe].length;Te+=1)typeof Ue[xe][Te]!="number"&&(Oe=!1);Oe===!0&&e.push([Ue[xe][0]-1,Ue[xe][1]-1].join(" "))}Me[Be].value="["+e.join(" ")+"]"}else Me[Be].value=Me[Be].defaultValue;Me[Be].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var Ae,Pe=[];for(Ae in Me)Me[Ae].explicitSet===!0&&(Me[Ae].type==="name"?Pe.push("/"+Ae+" /"+Me[Ae].value):Pe.push("/"+Ae+" "+Me[Ae].value));Pe.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+Pe.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=Me,this},function(Ie){var r=function(){var Oe='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',Be=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),Ue=unescape(encodeURIComponent(Oe)),He=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),Ee=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),e=unescape(encodeURIComponent("</x:xmpmeta>")),xe=Ue.length+He.length+Ee.length+Be.length+e.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+xe+" >>"),this.internal.write("stream"),this.internal.write(Be+Ue+He+Ee+e),this.internal.write("endstream"),this.internal.write("endobj")},Me=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};Ie.addMetadata=function(Oe,Be){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:Oe,namespaceuri:Be||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",Me),this.internal.events.subscribe("postPutResources",r)),this}}(E.API),function(Ie){var r=Ie.API,Me=r.pdfEscape16=function(Ue,He){for(var Ee,e=He.metadata.Unicode.widths,xe=["","0","00","000","0000"],Te=[""],_e=0,Se=Ue.length;_e<Se;++_e){if(Ee=He.metadata.characterToGlyph(Ue.charCodeAt(_e)),He.metadata.glyIdsUsed.push(Ee),He.metadata.toUnicode[Ee]=Ue.charCodeAt(_e),e.indexOf(Ee)==-1&&(e.push(Ee),e.push([parseInt(He.metadata.widthOfGlyph(Ee),10)])),Ee=="0")return Te.join("");Ee=Ee.toString(16),Te.push(xe[4-Ee.length],Ee)}return Te.join("")},Oe=function(Ue){var He,Ee,e,xe,Te,_e,Se;for(Te=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,e=[],_e=0,Se=(Ee=Object.keys(Ue).sort(function(t,Ae){return t-Ae})).length;_e<Se;_e++)He=Ee[_e],e.length>=100&&(Te+=`
`+e.length+` beginbfchar
`+e.join(`
`)+`
endbfchar`,e=[]),Ue[He]!==void 0&&Ue[He]!==null&&typeof Ue[He].toString=="function"&&(xe=("0000"+Ue[He].toString(16)).slice(-4),He=("0000"+(+He).toString(16)).slice(-4),e.push("<"+He+"><"+xe+">"));return e.length&&(Te+=`
`+e.length+` beginbfchar
`+e.join(`
`)+`
endbfchar
`),Te+=`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};r.events.push(["putFont",function(Ue){(function(He){var Ee=He.font,e=He.out,xe=He.newObject,Te=He.putStream;if(Ee.metadata instanceof Ie.API.TTFFont&&Ee.encoding==="Identity-H"){for(var _e=Ee.metadata.Unicode.widths,Se=Ee.metadata.subset.encode(Ee.metadata.glyIdsUsed,1),t="",Ae=0;Ae<Se.length;Ae++)t+=String.fromCharCode(Se[Ae]);var Pe=xe();Te({data:t,addLength1:!0,objectId:Pe}),e("endobj");var St=xe();Te({data:Oe(Ee.metadata.toUnicode),addLength1:!0,objectId:St}),e("endobj");var Ce=xe();e("<<"),e("/Type /FontDescriptor"),e("/FontName /"+F(Ee.fontName)),e("/FontFile2 "+Pe+" 0 R"),e("/FontBBox "+Ie.API.PDFObject.convert(Ee.metadata.bbox)),e("/Flags "+Ee.metadata.flags),e("/StemV "+Ee.metadata.stemV),e("/ItalicAngle "+Ee.metadata.italicAngle),e("/Ascent "+Ee.metadata.ascender),e("/Descent "+Ee.metadata.decender),e("/CapHeight "+Ee.metadata.capHeight),e(">>"),e("endobj");var ke=xe();e("<<"),e("/Type /Font"),e("/BaseFont /"+F(Ee.fontName)),e("/FontDescriptor "+Ce+" 0 R"),e("/W "+Ie.API.PDFObject.convert(_e)),e("/CIDToGIDMap /Identity"),e("/DW 1000"),e("/Subtype /CIDFontType2"),e("/CIDSystemInfo"),e("<<"),e("/Supplement 0"),e("/Registry (Adobe)"),e("/Ordering ("+Ee.encoding+")"),e(">>"),e(">>"),e("endobj"),Ee.objectNumber=xe(),e("<<"),e("/Type /Font"),e("/Subtype /Type0"),e("/ToUnicode "+St+" 0 R"),e("/BaseFont /"+F(Ee.fontName)),e("/Encoding /"+Ee.encoding),e("/DescendantFonts ["+ke+" 0 R]"),e(">>"),e("endobj"),Ee.isAlreadyPutted=!0}})(Ue)}]),r.events.push(["putFont",function(Ue){(function(He){var Ee=He.font,e=He.out,xe=He.newObject,Te=He.putStream;if(Ee.metadata instanceof Ie.API.TTFFont&&Ee.encoding==="WinAnsiEncoding"){for(var _e=Ee.metadata.rawData,Se="",t=0;t<_e.length;t++)Se+=String.fromCharCode(_e[t]);var Ae=xe();Te({data:Se,addLength1:!0,objectId:Ae}),e("endobj");var Pe=xe();Te({data:Oe(Ee.metadata.toUnicode),addLength1:!0,objectId:Pe}),e("endobj");var St=xe();e("<<"),e("/Descent "+Ee.metadata.decender),e("/CapHeight "+Ee.metadata.capHeight),e("/StemV "+Ee.metadata.stemV),e("/Type /FontDescriptor"),e("/FontFile2 "+Ae+" 0 R"),e("/Flags 96"),e("/FontBBox "+Ie.API.PDFObject.convert(Ee.metadata.bbox)),e("/FontName /"+F(Ee.fontName)),e("/ItalicAngle "+Ee.metadata.italicAngle),e("/Ascent "+Ee.metadata.ascender),e(">>"),e("endobj"),Ee.objectNumber=xe();for(var Ce=0;Ce<Ee.metadata.hmtx.widths.length;Ce++)Ee.metadata.hmtx.widths[Ce]=parseInt(Ee.metadata.hmtx.widths[Ce]*(1e3/Ee.metadata.head.unitsPerEm));e("<</Subtype/TrueType/Type/Font/ToUnicode "+Pe+" 0 R/BaseFont/"+F(Ee.fontName)+"/FontDescriptor "+St+" 0 R/Encoding/"+Ee.encoding+" /FirstChar 29 /LastChar 255 /Widths "+Ie.API.PDFObject.convert(Ee.metadata.hmtx.widths)+">>"),e("endobj"),Ee.isAlreadyPutted=!0}})(Ue)}]);var Be=function(Ue){var He,Ee=Ue.text||"",e=Ue.x,xe=Ue.y,Te=Ue.options||{},_e=Ue.mutex||{},Se=_e.pdfEscape,t=_e.activeFontKey,Ae=_e.fonts,Pe=t,St="",Ce=0,ke="",De=Ae[Pe].encoding;if(Ae[Pe].encoding!=="Identity-H")return{text:Ee,x:e,y:xe,options:Te,mutex:_e};for(ke=Ee,Pe=t,Array.isArray(Ee)&&(ke=Ee[0]),Ce=0;Ce<ke.length;Ce+=1)Ae[Pe].metadata.hasOwnProperty("cmap")&&(He=Ae[Pe].metadata.cmap.unicode.codeMap[ke[Ce].charCodeAt(0)]),He||ke[Ce].charCodeAt(0)<256&&Ae[Pe].metadata.hasOwnProperty("Unicode")?St+=ke[Ce]:St+="";var Re="";return parseInt(Pe.slice(1))<14||De==="WinAnsiEncoding"?Re=Se(St,Pe).split("").map(function(je){return je.charCodeAt(0).toString(16)}).join(""):De==="Identity-H"&&(Re=Me(St,Ae[Pe])),_e.isHex=!0,{text:Re,x:e,y:xe,options:Te,mutex:_e}};r.events.push(["postProcessText",function(Ue){var He=Ue.text||"",Ee=[],e={text:He,x:Ue.x,y:Ue.y,options:Ue.options,mutex:Ue.mutex};if(Array.isArray(He)){var xe=0;for(xe=0;xe<He.length;xe+=1)Array.isArray(He[xe])&&He[xe].length===3?Ee.push([Be(Object.assign({},e,{text:He[xe][0]})).text,He[xe][1],He[xe][2]]):Ee.push(Be(Object.assign({},e,{text:He[xe]})).text);Ue.text=Ee}else Ue.text=Be(Object.assign({},e,{text:He})).text}])}(E),function(Ie){var r=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};Ie.existsFileInVFS=function(Me){return r.call(this),this.internal.vFS[Me]!==void 0},Ie.addFileToVFS=function(Me,Oe){return r.call(this),this.internal.vFS[Me]=Oe,this},Ie.getFileFromVFS=function(Me){return r.call(this),this.internal.vFS[Me]!==void 0?this.internal.vFS[Me]:null}}(E.API),function(Ie){Ie.__bidiEngine__=Ie.prototype.__bidiEngine__=function(Oe){var Be,Ue,He,Ee,e,xe,Te,_e=r,Se=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],t=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],Ae={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},Pe={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},St=["(",")","(","<",">","<","[","]","[","{","}","{","\xAB","\xBB","\xAB","\u2039","\u203A","\u2039","\u2045","\u2046","\u2045","\u207D","\u207E","\u207D","\u208D","\u208E","\u208D","\u2264","\u2265","\u2264","\u2329","\u232A","\u2329","\uFE59","\uFE5A","\uFE59","\uFE5B","\uFE5C","\uFE5B","\uFE5D","\uFE5E","\uFE5D","\uFE64","\uFE65","\uFE64"],Ce=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),ke=!1,De=0;this.__bidiEngine__={};var Re=function(ti){var ai=ti.charCodeAt(),yi=ai>>8,di=Pe[yi];return di!==void 0?_e[256*di+(255&ai)]:yi===252||yi===253?"AL":Ce.test(yi)?"L":yi===8?"R":"N"},je=function(ti){for(var ai,yi=0;yi<ti.length;yi++){if((ai=Re(ti.charAt(yi)))==="L")return!1;if(ai==="R")return!0}return!1},We=function(ti,ai,yi,di){var bi,vi,Pi,xi,ni=ai[di];switch(ni){case"L":case"R":ke=!1;break;case"N":case"AN":break;case"EN":ke&&(ni="AN");break;case"AL":ke=!0,ni="R";break;case"WS":ni="N";break;case"CS":di<1||di+1>=ai.length||(bi=yi[di-1])!=="EN"&&bi!=="AN"||(vi=ai[di+1])!=="EN"&&vi!=="AN"?ni="N":ke&&(vi="AN"),ni=vi===bi?vi:"N";break;case"ES":ni=(bi=di>0?yi[di-1]:"B")==="EN"&&di+1<ai.length&&ai[di+1]==="EN"?"EN":"N";break;case"ET":if(di>0&&yi[di-1]==="EN"){ni="EN";break}if(ke){ni="N";break}for(Pi=di+1,xi=ai.length;Pi<xi&&ai[Pi]==="ET";)Pi++;ni=Pi<xi&&ai[Pi]==="EN"?"EN":"N";break;case"NSM":if(He&&!Ee){for(xi=ai.length,Pi=di+1;Pi<xi&&ai[Pi]==="NSM";)Pi++;if(Pi<xi){var fi=ti[di],Si=fi>=1425&&fi<=2303||fi===64286;if(bi=ai[Pi],Si&&(bi==="R"||bi==="AL")){ni="R";break}}}ni=di<1||(bi=ai[di-1])==="B"?"N":yi[di-1];break;case"B":ke=!1,Be=!0,ni=De;break;case"S":Ue=!0,ni="N";break;case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":ke=!1;break;case"BN":ni="N"}return ni},Ke=function(ti,ai,yi){var di=ti.split("");return yi&&Je(di,yi,{hiLevel:De}),di.reverse(),ai&&ai.reverse(),di.join("")},Je=function(ti,ai,yi){var di,bi,vi,Pi,xi,ni=-1,fi=ti.length,Si=0,Xe=[],Ge=De?t:Se,ze=[];for(ke=!1,Be=!1,Ue=!1,bi=0;bi<fi;bi++)ze[bi]=Re(ti[bi]);for(vi=0;vi<fi;vi++){if(xi=Si,Xe[vi]=We(ti,ze,Xe,vi),di=240&(Si=Ge[xi][Ae[Xe[vi]]]),Si&=15,ai[vi]=Pi=Ge[Si][5],di>0)if(di===16){for(bi=ni;bi<vi;bi++)ai[bi]=1;ni=-1}else ni=-1;if(Ge[Si][6])ni===-1&&(ni=vi);else if(ni>-1){for(bi=ni;bi<vi;bi++)ai[bi]=Pi;ni=-1}ze[vi]==="B"&&(ai[vi]=0),yi.hiLevel|=Pi}Ue&&function(Ve,ei,si){for(var li=0;li<si;li++)if(Ve[li]==="S"){ei[li]=De;for(var ci=li-1;ci>=0&&Ve[ci]==="WS";ci--)ei[ci]=De}}(ze,ai,fi)},hi=function(ti,ai,yi,di,bi){if(!(bi.hiLevel<ti)){if(ti===1&&De===1&&!Be)return ai.reverse(),void(yi&&yi.reverse());for(var vi,Pi,xi,ni,fi=ai.length,Si=0;Si<fi;){if(di[Si]>=ti){for(xi=Si+1;xi<fi&&di[xi]>=ti;)xi++;for(ni=Si,Pi=xi-1;ni<Pi;ni++,Pi--)vi=ai[ni],ai[ni]=ai[Pi],ai[Pi]=vi,yi&&(vi=yi[ni],yi[ni]=yi[Pi],yi[Pi]=vi);Si=xi}Si++}}},oi=function(ti,ai,yi){var di=ti.split(""),bi={hiLevel:De};return yi||(yi=[]),Je(di,yi,bi),function(vi,Pi,xi){if(xi.hiLevel!==0&&Te)for(var ni,fi=0;fi<vi.length;fi++)Pi[fi]===1&&(ni=St.indexOf(vi[fi]))>=0&&(vi[fi]=St[ni+1])}(di,yi,bi),hi(2,di,ai,yi,bi),hi(1,di,ai,yi,bi),di.join("")};return this.__bidiEngine__.doBidiReorder=function(ti,ai,yi){if(function(bi,vi){if(vi)for(var Pi=0;Pi<bi.length;Pi++)vi[Pi]=Pi;Ee===void 0&&(Ee=je(bi)),xe===void 0&&(xe=je(bi))}(ti,ai),He||!e||xe)if(He&&e&&Ee^xe)De=Ee?1:0,ti=Ke(ti,ai,yi);else if(!He&&e&&xe)De=Ee?1:0,ti=oi(ti,ai,yi),ti=Ke(ti,ai);else if(!He||Ee||e||xe){if(He&&!e&&Ee^xe)ti=Ke(ti,ai),Ee?(De=0,ti=oi(ti,ai,yi)):(De=1,ti=oi(ti,ai,yi),ti=Ke(ti,ai));else if(He&&Ee&&!e&&xe)De=1,ti=oi(ti,ai,yi),ti=Ke(ti,ai);else if(!He&&!e&&Ee^xe){var di=Te;Ee?(De=1,ti=oi(ti,ai,yi),De=0,Te=!1,ti=oi(ti,ai,yi),Te=di):(De=0,ti=oi(ti,ai,yi),ti=Ke(ti,ai),De=1,Te=!1,ti=oi(ti,ai,yi),Te=di,ti=Ke(ti,ai))}}else De=0,ti=oi(ti,ai,yi);else De=Ee?1:0,ti=oi(ti,ai,yi);return ti},this.__bidiEngine__.setOptions=function(ti){ti&&(He=ti.isInputVisual,e=ti.isOutputVisual,Ee=ti.isInputRtl,xe=ti.isOutputRtl,Te=ti.isSymmetricSwapping)},this.__bidiEngine__.setOptions(Oe),this.__bidiEngine__};var r=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],Me=new Ie.__bidiEngine__({isInputVisual:!0});Ie.API.events.push(["postProcessText",function(Oe){var Be=Oe.text,Ue=(Oe.x,Oe.y,Oe.options||{}),He=(Oe.mutex,Ue.lang,[]);if(Ue.isInputVisual=typeof Ue.isInputVisual!="boolean"||Ue.isInputVisual,Me.setOptions(Ue),Object.prototype.toString.call(Be)==="[object Array]"){var Ee=0;for(He=[],Ee=0;Ee<Be.length;Ee+=1)Object.prototype.toString.call(Be[Ee])==="[object Array]"?He.push([Me.doBidiReorder(Be[Ee][0]),Be[Ee][1],Be[Ee][2]]):He.push([Me.doBidiReorder(Be[Ee])]);Oe.text=He}else Oe.text=Me.doBidiReorder(Be);Me.setOptions({isInputVisual:!0})}])}(E),E.API.TTFFont=function(){function Ie(r){var Me;if(this.rawData=r,Me=this.contents=new ne(r),this.contents.pos=4,Me.readString(4)==="ttcf")throw new Error("TTCF not supported.");Me.pos=0,this.parse(),this.subset=new Le(this),this.registerTTF()}return Ie.open=function(r){return new Ie(r)},Ie.prototype.parse=function(){return this.directory=new ie(this.contents),this.head=new se(this),this.name=new pe(this),this.cmap=new ue(this),this.toUnicode={},this.hhea=new he(this),this.maxp=new ge(this),this.hmtx=new me(this),this.post=new fe(this),this.os2=new le(this),this.loca=new Ne(this),this.glyf=new be(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},Ie.prototype.registerTTF=function(){var r,Me,Oe,Be,Ue;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=function(){var He,Ee,e,xe;for(xe=[],He=0,Ee=(e=this.bbox).length;He<Ee;He++)r=e[He],xe.push(Math.round(r*this.scaleFactor));return xe}.call(this),this.stemV=0,this.post.exists?(Oe=255&(Be=this.post.italic_angle),(32768&(Me=Be>>16))!=0&&(Me=-(1+(65535^Me))),this.italicAngle=+(Me+"."+Oe)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(Ue=this.familyClass)===1||Ue===2||Ue===3||Ue===4||Ue===5||Ue===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},Ie.prototype.characterToGlyph=function(r){var Me;return((Me=this.cmap.unicode)!=null?Me.codeMap[r]:void 0)||0},Ie.prototype.widthOfGlyph=function(r){var Me;return Me=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(r).advance*Me},Ie.prototype.widthOfString=function(r,Me,Oe){var Be,Ue,He,Ee;for(He=0,Ue=0,Ee=(r=""+r).length;0<=Ee?Ue<Ee:Ue>Ee;Ue=0<=Ee?++Ue:--Ue)Be=r.charCodeAt(Ue),He+=this.widthOfGlyph(this.characterToGlyph(Be))+Oe*(1e3/Me)||0;return He*(Me/1e3)},Ie.prototype.lineHeight=function(r,Me){var Oe;return Me==null&&(Me=!1),Oe=Me?this.lineGap:0,(this.ascender+Oe-this.decender)/1e3*r},Ie}();var re,ne=function(){function Ie(r){this.data=r!=null?r:[],this.pos=0,this.length=this.data.length}return Ie.prototype.readByte=function(){return this.data[this.pos++]},Ie.prototype.writeByte=function(r){return this.data[this.pos++]=r},Ie.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},Ie.prototype.writeUInt32=function(r){return this.writeByte(r>>>24&255),this.writeByte(r>>16&255),this.writeByte(r>>8&255),this.writeByte(255&r)},Ie.prototype.readInt32=function(){var r;return(r=this.readUInt32())>=2147483648?r-4294967296:r},Ie.prototype.writeInt32=function(r){return r<0&&(r+=4294967296),this.writeUInt32(r)},Ie.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},Ie.prototype.writeUInt16=function(r){return this.writeByte(r>>8&255),this.writeByte(255&r)},Ie.prototype.readInt16=function(){var r;return(r=this.readUInt16())>=32768?r-65536:r},Ie.prototype.writeInt16=function(r){return r<0&&(r+=65536),this.writeUInt16(r)},Ie.prototype.readString=function(r){var Me,Oe;for(Oe=[],Me=0;0<=r?Me<r:Me>r;Me=0<=r?++Me:--Me)Oe[Me]=String.fromCharCode(this.readByte());return Oe.join("")},Ie.prototype.writeString=function(r){var Me,Oe,Be;for(Be=[],Me=0,Oe=r.length;0<=Oe?Me<Oe:Me>Oe;Me=0<=Oe?++Me:--Me)Be.push(this.writeByte(r.charCodeAt(Me)));return Be},Ie.prototype.readShort=function(){return this.readInt16()},Ie.prototype.writeShort=function(r){return this.writeInt16(r)},Ie.prototype.readLongLong=function(){var r,Me,Oe,Be,Ue,He,Ee,e;return r=this.readByte(),Me=this.readByte(),Oe=this.readByte(),Be=this.readByte(),Ue=this.readByte(),He=this.readByte(),Ee=this.readByte(),e=this.readByte(),128&r?-1*(72057594037927940*(255^r)+281474976710656*(255^Me)+1099511627776*(255^Oe)+4294967296*(255^Be)+16777216*(255^Ue)+65536*(255^He)+256*(255^Ee)+(255^e)+1):72057594037927940*r+281474976710656*Me+1099511627776*Oe+4294967296*Be+16777216*Ue+65536*He+256*Ee+e},Ie.prototype.writeLongLong=function(r){var Me,Oe;return Me=Math.floor(r/4294967296),Oe=4294967295&r,this.writeByte(Me>>24&255),this.writeByte(Me>>16&255),this.writeByte(Me>>8&255),this.writeByte(255&Me),this.writeByte(Oe>>24&255),this.writeByte(Oe>>16&255),this.writeByte(Oe>>8&255),this.writeByte(255&Oe)},Ie.prototype.readInt=function(){return this.readInt32()},Ie.prototype.writeInt=function(r){return this.writeInt32(r)},Ie.prototype.read=function(r){var Me,Oe;for(Me=[],Oe=0;0<=r?Oe<r:Oe>r;Oe=0<=r?++Oe:--Oe)Me.push(this.readByte());return Me},Ie.prototype.write=function(r){var Me,Oe,Be,Ue;for(Ue=[],Oe=0,Be=r.length;Oe<Be;Oe++)Me=r[Oe],Ue.push(this.writeByte(Me));return Ue},Ie}(),ie=function(){var Ie;function r(Me){var Oe,Be,Ue;for(this.scalarType=Me.readInt(),this.tableCount=Me.readShort(),this.searchRange=Me.readShort(),this.entrySelector=Me.readShort(),this.rangeShift=Me.readShort(),this.tables={},Be=0,Ue=this.tableCount;0<=Ue?Be<Ue:Be>Ue;Be=0<=Ue?++Be:--Be)Oe={tag:Me.readString(4),checksum:Me.readInt(),offset:Me.readInt(),length:Me.readInt()},this.tables[Oe.tag]=Oe}return r.prototype.encode=function(Me){var Oe,Be,Ue,He,Ee,e,xe,Te,_e,Se,t,Ae,Pe;for(Pe in t=Object.keys(Me).length,e=Math.log(2),_e=16*Math.floor(Math.log(t)/e),He=Math.floor(_e/e),Te=16*t-_e,(Be=new ne).writeInt(this.scalarType),Be.writeShort(t),Be.writeShort(_e),Be.writeShort(He),Be.writeShort(Te),Ue=16*t,xe=Be.pos+Ue,Ee=null,Ae=[],Me)for(Se=Me[Pe],Be.writeString(Pe),Be.writeInt(Ie(Se)),Be.writeInt(xe),Be.writeInt(Se.length),Ae=Ae.concat(Se),Pe==="head"&&(Ee=xe),xe+=Se.length;xe%4;)Ae.push(0),xe++;return Be.write(Ae),Oe=2981146554-Ie(Be.data),Be.pos=Ee+8,Be.writeUInt32(Oe),Be.data},Ie=function(Me){var Oe,Be,Ue,He;for(Me=ve.call(Me);Me.length%4;)Me.push(0);for(Ue=new ne(Me),Be=0,Oe=0,He=Me.length;Oe<He;Oe=Oe+=4)Be+=Ue.readUInt32();return 4294967295&Be},r}(),ae={}.hasOwnProperty,oe=function(Ie,r){for(var Me in r)ae.call(r,Me)&&(Ie[Me]=r[Me]);function Oe(){this.constructor=Ie}return Oe.prototype=r.prototype,Ie.prototype=new Oe,Ie.__super__=r.prototype,Ie};re=function(){function Ie(r){var Me;this.file=r,Me=this.file.directory.tables[this.tag],this.exists=!!Me,Me&&(this.offset=Me.offset,this.length=Me.length,this.parse(this.file.contents))}return Ie.prototype.parse=function(){},Ie.prototype.encode=function(){},Ie.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},Ie}();var se=function(Ie){function r(){return r.__super__.constructor.apply(this,arguments)}return oe(r,re),r.prototype.tag="head",r.prototype.parse=function(Me){return Me.pos=this.offset,this.version=Me.readInt(),this.revision=Me.readInt(),this.checkSumAdjustment=Me.readInt(),this.magicNumber=Me.readInt(),this.flags=Me.readShort(),this.unitsPerEm=Me.readShort(),this.created=Me.readLongLong(),this.modified=Me.readLongLong(),this.xMin=Me.readShort(),this.yMin=Me.readShort(),this.xMax=Me.readShort(),this.yMax=Me.readShort(),this.macStyle=Me.readShort(),this.lowestRecPPEM=Me.readShort(),this.fontDirectionHint=Me.readShort(),this.indexToLocFormat=Me.readShort(),this.glyphDataFormat=Me.readShort()},r.prototype.encode=function(Me){var Oe;return(Oe=new ne).writeInt(this.version),Oe.writeInt(this.revision),Oe.writeInt(this.checkSumAdjustment),Oe.writeInt(this.magicNumber),Oe.writeShort(this.flags),Oe.writeShort(this.unitsPerEm),Oe.writeLongLong(this.created),Oe.writeLongLong(this.modified),Oe.writeShort(this.xMin),Oe.writeShort(this.yMin),Oe.writeShort(this.xMax),Oe.writeShort(this.yMax),Oe.writeShort(this.macStyle),Oe.writeShort(this.lowestRecPPEM),Oe.writeShort(this.fontDirectionHint),Oe.writeShort(Me),Oe.writeShort(this.glyphDataFormat),Oe.data},r}(),ce=function(){function Ie(r,Me){var Oe,Be,Ue,He,Ee,e,xe,Te,_e,Se,t,Ae,Pe,St,Ce,ke,De;switch(this.platformID=r.readUInt16(),this.encodingID=r.readShort(),this.offset=Me+r.readInt(),_e=r.pos,r.pos=this.offset,this.format=r.readUInt16(),this.length=r.readUInt16(),this.language=r.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(e=0;e<256;++e)this.codeMap[e]=r.readByte();break;case 4:for(t=r.readUInt16(),Se=t/2,r.pos+=6,Ue=function(){var Re,je;for(je=[],e=Re=0;0<=Se?Re<Se:Re>Se;e=0<=Se?++Re:--Re)je.push(r.readUInt16());return je}(),r.pos+=2,Pe=function(){var Re,je;for(je=[],e=Re=0;0<=Se?Re<Se:Re>Se;e=0<=Se?++Re:--Re)je.push(r.readUInt16());return je}(),xe=function(){var Re,je;for(je=[],e=Re=0;0<=Se?Re<Se:Re>Se;e=0<=Se?++Re:--Re)je.push(r.readUInt16());return je}(),Te=function(){var Re,je;for(je=[],e=Re=0;0<=Se?Re<Se:Re>Se;e=0<=Se?++Re:--Re)je.push(r.readUInt16());return je}(),Be=(this.length-r.pos+this.offset)/2,Ee=function(){var Re,je;for(je=[],e=Re=0;0<=Be?Re<Be:Re>Be;e=0<=Be?++Re:--Re)je.push(r.readUInt16());return je}(),e=Ce=0,De=Ue.length;Ce<De;e=++Ce)for(St=Ue[e],Oe=ke=Ae=Pe[e];Ae<=St?ke<=St:ke>=St;Oe=Ae<=St?++ke:--ke)Te[e]===0?He=Oe+xe[e]:(He=Ee[Te[e]/2+(Oe-Ae)-(Se-e)]||0)!==0&&(He+=xe[e]),this.codeMap[Oe]=65535&He}r.pos=_e}return Ie.encode=function(r,Me){var Oe,Be,Ue,He,Ee,e,xe,Te,_e,Se,t,Ae,Pe,St,Ce,ke,De,Re,je,We,Ke,Je,hi,oi,ti,ai,yi,di,bi,vi,Pi,xi,ni,fi,Si,Xe,Ge,ze,Ve,ei,si,li,ci,Ci,Fi,Oi;switch(di=new ne,He=Object.keys(r).sort(function(Ti,Ze){return Ti-Ze}),Me){case"macroman":for(Pe=0,St=function(){var Ti=[];for(Ae=0;Ae<256;++Ae)Ti.push(0);return Ti}(),ke={0:0},Ue={},bi=0,ni=He.length;bi<ni;bi++)ke[ci=r[Be=He[bi]]]==null&&(ke[ci]=++Pe),Ue[Be]={old:r[Be],new:ke[r[Be]]},St[Be]=ke[r[Be]];return di.writeUInt16(1),di.writeUInt16(0),di.writeUInt32(12),di.writeUInt16(0),di.writeUInt16(262),di.writeUInt16(0),di.write(St),{charMap:Ue,subtable:di.data,maxGlyphID:Pe+1};case"unicode":for(ai=[],_e=[],De=0,ke={},Oe={},Ce=xe=null,vi=0,fi=He.length;vi<fi;vi++)ke[je=r[Be=He[vi]]]==null&&(ke[je]=++De),Oe[Be]={old:je,new:ke[je]},Ee=ke[je]-Be,Ce!=null&&Ee===xe||(Ce&&_e.push(Ce),ai.push(Be),xe=Ee),Ce=Be;for(Ce&&_e.push(Ce),_e.push(65535),ai.push(65535),oi=2*(hi=ai.length),Je=2*Math.pow(Math.log(hi)/Math.LN2,2),Se=Math.log(Je/2)/Math.LN2,Ke=2*hi-Je,e=[],We=[],t=[],Ae=Pi=0,Si=ai.length;Pi<Si;Ae=++Pi){if(ti=ai[Ae],Te=_e[Ae],ti===65535){e.push(0),We.push(0);break}if(ti-(yi=Oe[ti].new)>=32768)for(e.push(0),We.push(2*(t.length+hi-Ae)),Be=xi=ti;ti<=Te?xi<=Te:xi>=Te;Be=ti<=Te?++xi:--xi)t.push(Oe[Be].new);else e.push(yi-ti),We.push(0)}for(di.writeUInt16(3),di.writeUInt16(1),di.writeUInt32(12),di.writeUInt16(4),di.writeUInt16(16+8*hi+2*t.length),di.writeUInt16(0),di.writeUInt16(oi),di.writeUInt16(Je),di.writeUInt16(Se),di.writeUInt16(Ke),si=0,Xe=_e.length;si<Xe;si++)Be=_e[si],di.writeUInt16(Be);for(di.writeUInt16(0),li=0,Ge=ai.length;li<Ge;li++)Be=ai[li],di.writeUInt16(Be);for(Ci=0,ze=e.length;Ci<ze;Ci++)Ee=e[Ci],di.writeUInt16(Ee);for(Fi=0,Ve=We.length;Fi<Ve;Fi++)Re=We[Fi],di.writeUInt16(Re);for(Oi=0,ei=t.length;Oi<ei;Oi++)Pe=t[Oi],di.writeUInt16(Pe);return{charMap:Oe,subtable:di.data,maxGlyphID:De+1}}},Ie}(),ue=function(Ie){function r(){return r.__super__.constructor.apply(this,arguments)}return oe(r,re),r.prototype.tag="cmap",r.prototype.parse=function(Me){var Oe,Be,Ue;for(Me.pos=this.offset,this.version=Me.readUInt16(),Ue=Me.readUInt16(),this.tables=[],this.unicode=null,Be=0;0<=Ue?Be<Ue:Be>Ue;Be=0<=Ue?++Be:--Be)Oe=new ce(Me,this.offset),this.tables.push(Oe),Oe.isUnicode&&this.unicode==null&&(this.unicode=Oe);return!0},r.encode=function(Me,Oe){var Be,Ue;return Oe==null&&(Oe="macroman"),Be=ce.encode(Me,Oe),(Ue=new ne).writeUInt16(0),Ue.writeUInt16(1),Be.table=Ue.data.concat(Be.subtable),Be},r}(),he=function(Ie){function r(){return r.__super__.constructor.apply(this,arguments)}return oe(r,re),r.prototype.tag="hhea",r.prototype.parse=function(Me){return Me.pos=this.offset,this.version=Me.readInt(),this.ascender=Me.readShort(),this.decender=Me.readShort(),this.lineGap=Me.readShort(),this.advanceWidthMax=Me.readShort(),this.minLeftSideBearing=Me.readShort(),this.minRightSideBearing=Me.readShort(),this.xMaxExtent=Me.readShort(),this.caretSlopeRise=Me.readShort(),this.caretSlopeRun=Me.readShort(),this.caretOffset=Me.readShort(),Me.pos+=8,this.metricDataFormat=Me.readShort(),this.numberOfMetrics=Me.readUInt16()},r}(),le=function(Ie){function r(){return r.__super__.constructor.apply(this,arguments)}return oe(r,re),r.prototype.tag="OS/2",r.prototype.parse=function(Me){if(Me.pos=this.offset,this.version=Me.readUInt16(),this.averageCharWidth=Me.readShort(),this.weightClass=Me.readUInt16(),this.widthClass=Me.readUInt16(),this.type=Me.readShort(),this.ySubscriptXSize=Me.readShort(),this.ySubscriptYSize=Me.readShort(),this.ySubscriptXOffset=Me.readShort(),this.ySubscriptYOffset=Me.readShort(),this.ySuperscriptXSize=Me.readShort(),this.ySuperscriptYSize=Me.readShort(),this.ySuperscriptXOffset=Me.readShort(),this.ySuperscriptYOffset=Me.readShort(),this.yStrikeoutSize=Me.readShort(),this.yStrikeoutPosition=Me.readShort(),this.familyClass=Me.readShort(),this.panose=function(){var Oe,Be;for(Be=[],Oe=0;Oe<10;++Oe)Be.push(Me.readByte());return Be}(),this.charRange=function(){var Oe,Be;for(Be=[],Oe=0;Oe<4;++Oe)Be.push(Me.readInt());return Be}(),this.vendorID=Me.readString(4),this.selection=Me.readShort(),this.firstCharIndex=Me.readShort(),this.lastCharIndex=Me.readShort(),this.version>0&&(this.ascent=Me.readShort(),this.descent=Me.readShort(),this.lineGap=Me.readShort(),this.winAscent=Me.readShort(),this.winDescent=Me.readShort(),this.codePageRange=function(){var Oe,Be;for(Be=[],Oe=0;Oe<2;Oe=++Oe)Be.push(Me.readInt());return Be}(),this.version>1))return this.xHeight=Me.readShort(),this.capHeight=Me.readShort(),this.defaultChar=Me.readShort(),this.breakChar=Me.readShort(),this.maxContext=Me.readShort()},r}(),fe=function(Ie){function r(){return r.__super__.constructor.apply(this,arguments)}return oe(r,re),r.prototype.tag="post",r.prototype.parse=function(Me){var Oe,Be,Ue;switch(Me.pos=this.offset,this.format=Me.readInt(),this.italicAngle=Me.readInt(),this.underlinePosition=Me.readShort(),this.underlineThickness=Me.readShort(),this.isFixedPitch=Me.readInt(),this.minMemType42=Me.readInt(),this.maxMemType42=Me.readInt(),this.minMemType1=Me.readInt(),this.maxMemType1=Me.readInt(),this.format){case 65536:break;case 131072:var He;for(Be=Me.readUInt16(),this.glyphNameIndex=[],He=0;0<=Be?He<Be:He>Be;He=0<=Be?++He:--He)this.glyphNameIndex.push(Me.readUInt16());for(this.names=[],Ue=[];Me.pos<this.offset+this.length;)Oe=Me.readByte(),Ue.push(this.names.push(Me.readString(Oe)));return Ue;case 151552:return Be=Me.readUInt16(),this.offsets=Me.read(Be);case 196608:break;case 262144:return this.map=function(){var Ee,e,xe;for(xe=[],He=Ee=0,e=this.file.maxp.numGlyphs;0<=e?Ee<e:Ee>e;He=0<=e?++Ee:--Ee)xe.push(Me.readUInt32());return xe}.call(this)}},r}(),de=function(Ie,r){this.raw=Ie,this.length=Ie.length,this.platformID=r.platformID,this.encodingID=r.encodingID,this.languageID=r.languageID},pe=function(Ie){function r(){return r.__super__.constructor.apply(this,arguments)}return oe(r,re),r.prototype.tag="name",r.prototype.parse=function(Me){var Oe,Be,Ue,He,Ee,e,xe,Te,_e,Se,t;for(Me.pos=this.offset,Me.readShort(),Oe=Me.readShort(),e=Me.readShort(),Be=[],He=0;0<=Oe?He<Oe:He>Oe;He=0<=Oe?++He:--He)Be.push({platformID:Me.readShort(),encodingID:Me.readShort(),languageID:Me.readShort(),nameID:Me.readShort(),length:Me.readShort(),offset:this.offset+e+Me.readShort()});for(xe={},He=_e=0,Se=Be.length;_e<Se;He=++_e)Ue=Be[He],Me.pos=Ue.offset,Te=Me.readString(Ue.length),Ee=new de(Te,Ue),xe[t=Ue.nameID]==null&&(xe[t]=[]),xe[Ue.nameID].push(Ee);this.strings=xe,this.copyright=xe[0],this.fontFamily=xe[1],this.fontSubfamily=xe[2],this.uniqueSubfamily=xe[3],this.fontName=xe[4],this.version=xe[5];try{this.postscriptName=xe[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=xe[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=xe[7],this.manufacturer=xe[8],this.designer=xe[9],this.description=xe[10],this.vendorUrl=xe[11],this.designerUrl=xe[12],this.license=xe[13],this.licenseUrl=xe[14],this.preferredFamily=xe[15],this.preferredSubfamily=xe[17],this.compatibleFull=xe[18],this.sampleText=xe[19]},r}(),ge=function(Ie){function r(){return r.__super__.constructor.apply(this,arguments)}return oe(r,re),r.prototype.tag="maxp",r.prototype.parse=function(Me){return Me.pos=this.offset,this.version=Me.readInt(),this.numGlyphs=Me.readUInt16(),this.maxPoints=Me.readUInt16(),this.maxContours=Me.readUInt16(),this.maxCompositePoints=Me.readUInt16(),this.maxComponentContours=Me.readUInt16(),this.maxZones=Me.readUInt16(),this.maxTwilightPoints=Me.readUInt16(),this.maxStorage=Me.readUInt16(),this.maxFunctionDefs=Me.readUInt16(),this.maxInstructionDefs=Me.readUInt16(),this.maxStackElements=Me.readUInt16(),this.maxSizeOfInstructions=Me.readUInt16(),this.maxComponentElements=Me.readUInt16(),this.maxComponentDepth=Me.readUInt16()},r}(),me=function(Ie){function r(){return r.__super__.constructor.apply(this,arguments)}return oe(r,re),r.prototype.tag="hmtx",r.prototype.parse=function(Me){var Oe,Be,Ue,He,Ee,e,xe;for(Me.pos=this.offset,this.metrics=[],Oe=0,e=this.file.hhea.numberOfMetrics;0<=e?Oe<e:Oe>e;Oe=0<=e?++Oe:--Oe)this.metrics.push({advance:Me.readUInt16(),lsb:Me.readInt16()});for(Ue=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=function(){var Te,_e;for(_e=[],Oe=Te=0;0<=Ue?Te<Ue:Te>Ue;Oe=0<=Ue?++Te:--Te)_e.push(Me.readInt16());return _e}(),this.widths=function(){var Te,_e,Se,t;for(t=[],Te=0,_e=(Se=this.metrics).length;Te<_e;Te++)He=Se[Te],t.push(He.advance);return t}.call(this),Be=this.widths[this.widths.length-1],xe=[],Oe=Ee=0;0<=Ue?Ee<Ue:Ee>Ue;Oe=0<=Ue?++Ee:--Ee)xe.push(this.widths.push(Be));return xe},r.prototype.forGlyph=function(Me){return Me in this.metrics?this.metrics[Me]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[Me-this.metrics.length]}},r}(),ve=[].slice,be=function(Ie){function r(){return r.__super__.constructor.apply(this,arguments)}return oe(r,re),r.prototype.tag="glyf",r.prototype.parse=function(){return this.cache={}},r.prototype.glyphFor=function(Me){var Oe,Be,Ue,He,Ee,e,xe,Te,_e,Se;return Me in this.cache?this.cache[Me]:(He=this.file.loca,Oe=this.file.contents,Be=He.indexOf(Me),(Ue=He.lengthOf(Me))===0?this.cache[Me]=null:(Oe.pos=this.offset+Be,Ee=(e=new ne(Oe.read(Ue))).readShort(),Te=e.readShort(),Se=e.readShort(),xe=e.readShort(),_e=e.readShort(),this.cache[Me]=Ee===-1?new we(e,Te,Se,xe,_e):new ye(e,Ee,Te,Se,xe,_e),this.cache[Me]))},r.prototype.encode=function(Me,Oe,Be){var Ue,He,Ee,e,xe;for(Ee=[],He=[],e=0,xe=Oe.length;e<xe;e++)Ue=Me[Oe[e]],He.push(Ee.length),Ue&&(Ee=Ee.concat(Ue.encode(Be)));return He.push(Ee.length),{table:Ee,offsets:He}},r}(),ye=function(){function Ie(r,Me,Oe,Be,Ue,He){this.raw=r,this.numberOfContours=Me,this.xMin=Oe,this.yMin=Be,this.xMax=Ue,this.yMax=He,this.compound=!1}return Ie.prototype.encode=function(){return this.raw.data},Ie}(),we=function(){function Ie(r,Me,Oe,Be,Ue){var He,Ee;for(this.raw=r,this.xMin=Me,this.yMin=Oe,this.xMax=Be,this.yMax=Ue,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],He=this.raw;Ee=He.readShort(),this.glyphOffsets.push(He.pos),this.glyphIDs.push(He.readUInt16()),32&Ee;)He.pos+=1&Ee?4:2,128&Ee?He.pos+=8:64&Ee?He.pos+=4:8&Ee&&(He.pos+=2)}return Ie.prototype.encode=function(){var r,Me,Oe;for(Me=new ne(ve.call(this.raw.data)),r=0,Oe=this.glyphIDs.length;r<Oe;++r)Me.pos=this.glyphOffsets[r];return Me.data},Ie}(),Ne=function(Ie){function r(){return r.__super__.constructor.apply(this,arguments)}return oe(r,re),r.prototype.tag="loca",r.prototype.parse=function(Me){var Oe,Be;return Me.pos=this.offset,Oe=this.file.head.indexToLocFormat,this.offsets=Oe===0?function(){var Ue,He;for(He=[],Be=0,Ue=this.length;Be<Ue;Be+=2)He.push(2*Me.readUInt16());return He}.call(this):function(){var Ue,He;for(He=[],Be=0,Ue=this.length;Be<Ue;Be+=4)He.push(Me.readUInt32());return He}.call(this)},r.prototype.indexOf=function(Me){return this.offsets[Me]},r.prototype.lengthOf=function(Me){return this.offsets[Me+1]-this.offsets[Me]},r.prototype.encode=function(Me,Oe){for(var Be=new Uint32Array(this.offsets.length),Ue=0,He=0,Ee=0;Ee<Be.length;++Ee)if(Be[Ee]=Ue,He<Oe.length&&Oe[He]==Ee){++He,Be[Ee]=Ue;var e=this.offsets[Ee],xe=this.offsets[Ee+1]-e;xe>0&&(Ue+=xe)}for(var Te=new Array(4*Be.length),_e=0;_e<Be.length;++_e)Te[4*_e+3]=255&Be[_e],Te[4*_e+2]=(65280&Be[_e])>>8,Te[4*_e+1]=(16711680&Be[_e])>>16,Te[4*_e]=(4278190080&Be[_e])>>24;return Te},r}(),Le=function(){function Ie(r){this.font=r,this.subset={},this.unicodes={},this.next=33}return Ie.prototype.generateCmap=function(){var r,Me,Oe,Be,Ue;for(Me in Be=this.font.cmap.tables[0].codeMap,r={},Ue=this.subset)Oe=Ue[Me],r[Me]=Be[Oe];return r},Ie.prototype.glyphsFor=function(r){var Me,Oe,Be,Ue,He,Ee,e;for(Be={},He=0,Ee=r.length;He<Ee;He++)Be[Ue=r[He]]=this.font.glyf.glyphFor(Ue);for(Ue in Me=[],Be)(Oe=Be[Ue])!=null&&Oe.compound&&Me.push.apply(Me,Oe.glyphIDs);if(Me.length>0)for(Ue in e=this.glyphsFor(Me))Oe=e[Ue],Be[Ue]=Oe;return Be},Ie.prototype.encode=function(r,Me){var Oe,Be,Ue,He,Ee,e,xe,Te,_e,Se,t,Ae,Pe,St,Ce;for(Be in Oe=ue.encode(this.generateCmap(),"unicode"),He=this.glyphsFor(r),t={0:0},Ce=Oe.charMap)t[(e=Ce[Be]).old]=e.new;for(Ae in Se=Oe.maxGlyphID,He)Ae in t||(t[Ae]=Se++);return Te=function(ke){var De,Re;for(De in Re={},ke)Re[ke[De]]=De;return Re}(t),_e=Object.keys(Te).sort(function(ke,De){return ke-De}),Pe=function(){var ke,De,Re;for(Re=[],ke=0,De=_e.length;ke<De;ke++)Ee=_e[ke],Re.push(Te[Ee]);return Re}(),Ue=this.font.glyf.encode(He,Pe,t),xe=this.font.loca.encode(Ue.offsets,Pe),St={cmap:this.font.cmap.raw(),glyf:Ue.table,loca:xe,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(Me)},this.font.os2.exists&&(St["OS/2"]=this.font.os2.raw()),this.font.directory.encode(St)},Ie}();E.API.PDFObject=function(){var Ie;function r(){}return Ie=function(Me,Oe){return(Array(Oe+1).join("0")+Me).slice(-Oe)},r.convert=function(Me){var Oe,Be,Ue,He;if(Array.isArray(Me))return"["+function(){var Ee,e,xe;for(xe=[],Ee=0,e=Me.length;Ee<e;Ee++)Oe=Me[Ee],xe.push(r.convert(Oe));return xe}().join(" ")+"]";if(typeof Me=="string")return"/"+Me;if(Me!=null&&Me.isString)return"("+Me+")";if(Me instanceof Date)return"(D:"+Ie(Me.getUTCFullYear(),4)+Ie(Me.getUTCMonth(),2)+Ie(Me.getUTCDate(),2)+Ie(Me.getUTCHours(),2)+Ie(Me.getUTCMinutes(),2)+Ie(Me.getUTCSeconds(),2)+"Z)";if({}.toString.call(Me)==="[object Object]"){for(Be in Ue=["<<"],Me)He=Me[Be],Ue.push("/"+Be+" "+r.convert(He));return Ue.push(">>"),Ue.join(`
`)}return""+Me},r}();function useReadPDF(){const Ie="data:application/pdf;base64,";pdf.exports.GlobalWorkerOptions.workerSrc="https://westleft.github.io/f2e-sign/plugin/build/pdf.worker.js";class r{constructor(Oe){qn(this,"canvas");qn(this,"readBlob",Oe=>new Promise((Be,Ue)=>{const He=new FileReader;He.addEventListener("load",()=>Be(He.result)),He.addEventListener("error",Ue),He.readAsDataURL(Oe)}));qn(this,"printPDF",async Oe=>{const Be=await this.readBlob(Oe),Ue=atob(Be.substring(Ie.length)),Ee=await(await pdf.exports.getDocument({data:Ue}).promise).getPage(1),e=Ee.getViewport({scale:window.devicePixelRatio}),xe=document.createElement("canvas"),Te=xe.getContext("2d");xe.height=e.height,xe.width=e.width;const _e={canvasContext:Te,viewport:e};return Ee.render(_e).promise.then(()=>xe)});qn(this,"pdfToImage",async Oe=>{const Be=1/window.devicePixelRatio;return new fabric.fabric.Image(Oe,{scaleX:Be,scaleY:Be})});qn(this,"pdfEvent",async Oe=>{this.canvas.requestRenderAll(),console.log(Oe);const Be=await this.printPDF(Oe),Ue=await this.pdfToImage(Be);this.canvas.setWidth(Ue.width/window.devicePixelRatio),this.canvas.setHeight(Ue.height/window.devicePixelRatio),this.canvas.setBackgroundImage(Ue,this.canvas.renderAll.bind(this.canvas))});this.canvas=Oe}}return{PdfReader:r}}function usePdfDownloader(){const Ie=new E;function r(Me){const Oe=Me.toDataURL("image/png"),Be=Ie.internal.pageSize.width,Ue=Ie.internal.pageSize.height;Ie.addImage(Oe,"png",0,0,Be,Ue),Ie.save("download.pdf")}return{downloadPDF:r}}useReadPDF();class PopUnit{constructor(){qn(this,"current");this.current=ref("")}changePop(r){this.current.value=r}}class SignUnit{constructor(){qn(this,"sign");qn(this,"editing");this.sign=ref(""),this.editing=ref(!1)}selectSign(r){this.sign.value=r}addToPDF(r){fabric.fabric.Image.fromURL(this.sign.value,function(Me){Me.top=400,Me.scaleX=.5,Me.scaleY=.5,r.canvas.add(Me)})}}const _hoisted_1={id:"sign"},_hoisted_2={class:"sign-content"},_hoisted_3={class:"content-bar"},_hoisted_4=createStaticVNode('<ul class="step-list"><li class="list-item"><p class="list-text"><span>1</span>\u4E0A\u50B3\u6A94\u6848</p><img class="list-done-img" src="'+_imports_0$2+'" alt=""></li><li class="list-item"><p class="list-text"><span>2</span>\u9032\u884C\u7C3D\u540D</p><img class="list-done-img" src="'+_imports_0$2+'" alt=""></li><li class="list-item"><p class="list-text"><span>3</span>\u4E0B\u8F09\u6587\u4EF6</p></li></ul>',1),_hoisted_5={class:"sign-main-box"},_sfc_main=defineComponent({__name:"Sign",setup(Ie){const r=useStore(),Me=useRouter(),{PdfReader:Oe}=useReadPDF(),{CanvasUnit:Be,cannvasDOM:Ue}=useCanvas(),{downloadPDF:He}=usePdfDownloader();let Ee;onMounted(()=>{e()});const e=()=>{if(r.getters["Files/getFiles"].length===0){Me.push({name:"Home"});return}const Ae=r.getters["Files/getFiles"][0].file,Pe=new fabric.fabric.Canvas("canvas");Ee=new Oe(Pe),Ee.pdfEvent(Ae)},xe=()=>{Se.addToPDF(Ee),_e.changePop("")},Te=()=>{He(Ee.canvas)},_e=new PopUnit,Se=new SignUnit;return provide("addToPDF",xe),provide("popUnit",_e),provide("signUnit",Se),(t,Ae)=>(openBlock(),createElementBlock("div",_hoisted_1,[createVNode(SignList),createBaseVNode("div",_hoisted_2,[createBaseVNode("div",_hoisted_3,[createVNode(TransitionGroup,{tag:"div"},{default:withCtx(()=>[unref(_e).current.value==="sign"?(openBlock(),createBlock(WriteSign,{key:0})):createCommentVNode("",!0),unref(_e).current.value==="choose"?(openBlock(),createBlock(ChooseSign,{key:1})):createCommentVNode("",!0)]),_:1}),_hoisted_4]),createBaseVNode("div",_hoisted_5,[createBaseVNode("canvas",{ref_key:"cannvasDOM",ref:Ue,id:"canvas",style:{"box-shadow":"0px 0px 4px 4px #d8d8d8"}},null,512)]),createBaseVNode("img",{class:"download-pdf",onClick:Te,src:_imports_1$1,alt:"\u4E0B\u8F09pdf\u5716\u793A"})])]))}}),Sign_vue_vue_type_style_index_0_lang="",Sign=Object.freeze(Object.defineProperty({__proto__:null,default:_sfc_main},Symbol.toStringTag,{value:"Module"}));export{Sign as S,commonjsGlobal as c};
